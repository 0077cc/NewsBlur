/*
 jquery.layout 1.3.0 - Release Candidate 29.14
 $Date: 2011-02-13 08:00:00 (Sun, 13 Feb 2011) $
 $Rev: 302914 $

 Copyright (c) 2010 
 Fabrizio Balliano (http://www.fabrizioballiano.net)
 Kevin Dalman (http://allpro.net)

 Dual licensed under the GPL (http://www.gnu.org/licenses/gpl.html)
 and MIT (http://www.opensource.org/licenses/mit-license.php) licenses.

 Changelog: http://layout.jquery-dev.net/changelog.cfm#1.3.0.rc29.13

 Docs: http://layout.jquery-dev.net/documentation.html
 Tips: http://layout.jquery-dev.net/tips.html
 Help: http://groups.google.com/group/jquery-ui-layout
*/
(function(a,b){function c(b){var a=q[b]={},c,d,b=b.split(/\s+/);for(c=0,d=b.length;c<d;c++)a[b[c]]=!0;return a}function d(a,c,d){if(d===b&&a.nodeType===1)if(d="data-"+c.replace(T,"-$1").toLowerCase(),d=a.getAttribute(d),typeof d==="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:h.isNumeric(d)?parseFloat(d):fa.test(d)?h.parseJSON(d):d}catch(e){}h.data(a,c,d)}else d=b;return d}function e(b){for(var a in b)if(!(a==="data"&&h.isEmptyObject(b[a]))&&a!=="toJSON")return!1;return!0}function f(b,
a,c){var d=a+"defer",e=a+"queue",f=a+"mark",g=h._data(b,d);g&&(c==="queue"||!h._data(b,e))&&(c==="mark"||!h._data(b,f))&&setTimeout(function(){!h._data(b,e)&&!h._data(b,f)&&(h.removeData(b,d,!0),g.fire())},0)}function g(){return!1}function j(){return!0}function k(b,a,c){a=a||0;if(h.isFunction(a))return h.grep(b,function(b,d){return!!a.call(b,d,b)===c});else if(a.nodeType)return h.grep(b,function(b){return b===a===c});else if(typeof a==="string"){var d=h.grep(b,function(b){return b.nodeType===1});
if(Na.test(a))return h.filter(a,d,!c);else a=h.filter(a,d)}return h.grep(b,function(b){return h.inArray(b,a)>=0===c})}function l(b){var a=wa.split(" "),b=b.createDocumentFragment();if(b.createElement)for(;a.length;)b.createElement(a.pop());return b}function p(b,a){if(a.nodeType===1&&h.hasData(b)){var c,d,e;d=h._data(b);var f=h._data(a,d),g=d.events;if(g)for(c in delete f.handle,f.events={},g)for(d=0,e=g[c].length;d<e;d++)h.event.add(a,c+(g[c][d].namespace?".":"")+g[c][d].namespace,g[c][d],g[c][d].data);
if(f.data)f.data=h.extend({},f.data)}}function t(b,a){var c;if(a.nodeType===1){a.clearAttributes&&a.clearAttributes();a.mergeAttributes&&a.mergeAttributes(b);c=a.nodeName.toLowerCase();if(c==="object")a.outerHTML=b.outerHTML;else if(c==="input"&&(b.type==="checkbox"||b.type==="radio")){if(b.checked)a.defaultChecked=a.checked=b.checked;if(a.value!==b.value)a.value=b.value}else if(c==="option")a.selected=b.defaultSelected;else if(c==="input"||c==="textarea")a.defaultValue=b.defaultValue;a.removeAttribute(h.expando)}}
function v(b){return typeof b.getElementsByTagName!=="undefined"?b.getElementsByTagName("*"):typeof b.querySelectorAll!=="undefined"?b.querySelectorAll("*"):[]}function H(b){if(b.type==="checkbox"||b.type==="radio")b.defaultChecked=b.checked}function L(b){var a=(b.nodeName||"").toLowerCase();a==="input"?H(b):a!=="script"&&typeof b.getElementsByTagName!=="undefined"&&h.grep(b.getElementsByTagName("input"),H)}function ha(b,a){a.src?h.ajax({url:a.src,async:!1,dataType:"script"}):h.globalEval((a.text||
a.textContent||a.innerHTML||"").replace(pb,"/*$0*/"));a.parentNode&&a.parentNode.removeChild(a)}function N(b,a,c){var d=a==="width"?b.offsetWidth:b.offsetHeight,e=a==="width"?Da:$a;if(d>0)return c!=="border"&&h.each(e,function(){c||(d-=parseFloat(h.css(b,"padding"+this))||0);c==="margin"?d+=parseFloat(h.css(b,c+this))||0:d-=parseFloat(h.css(b,"border"+this+"Width"))||0}),d+"px";d=ta(b,a,a);if(d<0||d==null)d=b.style[a]||0;d=parseFloat(d)||0;c&&h.each(e,function(){d+=parseFloat(h.css(b,"padding"+this))||
0;c!=="padding"&&(d+=parseFloat(h.css(b,"border"+this+"Width"))||0);c==="margin"&&(d+=parseFloat(h.css(b,c+this))||0)});return d+"px"}function O(b){return function(a,c){var K;typeof a!=="string"&&(c=a,a="*");if(h.isFunction(c))for(var d=a.toLowerCase().split(Ga),e=0,f=d.length,g,m;e<f;e++)g=d[e],(m=/^\+/.test(g))&&(g=g.substr(1)||"*"),K=b[g]=b[g]||[],g=K,g[m?"unshift":"push"](c)}}function y(a,c,d,e,f,h){f=f||c.dataTypes[0];h=h||{};h[f]=!0;for(var f=a[f],g=0,m=f?f.length:0,j=a===C,k;g<m&&(j||!k);g++)k=
f[g](c,d,e),typeof k==="string"&&(!j||h[k]?k=b:(c.dataTypes.unshift(k),k=y(a,c,d,e,k,h)));if((j||!k)&&!h["*"])k=y(a,c,d,e,"*",h);return k}function ea(a,c){var d,e,f=h.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((f[d]?a:e||(e={}))[d]=c[d]);e&&h.extend(!0,a,e)}function V(b,a,c,d){if(h.isArray(a))h.each(a,function(a,e){c||Oa.test(b)?d(b,e):V(b+"["+(typeof e==="object"||h.isArray(e)?a:"")+"]",e,c,d)});else if(!c&&a!=null&&typeof a==="object")for(var e in a)V(b+"["+e+"]",a[e],c,d);else d(b,a)}function n(){try{return new a.XMLHttpRequest}catch(b){}}
function W(){setTimeout(ua,0);return hb=h.now()}function ua(){hb=b}function na(b,a){var c={};h.each(ub.concat.apply([],ub.slice(0,a)),function(){c[this]=b});return c}function oa(b){if(!qb[b]){var a=u.body,c=h("<"+b+">").appendTo(a),d=c.css("display");c.remove();if(d==="none"||d===""){if(!Ea)Ea=u.createElement("iframe"),Ea.frameBorder=Ea.width=Ea.height=0;a.appendChild(Ea);if(!Ta||!Ea.createElement)Ta=(Ea.contentWindow||Ea.contentDocument).document,Ta.write((u.compatMode==="CSS1Compat"?"<!doctype html>":
"")+"<html><body>"),Ta.close();c=Ta.createElement(b);Ta.body.appendChild(c);d=h.css(c,"display");a.removeChild(Ea)}qb[b]=d}return qb[b]}function Z(b){return h.isWindow(b)?b:b.nodeType===9?b.defaultView||b.parentWindow:!1}var u=a.document,w=a.navigator,r=a.location,h=function(){function c(){if(!d.isReady){try{u.documentElement.doScroll("left")}catch(b){setTimeout(c,1);return}d.ready()}}var d=function(b,a){return new d.fn.init(b,a,h)},e=a.jQuery,f=a.$,h,g=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,
m=/\S/,j=/^\s+/,k=/\s+$/,A=/\d/,l=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,B=/^[\],:{}\s]*$/,r=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,C=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,ka=/(?:^|:|,)(?:\s*\[)+/g,F=/(webkit)[ \/]([\w.]+)/,q=/(opera)(?:.*version)?[ \/]([\w.]+)/,p=/(msie) ([\w.]+)/,X=/(mozilla)(?:.*? rv:([\w.]+))?/,I=/-([a-z]|[0-9])/ig,qa=/^-ms-/,Aa=function(b,a){return(a+"").toUpperCase()},ab=w.userAgent,ib,Q,xa=Object.prototype.toString,sa=Object.prototype.hasOwnProperty,n=Array.prototype.push,
t=Array.prototype.slice,v=String.prototype.trim,L=Array.prototype.indexOf,J={};d.fn=d.prototype={constructor:d,init:function(a,c,e){var f;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if(a==="body"&&!c&&u.body)return this.context=u,this[0]=u.body,this.selector=a,this.length=1,this;if(typeof a==="string")if((f=a.charAt(0)==="<"&&a.charAt(a.length-1)===">"&&a.length>=3?[null,a,null]:g.exec(a))&&(f[1]||!c))if(f[1])return e=(c=c instanceof d?c[0]:c)?c.ownerDocument||
c:u,(a=l.exec(a))?d.isPlainObject(c)?(a=[u.createElement(a[1])],d.fn.attr.call(a,c,!0)):a=[e.createElement(a[1])]:(a=d.buildFragment([f[1]],[e]),a=(a.cacheable?d.clone(a.fragment):a.fragment).childNodes),d.merge(this,a);else{if((c=u.getElementById(f[2]))&&c.parentNode){if(c.id!==f[2])return e.find(a);this.length=1;this[0]=c}this.context=u;this.selector=a;return this}else return!c||c.jquery?(c||e).find(a):this.constructor(c).find(a);else if(d.isFunction(a))return e.ready(a);if(a.selector!==b)this.selector=
a.selector,this.context=a.context;return d.makeArray(a,this)},selector:"",jquery:"1.7",length:0,size:function(){return this.length},toArray:function(){return t.call(this,0)},get:function(b){return b==null?this.toArray():b<0?this[this.length+b]:this[b]},pushStack:function(b,a,c){var e=this.constructor();d.isArray(b)?n.apply(e,b):d.merge(e,b);e.prevObject=this;e.context=this.context;if(a==="find")e.selector=this.selector+(this.selector?" ":"")+c;else if(a)e.selector=this.selector+"."+a+"("+c+")";return e},
each:function(b,a){return d.each(this,b,a)},ready:function(b){d.bindReady();ib.add(b);return this},eq:function(b){return b===-1?this.slice(b):this.slice(b,+b+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(t.apply(this,arguments),"slice",t.call(arguments).join(","))},map:function(b){return this.pushStack(d.map(this,function(a,c){return b.call(a,c,a)}))},end:function(){return this.prevObject||this.constructor(null)},push:n,sort:[].sort,
splice:[].splice};d.fn.init.prototype=d.fn;d.extend=d.fn.extend=function(){var a,c,e,f,S,h=arguments[0]||{},g=1,m=arguments.length,Ma=!1;typeof h==="boolean"&&(Ma=h,h=arguments[1]||{},g=2);typeof h!=="object"&&!d.isFunction(h)&&(h={});m===g&&(h=this,--g);for(;g<m;g++)if((a=arguments[g])!=null)for(c in a)e=h[c],f=a[c],h!==f&&(Ma&&f&&(d.isPlainObject(f)||(S=d.isArray(f)))?(S?(S=!1,e=e&&d.isArray(e)?e:[]):e=e&&d.isPlainObject(e)?e:{},h[c]=d.extend(Ma,e,f)):f!==b&&(h[c]=f));return h};d.extend({noConflict:function(b){if(a.$===
d)a.$=f;if(b&&a.jQuery===d)a.jQuery=e;return d},isReady:!1,readyWait:1,holdReady:function(b){b?d.readyWait++:d.ready(!0)},ready:function(b){if(b===!0&&!--d.readyWait||b!==!0&&!d.isReady){if(!u.body)return setTimeout(d.ready,1);d.isReady=!0;b!==!0&&--d.readyWait>0||(ib.fireWith(u,[d]),d.fn.trigger&&d(u).trigger("ready").unbind("ready"))}},bindReady:function(){if(!ib){ib=d.Callbacks("once memory");if(u.readyState==="complete")return setTimeout(d.ready,1);if(u.addEventListener)u.addEventListener("DOMContentLoaded",
Q,!1),a.addEventListener("load",d.ready,!1);else if(u.attachEvent){u.attachEvent("onreadystatechange",Q);a.attachEvent("onload",d.ready);var b=!1;try{b=a.frameElement==null}catch(e){}u.documentElement.doScroll&&b&&c()}}},isFunction:function(b){return d.type(b)==="function"},isArray:Array.isArray||function(b){return d.type(b)==="array"},isWindow:function(b){return b&&typeof b==="object"&&"setInterval"in b},isNumeric:function(b){return b!=null&&A.test(b)&&!isNaN(b)},type:function(b){return b==null?
String(b):J[xa.call(b)]||"object"},isPlainObject:function(a){if(!a||d.type(a)!=="object"||a.nodeType||d.isWindow(a))return!1;try{if(a.constructor&&!sa.call(a,"constructor")&&!sa.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}for(var e in a);return e===b||sa.call(a,e)},isEmptyObject:function(b){for(var a in b)return!1;return!0},error:function(b){throw b;},parseJSON:function(b){if(typeof b!=="string"||!b)return null;b=d.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);
if(B.test(b.replace(r,"@").replace(C,"]").replace(ka,"")))return(new Function("return "+b))();d.error("Invalid JSON: "+b)},parseXML:function(c){var e,f;try{a.DOMParser?(f=new DOMParser,e=f.parseFromString(c,"text/xml")):(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(c))}catch(h){e=b}(!e||!e.documentElement||e.getElementsByTagName("parsererror").length)&&d.error("Invalid XML: "+c);return e},noop:function(){},globalEval:function(b){b&&m.test(b)&&(a.execScript||function(b){a.eval.call(a,
b)})(b)},camelCase:function(b){return b.replace(qa,"ms-").replace(I,Aa)},nodeName:function(b,a){return b.nodeName&&b.nodeName.toUpperCase()===a.toUpperCase()},each:function(a,c,e){var f,h=0,S=a.length,g=S===b||d.isFunction(a);if(e)if(g)for(f in a){if(c.apply(a[f],e)===!1)break}else for(;h<S;){if(c.apply(a[h++],e)===!1)break}else if(g)for(f in a){if(c.call(a[f],f,a[f])===!1)break}else for(;h<S;)if(c.call(a[h],h,a[h++])===!1)break;return a},trim:v?function(b){return b==null?"":v.call(b)}:function(b){return b==
null?"":b.toString().replace(j,"").replace(k,"")},makeArray:function(b,a){var c=a||[];if(b!=null){var e=d.type(b);b.length==null||e==="string"||e==="function"||e==="regexp"||d.isWindow(b)?n.call(c,b):d.merge(c,b)}return c},inArray:function(b,a,c){var d;if(a){if(L)return L.call(a,b,c);d=a.length;for(c=c?c<0?Math.max(0,d+c):c:0;c<d;c++)if(c in a&&a[c]===b)return c}return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length==="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else for(;c[e]!==b;)a[d++]=
c[e++];a.length=d;return a},grep:function(b,a,c){for(var d=[],e,c=!!c,f=0,h=b.length;f<h;f++)e=!!a(b[f],f),c!==e&&d.push(b[f]);return d},map:function(a,c,e){var f,h,S=[],g=0,m=a.length;if(a instanceof d||m!==b&&typeof m==="number"&&(m>0&&a[0]&&a[m-1]||m===0||d.isArray(a)))for(;g<m;g++)f=c(a[g],g,e),f!=null&&(S[S.length]=f);else for(h in a)f=c(a[h],h,e),f!=null&&(S[S.length]=f);return S.concat.apply([],S)},guid:1,proxy:function(a,c){if(typeof c==="string")var e=a[c],c=a,a=e;if(!d.isFunction(a))return b;
var f=t.call(arguments,2),e=function(){return a.apply(c,f.concat(t.call(arguments)))};e.guid=a.guid=a.guid||e.guid||d.guid++;return e},access:function(a,c,e,f,h,S){var g=a.length;if(typeof c==="object"){for(var m in c)d.access(a,m,c[m],f,h,e);return a}if(e!==b){f=!S&&f&&d.isFunction(e);for(m=0;m<g;m++)h(a[m],c,f?e.call(a[m],m,h(a[m],c)):e,S);return a}return g?h(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(b){b=b.toLowerCase();b=F.exec(b)||q.exec(b)||p.exec(b)||b.indexOf("compatible")<
0&&X.exec(b)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function b(a,c){return new b.fn.init(a,c)}d.extend(!0,b,this);b.superclass=this;b.fn=b.prototype=this();b.fn.constructor=b;b.sub=this.sub;b.fn.init=function(c,e){e&&e instanceof d&&!(e instanceof b)&&(e=b(e));return d.fn.init.call(this,c,e,a)};b.fn.init.prototype=b.fn;var a=b(u);return b},browser:{}});d.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(b,a){J["[object "+a+"]"]=a.toLowerCase()});
ab=d.uaMatch(ab);if(ab.browser)d.browser[ab.browser]=!0,d.browser.version=ab.version;if(d.browser.webkit)d.browser.safari=!0;m.test("\u00a0")&&(j=/^[\s\xA0]+/,k=/[\s\xA0]+$/);h=d(u);u.addEventListener?Q=function(){u.removeEventListener("DOMContentLoaded",Q,!1);d.ready()}:u.attachEvent&&(Q=function(){u.readyState==="complete"&&(u.detachEvent("onreadystatechange",Q),d.ready())});typeof define==="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return d});return d}(),q={};h.Callbacks=
function(a){var a=a?q[a]||c(a):{},d=[],e=[],f,g,m,j,k,A=function(b){var c,e,f,g;for(c=0,e=b.length;c<e;c++)f=b[c],g=h.type(f),g==="array"?A(f):g==="function"&&(!a.unique||!B.has(f))&&d.push(f)},l=function(b,c){c=c||[];f=!a.memory||[b,c];g=!0;k=m||0;m=0;for(j=d.length;d&&k<j;k++)if(d[k].apply(b,c)===!1&&a.stopOnFalse){f=!0;break}g=!1;d&&(a.once?f===!0?B.disable():d=[]:e&&e.length&&(f=e.shift(),B.fireWith(f[0],f[1])))},B={add:function(){if(d){var b=d.length;A(arguments);g?j=d.length:f&&f!==!0&&(m=b,
l(f[0],f[1]))}return this},remove:function(){if(d)for(var b=arguments,c=0,e=b.length;c<e;c++)for(var f=0;f<d.length;f++)if(b[c]===d[f]&&(g&&f<=j&&(j--,f<=k&&k--),d.splice(f--,1),a.unique))break;return this},has:function(b){if(d)for(var a=0,c=d.length;a<c;a++)if(b===d[a])return!0;return!1},empty:function(){d=[];return this},disable:function(){d=e=f=b;return this},disabled:function(){return!d},lock:function(){e=b;(!f||f===!0)&&B.disable();return this},locked:function(){return!e},fireWith:function(b,
c){e&&(g?a.once||e.push([b,c]):(!a.once||!f)&&l(b,c));return this},fire:function(){B.fireWith(this,arguments);return this},fired:function(){return!!f}};return B};var J=[].slice;h.extend({Deferred:function(b){var a=h.Callbacks("once memory"),c=h.Callbacks("once memory"),d=h.Callbacks("memory"),e="pending",f={resolve:a,reject:c,notify:d},g={done:a.add,fail:c.add,progress:d.add,state:function(){return e},isResolved:a.fired,isRejected:c.fired,then:function(b,a,c){m.done(b).fail(a).progress(c);return this},
always:function(){return m.done.apply(m,arguments).fail.apply(m,arguments)},pipe:function(b,a,c){return h.Deferred(function(d){h.each({done:[b,"resolve"],fail:[a,"reject"],progress:[c,"notify"]},function(b,a){var c=a[0],e=a[1],f;if(h.isFunction(c))m[b](function(){if((f=c.apply(this,arguments))&&h.isFunction(f.promise))f.promise().then(d.resolve,d.reject,d.notify);else d[e+"With"](this===m?d:this,[f])});else m[b](d[e])})}).promise()},promise:function(b){if(b==null)b=g;else for(var a in g)b[a]=g[a];
return b}},m=g.promise({}),j;for(j in f)m[j]=f[j].fire,m[j+"With"]=f[j].fireWith;m.done(function(){e="resolved"},c.disable,d.lock).fail(function(){e="rejected"},a.disable,d.lock);b&&b.call(m,m);return m},when:function(b){function a(b){return function(a){d[b]=arguments.length>1?J.call(arguments,0):a;--m||j.resolveWith(j,d)}}function c(b){return function(a){g[b]=arguments.length>1?J.call(arguments,0):a;j.notifyWith(k,g)}}var d=J.call(arguments,0),e=0,f=d.length,g=Array(f),m=f,j=f<=1&&b&&h.isFunction(b.promise)?
b:h.Deferred(),k=j.promise();if(f>1){for(;e<f;e++)d[e]&&d[e].promise&&h.isFunction(d[e].promise)?d[e].promise().then(a(e),j.reject,c(e)):--m;m||j.resolveWith(j,d)}else j!==b&&j.resolveWith(j,f?[b]:[]);return k}});h.support=function(){var b=u.createElement("div"),a=u.documentElement,c,d,e,f,g,m,j,k;b.setAttribute("className","t");b.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/><nav></nav>";c=b.getElementsByTagName("*");d=b.getElementsByTagName("a")[0];
if(!c||!c.length||!d)return{};e=u.createElement("select");f=e.appendChild(u.createElement("option"));c=b.getElementsByTagName("input")[0];g={leadingWhitespace:b.firstChild.nodeType===3,tbody:!b.getElementsByTagName("tbody").length,htmlSerialize:!!b.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:d.getAttribute("href")==="/a",opacity:/^0.55/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,unknownElems:!!b.getElementsByTagName("nav").length,checkOn:c.value===
"on",optSelected:f.selected,getSetAttribute:b.className!=="t",enctype:!!u.createElement("form").enctype,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0};c.checked=!0;g.noCloneChecked=c.cloneNode(!0).checked;e.disabled=!0;g.optDisabled=!f.disabled;try{delete b.test}catch(A){g.deleteExpando=!1}!b.addEventListener&&b.attachEvent&&b.fireEvent&&(b.attachEvent("onclick",function(){g.noCloneEvent=!1}),
b.cloneNode(!0).fireEvent("onclick"));c=u.createElement("input");c.value="t";c.setAttribute("type","radio");g.radioValue=c.value==="t";c.setAttribute("checked","checked");b.appendChild(c);d=u.createDocumentFragment();d.appendChild(b.lastChild);g.checkClone=d.cloneNode(!0).cloneNode(!0).lastChild.checked;b.innerHTML="";b.style.width=b.style.paddingLeft="1px";m=u.getElementsByTagName("body")[0];j=u.createElement(m?"div":"body");d={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};
m&&h.extend(d,{position:"absolute",left:"-999px",top:"-999px"});for(k in d)j.style[k]=d[k];j.appendChild(b);a=m||a;a.insertBefore(j,a.firstChild);g.appendChecked=c.checked;g.boxModel=b.offsetWidth===2;if("zoom"in b.style)b.style.display="inline",b.style.zoom=1,g.inlineBlockNeedsLayout=b.offsetWidth===2,b.style.display="",b.innerHTML="<div style='width:4px;'></div>",g.shrinkWrapBlocks=b.offsetWidth!==2;b.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";
d=b.getElementsByTagName("td");c=d[0].offsetHeight===0;d[0].style.display="";d[1].style.display="none";g.reliableHiddenOffsets=c&&d[0].offsetHeight===0;b.innerHTML="";if(u.defaultView&&u.defaultView.getComputedStyle)c=u.createElement("div"),c.style.width="0",c.style.marginRight="0",b.appendChild(c),g.reliableMarginRight=(parseInt((u.defaultView.getComputedStyle(c,null)||{marginRight:0}).marginRight,10)||0)===0;if(b.attachEvent)for(k in{submit:1,change:1,focusin:1})d="on"+k,c=d in b,c||(b.setAttribute(d,
"return;"),c=typeof b[d]==="function"),g[k+"Bubbles"]=c;h(function(){var b,a,c,d;if(m=u.getElementsByTagName("body")[0])b=u.createElement("div"),b.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",m.insertBefore(b,m.firstChild),j=u.createElement("div"),j.style.cssText="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;visibility:hidden;border:0;",j.innerHTML="<div style='position:absolute;top:0;left:0;width:1px;height:1px;margin:0;border:5px solid #000;padding:0;'><div></div></div><table style='position:absolute;top:0;left:0;width:1px;height:1px;margin:0;border:5px solid #000;padding:0;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>",
b.appendChild(j),a=j.firstChild,c=a.firstChild,d={doesNotAddBorder:c.offsetTop!==5,doesAddBorderForTableAndCells:a.nextSibling.firstChild.firstChild.offsetTop===5},c.style.position="fixed",c.style.top="20px",d.fixedPosition=c.offsetTop===20||c.offsetTop===15,c.style.position=c.style.top="",a.style.overflow="hidden",a.style.position="relative",d.subtractsBorderForOverflowNotVisible=c.offsetTop===-5,d.doesNotIncludeMarginInBodyOffset=m.offsetTop!==1,m.removeChild(b),j=null,h.extend(g,d)});j.innerHTML=
"";a.removeChild(j);j=d=e=f=m=c=b=c=null;return g}();h.boxModel=h.support.boxModel;var fa=/^(?:\{.*\}|\[.*\])$/,T=/([A-Z])/g;h.extend({cache:{},uuid:0,expando:"jQuery"+(h.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(b){b=b.nodeType?h.cache[b[h.expando]]:b[h.expando];return!!b&&!e(b)},data:function(a,c,d,e){if(h.acceptData(a)){var f,g=typeof c==="string",m=(f=a.nodeType)?h.cache:a,j=f?a[h.expando]:a[h.expando]&&
h.expando,k=c==="events";if(j&&m[j]&&(k||e||m[j].data)||!(g&&d===b)){if(!j)f?a[h.expando]=j=++h.uuid:j=h.expando;if(!m[j]&&(m[j]={},!f))m[j].toJSON=h.noop;if(typeof c==="object"||typeof c==="function")e?m[j]=h.extend(m[j],c):m[j].data=h.extend(m[j].data,c);f=a=m[j];if(!e){if(!a.data)a.data={};a=a.data}d!==b&&(a[h.camelCase(c)]=d);if(k&&!a[c])return f.events;g?(d=a[c],d==null&&(d=a[h.camelCase(c)])):d=a;return d}}},removeData:function(b,a,c){if(h.acceptData(b)){var d,f,g,m=b.nodeType,j=m?h.cache:b,
k=m?b[h.expando]:h.expando;if(j[k]){if(a&&(d=c?j[k]:j[k].data)){h.isArray(a)||(a in d?a=[a]:(a=h.camelCase(a),a=a in d?[a]:a.split(" ")));for(f=0,g=a.length;f<g;f++)delete d[a[f]];if(!(c?e:h.isEmptyObject)(d))return}if(!c&&(delete j[k].data,!e(j[k])))return;h.support.deleteExpando||!j.setInterval?delete j[k]:j[k]=null;m&&(h.support.deleteExpando?delete b[h.expando]:b.removeAttribute?b.removeAttribute(h.expando):b[h.expando]=null)}}},_data:function(b,a,c){return h.data(b,a,c,!0)},acceptData:function(b){if(b.nodeName){var a=
h.noData[b.nodeName.toLowerCase()];if(a)return!(a===!0||b.getAttribute("classid")!==a)}return!0}});h.fn.extend({data:function(a,c){var e,f,g,m=null;if(typeof a==="undefined"){if(this.length&&(m=h.data(this[0]),this[0].nodeType===1&&!h._data(this[0],"parsedAttrs"))){f=this[0].attributes;for(var j=0,k=f.length;j<k;j++)g=f[j].name,g.indexOf("data-")===0&&(g=h.camelCase(g.substring(5)),d(this[0],g,m[g]));h._data(this[0],"parsedAttrs",!0)}return m}else if(typeof a==="object")return this.each(function(){h.data(this,
a)});e=a.split(".");e[1]=e[1]?"."+e[1]:"";return c===b?(m=this.triggerHandler("getData"+e[1]+"!",[e[0]]),m===b&&this.length&&(m=h.data(this[0],a),m=d(this[0],a,m)),m===b&&e[1]?this.data(e[0]):m):this.each(function(){var b=h(this),d=[e[0],c];b.triggerHandler("setData"+e[1]+"!",d);h.data(this,a,c);b.triggerHandler("changeData"+e[1]+"!",d)})},removeData:function(b){return this.each(function(){h.removeData(this,b)})}});h.extend({_mark:function(b,a){b&&(a=(a||"fx")+"mark",h._data(b,a,(h._data(b,a)||0)+
1))},_unmark:function(b,a,c){b!==!0&&(c=a,a=b,b=!1);if(a){var c=c||"fx",d=c+"mark";(b=b?0:(h._data(a,d)||1)-1)?h._data(a,d,b):(h.removeData(a,d,!0),f(a,c,"mark"))}},queue:function(b,a,c){var d;if(b)return a=(a||"fx")+"queue",d=h._data(b,a),c&&(!d||h.isArray(c)?d=h._data(b,a,h.makeArray(c)):d.push(c)),d||[]},dequeue:function(b,a){var a=a||"fx",c=h.queue(b,a),d=c.shift(),e={};d==="inprogress"&&(d=c.shift());d&&(a==="fx"&&c.unshift("inprogress"),h._data(b,a+".run",e),d.call(b,function(){h.dequeue(b,
a)},e));c.length||(h.removeData(b,a+"queue "+a+".run",!0),f(b,a,"queue"))}});h.fn.extend({queue:function(a,c){typeof a!=="string"&&(c=a,a="fx");return c===b?h.queue(this[0],a):this.each(function(){var b=h.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&h.dequeue(this,a)})},dequeue:function(b){return this.each(function(){h.dequeue(this,b)})},delay:function(b,a){b=h.fx?h.fx.speeds[b]||b:b;return this.queue(a||"fx",function(a,c){var d=setTimeout(a,b);c.stop=function(){clearTimeout(d)}})},clearQueue:function(b){return this.queue(b||
"fx",[])},promise:function(a){function c(){--g||d.resolveWith(e,[e])}typeof a!=="string"&&(a=b);var a=a||"fx",d=h.Deferred(),e=this,f=e.length,g=1,m=a+"defer",j=a+"queue";a+="mark";for(var k;f--;)if(k=h.data(e[f],m,b,!0)||(h.data(e[f],j,b,!0)||h.data(e[f],a,b,!0))&&h.data(e[f],m,h.Callbacks("once memory"),!0))g++,k.add(c);c();return d.promise()}});var R=/[\n\t\r]/g,z=/\s+/,Ha=/\r/g,P=/^(?:button|input)$/i,Ba=/^(?:button|input|object|select|textarea)$/i,x=/^a(?:rea)?$/i,aa=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,
D=h.support.getSetAttribute,E,ba,ma;h.fn.extend({attr:function(b,a){return h.access(this,b,a,!0,h.attr)},removeAttr:function(b){return this.each(function(){h.removeAttr(this,b)})},prop:function(b,a){return h.access(this,b,a,!0,h.prop)},removeProp:function(a){a=h.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(b){var a,c,d,e,f,g,m;if(h.isFunction(b))return this.each(function(a){h(this).addClass(b.call(this,a,this.className))});if(b&&typeof b===
"string"){a=b.split(z);for(c=0,d=this.length;c<d;c++)if(e=this[c],e.nodeType===1)if(!e.className&&a.length===1)e.className=b;else{f=" "+e.className+" ";for(g=0,m=a.length;g<m;g++)~f.indexOf(" "+a[g]+" ")||(f+=a[g]+" ");e.className=h.trim(f)}}return this},removeClass:function(a){var c,d,e,f,g,m,j;if(h.isFunction(a))return this.each(function(b){h(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a==="string"||a===b){c=(a||"").split(z);for(d=0,e=this.length;d<e;d++)if(f=this[d],f.nodeType===
1&&f.className)if(a){g=(" "+f.className+" ").replace(R," ");for(m=0,j=c.length;m<j;m++)g=g.replace(" "+c[m]+" "," ");f.className=h.trim(g)}else f.className=""}return this},toggleClass:function(b,a){var c=typeof b,d=typeof a==="boolean";return h.isFunction(b)?this.each(function(c){h(this).toggleClass(b.call(this,c,this.className,a),a)}):this.each(function(){if(c==="string")for(var e,f=0,g=h(this),m=a,j=b.split(z);e=j[f++];)m=d?m:!g.hasClass(e),g[m?"addClass":"removeClass"](e);else if(c==="undefined"||
c==="boolean")this.className&&h._data(this,"__className__",this.className),this.className=this.className||b===!1?"":h._data(this,"__className__")||""})},hasClass:function(b){for(var b=" "+b+" ",a=0,c=this.length;a<c;a++)if(this[a].nodeType===1&&(" "+this[a].className+" ").replace(R," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,f=this[0];if(!arguments.length){if(f){if((c=h.valHooks[f.nodeName.toLowerCase()]||h.valHooks[f.type])&&"get"in c&&(d=c.get(f,"value"))!==b)return d;d=f.value;
return typeof d==="string"?d.replace(Ha,""):d==null?"":d}return b}e=h.isFunction(a);return this.each(function(d){var f=h(this);if(this.nodeType===1&&(d=e?a.call(this,d,f.val()):a,d==null?d="":typeof d==="number"?d+="":h.isArray(d)&&(d=h.map(d,function(b){return b==null?"":b+""})),c=h.valHooks[this.nodeName.toLowerCase()]||h.valHooks[this.type],!c||!("set"in c)||c.set(this,d,"value")===b))this.value=d})}});h.extend({valHooks:{option:{get:function(b){var a=b.attributes.value;return!a||a.specified?b.value:
b.text}},select:{get:function(b){var a,c,d=b.selectedIndex,e=[],f=b.options,g=b.type==="select-one";if(d<0)return null;b=g?d:0;for(c=g?d+1:f.length;b<c;b++)if(a=f[b],a.selected&&(h.support.optDisabled?!a.disabled:a.getAttribute("disabled")===null)&&(!a.parentNode.disabled||!h.nodeName(a.parentNode,"optgroup"))){a=h(a).val();if(g)return a;e.push(a)}return g&&!e.length&&f.length?h(f[d]).val():e},set:function(b,a){var c=h.makeArray(a);h(b).find("option").each(function(){this.selected=h.inArray(h(this).val(),
c)>=0});if(!c.length)b.selectedIndex=-1;return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var f,g,m=a.nodeType;if(!a||m===3||m===8||m===2)return b;if(e&&c in h.attrFn)return h(a)[c](d);if(!("getAttribute"in a))return h.prop(a,c,d);if(e=m!==1||!h.isXMLDoc(a))c=c.toLowerCase(),g=h.attrHooks[c]||(aa.test(c)?ba:E);return d!==b?d===null?(h.removeAttr(a,c),b):g&&"set"in g&&e&&(f=g.set(a,d,c))!==b?f:(a.setAttribute(c,""+d),d):g&&"get"in g&&e&&
(f=g.get(a,c))!==null?f:(f=a.getAttribute(c),f===null?b:f)},removeAttr:function(b,a){var c,d,e,f,g=0;if(b.nodeType===1){d=(a||"").split(z);for(f=d.length;g<f;g++)e=d[g].toLowerCase(),c=h.propFix[e]||e,h.attr(b,e,""),b.removeAttribute(D?e:c),aa.test(e)&&c in b&&(b[c]=!1)}},attrHooks:{type:{set:function(b,a){if(P.test(b.nodeName)&&b.parentNode)h.error("type property can't be changed");else if(!h.support.radioValue&&a==="radio"&&h.nodeName(b,"input")){var c=b.value;b.setAttribute("type",a);if(c)b.value=
c;return a}}},value:{get:function(b,a){return E&&h.nodeName(b,"button")?E.get(b,a):a in b?b.value:null},set:function(b,a,c){if(E&&h.nodeName(b,"button"))return E.set(b,a,c);b.value=a}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,f,g=a.nodeType;if(!a||
g===3||g===8||g===2)return b;if(g!==1||!h.isXMLDoc(a))c=h.propFix[c]||c,f=h.propHooks[c];return d!==b?f&&"set"in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get"in f&&(e=f.get(a,c))!==null?e:a[c]},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):Ba.test(a.nodeName)||x.test(a.nodeName)&&a.href?0:b}}}});h.attrHooks.tabindex=h.propHooks.tabIndex;ba={get:function(a,c){var d,e=h.prop(a,c);return e===!0||typeof e!=="boolean"&&(d=a.getAttributeNode(c))&&
d.nodeValue!==!1?c.toLowerCase():b},set:function(b,a,c){a===!1?h.removeAttr(b,c):(a=h.propFix[c]||c,a in b&&(b[a]=!0),b.setAttribute(c,c.toLowerCase()));return c}};if(!D)ma={name:!0,id:!0},E=h.valHooks.button={get:function(a,c){var d;return(d=a.getAttributeNode(c))&&(ma[c]?d.nodeValue!=="":d.specified)?d.nodeValue:b},set:function(b,a,c){var d=b.getAttributeNode(c);d||(d=u.createAttribute(c),b.setAttributeNode(d));return d.nodeValue=a+""}},h.attrHooks.tabindex.set=E.set,h.each(["width","height"],function(b,
a){h.attrHooks[a]=h.extend(h.attrHooks[a],{set:function(b,c){if(c==="")return b.setAttribute(a,"auto"),c}})}),h.attrHooks.contenteditable={get:E.get,set:function(b,a,c){a===""&&(a="false");E.set(b,a,c)}};h.support.hrefNormalized||h.each(["href","src","width","height"],function(a,c){h.attrHooks[c]=h.extend(h.attrHooks[c],{get:function(a){a=a.getAttribute(c,2);return a===null?b:a}})});if(!h.support.style)h.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(b,a){return b.style.cssText=
""+a}};if(!h.support.optSelected)h.propHooks.selected=h.extend(h.propHooks.selected,{get:function(){return null}});if(!h.support.enctype)h.propFix.enctype="encoding";h.support.checkOn||h.each(["radio","checkbox"],function(){h.valHooks[this]={get:function(b){return b.getAttribute("value")===null?"on":b.value}}});h.each(["radio","checkbox"],function(){h.valHooks[this]=h.extend(h.valHooks[this],{set:function(b,a){if(h.isArray(a))return b.checked=h.inArray(h(b).val(),a)>=0}})});var pa=/^(?:textarea|input|select)$/i,
ga=/^([^\.]*)?(?:\.(.+))?$/,ia=/\bhover(\.\S+)?/,U=/^key/,ja=/^(?:mouse|contextmenu)|click/,Fa=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,F=function(b){if(b=Fa.exec(b))b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)");return b},Q=function(b){return h.event.special.hover?b:b.replace(ia,"mouseenter$1 mouseleave$1")};h.event={add:function(a,c,d,e,f){var g,m,j,k,A,l,B,r,C;if(!(a.nodeType===3||a.nodeType===8||!c||!d||!(g=h._data(a)))){if(d.handler)B=d,d=B.handler;if(!d.guid)d.guid=
h.guid++;j=g.events;if(!j)g.events=j={};m=g.handle;if(!m)g.handle=m=function(a){return typeof h!=="undefined"&&(!a||h.event.triggered!==a.type)?h.event.dispatch.apply(m.elem,arguments):b},m.elem=a;c=Q(c).split(" ");for(g=0;g<c.length;g++){k=ga.exec(c[g])||[];A=k[1];l=(k[2]||"").split(".").sort();C=h.event.special[A]||{};A=(f?C.delegateType:C.bindType)||A;C=h.event.special[A]||{};k=h.extend({type:A,origType:k[1],data:e,handler:d,guid:d.guid,selector:f,namespace:l.join(".")},B);if(f&&(k.quick=F(f),
!k.quick&&h.expr.match.POS.test(f)))k.isPositional=!0;r=j[A];if(!r&&(r=j[A]=[],r.delegateCount=0,!C.setup||C.setup.call(a,e,l,m)===!1))a.addEventListener?a.addEventListener(A,m,!1):a.attachEvent&&a.attachEvent("on"+A,m);if(C.add&&(C.add.call(a,k),!k.handler.guid))k.handler.guid=d.guid;f?r.splice(r.delegateCount++,0,k):r.push(k);h.event.global[A]=!0}a=null}},global:{},remove:function(b,a,c,d){var e=h.hasData(b)&&h._data(b),f,g,m,j,k,A,l,B,r;if(e&&(A=e.events)){a=Q(a||"").split(" ");for(f=0;f<a.length;f++){g=
ga.exec(a[f])||[];m=g[1];g=g[2];if(!m){g=g?"."+g:"";for(k in A)h.event.remove(b,k+g,c,d);return}l=h.event.special[m]||{};m=(d?l.delegateType:l.bindType)||m;B=A[m]||[];j=B.length;g=g?RegExp("(^|\\.)"+g.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;if(c||g||d||l.remove)for(k=0;k<B.length;k++){if(r=B[k],!c||c.guid===r.guid)if(!g||g.test(r.namespace))if(!d||d===r.selector||d==="**"&&r.selector)B.splice(k--,1),r.selector&&B.delegateCount--,l.remove&&l.remove.call(b,r)}else B.length=0;B.length===
0&&j!==B.length&&((!l.teardown||l.teardown.call(b,g)===!1)&&h.removeEvent(b,m,e.handle),delete A[m])}if(h.isEmptyObject(A)){if(a=e.handle)a.elem=null;h.removeData(b,["events","handle"],!0)}}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,f){if(!e||!(e.nodeType===3||e.nodeType===8)){var g=c.type||c,m=[],j,k,A,B;g.indexOf("!")>=0&&(g=g.slice(0,-1),j=!0);g.indexOf(".")>=0&&(m=g.split("."),g=m.shift(),m.sort());if(e&&!h.event.customEvent[g]||h.event.global[g])if(c=typeof c===
"object"?c[h.expando]?c:new h.Event(g,c):new h.Event(g),c.type=g,c.isTrigger=!0,c.exclusive=j,c.namespace=m.join("."),c.namespace_re=c.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,m=g.indexOf(":")<0?"on"+g:"",(f||!e)&&c.preventDefault(),e){c.result=b;if(!c.target)c.target=e;d=d!=null?h.makeArray(d):[];d.unshift(c);j=h.event.special[g]||{};if(!(j.trigger&&j.trigger.apply(e,d)===!1)){B=[[e,j.bindType||g]];if(!f&&!j.noBubble&&!h.isWindow(e)){A=j.delegateType||g;k=null;for(f=e.parentNode;f;f=
f.parentNode)B.push([f,A]),k=f;k&&k===e.ownerDocument&&B.push([k.defaultView||k.parentWindow||a,A])}for(k=0;k<B.length;k++)if(f=B[k][0],c.type=B[k][1],(A=(h._data(f,"events")||{})[c.type]&&h._data(f,"handle"))&&A.apply(f,d),(A=m&&f[m])&&h.acceptData(f)&&A.apply(f,d),c.isPropagationStopped())break;c.type=g;if(!c.isDefaultPrevented()&&(!j._default||j._default.apply(e.ownerDocument,d)===!1)&&!(g==="click"&&h.nodeName(e,"a"))&&h.acceptData(e))if(m&&e[g]&&(g!=="focus"&&g!=="blur"||c.target.offsetWidth!==
0)&&!h.isWindow(e))(k=e[m])&&(e[m]=null),h.event.triggered=g,e[g](),h.event.triggered=b,k&&(e[m]=k);return c.result}}else for(k in e=h.cache,e)e[k].events&&e[k].events[g]&&h.event.trigger(c,d,e[k].handle.elem,!0)}},dispatch:function(c){var c=h.event.fix(c||a.event),d=(h._data(this,"events")||{})[c.type]||[],e=d.delegateCount,f=[].slice.call(arguments,0),g=!c.exclusive&&!c.namespace,m=(h.event.special[c.type]||{}).handle,j=[],k,A,B,l,r,C,ka;f[0]=c;c.delegateTarget=this;if(e&&!c.target.disabled&&!(c.button&&
c.type==="click"))for(A=c.target;A!=this;A=A.parentNode||this){l={};r=[];for(k=0;k<e;k++)B=d[k],C=B.selector,ka=l[C],B.isPositional?ka=(ka||(l[C]=h(C))).index(A)>=0:ka===b&&(ka=l[C]=B.quick?(!B.quick[1]||A.nodeName.toLowerCase()===B.quick[1])&&(!B.quick[2]||A.id===B.quick[2])&&(!B.quick[3]||B.quick[3].test(A.className)):h(A).is(C)),ka&&r.push(B);r.length&&j.push({elem:A,matches:r})}d.length>e&&j.push({elem:this,matches:d.slice(e)});for(k=0;k<j.length&&!c.isPropagationStopped();k++){e=j[k];c.currentTarget=
e.elem;for(d=0;d<e.matches.length&&!c.isImmediatePropagationStopped();d++)if(B=e.matches[d],g||!c.namespace&&!B.namespace||c.namespace_re&&c.namespace_re.test(B.namespace))if(c.data=B.data,c.handleObj=B,B=(m||B.handler).apply(e.elem,f),B!==b)c.result=B,B===!1&&(c.preventDefault(),c.stopPropagation())}return c.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},
keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(b,a){if(b.which==null)b.which=a.charCode!=null?a.charCode:a.keyCode;return b}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement wheelDelta".split(" "),filter:function(a,c){var d,e,f=c.button,g=c.fromElement;if(a.pageX==null&&c.clientX!=null)d=a.target.ownerDocument||u,e=d.documentElement,d=d.body,a.pageX=c.clientX+(e&&e.scrollLeft||d&&d.scrollLeft||0)-(e&&e.clientLeft||
d&&d.clientLeft||0),a.pageY=c.clientY+(e&&e.scrollTop||d&&d.scrollTop||0)-(e&&e.clientTop||d&&d.clientTop||0);if(!a.relatedTarget&&g)a.relatedTarget=g===a.target?c.toElement:g;if(!a.which&&f!==b)a.which=f&1?1:f&2?3:f&4?2:0;return a}},fix:function(a){if(a[h.expando])return a;var c,d,e=a,f=h.event.fixHooks[a.type]||{},g=f.props?this.props.concat(f.props):this.props,a=h.Event(e);for(c=g.length;c;)d=g[--c],a[d]=e[d];if(!a.target)a.target=e.srcElement||u;if(a.target.nodeType===3)a.target=a.target.parentNode;
if(a.metaKey===b)a.metaKey=a.ctrlKey;return f.filter?f.filter(a,e):a},special:{ready:{setup:h.bindReady},focus:{delegateType:"focusin",noBubble:!0},blur:{delegateType:"focusout",noBubble:!0},beforeunload:{setup:function(a,b,c){if(h.isWindow(this))this.onbeforeunload=c},teardown:function(a,b){if(this.onbeforeunload===b)this.onbeforeunload=null}}},simulate:function(a,b,c,d){a=h.extend(new h.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?h.event.trigger(a,null,b):h.event.dispatch.call(b,a);a.isDefaultPrevented()&&
c.preventDefault()}};h.event.handle=h.event.dispatch;h.removeEvent=u.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)};h.Event=function(a,b){if(!(this instanceof h.Event))return new h.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?j:g):this.type=a;b&&h.extend(this,b);this.timeStamp=a&&
a.timeStamp||h.now();this[h.expando]=!0};h.Event.prototype={preventDefault:function(){this.isDefaultPrevented=j;var a=this.originalEvent;if(a)a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=j;var a=this.originalEvent;if(a)a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=j;this.stopPropagation()},isDefaultPrevented:g,isPropagationStopped:g,isImmediatePropagationStopped:g};
h.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){h.event.special[a]=h.event.special[b]={delegateType:b,bindType:b,handle:function(a){var b=a.relatedTarget,c=a.handleObj,d;if(!b||c.origType===a.type||b!==this&&!h.contains(this,b))b=a.type,a.type=c.origType,d=c.handler.apply(this,arguments),a.type=b;return d}}});if(!h.support.submitBubbles)h.event.special.submit={setup:function(){if(h.nodeName(this,"form"))return!1;h.event.add(this,"click._submit keypress._submit",function(a){a=a.target;
if((a=h.nodeName(a,"input")||h.nodeName(a,"button")?a.form:b)&&!a._submit_attached)h.event.add(a,"submit._submit",function(a){this.parentNode&&h.event.simulate("submit",this.parentNode,a,!0)}),a._submit_attached=!0})},teardown:function(){if(h.nodeName(this,"form"))return!1;h.event.remove(this,"._submit")}};if(!h.support.changeBubbles)h.event.special.change={setup:function(){if(pa.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio")h.event.add(this,"propertychange._change",function(a){if(a.originalEvent.propertyName===
"checked")this._just_changed=!0}),h.event.add(this,"click._change",function(a){if(this._just_changed)this._just_changed=!1,h.event.simulate("change",this,a,!0)});return!1}h.event.add(this,"beforeactivate._change",function(a){a=a.target;if(pa.test(a.nodeName)&&!a._change_attached)h.event.add(a,"change._change",function(a){this.parentNode&&!a.isSimulated&&h.event.simulate("change",this.parentNode,a,!0)}),a._change_attached=!0})},handle:function(a){var b=a.target;if(this!==b||a.isSimulated||a.isTrigger||
b.type!=="radio"&&b.type!=="checkbox")return a.handleObj.handler.apply(this,arguments)},teardown:function(){h.event.remove(this,"._change");return pa.test(this.nodeName)}};h.support.focusinBubbles||h.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){h.event.simulate(b,a.target,h.event.fix(a),!0)};h.event.special[b]={setup:function(){c++===0&&u.addEventListener(a,d,!0)},teardown:function(){--c===0&&u.removeEventListener(a,d,!0)}}});h.fn.extend({on:function(a,c,d,e,f){var m,
j;if(typeof a==="object"){typeof c!=="string"&&(d=c,c=b);for(j in a)this.on(j,c,d,a[j],f);return this}d==null&&e==null?(e=c,d=c=b):e==null&&(typeof c==="string"?(e=d,d=b):(e=d,d=c,c=b));if(e===!1)e=g;else if(!e)return this;if(f===1)m=e,e=function(a){h().off(a);return m.apply(this,arguments)},e.guid=m.guid||(m.guid=h.guid++);return this.each(function(){h.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on.call(this,a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=
a.handleObj;h(a.delegateTarget).off(e.namespace?e.type+"."+e.namespace:e.type,e.selector,e.handler);return this}if(typeof a==="object"){for(e in a)this.off(e,c,a[e]);return this}if(c===!1||typeof c==="function")d=c,c=b;d===!1&&(d=g);return this.each(function(){h.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){h(this.context).on(a,this.selector,b,c);return this},die:function(a,b){h(this.context).off(a,
this.selector||"**",b);return this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return arguments.length==1?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){h.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return h.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||h.guid++,d=0,e=function(c){var e=(h._data(this,"lastToggle"+a.guid)||0)%d;h._data(this,"lastToggle"+a.guid,e+1);c.preventDefault();
return b[e].apply(this,arguments)||!1};for(e.guid=c;d<b.length;)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});h.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){h.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.bind(b,a,c):this.trigger(b)};
h.attrFn&&(h.attrFn[b]=!0);if(U.test(b))h.event.fixHooks[b]=h.event.keyHooks;if(ja.test(b))h.event.fixHooks[b]=h.event.mouseHooks});(function(){function a(b,c,d,f,g,h){for(var g=0,m=f.length;g<m;g++){var j=f[g];if(j){for(var k=!1,j=j[b];j;){if(j[e]===d){k=f[j.sizset];break}if(j.nodeType===1&&!h)j[e]=d,j.sizset=g;if(j.nodeName.toLowerCase()===c){k=j;break}j=j[b]}f[g]=k}}}function c(a,b,d,f,g,h){for(var g=0,m=f.length;g<m;g++){var j=f[g];if(j){for(var k=!1,j=j[a];j;){if(j[e]===d){k=f[j.sizset];break}if(j.nodeType===
1){if(!h)j[e]=d,j.sizset=g;if(typeof b!=="string"){if(j===b){k=!0;break}}else if(l.filter(b,[j]).length>0){k=j;break}}j=j[a]}f[g]=k}}}var d=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,e="sizcache"+(Math.random()+"").replace(".",""),f=0,g=Object.prototype.toString,m=!1,j=!0,k=/\\/g,A=/\r\n/g,B=/\W/;[0,0].sort(function(){j=!1;return 0});var l=function(a,b,c,e){var c=c||[],f=b=b||u;if(b.nodeType!==1&&b.nodeType!==
9)return[];if(!a||typeof a!=="string")return c;var h,m,j,k,S,A=!0,B=l.isXML(b),K=[],r=a;do if(d.exec(""),h=d.exec(r))if(r=h[3],K.push(h[1]),h[2]){k=h[3];break}while(h);if(K.length>1&&ka.exec(a))if(K.length===2&&C.relative[K[0]])m=Q(K[0]+K[1],b,e);else for(m=C.relative[K[0]]?[b]:l(K.shift(),b);K.length;)a=K.shift(),C.relative[a]&&(a+=K.shift()),m=Q(a,m,e);else if(!e&&K.length>1&&b.nodeType===9&&!B&&C.match.ID.test(K[0])&&!C.match.ID.test(K[K.length-1])&&(h=l.find(K.shift(),b,B),b=h.expr?l.filter(h.expr,
h.set)[0]:h.set[0]),b){h=e?{expr:K.pop(),set:p(e)}:l.find(K.pop(),K.length===1&&(K[0]==="~"||K[0]==="+")&&b.parentNode?b.parentNode:b,B);m=h.expr?l.filter(h.expr,h.set):h.set;for(K.length>0?j=p(m):A=!1;K.length;)h=S=K.pop(),C.relative[S]?h=K.pop():S="",h==null&&(h=b),C.relative[S](j,h,B)}else j=[];j||(j=m);j||l.error(S||a);if(g.call(j)==="[object Array]")if(A)if(b&&b.nodeType===1)for(a=0;j[a]!=null;a++)j[a]&&(j[a]===!0||j[a].nodeType===1&&l.contains(b,j[a]))&&c.push(m[a]);else for(a=0;j[a]!=null;a++)j[a]&&
j[a].nodeType===1&&c.push(m[a]);else c.push.apply(c,j);else p(j,c);k&&(l(k,f,c,e),l.uniqueSort(c));return c};l.uniqueSort=function(a){if(I&&(m=j,a.sort(I),m))for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1);return a};l.matches=function(a,b){return l(a,null,null,b)};l.matchesSelector=function(a,b){return l(b,null,null,[a]).length>0};l.find=function(a,b,c){var d,e,f,g,h,m;if(!a)return[];for(e=0,f=C.order.length;e<f;e++)if(h=C.order[e],g=C.leftMatch[h].exec(a))if(m=g[1],g.splice(1,1),m.substr(m.length-
1)!=="\\"&&(g[1]=(g[1]||"").replace(k,""),d=C.find[h](g,b,c),d!=null)){a=a.replace(C.match[h],"");break}d||(d=typeof b.getElementsByTagName!=="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}};l.filter=function(a,c,d,e){for(var f,g,h,m,j,k,S,A,B=a,K=[],r=c,ka=c&&c[0]&&l.isXML(c[0]);a&&c.length;){for(h in C.filter)if((f=C.leftMatch[h].exec(a))!=null&&f[2])if(k=C.filter[h],j=f[1],g=!1,f.splice(1,1),j.substr(j.length-1)!=="\\"){r===K&&(K=[]);if(C.preFilter[h])if(f=C.preFilter[h](f,r,d,
K,e,ka)){if(f===!0)continue}else g=m=!0;if(f)for(S=0;(j=r[S])!=null;S++)j&&(m=k(j,f,S,r),A=e^m,d&&m!=null?A?g=!0:r[S]=!1:A&&(K.push(j),g=!0));if(m!==b){d||(r=K);a=a.replace(C.match[h],"");if(!g)return[];break}}if(a===B)if(g==null)l.error(a);else break;B=a}return r};l.error=function(a){throw"Syntax error, unrecognized expression: "+a;};var r=l.getText=function(a){var b,c;b=a.nodeType;var d="";if(b)if(b===1)if(typeof a.textContent==="string")return a.textContent;else if(typeof a.innerText==="string")return a.innerText.replace(A,
"");else for(a=a.firstChild;a;a=a.nextSibling)d+=r(a);else{if(b===3||b===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(d+=r(c));return d},C=l.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,
POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b==="string",d=c&&!B.test(b),c=c&&!d;d&&(b=b.toLowerCase());for(var d=0,e=a.length,f;d<e;d++)if(f=a[d]){for(;(f=f.previousSibling)&&f.nodeType!==
1;);a[d]=c||f&&f.nodeName.toLowerCase()===b?f||!1:f===b}c&&l.filter(b,a,!0)},">":function(a,b){var c,d=typeof b==="string",e=0,f=a.length;if(d&&!B.test(b))for(b=b.toLowerCase();e<f;e++){if(c=a[e])c=c.parentNode,a[e]=c.nodeName.toLowerCase()===b?c:!1}else{for(;e<f;e++)(c=a[e])&&(a[e]=d?c.parentNode:c.parentNode===b);d&&l.filter(b,a,!0)}},"":function(b,d,e){var g,h=f++,m=c;typeof d==="string"&&!B.test(d)&&(g=d=d.toLowerCase(),m=a);m("parentNode",d,h,b,g,e)},"~":function(b,d,e){var g,h=f++,m=c;typeof d===
"string"&&!B.test(d)&&(g=d=d.toLowerCase(),m=a);m("previousSibling",d,h,b,g,e)}},find:{ID:function(a,b,c){if(typeof b.getElementById!=="undefined"&&!c)return(a=b.getElementById(a[1]))&&a.parentNode?[a]:[]},NAME:function(a,b){if(typeof b.getElementsByName!=="undefined"){for(var c=[],d=b.getElementsByName(a[1]),e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!=="undefined")return b.getElementsByTagName(a[1])}},
preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(k,"")+" ";if(f)return a;for(var f=0,g;(g=b[f])!=null;f++)g&&(e^(g.className&&(" "+g.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(g):c&&(b[f]=!1));return!1},ID:function(a){return a[1].replace(k,"")},TAG:function(a){return a[1].replace(k,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||l.error(a[0]);a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||
!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0;a[3]=b[3]-0}else a[2]&&l.error(a[0]);a[0]=f++;return a},ATTR:function(a,b,c,d,e,f){b=a[1]=a[1].replace(k,"");!f&&C.attrMap[b]&&(a[1]=C.attrMap[b]);a[4]=(a[4]||a[5]||"").replace(k,"");a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(a,b,c,e,f){if(a[1]==="not")if((d.exec(a[3])||"").length>1||/^\w/.test(a[3]))a[3]=l(a[3],null,null,b);else return a=l.filter(a[3],b,c,1^f),c||e.push.apply(e,a),!1;else if(C.match.POS.test(a[0])||C.match.CHILD.test(a[0]))return!0;
return a},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!l(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()===
"input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()===
"input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,
b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=C.filters[e];if(f)return f(a,c,b,d);else if(e==="contains")return(a.textContent||a.innerText||r([a])||"").indexOf(b[3])>=0;else if(e==="not"){b=b[3];c=0;for(d=b.length;c<d;c++)if(b[c]===a)return!1;return!0}else l.error(e)},CHILD:function(a,b){var c,d,f,g,h,m;c=b[1];m=a;switch(c){case "only":case "first":for(;m=
m.previousSibling;)if(m.nodeType===1)return!1;if(c==="first")return!0;m=a;case "last":for(;m=m.nextSibling;)if(m.nodeType===1)return!1;return!0;case "nth":c=b[2];d=b[3];if(c===1&&d===0)return!0;f=b[0];if((g=a.parentNode)&&(g[e]!==f||!a.nodeIndex)){h=0;for(m=g.firstChild;m;m=m.nextSibling)if(m.nodeType===1)m.nodeIndex=++h;g[e]=f}m=a.nodeIndex-d;return c===0?m===0:m%c===0&&m/c>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&
a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],c=l.attr?l.attr(a,c):C.attrHandle[c]?C.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),d=c+"",e=b[2],f=b[4];return c==null?e==="!=":!e&&l.attr?c!=null:e==="="?d===f:e==="*="?d.indexOf(f)>=0:e==="~="?(" "+d+" ").indexOf(f)>=0:!f?d&&c!==!1:e==="!="?d!==f:e==="^="?d.indexOf(f)===0:e==="$="?d.substr(d.length-f.length)===f:e==="|="?d===f||d.substr(0,f.length+
1)===f+"-":!1},POS:function(a,b,c,d){var e=C.setFilters[b[2]];if(e)return e(a,c,b,d)}}},ka=C.match.POS,F=function(a,b){return"\\"+(b-0+1)},q;for(q in C.match)C.match[q]=RegExp(C.match[q].source+/(?![^\[]*\])(?![^\(]*\))/.source),C.leftMatch[q]=RegExp(/(^(?:.|\r|\n)*?)/.source+C.match[q].source.replace(/\\(\d+)/g,F));var p=function(a,b){a=Array.prototype.slice.call(a,0);return b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(u.documentElement.childNodes,0)}catch(X){p=function(a,b){var c=0,
d=b||[];if(g.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length==="number")for(var e=a.length;c<e;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var I,qa;u.documentElement.compareDocumentPosition?I=function(a,b){return a===b?(m=!0,0):!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition?-1:1:a.compareDocumentPosition(b)&4?-1:1}:(I=function(a,b){if(a===b)return m=!0,0;else if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;
var c,d,e=[],f=[];c=a.parentNode;d=b.parentNode;var g=c;if(c===d)return qa(a,b);else if(c){if(!d)return 1}else return-1;for(;g;)e.unshift(g),g=g.parentNode;for(g=d;g;)f.unshift(g),g=g.parentNode;c=e.length;d=f.length;for(g=0;g<c&&g<d;g++)if(e[g]!==f[g])return qa(e[g],f[g]);return g===c?qa(a,f[g],-1):qa(e[g],b,1)},qa=function(a,b,c){if(a===b)return c;for(a=a.nextSibling;a;){if(a===b)return-1;a=a.nextSibling}return 1});(function(){var a=u.createElement("div"),c="script"+(new Date).getTime(),d=u.documentElement;
a.innerHTML="<a name='"+c+"'/>";d.insertBefore(a,d.firstChild);if(u.getElementById(c))C.find.ID=function(a,c,d){if(typeof c.getElementById!=="undefined"&&!d)return(c=c.getElementById(a[1]))?c.id===a[1]||typeof c.getAttributeNode!=="undefined"&&c.getAttributeNode("id").nodeValue===a[1]?[c]:b:[]},C.filter.ID=function(a,b){var c=typeof a.getAttributeNode!=="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b};d.removeChild(a);d=a=null})();(function(){var a=u.createElement("div");
a.appendChild(u.createComment(""));if(a.getElementsByTagName("*").length>0)C.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){for(var d=[],e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c};a.innerHTML="<a href='#'></a>";if(a.firstChild&&typeof a.firstChild.getAttribute!=="undefined"&&a.firstChild.getAttribute("href")!=="#")C.attrHandle.href=function(a){return a.getAttribute("href",2)};a=null})();u.querySelectorAll&&function(){var a=l,b=u.createElement("div");b.innerHTML=
"<p class='TEST'></p>";if(!(b.querySelectorAll&&b.querySelectorAll(".TEST").length===0)){l=function(b,c,d,e){c=c||u;if(!e&&!l.isXML(c)){var f=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(f&&(c.nodeType===1||c.nodeType===9))if(f[1])return p(c.getElementsByTagName(b),d);else if(f[2]&&C.find.CLASS&&c.getElementsByClassName)return p(c.getElementsByClassName(f[2]),d);if(c.nodeType===9){if(b==="body"&&c.body)return p([c.body],d);else if(f&&f[3]){var g=c.getElementById(f[3]);if(g&&g.parentNode){if(g.id===
f[3])return p([g],d)}else return p([],d)}try{return p(c.querySelectorAll(b),d)}catch(h){}}else if(c.nodeType===1&&c.nodeName.toLowerCase()!=="object"){var f=c,m=(g=c.getAttribute("id"))||"__sizzle__",j=c.parentNode,k=/^\s*[+~]/.test(b);g?m=m.replace(/'/g,"\\$&"):c.setAttribute("id",m);if(k&&j)c=c.parentNode;try{if(!k||j)return p(c.querySelectorAll("[id='"+m+"'] "+b),d)}catch(S){}finally{g||f.removeAttribute("id")}}}return a(b,c,d,e)};for(var c in a)l[c]=a[c];b=null}}();(function(){var a=u.documentElement,
b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var c=!b.call(u.createElement("div"),"div"),d=!1;try{b.call(u.documentElement,"[test!='']:sizzle")}catch(e){d=!0}l.matchesSelector=function(a,e){e=e.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!l.isXML(a))try{if(d||!C.match.PSEUDO.test(e)&&!/!=/.test(e)){var f=b.call(a,e);if(f||!c||a.document&&a.document.nodeType!==11)return f}}catch(g){}return l(e,null,null,[a]).length>0}}})();(function(){var a=u.createElement("div");
a.innerHTML="<div class='test e'></div><div class='test'></div>";if(a.getElementsByClassName&&a.getElementsByClassName("e").length!==0&&(a.lastChild.className="e",a.getElementsByClassName("e").length!==1))C.order.splice(1,0,"CLASS"),C.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!=="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null})();l.contains=u.documentElement.contains?function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:u.documentElement.compareDocumentPosition?
function(a,b){return!!(a.compareDocumentPosition(b)&16)}:function(){return!1};l.isXML=function(a){return(a=(a?a.ownerDocument||a:0).documentElement)?a.nodeName!=="HTML":!1};var Q=function(a,b,c){for(var d,e=[],f="",b=b.nodeType?[b]:b;d=C.match.PSEUDO.exec(a);)f+=d[0],a=a.replace(C.match.PSEUDO,"");a=C.relative[a]?a+"*":a;d=0;for(var g=b.length;d<g;d++)l(a,b[d],e,c);return l.filter(f,e)};l.attr=h.attr;l.selectors.attrMap={};h.find=l;h.expr=l.selectors;h.expr[":"]=h.expr.filters;h.unique=l.uniqueSort;
h.text=l.getText;h.isXMLDoc=l.isXML;h.contains=l.contains})();var X=/Until$/,I=/^(?:parents|prevUntil|prevAll)/,qa=/,/,Na=/^.[^:#\[\.,]*$/,Ua=Array.prototype.slice,Ia=h.expr.match.POS,ya={children:!0,contents:!0,next:!0,prev:!0};h.fn.extend({find:function(a){var b=this,c,d;if(typeof a!=="string")return h(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(h.contains(b[c],this))return!0});var e=this.pushStack("","find",a),f,g,m;for(c=0,d=this.length;c<d;c++)if(f=e.length,h.find(a,this[c],e),c>0)for(g=
f;g<e.length;g++)for(m=0;m<f;m++)if(e[m]===e[g]){e.splice(g--,1);break}return e},has:function(a){var b=h(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(h.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(k(this,a,!1),"not",a)},filter:function(a){return this.pushStack(k(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a==="string"?Ia.test(a)?h(a,this.context).index(this[0])>=0:h.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=
[],d,e,f=this[0];if(h.isArray(a)){for(e=1;f&&f.ownerDocument&&f!==b;){for(d=0;d<a.length;d++)h(f).is(a[d])&&c.push({selector:a[d],elem:f,level:e});f=f.parentNode;e++}return c}var g=Ia.test(a)||typeof a!=="string"?h(a,b||this.context):0;for(d=0,e=this.length;d<e;d++)for(f=this[d];f;)if(g?g.index(f)>-1:h.find.matchesSelector(f,a)){c.push(f);break}else if(f=f.parentNode,!f||!f.ownerDocument||f===b||f.nodeType===11)break;c=c.length>1?h.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){return!a?
this[0]&&this[0].parentNode?this.prevAll().length:-1:typeof a==="string"?h.inArray(this[0],h(a)):h.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a==="string"?h(a,b):h.makeArray(a&&a.nodeType?[a]:a),d=h.merge(this.get(),c);return this.pushStack(!c[0]||!c[0].parentNode||c[0].parentNode.nodeType===11||!d[0]||!d[0].parentNode||d[0].parentNode.nodeType===11?d:h.unique(d))},andSelf:function(){return this.add(this.prevObject)}});h.each({parent:function(a){return(a=a.parentNode)&&a.nodeType!==
11?a:null},parents:function(a){return h.dir(a,"parentNode")},parentsUntil:function(a,b,c){return h.dir(a,"parentNode",c)},next:function(a){return h.nth(a,2,"nextSibling")},prev:function(a){return h.nth(a,2,"previousSibling")},nextAll:function(a){return h.dir(a,"nextSibling")},prevAll:function(a){return h.dir(a,"previousSibling")},nextUntil:function(a,b,c){return h.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return h.dir(a,"previousSibling",c)},siblings:function(a){return h.sibling(a.parentNode.firstChild,
a)},children:function(a){return h.sibling(a.firstChild)},contents:function(a){return h.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:h.makeArray(a.childNodes)}},function(a,b){h.fn[a]=function(c,d){var e=h.map(this,b,c),f=Ua.call(arguments);X.test(a)||(d=c);d&&typeof d==="string"&&(e=h.filter(d,e));e=this.length>1&&!ya[a]?h.unique(e):e;if((this.length>1||qa.test(d))&&I.test(a))e=e.reverse();return this.pushStack(e,a,f.join(","))}});h.extend({filter:function(a,b,c){c&&(a=":not("+
a+")");return b.length===1?h.find.matchesSelector(b[0],a)?[b[0]]:[]:h.find.matches(a,b)},dir:function(a,c,d){for(var e=[],a=a[c];a&&a.nodeType!==9&&(d===b||a.nodeType!==1||!h(a).is(d));)a.nodeType===1&&e.push(a),a=a[c];return e},nth:function(a,b,c){for(var b=b||1,d=0;a;a=a[c])if(a.nodeType===1&&++d===b)break;return a},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var wa="abbr article aside audio canvas datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",
jb=/ jQuery\d+="(?:\d+|null)"/g,bb=/^\s+/,cb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Va=/<([\w:]+)/,kb=/<tbody/i,rb=/<|&#?\w+;/,sb=/<(?:script|style)/i,db=/<(?:script|object|embed|option|style)/i,Wa=RegExp("<(?:"+wa.replace(" ","|")+")","i"),Pa=/checked\s*(?:[^=]|=\s*.checked.)/i,Qa=/\/(java|ecma)script/i,pb=/^\s*<!(?:\[CDATA\[|\-\-)/,ca={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,
"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},eb=l(u);ca.optgroup=ca.option;ca.tbody=ca.tfoot=ca.colgroup=ca.caption=ca.thead;ca.th=ca.td;if(!h.support.htmlSerialize)ca._default=[1,"div<div>","</div>"];h.fn.extend({text:function(a){return h.isFunction(a)?this.each(function(b){var c=h(this);c.text(a.call(this,b,c.text()))}):typeof a!=="object"&&a!==
b?this.empty().append((this[0]&&this[0].ownerDocument||u).createTextNode(a)):h.text(this)},wrapAll:function(a){if(h.isFunction(a))return this.each(function(b){h(this).wrapAll(a.call(this,b))});if(this[0]){var b=h(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]);b.map(function(){for(var a=this;a.firstChild&&a.firstChild.nodeType===1;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return h.isFunction(a)?this.each(function(b){h(this).wrapInner(a.call(this,
b))}):this.each(function(){var b=h(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){h(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){h.nodeName(this,"body")||h(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},
before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});else if(arguments.length){var a=h(arguments[0]);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});else if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,h(arguments[0]).toArray());
return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||h.filter(a,[d]).length)!b&&d.nodeType===1&&(h.cleanData(d.getElementsByTagName("*")),h.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++)for(b.nodeType===1&&h.cleanData(b.getElementsByTagName("*"));b.firstChild;)b.removeChild(b.firstChild);return this},clone:function(a,b){a=a==null?!1:a;b=b==null?a:b;return this.map(function(){return h.clone(this,a,b)})},
html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(jb,""):null;else if(typeof a==="string"&&!sb.test(a)&&(h.support.leadingWhitespace||!bb.test(a))&&!ca[(Va.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(cb,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)if(this[c].nodeType===1)h.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a}catch(e){this.empty().append(a)}}else h.isFunction(a)?this.each(function(b){var c=h(this);c.html(a.call(this,b,c.html()))}):
this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(h.isFunction(a))return this.each(function(b){var c=h(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!=="string"&&(a=h(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;h(this).remove();b?h(b).before(a):h(c).append(a)})}else return this.length?this.pushStack(h(h.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,
c,d){var e,f,g,m=a[0],j=[];if(!h.support.checkClone&&arguments.length===3&&typeof m==="string"&&Pa.test(m))return this.each(function(){h(this).domManip(a,c,d,!0)});if(h.isFunction(m))return this.each(function(e){var f=h(this);a[0]=m.call(this,e,c?f.html():b);f.domManip(a,c,d)});if(this[0]){e=m&&m.parentNode;e=h.support.parentNode&&e&&e.nodeType===11&&e.childNodes.length===this.length?{fragment:e}:h.buildFragment(a,this,j);g=e.fragment;if(f=g.childNodes.length===1?g=g.firstChild:g.firstChild){c=c&&
h.nodeName(f,"tr");f=0;for(var k=this.length,A=k-1;f<k;f++)d.call(c?h.nodeName(this[f],"table")?this[f].getElementsByTagName("tbody")[0]||this[f].appendChild(this[f].ownerDocument.createElement("tbody")):this[f]:this[f],e.cacheable||k>1&&f<A?h.clone(g,!0,!0):g)}j.length&&h.each(j,ha)}return this}});h.buildFragment=function(a,b,c){var d,e,f,g,m=a[0];b&&b[0]&&(g=b[0].ownerDocument||b[0]);g.createDocumentFragment||(g=u);if(a.length===1&&typeof m==="string"&&m.length<512&&g===u&&m.charAt(0)==="<"&&!db.test(m)&&
(h.support.checkClone||!Pa.test(m))&&!h.support.unknownElems&&Wa.test(m))e=!0,(f=h.fragments[m])&&f!==1&&(d=f);d||(d=g.createDocumentFragment(),h.clean(a,g,d,c));e&&(h.fragments[m]=f?d:1);return{fragment:d,cacheable:e}};h.fragments={};h.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){h.fn[a]=function(c){var d=[],c=h(c),e=this.length===1&&this[0].parentNode;if(e&&e.nodeType===11&&e.childNodes.length===1&&c.length===1)return c[b](this[0]),
this;else{for(var e=0,f=c.length;e<f;e++){var g=(e>0?this.clone(!0):this).get();h(c[e])[b](g);d=d.concat(g)}return this.pushStack(d,a,c.selector)}}});h.extend({clone:function(a,b,c){var d=a.cloneNode(!0),e,f,g;if((!h.support.noCloneEvent||!h.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!h.isXMLDoc(a)){t(a,d);e=v(a);f=v(d);for(g=0;e[g];++g)f[g]&&t(e[g],f[g])}if(b&&(p(a,d),c)){e=v(a);f=v(d);for(g=0;e[g];++g)p(e[g],f[g])}return d},clean:function(a,b,c,d){b=b||u;typeof b.createElement===
"undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||u);for(var e=[],f,g=0,m;(m=a[g])!=null;g++)if(typeof m==="number"&&(m+=""),m){if(typeof m==="string")if(rb.test(m)){m=m.replace(cb,"<$1></$2>");f=(Va.exec(m)||["",""])[1].toLowerCase();var j=ca[f]||ca._default,k=j[0],A=b.createElement("div");b===u?eb.appendChild(A):l(b).appendChild(A);for(A.innerHTML=j[1]+m+j[2];k--;)A=A.lastChild;if(!h.support.tbody){k=kb.test(m);j=f==="table"&&!k?A.firstChild&&A.firstChild.childNodes:j[1]==="<table>"&&!k?
A.childNodes:[];for(f=j.length-1;f>=0;--f)h.nodeName(j[f],"tbody")&&!j[f].childNodes.length&&j[f].parentNode.removeChild(j[f])}!h.support.leadingWhitespace&&bb.test(m)&&A.insertBefore(b.createTextNode(bb.exec(m)[0]),A.firstChild);m=A.childNodes}else m=b.createTextNode(m);var B;if(!h.support.appendChecked)if(m[0]&&typeof(B=m.length)==="number")for(f=0;f<B;f++)L(m[f]);else L(m);m.nodeType?e.push(m):e=h.merge(e,m)}if(c){a=function(a){return!a.type||Qa.test(a.type)};for(g=0;e[g];g++)d&&h.nodeName(e[g],
"script")&&(!e[g].type||e[g].type.toLowerCase()==="text/javascript")?d.push(e[g].parentNode?e[g].parentNode.removeChild(e[g]):e[g]):(e[g].nodeType===1&&(b=h.grep(e[g].getElementsByTagName("script"),a),e.splice.apply(e,[g+1,0].concat(b))),c.appendChild(e[g]))}return e},cleanData:function(a){for(var b,c,d=h.cache,e=h.event.special,f=h.support.deleteExpando,g=0,m;(m=a[g])!=null;g++)if(!m.nodeName||!h.noData[m.nodeName.toLowerCase()])if(c=m[h.expando]){if((b=d[c])&&b.events){for(var j in b.events)e[j]?
h.event.remove(m,j):h.removeEvent(m,j,b.handle);if(b.handle)b.handle.elem=null}f?delete m[h.expando]:m.removeAttribute&&m.removeAttribute(h.expando);delete d[c]}}});var va=/alpha\([^)]*\)/i,fb=/opacity=([^)]*)/,lb=/([A-Z]|^ms)/g,Xa=/^-?\d+(?:px)?$/i,Ya=/^-?\d/,Ja=/^([\-+])=([\-+.\de]+)/,Sa={position:"absolute",visibility:"hidden",display:"block"},Da=["Left","Right"],$a=["Top","Bottom"],ta,Ca,Ka;h.fn.css=function(a,c){return arguments.length===2&&c===b?this:h.access(this,a,c,!0,function(a,c,d){return d!==
b?h.style(a,c,d):h.css(a,c)})};h.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=ta(a,"opacity","opacity");return c===""?"1":c}else return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":h.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(a&&!(a.nodeType===3||a.nodeType===8||!a.style)){var f,g=h.camelCase(c),m=a.style,j=h.cssHooks[g],c=h.cssProps[g]||g;if(d!==b){e=typeof d;if(e===
"string"&&(f=Ja.exec(d)))d=+(f[1]+1)*+f[2]+parseFloat(h.css(a,c)),e="number";if(!(d==null||e==="number"&&isNaN(d)))if(e==="number"&&!h.cssNumber[g]&&(d+="px"),!j||!("set"in j)||(d=j.set(a,d))!==b)try{m[c]=d}catch(k){}}else return j&&"get"in j&&(f=j.get(a,!1,e))!==b?f:m[c]}},css:function(a,c,d){var e,f,c=h.camelCase(c);f=h.cssHooks[c];c=h.cssProps[c]||c;c==="cssFloat"&&(c="float");if(f&&"get"in f&&(e=f.get(a,!0,d))!==b)return e;else if(ta)return ta(a,c)},swap:function(a,b,c){var d={},e;for(e in b)d[e]=
a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}});h.curCSS=h.css;h.each(["height","width"],function(a,b){h.cssHooks[b]={get:function(a,c,d){var e;if(c){if(a.offsetWidth!==0)return N(a,b,d);else h.swap(a,Sa,function(){e=N(a,b,d)});return e}},set:function(a,b){if(Xa.test(b)){if(b=parseFloat(b),b>=0)return b+"px"}else return b}}});if(!h.support.opacity)h.cssHooks.opacity={get:function(a,b){return fb.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/
100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=h.isNumeric(b)?"alpha(opacity="+b*100+")":"",f=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&h.trim(f.replace(va,""))===""&&(c.removeAttribute("filter"),d&&!d.filter))return;c.filter=va.test(f)?f.replace(va,e):f+" "+e}};h(function(){if(!h.support.reliableMarginRight)h.cssHooks.marginRight={get:function(a,b){var c;h.swap(a,{display:"inline-block"},function(){c=b?ta(a,"margin-right","marginRight"):a.style.marginRight});return c}}});u.defaultView&&
u.defaultView.getComputedStyle&&(Ca=function(a,c){var d,e,c=c.replace(lb,"-$1").toLowerCase();if(!(e=a.ownerDocument.defaultView))return b;if(e=e.getComputedStyle(a,null))d=e.getPropertyValue(c),d===""&&!h.contains(a.ownerDocument.documentElement,a)&&(d=h.style(a,c));return d});u.documentElement.currentStyle&&(Ka=function(a,b){var c,d,e=a.currentStyle&&a.currentStyle[b],f=a.style;if(e===null&&f&&(c=f[b]))e=c;if(!Xa.test(e)&&Ya.test(e)){c=f.left;if(d=a.runtimeStyle&&a.runtimeStyle.left)a.runtimeStyle.left=
a.currentStyle.left;f.left=b==="fontSize"?"1em":e||0;e=f.pixelLeft+"px";f.left=c;if(d)a.runtimeStyle.left=d}return e===""?"auto":e});ta=Ca||Ka;if(h.expr&&h.expr.filters)h.expr.filters.hidden=function(a){var b=a.offsetHeight;return a.offsetWidth===0&&b===0||!h.support.reliableHiddenOffsets&&(a.style&&a.style.display||h.css(a,"display"))==="none"},h.expr.filters.visible=function(a){return!h.expr.filters.hidden(a)};var La=/%20/g,Oa=/\[\]$/,Ra=/\r?\n/g,mb=/#.*$/,ra=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,G=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,
za=/^(?:GET|HEAD)$/,Y=/^\/\//,la=/\?/,M=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,da=/^(?:select|textarea)/i,Ga=/\s+/,m=/([?&])_=[^&]*/,A=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,B=h.fn.load,C={},ka={},sa,Aa,xa=["*/"]+["*"];try{sa=r.href}catch(gb){sa=u.createElement("a"),sa.href="",sa=sa.href}Aa=A.exec(sa.toLowerCase())||[];h.fn.extend({load:function(a,c,d){if(typeof a!=="string"&&B)return B.apply(this,arguments);else if(!this.length)return this;var e=a.indexOf(" ");if(e>=0)var f=
a.slice(e,a.length),a=a.slice(0,e);e="GET";c&&(h.isFunction(c)?(d=c,c=b):typeof c==="object"&&(c=h.param(c,h.ajaxSettings.traditional),e="POST"));var g=this;h.ajax({url:a,type:e,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText;a.isResolved()&&(a.done(function(a){c=a}),g.html(f?h("<div>").append(c.replace(M,"")).find(f):c));d&&g.each(d,[c,b,a])}});return this},serialize:function(){return h.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?
h.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||da.test(this.nodeName)||G.test(this.type))}).map(function(a,b){var c=h(this).val();return c==null?null:h.isArray(c)?h.map(c,function(a){return{name:b.name,value:a.replace(Ra,"\r\n")}}):{name:b.name,value:c.replace(Ra,"\r\n")}}).get()}});h.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){h.fn[b]=function(a){return this.bind(b,a)}});h.each(["get","post"],
function(a,c){h[c]=function(a,d,e,f){h.isFunction(d)&&(f=f||e,e=d,d=b);return h.ajax({type:c,url:a,data:d,success:e,dataType:f})}});h.extend({getScript:function(a,c){return h.get(a,b,c,"script")},getJSON:function(a,b,c){return h.get(a,b,c,"json")},ajaxSetup:function(a,b){b?ea(a,h.ajaxSettings):(b=a,a=h.ajaxSettings);ea(a,b);return a},ajaxSettings:{url:sa,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(Aa[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",
processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":xa},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":h.parseJSON,"text xml":h.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:O(C),ajaxTransport:O(ka),ajax:function(a,c){function d(a,c,m,A){if(Q!==2){Q=2;qa&&clearTimeout(qa);X=b;q=A||"";t.readyState=
a>0?4:0;var r,C,ka,A=c;if(m){var F=e,p=t,S=F.contents,I=F.dataTypes,Aa=F.responseFields,K,n,xa,v;for(n in Aa)n in m&&(p[Aa[n]]=m[n]);for(;I[0]==="*";)I.shift(),K===b&&(K=F.mimeType||p.getResponseHeader("content-type"));if(K)for(n in S)if(S[n]&&S[n].test(K)){I.unshift(n);break}if(I[0]in m)xa=I[0];else{for(n in m){if(!I[0]||F.converters[n+" "+I[0]]){xa=n;break}v||(v=n)}xa=xa||v}xa?(xa!==I[0]&&I.unshift(xa),m=m[xa]):m=void 0}else m=b;if(a>=200&&a<300||a===304){if(e.ifModified){if(K=t.getResponseHeader("Last-Modified"))h.lastModified[B]=
K;if(K=t.getResponseHeader("Etag"))h.etag[B]=K}if(a===304)A="notmodified",r=!0;else try{K=e;K.dataFilter&&(m=K.dataFilter(m,K.dataType));var L=K.dataTypes;n={};var J,gb,Na=L.length,Ma,u=L[0],H,Ia,wa,ya,w;for(J=1;J<Na;J++){if(J===1)for(gb in K.converters)typeof gb==="string"&&(n[gb.toLowerCase()]=K.converters[gb]);H=u;u=L[J];if(u==="*")u=H;else if(H!=="*"&&H!==u){Ia=H+" "+u;wa=n[Ia]||n["* "+u];if(!wa)for(ya in w=b,n)if(Ma=ya.split(" "),Ma[0]===H||Ma[0]==="*")if(w=n[Ma[1]+" "+u]){ya=n[ya];ya===!0?wa=
w:w===!0&&(wa=ya);break}!wa&&!w&&h.error("No conversion from "+Ia.replace(" "," to "));wa!==!0&&(m=wa?wa(m):w(ya(m)))}}C=m;A="success";r=!0}catch(Ua){A="parsererror",ka=Ua}}else if(ka=A,!A||a)A="error",a<0&&(a=0);t.status=a;t.statusText=""+(c||A);r?j.resolveWith(f,[C,A,t]):j.rejectWith(f,[t,A,ka]);t.statusCode(l);l=b;sa&&g.trigger("ajax"+(r?"Success":"Error"),[t,e,r?C:ka]);k.fireWith(f,[t,A]);sa&&(g.trigger("ajaxComplete",[t,e]),--h.active||h.event.trigger("ajaxStop"))}}typeof a==="object"&&(c=a,
a=b);var c=c||{},e=h.ajaxSetup({},c),f=e.context||e,g=f!==e&&(f.nodeType||f instanceof h)?h(f):h.event,j=h.Deferred(),k=h.Callbacks("once memory"),l=e.statusCode||{},B,r={},F={},q,p,X,qa,I,Q=0,sa,n,t={readyState:0,setRequestHeader:function(a,b){if(!Q){var c=a.toLowerCase(),a=F[c]=F[c]||a;r[a]=b}return this},getAllResponseHeaders:function(){return Q===2?q:null},getResponseHeader:function(a){var c;if(Q===2){if(!p)for(p={};c=ra.exec(q);)p[c[1].toLowerCase()]=c[2];c=p[a.toLowerCase()]}return c===b?null:
c},overrideMimeType:function(a){if(!Q)e.mimeType=a;return this},abort:function(a){a=a||"abort";X&&X.abort(a);d(0,a);return this}};j.promise(t);t.success=t.done;t.error=t.fail;t.complete=k.add;t.statusCode=function(a){if(a){var b;if(Q<2)for(b in a)l[b]=[l[b],a[b]];else b=a[t.status],t.then(b,b)}return this};e.url=((a||e.url)+"").replace(mb,"").replace(Y,Aa[1]+"//");e.dataTypes=h.trim(e.dataType||"*").toLowerCase().split(Ga);if(e.crossDomain==null)I=A.exec(e.url.toLowerCase()),e.crossDomain=!(!I||!(I[1]!=
Aa[1]||I[2]!=Aa[2]||(I[3]||(I[1]==="http:"?80:443))!=(Aa[3]||(Aa[1]==="http:"?80:443))));if(e.data&&e.processData&&typeof e.data!=="string")e.data=h.param(e.data,e.traditional);y(C,e,c,t);if(Q===2)return!1;sa=e.global;e.type=e.type.toUpperCase();e.hasContent=!za.test(e.type);sa&&h.active++===0&&h.event.trigger("ajaxStart");if(!e.hasContent&&(e.data&&(e.url+=(la.test(e.url)?"&":"?")+e.data,delete e.data),B=e.url,e.cache===!1)){I=h.now();var v=e.url.replace(m,"$1_="+I);e.url=v+(v===e.url?(la.test(e.url)?
"&":"?")+"_="+I:"")}(e.data&&e.hasContent&&e.contentType!==!1||c.contentType)&&t.setRequestHeader("Content-Type",e.contentType);e.ifModified&&(B=B||e.url,h.lastModified[B]&&t.setRequestHeader("If-Modified-Since",h.lastModified[B]),h.etag[B]&&t.setRequestHeader("If-None-Match",h.etag[B]));t.setRequestHeader("Accept",e.dataTypes[0]&&e.accepts[e.dataTypes[0]]?e.accepts[e.dataTypes[0]]+(e.dataTypes[0]!=="*"?", "+xa+"; q=0.01":""):e.accepts["*"]);for(n in e.headers)t.setRequestHeader(n,e.headers[n]);if(e.beforeSend&&
(e.beforeSend.call(f,t,e)===!1||Q===2))return t.abort(),!1;for(n in{success:1,error:1,complete:1})t[n](e[n]);if(X=y(ka,e,c,t)){t.readyState=1;sa&&g.trigger("ajaxSend",[t,e]);e.async&&e.timeout>0&&(qa=setTimeout(function(){t.abort("timeout")},e.timeout));try{Q=1,X.send(r,d)}catch(L){Q<2?d(-1,L):h.error(L)}}else d(-1,"No Transport");return t},param:function(a,c){var d=[],e=function(a,b){b=h.isFunction(b)?b():b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(c===b)c=h.ajaxSettings.traditional;
if(h.isArray(a)||a.jquery&&!h.isPlainObject(a))h.each(a,function(){e(this.name,this.value)});else for(var f in a)V(f,a[f],c,e);return d.join("&").replace(La,"+")}});h.extend({active:0,lastModified:{},etag:{}});var wb=h.now(),nb=/(\=)\?(&|$)|\?\?/i;h.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return h.expando+"_"+wb++}});h.ajaxPrefilter("json jsonp",function(b,c,d){c=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data==="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(nb.test(b.url)||
c&&nb.test(b.data))){var e,f=b.jsonpCallback=h.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,g=a[f],m=b.url,j=b.data,k="$1"+f+"$2";b.jsonp!==!1&&(m=m.replace(nb,k),b.url===m&&(c&&(j=j.replace(nb,k)),b.data===j&&(m+=(/\?/.test(m)?"&":"?")+b.jsonp+"="+f)));b.url=m;b.data=j;a[f]=function(a){e=[a]};d.always(function(){a[f]=g;if(e&&h.isFunction(g))a[f](e[0])});b.converters["script json"]=function(){e||h.error(f+" was not called");return e[0]};b.dataTypes[0]="json";return"script"}});h.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){h.globalEval(a);return a}}});h.ajaxPrefilter("script",function(a){if(a.cache===b)a.cache=!1;if(a.crossDomain)a.type="GET",a.global=!1});h.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=u.head||u.getElementsByTagName("head")[0]||u.documentElement;return{send:function(e,f){c=u.createElement("script");c.async="async";if(a.scriptCharset)c.charset=a.scriptCharset;c.src=a.url;c.onload=c.onreadystatechange=function(a,
e){if(e||!c.readyState||/loaded|complete/.test(c.readyState))c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||f(200,"success")};d.insertBefore(c,d.firstChild)},abort:function(){if(c)c.onload(0,1)}}}});var tb=a.ActiveXObject?function(){for(var a in Za)Za[a](0,1)}:!1,xb=0,Za;h.ajaxSettings.xhr=a.ActiveXObject?function(){var b;if(!(b=!this.isLocal&&n()))a:{try{b=new a.ActiveXObject("Microsoft.XMLHTTP");break a}catch(c){}b=void 0}return b}:n;(function(a){h.extend(h.support,
{ajax:!!a,cors:!!a&&"withCredentials"in a})})(h.ajaxSettings.xhr());h.support.ajax&&h.ajaxTransport(function(c){if(!c.crossDomain||h.support.cors){var d;return{send:function(e,f){var g=c.xhr(),m,j;c.username?g.open(c.type,c.url,c.async,c.username,c.password):g.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)g[j]=c.xhrFields[j];c.mimeType&&g.overrideMimeType&&g.overrideMimeType(c.mimeType);!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)g.setRequestHeader(j,
e[j])}catch(k){}g.send(c.hasContent&&c.data||null);d=function(a,e){var j,k,A,l,B;try{if(d&&(e||g.readyState===4)){d=b;if(m)g.onreadystatechange=h.noop,tb&&delete Za[m];if(e)g.readyState!==4&&g.abort();else{j=g.status;A=g.getAllResponseHeaders();l={};if((B=g.responseXML)&&B.documentElement)l.xml=B;l.text=g.responseText;try{k=g.statusText}catch(r){k=""}!j&&c.isLocal&&!c.crossDomain?j=l.text?200:404:j===1223&&(j=204)}}}catch(C){e||f(-1,C)}l&&f(j,k,l,A)};!c.async||g.readyState===4?d():(m=++xb,tb&&(Za||
(Za={},h(a).unload(tb)),Za[m]=d),g.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var qb={},Ea,Ta,yb=/^(?:toggle|show|hide)$/,zb=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,ob,ub=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],hb;h.fn.extend({show:function(a,b,c){if(a||a===0)return this.animate(na("show",3),a,b,c);else{for(var c=0,d=this.length;c<d;c++)if(a=this[c],a.style){b=a.style.display;if(!h._data(a,
"olddisplay")&&b==="none")b=a.style.display="";b===""&&h.css(a,"display")==="none"&&h._data(a,"olddisplay",oa(a.nodeName))}for(c=0;c<d;c++)if(a=this[c],a.style&&(b=a.style.display,b===""||b==="none"))a.style.display=h._data(a,"olddisplay")||"";return this}},hide:function(a,b,c){if(a||a===0)return this.animate(na("hide",3),a,b,c);else{for(var c=0,d=this.length;c<d;c++)a=this[c],a.style&&(b=h.css(a,"display"),b!=="none"&&!h._data(a,"olddisplay")&&h._data(a,"olddisplay",b));for(c=0;c<d;c++)if(this[c].style)this[c].style.display=
"none";return this}},_toggle:h.fn.toggle,toggle:function(a,b,c){var d=typeof a==="boolean";h.isFunction(a)&&h.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:h(this).is(":hidden");h(this)[b?"show":"hide"]()}):this.animate(na("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){function e(){var K;f.queue===!1&&h._mark(this);var b=h.extend({},
f),c=this.nodeType===1,d=c&&h(this).is(":hidden"),g,m,j,k,A;b.animatedProperties={};for(j in a){g=h.camelCase(j);j!==g&&(a[g]=a[j],delete a[j]);m=a[g];h.isArray(m)?(b.animatedProperties[g]=m[1],K=a[g]=m[0],m=K):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(m==="hide"&&d||m==="show"&&!d)return b.complete.call(this);if(c&&(g==="height"||g==="width"))if(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],h.css(this,"display")==="inline"&&h.css(this,
"float")==="none")!h.support.inlineBlockNeedsLayout||oa(this.nodeName)==="inline"?this.style.display="inline-block":this.style.zoom=1}if(b.overflow!=null)this.style.overflow="hidden";for(j in a)if(c=new h.fx(this,b,j),m=a[j],yb.test(m))if(g=h._data(this,"toggle"+j)||(m==="toggle"?d?"show":"hide":0))h._data(this,"toggle"+j,g==="show"?"hide":"show"),c[g]();else c[m]();else g=zb.exec(m),k=c.cur(),g?(m=parseFloat(g[2]),A=g[3]||(h.cssNumber[j]?"":"px"),A!=="px"&&(h.style(this,j,(m||1)+A),k*=(m||1)/c.cur(),
h.style(this,j,k+A)),g[1]&&(m=(g[1]==="-="?-1:1)*m+k),c.custom(k,m,A)):c.custom(k,m,"");return!0}var f=h.speed(b,c,d);if(h.isEmptyObject(a))return this.each(f.complete,[!1]);a=h.extend({},a);return f.queue===!1?this.each(e):this.queue(f.queue,e)},stop:function(a,c,d){typeof a!=="string"&&(d=c,c=a,a=b);c&&a!==!1&&this.queue(a||"fx",[]);return this.each(function(){function b(a,c,e){c=c[e];h.removeData(a,e,!0);c.stop(d)}var c,e=!1,f=h.timers,g=h._data(this);d||h._unmark(!0,this);if(a==null)for(c in g)g[c].stop&&
c.indexOf(".run")===c.length-4&&b(this,g,c);else g[c=a+".run"]&&g[c].stop&&b(this,g,c);for(c=f.length;c--;)if(f[c].elem===this&&(a==null||f[c].queue===a)){if(d)f[c](!0);else f[c].saveState();e=!0;f.splice(c,1)}(!d||!e)&&h.dequeue(this,a)})}});h.each({slideDown:na("show",1),slideUp:na("hide",1),slideToggle:na("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){h.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});h.extend({speed:function(a,b,
c){var d=a&&typeof a==="object"?h.extend({},a):{complete:c||!c&&b||h.isFunction(a)&&a,duration:a,easing:c&&b||b&&!h.isFunction(b)&&b};d.duration=h.fx.off?0:typeof d.duration==="number"?d.duration:d.duration in h.fx.speeds?h.fx.speeds[d.duration]:h.fx.speeds._default;if(d.queue==null||d.queue===!0)d.queue="fx";d.old=d.complete;d.complete=function(a){h.isFunction(d.old)&&d.old.call(this);d.queue?h.dequeue(this,d.queue):a!==!1&&h._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},
swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+0.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b;this.elem=a;this.prop=c;b.orig=b.orig||{}}});h.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this);(h.fx.step[this.prop]||h.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=h.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||
b==="auto"?0:b:a},custom:function(a,c,d){function e(a){return f.step(a)}var f=this,g=h.fx;this.startTime=hb||W();this.end=c;this.now=this.start=a;this.pos=this.state=0;this.unit=d||this.unit||(h.cssNumber[this.prop]?"":"px");e.queue=this.options.queue;e.elem=this.elem;e.saveState=function(){f.options.hide&&h._data(f.elem,"fxshow"+f.prop)===b&&h._data(f.elem,"fxshow"+f.prop,f.start)};e()&&h.timers.push(e)&&!ob&&(ob=setInterval(g.tick,g.interval))},show:function(){var a=h._data(this.elem,"fxshow"+this.prop);
this.options.orig[this.prop]=a||h.style(this.elem,this.prop);this.options.show=!0;a!==b?this.custom(this.cur(),a):this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());h(this.elem).show()},hide:function(){this.options.orig[this.prop]=h._data(this.elem,"fxshow"+this.prop)||h.style(this.elem,this.prop);this.options.hide=!0;this.custom(this.cur(),0)},step:function(a){var b,c=hb||W(),d=!0,e=this.elem,f=this.options;if(a||c>=f.duration+this.startTime){this.now=this.end;this.pos=this.state=
1;this.update();f.animatedProperties[this.prop]=!0;for(b in f.animatedProperties)f.animatedProperties[b]!==!0&&(d=!1);if(d){f.overflow!=null&&!h.support.shrinkWrapBlocks&&h.each(["","X","Y"],function(a,b){e.style["overflow"+b]=f.overflow[a]});f.hide&&h(e).hide();if(f.hide||f.show)for(b in f.animatedProperties)h.style(e,b,f.orig[b]),h.removeData(e,"fxshow"+b,!0),h.removeData(e,"toggle"+b,!0);if(a=f.complete)f.complete=!1,a.call(e)}return!1}else f.duration==Infinity?this.now=c:(a=c-this.startTime,this.state=
a/f.duration,this.pos=h.easing[f.animatedProperties[this.prop]](this.state,a,0,1,f.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}};h.extend(h.fx,{tick:function(){for(var a,b=h.timers,c=0;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||h.fx.stop()},interval:13,stop:function(){clearInterval(ob);ob=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){h.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=
null?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}});h.each(["width","height"],function(a,b){h.fx.step[b]=function(a){h.style(a.elem,b,Math.max(0,a.now))}});if(h.expr&&h.expr.filters)h.expr.filters.animated=function(a){return h.grep(h.timers,function(b){return a===b.elem}).length};var Ab=/^t(?:able|d|h)$/i,vb=/^(?:body|html)$/i;h.fn.offset="getBoundingClientRect"in u.documentElement?function(a){var b=this[0],c;if(a)return this.each(function(b){h.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;
if(b===b.ownerDocument.body)return h.offset.bodyOffset(b);try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,f=e.documentElement;if(!c||!h.contains(f,b))return c?{top:c.top,left:c.left}:{top:0,left:0};b=e.body;e=Z(e);return{top:c.top+(e.pageYOffset||h.support.boxModel&&f.scrollTop||b.scrollTop)-(f.clientTop||b.clientTop||0),left:c.left+(e.pageXOffset||h.support.boxModel&&f.scrollLeft||b.scrollLeft)-(f.clientLeft||b.clientLeft||0)}}:function(a){var b=this[0];if(a)return this.each(function(b){h.offset.setOffset(this,
a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return h.offset.bodyOffset(b);var c,d=b.offsetParent,e=b.ownerDocument,f=e.documentElement,g=e.body;c=(e=e.defaultView)?e.getComputedStyle(b,null):b.currentStyle;for(var m=b.offsetTop,j=b.offsetLeft;(b=b.parentNode)&&b!==g&&b!==f;){if(h.support.fixedPosition&&c.position==="fixed")break;c=e?e.getComputedStyle(b,null):b.currentStyle;m-=b.scrollTop;j-=b.scrollLeft;if(b===d){m+=b.offsetTop;j+=b.offsetLeft;if(h.support.doesNotAddBorder&&
(!h.support.doesAddBorderForTableAndCells||!Ab.test(b.nodeName)))m+=parseFloat(c.borderTopWidth)||0,j+=parseFloat(c.borderLeftWidth)||0;d=b.offsetParent}h.support.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(m+=parseFloat(c.borderTopWidth)||0,j+=parseFloat(c.borderLeftWidth)||0)}if(c.position==="relative"||c.position==="static")m+=g.offsetTop,j+=g.offsetLeft;h.support.fixedPosition&&c.position==="fixed"&&(m+=Math.max(f.scrollTop,g.scrollTop),j+=Math.max(f.scrollLeft,g.scrollLeft));
return{top:m,left:j}};h.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;h.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(h.css(a,"marginTop"))||0,c+=parseFloat(h.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=h.css(a,"position");if(d==="static")a.style.position="relative";var e=h(a),f=e.offset(),g=h.css(a,"top"),m=h.css(a,"left"),j={},k={};(d==="absolute"||d==="fixed")&&h.inArray("auto",[g,m])>-1?(k=e.position(),d=k.top,m=k.left):(d=parseFloat(g)||
0,m=parseFloat(m)||0);h.isFunction(b)&&(b=b.call(a,c,f));if(b.top!=null)j.top=b.top-f.top+d;if(b.left!=null)j.left=b.left-f.left+m;"using"in b?b.using.call(a,j):e.css(j)}};h.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=vb.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(h.css(a,"marginTop"))||0;c.left-=parseFloat(h.css(a,"marginLeft"))||0;d.top+=parseFloat(h.css(b[0],"borderTopWidth"))||0;d.left+=parseFloat(h.css(b[0],
"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||u.body;a&&!vb.test(a.nodeName)&&h.css(a,"position")==="static";)a=a.offsetParent;return a})}});h.each(["Left","Top"],function(a,c){var d="scroll"+c;h.fn[d]=function(c){var e,f;if(c===b){e=this[0];return!e?null:(f=Z(e))?"pageXOffset"in f?f[a?"pageYOffset":"pageXOffset"]:h.support.boxModel&&f.document.documentElement[d]||f.document.body[d]:e[d]}return this.each(function(){(f=
Z(this))?f.scrollTo(!a?c:h(f).scrollLeft(),a?c:h(f).scrollTop()):this[d]=c})}});h.each(["Height","Width"],function(a,c){var d=c.toLowerCase();h.fn["inner"+c]=function(){var a=this[0];return a?a.style?parseFloat(h.css(a,d,"padding")):this[d]():null};h.fn["outer"+c]=function(a){var b=this[0];return b?b.style?parseFloat(h.css(b,d,a?"margin":"border")):this[d]():null};h.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(h.isFunction(a))return this.each(function(b){var c=h(this);c[d](a.call(this,
b,c[d]()))});if(h.isWindow(e)){var f=e.document.documentElement["client"+c],g=e.document.body;return e.document.compatMode==="CSS1Compat"&&f||g&&g["client"+c]||f}else return e.nodeType===9?Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]):a===b?(e=h.css(e,d),f=parseFloat(e),h.isNumeric(f)?f:e):this.css(d,typeof a==="string"?a:a+"px")}});a.jQuery=a.$=h})(window);
(function(a){a.toJSON=function(b){if(typeof JSON=="object"&&JSON.stringify)return JSON.stringify(b);var c=typeof b;if(b===null)return"null";if(c!="undefined"){if(c=="number"||c=="boolean")return b+"";if(c=="string")return a.quoteString(b);if(c=="object"){if(typeof b.toJSON=="function")return a.toJSON(b.toJSON());if(b.constructor===Date){var f=b.getUTCMonth()+1;f<10&&(f="0"+f);var g=b.getUTCDate();g<10&&(g="0"+g);var c=b.getUTCFullYear(),j=b.getUTCHours();j<10&&(j="0"+j);var k=b.getUTCMinutes();k<
10&&(k="0"+k);var l=b.getUTCSeconds();l<10&&(l="0"+l);b=b.getUTCMilliseconds();b<100&&(b="0"+b);b<10&&(b="0"+b);return'"'+c+"-"+f+"-"+g+"T"+j+":"+k+":"+l+"."+b+'Z"'}if(b.constructor===Array){f=[];for(g=0;g<b.length;g++)f.push(a.toJSON(b[g])||"null");return"["+f.join(",")+"]"}f=[];for(g in b){c=typeof g;if(c=="number")c='"'+g+'"';else if(c=="string")c=a.quoteString(g);else continue;typeof b[g]!="function"&&(j=a.toJSON(b[g]),f.push(c+":"+j))}return"{"+f.join(", ")+"}"}}};a.evalJSON=function(a){return typeof JSON==
"object"&&JSON.parse?JSON.parse(a):eval("("+a+")")};a.secureEvalJSON=function(a){if(typeof JSON=="object"&&JSON.parse)return JSON.parse(a);var b;b=a.replace(/\\["\\\/bfnrtu]/g,"@");b=b.replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]");b=b.replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(b))return eval("("+a+")");else throw new SyntaxError("Error parsing JSON, source is not valid.");};a.quoteString=function(a){return a.match(b)?'"'+a.replace(b,function(a){var b=
c[a];if(typeof b==="string")return b;b=a.charCodeAt();return"\\u00"+Math.floor(b/16).toString(16)+(b%16).toString(16)})+'"':'"'+a+'"'};var b=/["\\\x00-\x1f\x7f-\x9f]/g,c={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"}})(jQuery);jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,b,c,d,e){return jQuery.easing[jQuery.easing.def](a,b,c,d,e)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/
2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/
e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return b==0?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return b==0?c:b==e?c+d:(b/=e/2)<1?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*
b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return(b/=e/2)<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var a=1.70158,f=0,g=d;if(b==0)return c;if((b/=e)==1)return c+d;f||(f=e*0.3);g<Math.abs(d)?(g=d,a=f/4):a=f/(2*Math.PI)*Math.asin(d/g);return-(g*Math.pow(2,10*(b-=1))*Math.sin((b*e-a)*2*Math.PI/f))+c},easeOutElastic:function(a,b,c,d,e){var a=1.70158,f=0,g=d;if(b==0)return c;if((b/=
e)==1)return c+d;f||(f=e*0.3);g<Math.abs(d)?(g=d,a=f/4):a=f/(2*Math.PI)*Math.asin(d/g);return g*Math.pow(2,-10*b)*Math.sin((b*e-a)*2*Math.PI/f)+d+c},easeInOutElastic:function(a,b,c,d,e){var a=1.70158,f=0,g=d;if(b==0)return c;if((b/=e/2)==2)return c+d;f||(f=e*0.3*1.5);g<Math.abs(d)?(g=d,a=f/4):a=f/(2*Math.PI)*Math.asin(d/g);return b<1?-0.5*g*Math.pow(2,10*(b-=1))*Math.sin((b*e-a)*2*Math.PI/f)+c:g*Math.pow(2,-10*(b-=1))*Math.sin((b*e-a)*2*Math.PI/f)*0.5+d+c},easeInBack:function(a,b,c,d,e,f){f==void 0&&
(f=1.70158);return d*(b/=e)*b*((f+1)*b-f)+c},easeOutBack:function(a,b,c,d,e,f){f==void 0&&(f=1.70158);return d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(a,b,c,d,e,f){f==void 0&&(f=1.70158);return(b/=e/2)<1?d/2*b*b*(((f*=1.525)+1)*b-f)+c:d/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+c},easeInBounce:function(a,b,c,d,e){return d-jQuery.easing.easeOutBounce(a,e-b,0,d,e)+c},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?d*7.5625*b*b+c:b<2/2.75?d*(7.5625*(b-=1.5/2.75)*b+0.75)+c:b<2.5/2.75?d*
(7.5625*(b-=2.25/2.75)*b+0.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+0.984375)+c},easeInOutBounce:function(a,b,c,d,e){return b<e/2?jQuery.easing.easeInBounce(a,b*2,0,d,e)*0.5+c:jQuery.easing.easeOutBounce(a,b*2-e,0,d,e)*0.5+d*0.5+c}});typeof NEWSBLUR=="undefined"&&(NEWSBLUR={});if(typeof NEWSBLUR.Globals=="undefined")NEWSBLUR.Globals={};var URL_REGEX=/((https?\:\/\/)|(www\.))(\S+)(\w{2,4})(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi;
NEWSBLUR.log=function(a){try{if(typeof o=="object"){for(var b=[],c=0;c<a.length;c++)c!=0&&b.push(a[c]);console.debug(a[0],b)}else console.log(a)}catch(d){console={log:function(){}}}};
(function(a){a.fn.extend({autolink:function(){return this.each(function(){a(this).textNodes().each(function(){var b=a(this);b&&b.parent()&&b.parent()[0]&&b.parent()[0].nodeName!="A"&&b.replaceWith(this.data.replace(URL_REGEX,function(a){return'<a href="'+a+'">'+a+"</a>"}))})})},textNodes:function(){var b=[];(function(a){if(a)if(a.nodeType==3)b.push(a);else for(var d=0;d<a.childNodes.length;++d)arguments.callee(a.childNodes[d])})(this[0]);return a(b)},isScrollVisible:function(b){var c=0+a(this).height(),
d=a(this).offset().top,d=b.offset().top-d,b=d+b.outerHeight();return d>=0&&b<=c},align:function(b,c,d){var e,f,g,j,c=c||"",d=d||{},k=document.documentElement.scrollTop||document.body.scrollTop||0,l=document.documentElement.scrollLeft||document.body.scrollLeft||0,p=document.documentElement.clientWidth,t=document.documentElement.clientHeight;if(b==window)e=l,f=k,g=a(window).width(),j=a(window).height();else{var b=a(b),v=b.offset();e=v.left;f=v.top;g=b.innerWidth();j=b.innerHeight()}b=this.innerWidth();
v=this.innerHeight();e=c.indexOf("-left")>=0?e:c.indexOf("left")>=0?e-b:c.indexOf("-right")>=0?e+g-b:c.indexOf("right")>=0?e+g:e+(g-b)/2;f=c.indexOf("-top")>=0?f:c.indexOf("top")>=0?f-v:c.indexOf("-bottom")>=0?f+j-v:c.indexOf("bottom")>=0?f+j:f+(j-v)/2;c=c.indexOf("no-constraint")>=0?!1:!0;e+=d.left||0;f+=d.top||0;c&&(e=Math.max(l,Math.min(e,l+p-b)),f=Math.max(k,Math.min(f,k+t-v)));a(this).css({position:"absolute",left:e+"px",top:f+"px"});return this}});a.extend({textColor:function(a){var c=function(a,
b){var c=d(a),j=d(b);return c>j?(c+0.05)/(j+0.05):(j+0.05)/(c+0.05)},d=function(a){var b=a.r,c=a.g,a=a.b,b=b<=0.03928?b/12.92:Math.pow((b+0.055)/1.055,2.4),c=c<=0.03928?c/12.92:Math.pow((c+0.055)/1.055,2.4),a=a<=0.03928?a/12.92:Math.pow((a+0.055)/1.055,2.4);return 0.2126*b+0.7152*c+0.0722*a};return c(a,{r:1,g:1,b:1})>c(a,{r:0.5,g:0.5,b:0.5})?"white":"black"},favicon:function(a,c){if(a&&a.indexOf("data:image/png;base64,")!=-1)return a;else if(a)return"data:image/png;base64,"+a;else if(c)return"data:image/png;base64,R0lGODlhAQABAIAAAAAAAAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";
return NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/world.png"},deepCopy:function(b){switch(a.typeOf(b)){case "object":var c={};for(key in b)c[key]=a.deepCopy(b[key]);return c;case "array":for(var c=[],d=0;d<b.length;d++)c.push(a.deepCopy(b[d]));return c;default:return b}},typeOf:function(a){var c=typeof a;c=="object"&&(a?typeof a.length=="number"&&!a.propertyIsEnumerable("length")&&typeof a.splice=="function"&&(c="array"):c="null");return c},targetIs:function(b,c,d){if(!b||!c)return!1;var c={childOf:c.childOf||
null,tagSelector:c.tagSelector||null,cancelBubbling:c.cancelBubbling||!1},b=a(b.target),e=null,f=!1;c.childOf&&(e=b.closest(c.childOf),e.length||(f=!0));if(c.tagSelector){var g=c.tagSelector;b.is(g)||(c.cancelBubbling?f=!0:($tp=b.closest(g),$tp.length?b=$tp:f=!0))}return f?!1:(d&&typeof d=="function"&&d(b,e),!0)},entity:function(a){var c=document.createElement("div");c.innerHTML=String(a);return c.innerHTML},make:function(){var b,c,d,e;b=arguments;var f=b[0];if(b[1])if(typeof b[1]=="string"||typeof b[1]==
"number")c=b[1];else if(typeof b[1]=="object"&&b[1].push)d=b[1];else if(e=b[1],e.className)e["class"]=e.className,delete e.className;b[2]&&(typeof b[2]=="string"||typeof b[2]=="number"?c=b[2]:typeof b[1]=="object"&&b[2].push&&(d=b[2]));b=a(document.createElement(f));if(e)for(var g in e)e.hasOwnProperty(g)&&(b.is(":input")&&g=="value"?b.val(e[g]):b.attr(g,e[g]));if(d)for(e=0;e<d.length;e++)d[e]&&b.append(d[e]);c&&b.html(c);return b},rescope:function(a,c){return function(d,e,f,g,j,k){a.call(c,this,
d,e,f,g,j,k)}},closest:function(a,c){var d=0,e=Math.abs(c[d]-a),f;for(f in c){var g=c[f]-a;if(g<=0&&Math.abs(g)<e)d=parseInt(f,10),e=Math.abs(c[d]-a);else if(g>0)break}return d},getQueryString:function(a){function c(){for(var a={},b,c=/\+/g,g=/([^&=]+)=?([^&]*)/g,j=window.location.search.substring(1);b=g.exec(j);)a[decodeURIComponent(b[1].replace(c," "))]=decodeURIComponent(b[2].replace(c," "));return a}if(!this.queryStringParams)this.queryStringParams=c();return this.queryStringParams[a]}})})(jQuery);
(function(a){var b;a.extend({iedebug:function(c){b||(b=a.make("div",[a.make("ol")]).css({position:"absolute",top:10,left:10,zIndex:2E4,border:"1px solid #000",padding:"10px",backgroundColor:"#fff",fontFamily:"arial,helvetica,sans-serif",fontSize:"11px"}),a("body").append(b),b.draggable());b.find("ol").append(a.make("li",c).css({borderBottom:"1px solid #999999"}))}})})(jQuery);
(function(a){function b(a){return typeof a=="object"?a:{top:a,left:a}}var c=a.scrollTo=function(b,c,f){a(window).scrollTo(b,c,f)};c.defaults={axis:"xy",duration:parseFloat(a.fn.jquery)>=1.3?0:1,queue:!0};c.window=function(){return a(window).scrollable()};a.fn.scrollable=function(){return this.map(function(){if(this.nodeName&&a.inArray(this.nodeName.toLowerCase(),["iframe","#document","html","body"])==-1)return this;var b=(this.contentWindow||this).document||this.ownerDocument||this;return a.browser.safari||
b.compatMode=="BackCompat"?b.body:b.documentElement})};a.fn.scrollTo=function(d,e,f){typeof e=="object"&&(f=e,e=0);typeof f=="function"&&(f={onAfter:f});d=="max"&&(d=9E9);f=a.extend({},c.defaults,f);e=e||f.speed||f.duration;f.queue=f.queue&&f.axis.length>1;f.queue&&(e/=2);f.offset=b(f.offset);f.over=b(f.over);return this.scrollable().each(function(){function c(a){l.animate(v,{duration:e,easing:f.easing,complete:a&&function(){a.call(this,d,f)},queue:f.queue})}function j(a){var b="scroll"+a;if(!H)return k[b];
var a="client"+a,c=k.ownerDocument.documentElement,d=k.ownerDocument.body;return Math.max(c[b],d[b])-Math.min(c[a],d[a])}var k=this,l=a(k),p=d,t,v={},H=l.is("html,body");switch(typeof p){case "number":case "string":if(/^([+-]=)?\d+(\.\d+)?(px)?$/.test(p)){p=b(p);break}p=a(p,this);case "object":if(p.is||p.style)t=(p=a(p)).offset()}a.each(f.axis.split(""),function(a,b){var d=b=="x"?"Left":"Top",e=d.toLowerCase(),y="scroll"+d,ea=k[y],V=b=="x"?"Width":"Height";t?(v[y]=t[e]+(H?0:ea-l.offset()[e]),f.margin&&
(v[y]-=parseInt(p.css("margin"+d))||0,v[y]-=parseInt(p.css("border"+d+"Width"))||0),v[y]+=f.offset[e]||0,f.over[e]&&(v[y]+=p[V.toLowerCase()]()*f.over[e])):v[y]=p[e];/^\d+$/.test(v[y])&&(v[y]=v[y]<=0?0:Math.min(v[y],j(V)));!a&&f.queue&&(ea!=v[y]&&c(f.onAfterFirst),delete v[y])});c(f.onAfter)}).end()}})(jQuery);
(function(a){function b(a){a=parseInt(a).toString(16);return a.length<2?"0"+a:a}function c(c){for(;c;){var d=a.css(c,"backgroundColor");if(d&&d!="transparent"&&d!="rgba(0, 0, 0, 0)")return d.indexOf("rgb")>=0?(c=d.match(/\d+/g),"#"+b(c[0])+b(c[1])+b(c[2])):d;c=c.parentNode}return"#ffffff"}function d(a,b,c){switch(a){case "round":return Math.round(c*(1-Math.cos(Math.asin(b/c))));case "cool":return Math.round(c*(1+Math.cos(Math.asin(b/c))));case "sharp":return Math.round(c*(1-Math.cos(Math.acos(b/c))));
case "bite":return Math.round(c*Math.cos(Math.asin((c-b-1)/c)));case "slide":return Math.round(c*Math.atan2(b,c/b));case "jut":return Math.round(c*Math.atan2(c,c-b-1));case "curl":return Math.round(c*Math.atan(b));case "tear":return Math.round(c*Math.cos(b));case "wicked":return Math.round(c*Math.tan(b));case "long":return Math.round(c*Math.sqrt(b));case "sculpt":return Math.round(c*Math.log(c-b-1,c));case "dogfold":case "dog":return b&1?b+1:c;case "dog2":return b&2?b+1:c;case "dog3":return b&3?b+
1:c;case "fray":return b%2*c;case "notch":return c;case "bevelfold":case "bevel":return b+1}}var e=document.createElement("div").style,f=e.MozBorderRadius!==void 0,g=e.WebkitBorderRadius!==void 0,j=e.borderRadius!==void 0||e.BorderRadius!==void 0,e=document.documentMode||0,k=a.browser.msie&&(a.browser.version<8&&!e||e<8),l=a.browser.msie&&function(){var a=document.createElement("div");try{a.style.setExpression("width","0+0"),a.style.removeExpression("width")}catch(b){return!1}return!0}();a.fn.corner=
function(b){if(this.length==0){if(!a.isReady&&this.selector){var e=this.selector,v=this.context;a(function(){a(e,v).corner(b)})}return this}return this.each(function(){var e=a(this),t=[e.attr(a.fn.corner.defaults.metaAttr)||"",b||""].join(" ").toLowerCase(),v=/keep/.test(t),N=(t.match(/cc:(#[0-9a-f]+)/)||[])[1],O=(t.match(/sc:(#[0-9a-f]+)/)||[])[1],y=parseInt((t.match(/(\d+)px/)||[])[1])||10,ea=(t.match(/round|bevelfold|bevel|notch|bite|cool|sharp|slide|jut|curl|tear|fray|wicked|sculpt|long|dog3|dog2|dogfold|dog/)||
["round"])[0],V=/dogfold|bevelfold/.test(t),n={T:0,B:1},t={TL:/top|tl|left/.test(t),TR:/top|tr|right/.test(t),BL:/bottom|bl|left/.test(t),BR:/bottom|br|right/.test(t)};!t.TL&&!t.TR&&!t.BL&&!t.BR&&(t={TL:1,TR:1,BL:1,BR:1});if(a.fn.corner.defaults.useNative&&ea=="round"&&(j||f||g)&&!N&&!O)t.TL&&e.css(j?"border-top-left-radius":f?"-moz-border-radius-topleft":"-webkit-border-top-left-radius",y+"px"),t.TR&&e.css(j?"border-top-right-radius":f?"-moz-border-radius-topright":"-webkit-border-top-right-radius",
y+"px"),t.BL&&e.css(j?"border-bottom-left-radius":f?"-moz-border-radius-bottomleft":"-webkit-border-bottom-left-radius",y+"px"),t.BR&&e.css(j?"border-bottom-right-radius":f?"-moz-border-radius-bottomright":"-webkit-border-bottom-right-radius",y+"px");else{e=document.createElement("div");a(e).css({overflow:"hidden",height:"1px",minHeight:"1px",fontSize:"1px",backgroundColor:O||"transparent",borderStyle:"solid"});var O=parseInt(a.css(this,"paddingTop"))||0,W=parseInt(a.css(this,"paddingRight"))||0,
ua=parseInt(a.css(this,"paddingBottom"))||0,na=parseInt(a.css(this,"paddingLeft"))||0;if(typeof this.style.zoom!=void 0)this.style.zoom=1;if(!v)this.style.border="none";e.style.borderColor=N||c(this.parentNode);var v=a(this).outerHeight(),oa;for(oa in n)if((N=n[oa])&&(t.BL||t.BR)||!N&&(t.TL||t.TR)){e.style.borderStyle="none "+(t[oa+"R"]?"solid":"none")+" none "+(t[oa+"L"]?"solid":"none");var Z=document.createElement("div");a(Z).addClass("jquery-corner");var u=Z.style;N?this.appendChild(Z):this.insertBefore(Z,
this.firstChild);if(N&&v!="auto"){if(a.css(this,"position")=="static")this.style.position="relative";u.position="absolute";u.bottom=u.left=u.padding=u.margin="0";l?u.setExpression("width","this.parentNode.offsetWidth"):u.width="100%"}else if(!N&&a.browser.msie){if(a.css(this,"position")=="static")this.style.position="relative";u.position="absolute";u.top=u.left=u.right=u.padding=u.margin="0";if(l){var w=(parseInt(a.css(this,"borderLeftWidth"))||0)+(parseInt(a.css(this,"borderRightWidth"))||0);u.setExpression("width",
"this.parentNode.offsetWidth - "+w+'+ "px"')}else u.width="100%"}else u.position="relative",u.margin=!N?"-"+O+"px -"+W+"px "+(O-y)+"px -"+na+"px":ua-y+"px -"+W+"px -"+ua+"px -"+na+"px";for(u=0;u<y;u++){var w=Math.max(0,d(ea,u,y)),r=e.cloneNode(!1);r.style.borderWidth="0 "+(t[oa+"R"]?w:0)+"px 0 "+(t[oa+"L"]?w:0)+"px";N?Z.appendChild(r):Z.insertBefore(r,Z.firstChild)}if(V&&a.support.boxModel&&(!N||!k))for(var h in t)if(t[h]&&(!N||!(h=="TL"||h=="TR")))if(N||!(h=="BL"||h=="BR")){u={position:"absolute",
border:"none",margin:0,padding:0,overflow:"hidden",backgroundColor:e.style.borderColor};w=a("<div/>").css(u).css({width:y+"px",height:"1px"});switch(h){case "TL":w.css({bottom:0,left:0});break;case "TR":w.css({bottom:0,right:0});break;case "BL":w.css({top:0,left:0});break;case "BR":w.css({top:0,right:0})}Z.appendChild(w[0]);u=a("<div/>").css(u).css({top:0,bottom:0,width:"1px",height:y+"px"});switch(h){case "TL":u.css({left:y});break;case "TR":u.css({right:y});break;case "BL":u.css({left:y});break;
case "BR":u.css({right:y})}Z.appendChild(u[0])}}}})};a.fn.uncorner=function(){if(j||f||g)this.css(j?"border-radius":f?"-moz-border-radius":"-webkit-border-radius",0);a("div.jquery-corner",this).remove();return this};a.fn.corner.defaults={useNative:!0,metaAttr:"data-corner"}})(jQuery);
NEWSBLUR.hotkeys={KEYS:{16:"shift",17:"control",91:"command",93:"command",224:"command"},initialize:function(){_.bindAll(this,"down","up","blur");$(document).bind("keydown",this.down);$(document).bind("keyup",this.up);$(window).bind("blur",this.blur)},down:function(a){(a=this.KEYS[a.keyCode])&&(this[a]=!0)},up:function(a){(a=this.KEYS[a.keyCode])&&(this[a]=!1)},blur:function(){for(var a in this.KEYS)this[this.KEYS[a]]=!1}};
(function(a){function b(b){if(typeof b.data==="string"){var d=b.handler,e=b.data.toLowerCase().split(" ");b.handler=function(b){if(!(this!==b.target&&(/textarea|select/i.test(b.target.nodeName)||b.target.type==="text"||b.target.type==="password"))){var c=b.type!=="keypress"&&a.hotkeys.specialKeys[b.which],j=String.fromCharCode(b.which).toLowerCase(),k="",l={};b.altKey&&c!=="alt"&&(k+="alt+");b.ctrlKey&&c!=="ctrl"&&(k+="ctrl+");b.metaKey&&!b.ctrlKey&&c!=="meta"&&(k+="meta+");b.shiftKey&&c!=="shift"&&
(k+="shift+");c?l[k+c]=!0:(l[k+j]=!0,l[k+a.hotkeys.shiftNums[j]]=!0,k==="shift+"&&(l[a.hotkeys.shiftNums[j]]=!0));c=0;for(j=e.length;c<j;c++)if(l[e[c]])return d.apply(this,arguments)}}}}a.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",
105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};a.each(["keydown","keyup","keypress"],function(){a.event.special[this]={add:b}})})(jQuery);
jQuery.extend({createUploadIframe:function(a,b){var c="jUploadFrame"+a;if(window.ActiveXObject){var d=document.createElement('<iframe id="'+c+'" name="'+c+'" />');if(typeof b=="boolean")d.src="javascript:false";else if(typeof b=="string")d.src=b}else d=document.createElement("iframe"),d.id=c,d.name=c;d.style.position="absolute";d.style.top="-1000px";d.style.left="-1000px";document.body.appendChild(d);return d},createUploadForm:function(a,b){var c="jUploadForm"+a,d="jUploadFile"+a,c=$('<form  action="" method="POST" name="'+
c+'" id="'+c+'" enctype="multipart/form-data"></form>'),e=$("#"+b),f=$(e).clone();$(e).attr("id",d);$(e).before(f);$(e).appendTo(c);$(c).css("position","absolute");$(c).css("top","-1200px");$(c).css("left","-1200px");$(c).appendTo("body");return c},ajaxFileUpload:function(a){var a=jQuery.extend({},jQuery.ajaxSettings,a),b=(new Date).getTime(),c=jQuery.createUploadForm(b,a.fileElementId);jQuery.createUploadIframe(b,a.secureuri);var d="jUploadFrame"+b,b="jUploadForm"+b;a.global&&!jQuery.active++&&jQuery.event.trigger("ajaxStart");
var e=!1,f={};a.global&&jQuery.event.trigger("ajaxSend",[f,a]);var g=function(b){var g=document.getElementById(d);try{if(g.contentWindow)f.responseText=g.contentWindow.document.body?g.contentWindow.document.body.innerHTML:null,f.responseXML=g.contentWindow.document.XMLDocument?g.contentWindow.document.XMLDocument:g.contentWindow.document;else if(g.contentDocument)f.responseText=g.contentDocument.document.body?g.contentDocument.document.body.innerHTML:null,f.responseXML=g.contentDocument.document.XMLDocument?
g.contentDocument.document.XMLDocument:g.contentDocument.document}catch(j){jQuery.handleError(a,f,null,j)}if(f||b=="timeout"){e=!0;var t;try{if(t=b!="timeout"?"success":"error",t!="error"){var v=jQuery.uploadHttpData(f,a.dataType);a.success&&a.success(v,t);a.global&&jQuery.event.trigger("ajaxSuccess",[f,a])}else jQuery.handleError(a,f,t)}catch(H){t="error",jQuery.handleError(a,f,t,H)}a.global&&jQuery.event.trigger("ajaxComplete",[f,a]);a.global&&!--jQuery.active&&jQuery.event.trigger("ajaxStop");
a.complete&&a.complete(f,t);jQuery(g).unbind();setTimeout(function(){try{$(g).remove(),$(c).remove()}catch(b){jQuery.handleError(a,f,null,b)}},100);f=null}};a.timeout>0&&setTimeout(function(){e||g("timeout")},a.timeout);try{c=$("#"+b),$(c).attr("action",a.url),$(c).attr("method","POST"),$(c).attr("target",d),c.encoding?c.encoding="multipart/form-data":c.enctype="multipart/form-data",$(c).submit()}catch(j){jQuery.handleError(a,f,null,j)}window.attachEvent?document.getElementById(d).attachEvent("onload",
g):document.getElementById(d).addEventListener("load",g,!1);return{abort:function(){}}},uploadHttpData:function(a,b){var c;c=b=="xml"||!b?a.responseXML:a.responseText;b=="script"&&jQuery.globalEval(c);b=="json"&&(c=c.replace(/<pre>/i,"").replace(/<\/pre>/i,""),c=eval("("+c+")"));b=="html"&&jQuery("<div>").html(c).evalScripts();return c}});
(function(a){var b={},c={};a.manageAjax=function(){return{create:function(c,e){b[c]=new a.manageAjax._manager(c,e);return b[c]},destroy:function(a){b[a]&&(b[a].clear(!0),delete b[a])}}}();a.manageAjax._manager=function(b,c){this.requests={};this.inProgress=0;this.qName=this.name=b;this.opts=a.extend({},a.ajaxSettings,a.manageAjax.defaults,c);if(c&&c.queue&&c.queue!==!0&&typeof c.queue==="string"&&c.queue!=="clear")this.qName=c.queue};a.manageAjax._manager.prototype={add:function(b,c){typeof b=="object"?
c=b:typeof b=="string"&&(c=a.extend(c||{},{url:b}));var c=a.extend({},this.opts,c),f=c.complete||a.noop,g=c.success||a.noop,j=c.beforeSend||a.noop,k=c.error||a.noop,l=typeof c.data=="string"?c.data:a.param(c.data||{}),p=c.type+c.url+l,t=this,v=this._createAjax(p,c,g,f);if(c.preventDoubleRequests&&c.queueDuplicateRequests){if(c.preventDoubleRequests)c.queueDuplicateRequests=!1;setTimeout(function(){throw"preventDoubleRequests and queueDuplicateRequests can't be both true";},0)}if(!this.requests[p]||
!c.preventDoubleRequests){v.xhrID=p;c.xhrID=p;c.beforeSend=function(a,b){var c=j.call(this,a,b);c===!1&&t._removeXHR(p);return c};c.complete=function(a,b){t._complete.call(t,this,f,a,b,p,c)};c.success=function(a,b,d){t._success.call(t,this,g,a,b,d,c)};c.error=function(a,b,d){var f="",g="";if(b!=="timeout"&&a)f=a.status,g=a.responseXML||a.responseText;k?k.call(this,a,b,d,c):setTimeout(function(){throw b+"| status: "+f+" | URL: "+c.url+" | data: "+l+" | thrown: "+d+" | response: "+g;},0);a=null};c.queue===
"clear"&&a(document).clearQueue(this.qName);return c.queue||c.queueDuplicateRequests&&this.requests[p]?(a.queue(document,this.qName,v),this.inProgress<c.maxRequests&&(!this.requests[p]||!c.queueDuplicateRequests)&&a.dequeue(document,this.qName),p):v()}},_createAjax:function(b,e,f,g){var j=this;return function(){if(e.beforeCreate.call(e.context||j,b,e)!==!1){j.inProgress++;j.inProgress===1&&a.event.trigger(j.name+"AjaxStart");e.cacheResponse&&c[b]&&(!c[b].cacheTTL||c[b].cacheTTL<0||(new Date).getTime()-
c[b].timestamp<c[b].cacheTTL?(j.requests[b]={},setTimeout(function(){j._success.call(j,e.context||e,f,c[b]._successData,"success",c[b],e);j._complete.call(j,e.context||e,g,c[b],"success",b,e)},0)):delete c[b]);if(!e.cacheResponse||!c[b])e.async?j.requests[b]=a.ajax(e):a.ajax(e);return b}}},_removeXHR:function(b){(this.opts.queue||this.opts.queueDuplicateRequests)&&a.dequeue(document,this.qName);this.inProgress--;this.requests[b]=null;delete this.requests[b]},clearCache:function(){c={}},_isAbort:function(a,
b,c){return!c.abortIsNoSuccess||!a&&!b?!1:!(a&&!(a.readyState===0||this.lastAbort===c.xhrID))},_complete:function(b,c,f,g,j,k){this._isAbort(f,g,k)&&(g="abort",k.abort.call(b,f,g,k));c.call(b,f,g,k);a.event.trigger(this.name+"AjaxComplete",[f,g,k]);k.domCompleteTrigger&&a(k.domCompleteTrigger).trigger(this.name+"DOMComplete",[f,g,k]).trigger("DOMComplete",[f,g,k]);this._removeXHR(j);this.inProgress||a.event.trigger(this.name+"AjaxStop")},_success:function(b,e,f,g,j,k){var l=this;if(!this._isAbort(j,
g,k)){k.abortOld&&a.each(this.requests,function(a){if(a===k.xhrID)return!1;l.abort(a)});if(k.cacheResponse&&!c[k.xhrID]&&(j||(j={}),c[k.xhrID]={status:j.status,statusText:j.statusText,responseText:j.responseText,responseXML:j.responseXML,_successData:f,cacheTTL:k.cacheTTL,timestamp:(new Date).getTime()},"getAllResponseHeaders"in j)){var p=j.getAllResponseHeaders(),t,v=function(){t||(t={},a.each(p.split("\n"),function(a,b){var c=b.indexOf(":");t[b.substr(0,c)]=b.substr(c+2)}))};a.extend(c[k.xhrID],
{getAllResponseHeaders:function(){return p},getResponseHeader:function(a){v();return a in t?t[a]:null}})}e.call(b,f,g,j,k);a.event.trigger(this.name+"AjaxSuccess",[j,k,f]);k.domSuccessTrigger&&a(k.domSuccessTrigger).trigger(this.name+"DOMSuccess",[f,k]).trigger("DOMSuccess",[f,k])}j=null},getData:function(b){if(b){var c=this.requests[b];!c&&this.opts.queue&&(c=a.grep(a(document).queue(this.qName),function(a){return a.xhrID===b})[0]);return c}return{requests:this.requests,queue:this.opts.queue?a(document).queue(this.qName):
[],inProgress:this.inProgress}},abort:function(b){var c;if(b)(c=this.getData(b))&&c.abort?(this.lastAbort=b,c.abort(),this.lastAbort=!1):a(document).queue(this.qName,a.grep(a(document).queue(this.qName),function(a){return a!==c})),c=null;else{var f=this,g=[];a.each(this.requests,function(a){g.push(a)});a.each(g,function(a,b){f.abort(b)})}},clear:function(b){a(document).clearQueue(this.qName);b&&this.abort()}};a.manageAjax._manager.prototype.getXHR=a.manageAjax._manager.prototype.getData;a.manageAjax.defaults=
{beforeCreate:a.noop,abort:a.noop,abortIsNoSuccess:!0,maxRequests:1,cacheResponse:!1,domCompleteTrigger:!1,domSuccessTrigger:!1,preventDoubleRequests:!0,queueDuplicateRequests:!1,cacheTTL:-1,queue:!1};a.each(a.manageAjax._manager.prototype,function(c,e){c.indexOf("_")!==0&&a.isFunction(e)&&(a.manageAjax[c]=function(e,g){if(!b[e])if(c==="add")a.manageAjax.create(e,g);else return;var j=Array.prototype.slice.call(arguments,1);b[e][c].apply(b[e],j)})})})(jQuery);
(function(a){var b=a.browser.msie&&parseInt(a.browser.version)===6&&typeof window.XMLHttpRequest!=="object",c=null,d=[];a.modal=function(b,c){return a.modal.impl.init(b,c)};a.modal.close=function(b){a.modal.impl.close(b)};a.modal.focus=function(b){a.modal.impl.focus(b)};a.modal.setContainerDimensions=function(){a.modal.impl.setContainerDimensions()};a.modal.setPosition=function(){a.modal.impl.setPosition()};a.modal.update=function(b,c){a.modal.impl.update(b,c)};a.fn.modal=function(b){return a.modal.impl.init(this,
b)};a.modal.defaults={appendTo:"body",focus:!0,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!0,autoPosition:!0,zIndex:1E3,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:!0,overlayClose:!0,position:null,persist:!1,modal:!0,onOpen:null,onShow:null,onClose:null};a.modal.impl=
{d:{},init:function(b,d){if(this.d.data)return!1;c=a.browser.msie&&!a.boxModel;this.o=a.extend({},a.modal.defaults,d);this.zIndex=this.o.zIndex;this.occb=!1;if(typeof b==="object"){if(b=b instanceof jQuery?b:a(b),this.d.placeholder=!1,b.parent().parent().size()>0&&(b.before(a("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"})),this.d.placeholder=!0,this.display=b.css("display"),!this.o.persist))this.d.orig=b.clone(!0)}else if(typeof b==="string"||typeof b==="number")b=a("<div></div>").html(b);
else return alert("SimpleModal Error: Unsupported data type: "+typeof b),this;this.create(b);this.open();a.isFunction(this.o.onShow)&&this.o.onShow.apply(this,[this.d]);return this},create:function(e){d=this.getDimensions();if(this.o.modal&&b)this.d.iframe=a('<iframe src="javascript:false;"></iframe>').css(a.extend(this.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:d[0],width:d[1],zIndex:this.o.zIndex,top:0,left:0})).appendTo(this.o.appendTo);this.d.overlay=a("<div></div>").attr("id",
this.o.overlayId).addClass("simplemodal-overlay").css(a.extend(this.o.overlayCss,{display:"none",opacity:this.o.opacity/100,height:this.o.modal?d[0]:0,width:this.o.modal?d[1]:0,position:"fixed",left:0,top:0,zIndex:this.o.zIndex+1})).appendTo(this.o.appendTo);this.d.container=a("<div></div>").attr("id",this.o.containerId).addClass("simplemodal-container").css(a.extend(this.o.containerCss,{display:"none",position:"fixed",zIndex:this.o.zIndex+2})).append(this.o.close&&this.o.closeHTML?a(this.o.closeHTML).addClass(this.o.closeClass):
"").appendTo(this.o.appendTo);this.d.wrap=a("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(this.d.container);this.d.data=e.attr("id",e.attr("id")||this.o.dataId).addClass("simplemodal-data").css(a.extend(this.o.dataCss,{display:"none"})).appendTo("body");this.setContainerDimensions();this.d.data.appendTo(this.d.wrap);(b||c)&&this.fixIE()},bindEvents:function(){var e=this;a("."+e.o.closeClass).bind("click.simplemodal",function(a){a.preventDefault();
e.close()});e.o.modal&&e.o.close&&e.o.overlayClose&&e.d.overlay.bind("click.simplemodal",function(a){a.preventDefault();e.close()});a(document).bind("keydown.simplemodal",function(a){e.o.modal&&a.keyCode===9?e.watchTab(a):e.o.close&&e.o.escClose&&a.keyCode===27&&(a.preventDefault(),e.close())});a(window).bind("resize.simplemodal",function(){d=e.getDimensions();e.o.autoResize?e.setContainerDimensions():e.o.autoPosition&&e.setPosition();b||c?e.fixIE():e.o.modal&&(e.d.iframe&&e.d.iframe.css({height:d[0],
width:d[1]}),e.d.overlay.css({height:d[0],width:d[1]}))})},unbindEvents:function(){a("."+this.o.closeClass).unbind("click.simplemodal");a(document).unbind("keydown.simplemodal");a(window).unbind("resize.simplemodal");this.d.overlay.unbind("click.simplemodal")},fixIE:function(){var b=this.o.position;a.each([this.d.iframe||null,!this.o.modal?null:this.d.overlay,this.d.container],function(a,c){if(c){var d=c[0].style;d.position="absolute";if(a<2)d.removeExpression("height"),d.removeExpression("width"),
d.setExpression("height",'document.body.scrollHeight > document.body.clientHeight ? document.body.scrollHeight : document.body.clientHeight + "px"'),d.setExpression("width",'document.body.scrollWidth > document.body.clientWidth ? document.body.scrollWidth : document.body.clientWidth + "px"');else{var k,l;b&&b.constructor===Array?(k=b[0]?typeof b[0]==="number"?b[0].toString():b[0].replace(/px/,""):c.css("top").replace(/px/,""),k=k.indexOf("%")===-1?k+' + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"':
parseInt(k.replace(/%/,""))+' * ((document.documentElement.clientHeight || document.body.clientHeight) / 100) + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"',b[1]&&(l=typeof b[1]==="number"?b[1].toString():b[1].replace(/px/,""),l=l.indexOf("%")===-1?l+' + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + "px"':parseInt(l.replace(/%/,""))+' * ((document.documentElement.clientWidth || document.body.clientWidth) / 100) + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + "px"')):
(k='(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (t = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"',l='(document.documentElement.clientWidth || document.body.clientWidth) / 2 - (this.offsetWidth / 2) + (t = document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft) + "px"');d.removeExpression("top");d.removeExpression("left");d.setExpression("top",
k);d.setExpression("left",l)}}})},focus:function(b){var c=this,b=b&&a.inArray(b,["first","last"])!==-1?b:"first",d=a(":input:enabled:visible:"+b,c.d.wrap);setTimeout(function(){d.length>0?d.focus():c.d.wrap.focus()},10)},getDimensions:function(){var b=a(window);return[a.browser.opera&&a.browser.version>"9.5"&&a.fn.jquery<"1.3"||a.browser.opera&&a.browser.version<"9.5"&&a.fn.jquery>"1.2.6"?b[0].innerHeight:b.height(),b.width()]},getVal:function(a,b){return a?typeof a==="number"?a:a==="auto"?0:a.indexOf("%")>
0?parseInt(a.replace(/%/,""))/100*(b==="h"?d[0]:d[1]):parseInt(a.replace(/px/,"")):null},update:function(a,b){if(!this.d.data)return!1;this.d.origHeight=this.getVal(a,"h");this.d.origWidth=this.getVal(b,"w");this.d.data.hide();a&&this.d.container.css("height",a);b&&this.d.container.css("width",b);this.setContainerDimensions();this.d.data.show();this.o.focus&&this.focus();this.unbindEvents();this.bindEvents()},resize:function(a){if(a)this.d.data=a;d=this.getDimensions();this.setContainerDimensions()},
setContainerDimensions:function(){var a=this.getVal(this.d.container.css("height"),"h"),b=this.getVal(this.d.container.css("width"),"w"),c=this.d.data.outerHeight(!0),j=this.d.data.outerWidth(!0),a=this.o.maxHeight?this.getVal(this.o.maxHeight,"h"):null,b=this.o.maxWidth?this.getVal(this.o.maxWidth,"w"):null,k=a&&a<d[0]-80?a:d[0]-80,l=b&&b<d[1]-80?b:d[1]-80,p=this.o.minHeight?this.getVal(this.o.minHeight,"h"):"auto",a=c>k?k:this.o.minHeight&&p!=="auto"&&c<a?p:c,k=this.o.minWidth?this.getVal(this.o.minWidth,
"w"):"auto",b=j>l?l:this.o.minWidth&&k!=="auto"&&j<b?k:j;this.d.container.css({height:a,width:b});this.d.wrap.css({overflow:c>a||j>b?"auto":"visible"});this.o.autoPosition&&this.setPosition()},setPosition:function(){var a,b;a=d[0]/2-this.d.container.outerHeight(!0)/2;b=d[1]/2-this.d.container.outerWidth(!0)/2;this.o.position&&Object.prototype.toString.call(this.o.position)==="[object Array]"&&(a=this.o.position[0]||a,b=this.o.position[1]||b);this.d.container.css({left:b,top:a})},watchTab:function(b){if(a(b.target).parents(".simplemodal-container").length>
0){if(this.inputs=a(":input:enabled:visible:first, :input:enabled:visible:last",this.d.data[0]),!b.shiftKey&&b.target===this.inputs[this.inputs.length-1]||b.shiftKey&&b.target===this.inputs[0]||this.inputs.length===0)b.preventDefault(),this.focus(b.shiftKey?"last":"first")}else b.preventDefault(),this.focus()},open:function(){this.d.iframe&&this.d.iframe.show();a.isFunction(this.o.onOpen)?this.o.onOpen.apply(this,[this.d]):(this.d.overlay.show(),this.d.container.show(),this.d.data.show());this.o.focus&&
this.focus();this.bindEvents()},close:function(b){var c=this;if(!c.d.data)return!1;c.unbindEvents();if(a.isFunction(c.o.onClose)&&!c.occb)c.occb=!0,c.o.onClose.apply(c,[c.d,b]);else{if(c.d.placeholder){var d=a("#simplemodal-placeholder");c.o.persist?d.replaceWith(c.d.data.removeClass("simplemodal-data").css("display",c.display)):(c.d.data.hide().remove(),d.replaceWith(c.d.orig))}else c.d.data.hide().remove();c.d.container&&c.d.container.length&&c.d.container.hide().remove();c.d.overlay&&c.d.overlay.length&&
c.d.overlay.hide();c.d.iframe&&c.d.iframe.hide().remove();setTimeout(function(){c.d.overlay&&c.d.overlay.length&&c.d.overlay.remove();c.d={};a.isFunction(b)&&b()},10)}}}})(jQuery);
(function(a){function b(b){var e;return b&&b.constructor==Array&&b.length==3?b:(e=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(b))?[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]:(e=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(b))?[parseFloat(e[1])*2.55,parseFloat(e[2])*2.55,parseFloat(e[3])*2.55]:(e=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(b))?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:
(e=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(b))?[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]:c[a.trim(b).toLowerCase()]}a.each("backgroundColor,borderBottomColor,borderLeftColor,borderRightColor,borderTopColor,color,outlineColor".split(","),function(c,e){a.fx.step[e]=function(c){if(c.state==0){var d;d=c.elem;var j=e,k;do{k=a.curCSS(d,j);if(k!=""&&k!="transparent"||a.nodeName(d,"body"))break;j="backgroundColor"}while(d=d.parentNode);d=b(k);c.start=d;c.end=b(c.end)}c.elem.style[e]=
"rgb("+[Math.max(Math.min(parseInt(c.pos*(c.end[0]-c.start[0])+c.start[0]),255),0),Math.max(Math.min(parseInt(c.pos*(c.end[1]-c.start[1])+c.start[1]),255),0),Math.max(Math.min(parseInt(c.pos*(c.end[2]-c.start[2])+c.start[2]),255),0)].join(",")+")"}});var c={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,
0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,
203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery);
jQuery&&function(){$.extend($.fn,{rightClick:function(a){$(this).each(function(){$(this).mousedown(function(b){$(this).mouseup(function(){$(this).unbind("mouseup");return b.button==2?(a.call($(this),b),!1):!0})});$(this)[0].oncontextmenu=function(){return!1}});return $(this)},rightMouseDown:function(a){$(this).each(function(){$(this).mousedown(function(b){return b.button==2?(a.call($(this),b),!1):!0});$(this)[0].oncontextmenu=function(){return!1}});return $(this)},rightMouseUp:function(a){$(this).each(function(){$(this).mouseup(function(b){return b.button==
2?(a.call($(this),b),!1):!0});$(this)[0].oncontextmenu=function(){return!1}});return $(this)},noContext:function(){$(this).each(function(){$(this)[0].oncontextmenu=function(){return!1}});return $(this)}})}(jQuery);
(function(a,b){function c(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{};a.ui.version||(a.extend(a.ui,{version:"1.8.9",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,
PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({_focus:a.fn.focus,focus:function(b,c){return typeof b==="number"?this.each(function(){var f=this;setTimeout(function(){a(f).focus();c&&c.call(f)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;b=a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,
"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var c=a(this[0]),e;c.length&&c[0]!==document;){e=c.css("position");if(e===
"absolute"||e==="relative"||e==="fixed")if(e=parseInt(c.css("zIndex"),10),!isNaN(e)&&e!==0)return e;c=c.parent()}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(c,e){function f(b,c,d,e){a.each(g,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0;d&&(c-=parseFloat(a.curCSS(b,
"border"+this+"Width",!0))||0);e&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)});return c}var g=e==="Width"?["Left","Right"]:["Top","Bottom"],j=e.toLowerCase(),k={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+e]=function(c){return c===b?k["inner"+e].call(this):this.each(function(){a(this).css(j,f(this,c)+"px")})};a.fn["outer"+e]=function(b,c){return typeof b!=="number"?k["outer"+e].call(this,b):this.each(function(){a(this).css(j,
f(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:function(b,c,f){return!!a.data(b,f[3])},focusable:function(b){var e=b.nodeName.toLowerCase(),f=a.attr(b,"tabindex");if("area"===e){e=b.parentNode;f=e.name;if(!b.href||!f||e.nodeName.toLowerCase()!=="map")return!1;b=a("img[usemap=#"+f+"]")[0];return!!b&&c(b)}return(/input|select|textarea|button|object/.test(e)?!b.disabled:"a"==e?b.href||!isNaN(f):!isNaN(f))&&c(b)},tabbable:function(b){var c=a.attr(b,"tabindex");return(isNaN(c)||c>=0)&&a(b).is(":focusable")}}),
a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});a.support.minHeight=c.offsetHeight===100;a.support.selectstart="onselectstart"in c;b.removeChild(c).style.display="none"}),a.extend(a.ui,{plugin:{add:function(b,c,f){var b=a.ui[b].prototype,g;for(g in f)b.plugins[g]=b.plugins[g]||[],b.plugins[g].push([c,f[g]])},call:function(a,b,c){if((b=a.plugins[b])&&a.element[0].parentNode)for(var g=0;g<b.length;g++)a.options[b[g][0]]&&
b[g][1].apply(a.element,c)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(b,c){if(a(b).css("overflow")==="hidden")return!1;var f=c&&c==="left"?"scrollLeft":"scrollTop",g=!1;if(b[f]>0)return!0;b[f]=1;g=b[f]>0;b[f]=0;return g},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,f,g,j,k){return a.ui.isOverAxis(b,f,j)&&a.ui.isOverAxis(c,g,k)}}))})(jQuery);
(function(a,b){if(a.cleanData){var c=a.cleanData;a.cleanData=function(b){for(var d=0,g;(g=b[d])!=null;d++)a(g).triggerHandler("remove");c(b)}}else{var d=a.fn.remove;a.fn.remove=function(b,c){return this.each(function(){c||(!b||a.filter(b,[this]).length)&&a("*",this).add([this]).each(function(){a(this).triggerHandler("remove")});return d.call(a(this),b,c)})}}a.widget=function(b,c,d){var j=b.split(".")[0],k,b=b.split(".")[1];k=j+"-"+b;if(!d)d=c,c=a.Widget;a.expr[":"][k]=function(c){return!!a.data(c,
b)};a[j]=a[j]||{};a[j][b]=function(a,b){arguments.length&&this._createWidget(a,b)};c=new c;c.options=a.extend(!0,{},c.options);a[j][b].prototype=a.extend(!0,c,{namespace:j,widgetName:b,widgetEventPrefix:a[j][b].prototype.widgetEventPrefix||b,widgetBaseClass:k},d);a.widget.bridge(b,a[j][b])};a.widget.bridge=function(c,d){a.fn[c]=function(g){var j=typeof g==="string",k=Array.prototype.slice.call(arguments,1),l=this,g=!j&&k.length?a.extend.apply(null,[!0,g].concat(k)):g;if(j&&g.charAt(0)==="_")return l;
j?this.each(function(){var d=a.data(this,c),f=d&&a.isFunction(d[g])?d[g].apply(d,k):d;if(f!==d&&f!==b)return l=f,!1}):this.each(function(){var b=a.data(this,c);b?b.option(g||{})._init():a.data(this,c,new d(g,this))});return l}};a.Widget=function(a,b){arguments.length&&this._createWidget(a,b)};a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(b,c){a.data(c,this.widgetName,this);this.element=a(c);this.options=a.extend(!0,{},this.options,this._getCreateOptions(),
b);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},
option:function(c,d){var g=c;if(arguments.length===0)return a.extend({},this.options);if(typeof c==="string"){if(d===b)return this.options[c];g={};g[c]=d}this._setOptions(g);return this},_setOptions:function(b){var c=this;a.each(b,function(a,b){c._setOption(a,b)});return this},_setOption:function(a,b){this.options[a]=b;a==="disabled"&&this.widget()[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",b);return this},enable:function(){return this._setOption("disabled",
!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(b,c,d){var j=this.options[b],c=a.Event(c);c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase();d=d||{};if(c.originalEvent)for(var b=a.event.props.length,k;b;)k=a.event.props[--b],c[k]=c.originalEvent[k];this.element.trigger(c,d);return!(a.isFunction(j)&&j.call(this.element[0],c,d)===!1||c.isDefaultPrevented())}}})(jQuery);
(function(a){a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){if(!0===a.data(c.target,b.widgetName+".preventClickEvent"))return a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(b){b.originalEvent=
b.originalEvent||{};if(!b.originalEvent.mouseHandled){this._mouseStarted&&this._mouseUp(b);this._mouseDownEvent=b;var c=this,d=b.which==1,e=typeof this.options.cancel=="string"?a(b.target).parents().add(b.target).filter(this.options.cancel).length:!1;if(!d||e||!this._mouseCapture(b))return!0;this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet)this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=!0},this.options.delay);if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=
this._mouseStart(b)!==!1,!this._mouseStarted))return b.preventDefault(),!0;this._mouseMoveDelegate=function(a){return c._mouseMove(a)};this._mouseUpDelegate=function(a){return c._mouseUp(a)};a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);b.preventDefault();return b.originalEvent.mouseHandled=!0}},_mouseMove:function(b){if(a.browser.msie&&!(document.documentMode>=9)&&!b.button)return this._mouseUp(b);if(this._mouseStarted)return this._mouseDrag(b),
b.preventDefault();if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b))(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1)?this._mouseDrag(b):this._mouseUp(b);return!this._mouseStarted},_mouseUp:function(b){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted)this._mouseStarted=!1,b.target==this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b);
return!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(jQuery);
(function(a){a.ui=a.ui||{};var b=/left|center|right/,c=/top|center|bottom/,d=a.fn.position,e=a.fn.offset;a.fn.position=function(e){if(!e||!e.of)return d.apply(this,arguments);var e=a.extend({},e),g=a(e.of),j=g[0],k=(e.collision||"flip").split(" "),l=e.offset?e.offset.split(" "):[0,0],p,t,v;j.nodeType===9?(p=g.width(),t=g.height(),v={top:0,left:0}):j.setTimeout?(p=g.width(),t=g.height(),v={top:g.scrollTop(),left:g.scrollLeft()}):j.preventDefault?(e.at="left top",p=t=0,v={top:e.of.pageY,left:e.of.pageX}):
(p=g.outerWidth(),t=g.outerHeight(),v=g.offset());a.each(["my","at"],function(){var a=(e[this]||"").split(" ");a.length===1&&(a=b.test(a[0])?a.concat(["center"]):c.test(a[0])?["center"].concat(a):["center","center"]);a[0]=b.test(a[0])?a[0]:"center";a[1]=c.test(a[1])?a[1]:"center";e[this]=a});k.length===1&&(k[1]=k[0]);l[0]=parseInt(l[0],10)||0;l.length===1&&(l[1]=l[0]);l[1]=parseInt(l[1],10)||0;e.at[0]==="right"?v.left+=p:e.at[0]==="center"&&(v.left+=p/2);e.at[1]==="bottom"?v.top+=t:e.at[1]==="center"&&
(v.top+=t/2);v.left+=l[0];v.top+=l[1];return this.each(function(){var b=a(this),c=b.outerWidth(),d=b.outerHeight(),g=parseInt(a.curCSS(this,"marginLeft",!0))||0,j=parseInt(a.curCSS(this,"marginTop",!0))||0,y=c+g+(parseInt(a.curCSS(this,"marginRight",!0))||0),ea=d+j+(parseInt(a.curCSS(this,"marginBottom",!0))||0),V=a.extend({},v),n;e.my[0]==="right"?V.left-=c:e.my[0]==="center"&&(V.left-=c/2);e.my[1]==="bottom"?V.top-=d:e.my[1]==="center"&&(V.top-=d/2);V.left=Math.round(V.left);V.top=Math.round(V.top);
n={left:V.left-g,top:V.top-j};a.each(["left","top"],function(b,g){if(a.ui.position[k[b]])a.ui.position[k[b]][g](V,{targetWidth:p,targetHeight:t,elemWidth:c,elemHeight:d,collisionPosition:n,collisionWidth:y,collisionHeight:ea,offset:l,my:e.my,at:e.at})});a.fn.bgiframe&&b.bgiframe();b.offset(a.extend(V,{using:e.using}))})};a.ui.position={fit:{left:function(b,c){var d=a(window),d=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft();b.left=d>0?b.left-d:Math.max(b.left-c.collisionPosition.left,
b.left)},top:function(b,c){var d=a(window),d=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop();b.top=d>0?b.top-d:Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(b,c){if(c.at[0]!=="center"){var d=a(window),d=c.collisionPosition.left+c.collisionWidth-d.width()-d.scrollLeft(),e=c.my[0]==="left"?-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,l=c.at[0]==="left"?c.targetWidth:-c.targetWidth,p=-2*c.offset[0];b.left+=c.collisionPosition.left<0?e+l+p:d>0?e+l+p:0}},top:function(b,
c){if(c.at[1]!=="center"){var d=a(window),d=c.collisionPosition.top+c.collisionHeight-d.height()-d.scrollTop(),e=c.my[1]==="top"?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,l=c.at[1]==="top"?c.targetHeight:-c.targetHeight,p=-2*c.offset[1];b.top+=c.collisionPosition.top<0?e+l+p:d>0?e+l+p:0}}}};if(!a.offset.setOffset)a.offset.setOffset=function(b,c){if(/static/.test(a.curCSS(b,"position")))b.style.position="relative";var d=a(b),e=d.offset(),l=parseInt(a.curCSS(b,"top",!0),10)||0,p=parseInt(a.curCSS(b,
"left",!0),10)||0,e={top:c.top-e.top+l,left:c.left-e.left+p};"using"in c?c.using.call(b,e):d.css(e)},a.fn.offset=function(b){var c=this[0];return!c||!c.ownerDocument?null:b?this.each(function(){a.offset.setOffset(this,b)}):e.call(this)}})(jQuery);
(function(a){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){if(this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position")))this.element[0].style.position=
"relative";this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable"))return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(b){var c=this.options;if(this.helper||c.disabled||a(b.target).is(".ui-resizable-handle"))return!1;
this.handle=this._getHandle(b);return!this.handle?!1:!0},_mouseStart:function(b){var c=this.options;this.helper=this._createHelper(b);this._cacheHelperProportions();if(a.ui.ddmanager)a.ui.ddmanager.current=this;this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:b.pageX-
this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(b);this.originalPageX=b.pageX;this.originalPageY=b.pageY;c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt);c.containment&&this._setContainment();if(this._trigger("start",b)===!1)return this._clear(),!1;this._cacheHelperProportions();a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b);this.helper.addClass("ui-draggable-dragging");
this._mouseDrag(b,!0);return!0},_mouseDrag:function(b,c){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");if(!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";a.ui.ddmanager&&a.ui.ddmanager.drag(this,b);return!1},
_mouseStop:function(b){var c=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(c=a.ui.ddmanager.drop(this,b));if(this.dropped)c=this.dropped,this.dropped=!1;if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return!1;if(this.options.revert=="invalid"&&!c||this.options.revert=="valid"&&c||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,c)){var d=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,
10),function(){d._trigger("stop",b)!==!1&&d._clear()})}else this._trigger("stop",b)!==!1&&this._clear();return!1},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(b){var c=!this.options.handle||!a(this.options.handle,this.element).length?!0:!1;a(this.options.handle,this.element).find("*").andSelf().each(function(){this==b.target&&(c=!0)});return c},_createHelper:function(b){var c=this.options,b=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],
[b])):c.helper=="clone"?this.element.clone():this.element;b.parents("body").length||b.appendTo(c.appendTo=="parent"?this.element[0].parentNode:c.appendTo);b[0]!=this.element[0]&&!/(fixed|absolute)/.test(b.css("position"))&&b.css("position","absolute");return b},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" "));a.isArray(b)&&(b={left:+b[0],top:+b[1]||0});if("left"in b)this.offset.click.left=b.left+this.margins.left;if("right"in b)this.offset.click.left=this.helperProportions.width-
b.right+this.margins.left;if("top"in b)this.offset.click.top=b.top+this.margins.top;if("bottom"in b)this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==
document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),
10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;if(b.containment=="parent")b.containment=this.helper[0].parentNode;if(b.containment=="document"||b.containment=="window")this.containment=
[(b.containment=="document"?0:a(window).scrollLeft())-this.offset.relative.left-this.offset.parent.left,(b.containment=="document"?0:a(window).scrollTop())-this.offset.relative.top-this.offset.parent.top,(b.containment=="document"?0:a(window).scrollLeft())+a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(b.containment=="document"?0:a(window).scrollTop())+(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-
this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&b.containment.constructor!=Array){var c=a(b.containment)[0];if(c){var b=a(b.containment).offset(),d=a(c).css("overflow")!="hidden";this.containment=[b.left+(parseInt(a(c).css("borderLeftWidth"),10)||0)+(parseInt(a(c).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0)-this.margins.top,b.left+(d?Math.max(c.scrollWidth,
c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(d?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}}else if(b.containment.constructor==Array)this.containment=b.containment},_convertPositionTo:function(b,c){if(!c)c=this.position;var d=
b=="absolute"?1:-1,e=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&
a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d)}},_generatePosition:function(b){var c=this.options,d=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(d[0].tagName),f=b.pageX,g=b.pageY;this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+
this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),c.grid&&(g=this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1],g=this.containment?!(g-this.offset.click.top<this.containment[1]||g-this.offset.click.top>this.containment[3])?
g:!(g-this.offset.click.top<this.containment[1])?g-c.grid[1]:g+c.grid[1]:g,f=this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0],f=this.containment?!(f-this.offset.click.left<this.containment[0]||f-this.offset.click.left>this.containment[2])?f:!(f-this.offset.click.left<this.containment[0])?f-c.grid[0]:f+c.grid[0]:f));return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition==
"fixed"?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(b,
c,d){d=d||this._uiHash();a.ui.plugin.call(this,b,[c,d]);if(b=="drag")this.positionAbs=this._convertPositionTo("absolute");return a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.extend(a.ui.draggable,{version:"1.8.9"});a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("draggable"),e=d.options,f=a.extend({},c,{item:d.element});
d.sortables=[];a(e.connectToSortable).each(function(){var c=a.data(this,"sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c._refreshItems(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;d.cancelHelperRemoval=!0;this.instance.cancelHelperRemoval=!1;if(this.shouldRevert)this.instance.options.revert=!0;this.instance._mouseStop(b);
this.instance.options.helper=this.instance.options._helper;d.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})}else this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e)})},drag:function(b,c){var d=a(this).data("draggable"),e=this;a.each(d.sortables,function(){this.instance.positionAbs=d.positionAbs;this.instance.helperProportions=d.helperProportions;this.instance.offset.click=d.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver)this.instance.isOver=
1,this.instance.currentItem=a(e).clone().appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,
this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d;this.instance.currentItem&&this.instance._mouseDrag(b)}else if(this.instance.isOver)this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=
this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1})}});a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),c=a(this).data("draggable").options;if(b.css("cursor"))c._cursor=b.css("cursor");b.css("cursor",c.cursor)},stop:function(){var b=a(this).data("draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}});a.ui.plugin.add("draggable","iframeFix",{start:function(){var b=
a(this).data("draggable").options;a(b.iframeFix===!0?"iframe":b.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(a(this).offset()).appendTo("body")})},stop:function(){a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}});a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=
a(this).data("draggable").options;if(d.css("opacity"))e._opacity=d.css("opacity");d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}});a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("draggable");if(b.scrollParent[0]!=document&&b.scrollParent[0].tagName!="HTML")b.overflowOffset=b.scrollParent.offset()},drag:function(b){var c=a(this).data("draggable"),d=c.options,e=!1;if(c.scrollParent[0]!=
document&&c.scrollParent[0].tagName!="HTML"){if(!d.axis||d.axis!="x")if(c.overflowOffset.top+c.scrollParent[0].offsetHeight-b.pageY<d.scrollSensitivity)c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop+d.scrollSpeed;else if(b.pageY-c.overflowOffset.top<d.scrollSensitivity)c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop-d.scrollSpeed;if(!d.axis||d.axis!="y")if(c.overflowOffset.left+c.scrollParent[0].offsetWidth-b.pageX<d.scrollSensitivity)c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft+
d.scrollSpeed;else if(b.pageX-c.overflowOffset.left<d.scrollSensitivity)c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft-d.scrollSpeed}else{if(!d.axis||d.axis!="x")b.pageY-a(document).scrollTop()<d.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<d.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed));if(!d.axis||d.axis!="y")b.pageX-a(document).scrollLeft()<d.scrollSensitivity?
e=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<d.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed))}e!==!1&&a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,b)}});a.ui.plugin.add("draggable","snap",{start:function(){var b=a(this).data("draggable"),c=b.options;b.snapElements=[];a(c.snap.constructor!=String?c.snap.items||":data(draggable)":c.snap).each(function(){var c=a(this),
e=c.offset();this!=b.element[0]&&b.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:e.top,left:e.left})})},drag:function(b,c){for(var d=a(this).data("draggable"),e=d.options,f=e.snapTolerance,g=c.offset.left,j=g+d.helperProportions.width,k=c.offset.top,l=k+d.helperProportions.height,p=d.snapElements.length-1;p>=0;p--){var t=d.snapElements[p].left,v=t+d.snapElements[p].width,H=d.snapElements[p].top,L=H+d.snapElements[p].height;if(t-f<g&&g<v+f&&H-f<k&&k<L+f||t-f<g&&g<v+f&&
H-f<l&&l<L+f||t-f<j&&j<v+f&&H-f<k&&k<L+f||t-f<j&&j<v+f&&H-f<l&&l<L+f){if(e.snapMode!="inner"){var ha=Math.abs(H-l)<=f,N=Math.abs(L-k)<=f,O=Math.abs(t-j)<=f,y=Math.abs(v-g)<=f;if(ha)c.position.top=d._convertPositionTo("relative",{top:H-d.helperProportions.height,left:0}).top-d.margins.top;if(N)c.position.top=d._convertPositionTo("relative",{top:L,left:0}).top-d.margins.top;if(O)c.position.left=d._convertPositionTo("relative",{top:0,left:t-d.helperProportions.width}).left-d.margins.left;if(y)c.position.left=
d._convertPositionTo("relative",{top:0,left:v}).left-d.margins.left}var ea=ha||N||O||y;if(e.snapMode!="outer"){ha=Math.abs(H-k)<=f;N=Math.abs(L-l)<=f;O=Math.abs(t-g)<=f;y=Math.abs(v-j)<=f;if(ha)c.position.top=d._convertPositionTo("relative",{top:H,left:0}).top-d.margins.top;if(N)c.position.top=d._convertPositionTo("relative",{top:L-d.helperProportions.height,left:0}).top-d.margins.top;if(O)c.position.left=d._convertPositionTo("relative",{top:0,left:t}).left-d.margins.left;if(y)c.position.left=d._convertPositionTo("relative",
{top:0,left:v-d.helperProportions.width}).left-d.margins.left}!d.snapElements[p].snapping&&(ha||N||O||y||ea)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[p].item}));d.snapElements[p].snapping=ha||N||O||y||ea}else d.snapElements[p].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[p].item})),d.snapElements[p].snapping=!1}}});a.ui.plugin.add("draggable","stack",{start:function(){var b=
a(this).data("draggable").options,b=a.makeArray(a(b.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});if(b.length){var c=parseInt(b[0].style.zIndex)||0;a(b).each(function(a){this.style.zIndex=c+a});this[0].style.zIndex=c+b.length}}});a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;if(d.css("zIndex"))e._zIndex=d.css("zIndex");d.css("zIndex",e.zIndex)},stop:function(b,c){var d=
a(this).data("draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})})(jQuery);
(function(a){a.widget("ui.sortable",a.ui.mouse,{widgetEventPrefix:"sort",options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3},_create:function(){this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=
this.items.length?/left|right/.test(this.items[0].item.css("float")):!1;this.offset=this.element.offset();this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData("sortable-item");return this},_setOption:function(b,c){b==="disabled"?(this.options[b]=c,this.widget()[c?"addClass":"removeClass"]("ui-sortable-disabled")):a.Widget.prototype._setOption.apply(this,
arguments)},_mouseCapture:function(b,c){if(this.reverting)return!1;if(this.options.disabled||this.options.type=="static")return!1;this._refreshItems(b);var d=null,e=this;a(b.target).parents().each(function(){if(a.data(this,"sortable-item")==e)return d=a(this),!1});a.data(b.target,"sortable-item")==e&&(d=a(b.target));if(!d)return!1;if(this.options.handle&&!c){var f=!1;a(this.options.handle,d).find("*").andSelf().each(function(){this==b.target&&(f=!0)});if(!f)return!1}this.currentItem=d;this._removeCurrentsFromItems();
return!0},_mouseStart:function(b,c,d){c=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(b);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");a.extend(this.offset,{click:{left:b.pageX-this.offset.left,
top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this._generatePosition(b);this.originalPageX=b.pageX;this.originalPageY=b.pageY;c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();c.containment&&this._setContainment();if(c.cursor){if(a("body").css("cursor"))this._storedCursor=
a("body").css("cursor");a("body").css("cursor",c.cursor)}if(c.opacity){if(this.helper.css("opacity"))this._storedOpacity=this.helper.css("opacity");this.helper.css("opacity",c.opacity)}if(c.zIndex){if(this.helper.css("zIndex"))this._storedZIndex=this.helper.css("zIndex");this.helper.css("zIndex",c.zIndex)}if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML")this.overflowOffset=this.scrollParent.offset();this._trigger("start",b,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();
if(!d)for(d=this.containers.length-1;d>=0;d--)this.containers[d]._trigger("activate",b,this._uiHash(this));if(a.ui.ddmanager)a.ui.ddmanager.current=this;a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b);this.dragging=!0;this.helper.addClass("ui-sortable-helper");this._mouseDrag(b);return!0},_mouseDrag:function(b){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs)this.lastPositionAbs=this.positionAbs;if(this.options.scroll){var c=
this.options,d=!1;if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){if(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<c.scrollSensitivity)this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop+c.scrollSpeed;else if(b.pageY-this.overflowOffset.top<c.scrollSensitivity)this.scrollParent[0].scrollTop=d=this.scrollParent[0].scrollTop-c.scrollSpeed;if(this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<c.scrollSensitivity)this.scrollParent[0].scrollLeft=
d=this.scrollParent[0].scrollLeft+c.scrollSpeed;else if(b.pageX-this.overflowOffset.left<c.scrollSensitivity)this.scrollParent[0].scrollLeft=d=this.scrollParent[0].scrollLeft-c.scrollSpeed}else b.pageY-a(document).scrollTop()<c.scrollSensitivity?d=a(document).scrollTop(a(document).scrollTop()-c.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<c.scrollSensitivity&&(d=a(document).scrollTop(a(document).scrollTop()+c.scrollSpeed)),b.pageX-a(document).scrollLeft()<c.scrollSensitivity?
d=a(document).scrollLeft(a(document).scrollLeft()-c.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<c.scrollSensitivity&&(d=a(document).scrollLeft(a(document).scrollLeft()+c.scrollSpeed));d!==!1&&a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=
this.position.top+"px";for(c=this.items.length-1;c>=0;c--){var d=this.items[c],e=d.item[0],f=this._intersectsWithPointer(d);if(f&&e!=this.currentItem[0]&&this.placeholder[f==1?"next":"prev"]()[0]!=e&&!a.ui.contains(this.placeholder[0],e)&&(this.options.type=="semi-dynamic"?!a.ui.contains(this.element[0],e):1)){this.direction=f==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(d))this._rearrange(b,d);else break;this._trigger("change",b,this._uiHash());break}}this._contactContainers(b);
a.ui.ddmanager&&a.ui.ddmanager.drag(this,b);this._trigger("sort",b,this._uiHash());this.lastPositionAbs=this.positionAbs;return!1},_mouseStop:function(b,c){if(b){a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b);if(this.options.revert){var d=this,e=d.placeholder.offset();d.reverting=!0;a(this.helper).animate({left:e.left-this.offset.parent.left-d.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:e.top-this.offset.parent.top-d.margins.top+
(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;b>=0;b--)if(this.containers[b]._trigger("deactivate",null,this._uiHash(this)),this.containers[b].containerCache.over)this.containers[b]._trigger("out",
null,this._uiHash(this)),this.containers[b].containerCache.over=0}this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem));return this},serialize:function(b){var c=
this._getItemsAsjQuery(b&&b.connected),d=[],b=b||{};a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))});!d.length&&b.key&&d.push(b.key+"=");return d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[],b=b||{};c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")});return d},_intersectsWith:function(a){var c=this.positionAbs.left,
d=c+this.helperProportions.width,e=this.positionAbs.top,f=e+this.helperProportions.height,g=a.left,j=g+a.width,k=a.top,l=k+a.height,p=this.offset.click.top,t=this.offset.click.left;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?e+p>k&&e+p<l&&c+t>g&&c+t<j:g<c+this.helperProportions.width/2&&d-this.helperProportions.width/2<j&&k<e+this.helperProportions.height/
2&&f-this.helperProportions.height/2<l},_intersectsWithPointer:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top,b.height),b=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left,b.width),c=c&&b,b=this._getDragVerticalDirection(),d=this._getDragHorizontalDirection();return!c?!1:this.floating?d&&d=="right"||b=="down"?2:1:b&&(b=="down"?2:1)},_intersectsWithSides:function(b){var c=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,b.top+b.height/
2,b.height),b=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,b.left+b.width/2,b.width),d=this._getDragVerticalDirection(),e=this._getDragHorizontalDirection();return this.floating&&e?e=="right"&&b||e=="left"&&!b:d&&(d=="down"&&c||d=="up"&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return a!=0&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return a!=0&&(a>0?"right":"left")},
refresh:function(a){this._refreshItems(a);this.refreshPositions();return this},_connectWith:function(){var a=this.options;return a.connectWith.constructor==String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var c=[],d=[],e=this._connectWith();if(e&&b)for(b=e.length-1;b>=0;b--)for(var f=a(e[b]),g=f.length-1;g>=0;g--){var j=a.data(f[g],"sortable");j&&j!=this&&!j.options.disabled&&d.push([a.isFunction(j.options.items)?j.options.items.call(j.element):a(j.options.items,j.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),
j])}d.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(b=d.length-1;b>=0;b--)d[b][0].each(function(){c.push(this)});return a(c)},_removeCurrentsFromItems:function(){for(var a=this.currentItem.find(":data(sortable-item)"),c=0;c<this.items.length;c++)for(var d=0;d<a.length;d++)a[d]==this.items[c].item[0]&&this.items.splice(c,
1)},_refreshItems:function(b){this.items=[];this.containers=[this];var c=this.items,d=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],e=this._connectWith();if(e)for(var f=e.length-1;f>=0;f--)for(var g=a(e[f]),j=g.length-1;j>=0;j--){var k=a.data(g[j],"sortable");k&&k!=this&&!k.options.disabled&&(d.push([a.isFunction(k.options.items)?k.options.items.call(k.element[0],b,{item:this.currentItem}):a(k.options.items,
k.element),k]),this.containers.push(k))}for(f=d.length-1;f>=0;f--){b=d[f][1];e=d[f][0];j=0;for(g=e.length;j<g;j++)k=a(e[j]),k.data("sortable-item",b),c.push({item:k,instance:b,width:0,height:0,left:0,top:0})}},refreshPositions:function(b){if(this.offsetParent&&this.helper)this.offset.parent=this._getParentOffset();for(var c=this.items.length-1;c>=0;c--){var d=this.items[c],e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item;if(!b)d.width=e.outerWidth(),d.height=e.outerHeight();
e=e.offset();d.left=e.left;d.top=e.top}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;c>=0;c--)e=this.containers[c].element.offset(),this.containers[c].containerCache.left=e.left,this.containers[c].containerCache.top=e.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){var c=
b||this,d=c.options;if(!d.placeholder||d.placeholder.constructor==String){var e=d.placeholder;d.placeholder={element:function(){var b=a(document.createElement(c.currentItem[0].nodeName)).addClass(e||c.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];if(!e)b.style.visibility="hidden";return b},update:function(a,b){if(!e||d.forcePlaceholderSize)b.height()||b.height(c.currentItem.innerHeight()-parseInt(c.currentItem.css("paddingTop")||0,10)-parseInt(c.currentItem.css("paddingBottom")||
0,10)),b.width()||b.width(c.currentItem.innerWidth()-parseInt(c.currentItem.css("paddingLeft")||0,10)-parseInt(c.currentItem.css("paddingRight")||0,10))}}}c.placeholder=a(d.placeholder.element.call(c.element,c.currentItem));c.currentItem.after(c.placeholder);d.placeholder.update(c,c.placeholder)},_contactContainers:function(b){for(var c=null,d=null,e=this.containers.length-1;e>=0;e--)if(!a.ui.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(!c||
!a.ui.contains(this.containers[e].element[0],c.element[0]))c=this.containers[e],d=e}else if(this.containers[e].containerCache.over)this.containers[e]._trigger("out",b,this._uiHash(this)),this.containers[e].containerCache.over=0;if(c)if(this.containers.length===1)this.containers[d]._trigger("over",b,this._uiHash(this)),this.containers[d].containerCache.over=1;else if(this.currentContainer!=this.containers[d]){for(var c=1E4,e=null,f=this.positionAbs[this.containers[d].floating?"left":"top"],g=this.items.length-
1;g>=0;g--)if(a.ui.contains(this.containers[d].element[0],this.items[g].item[0])){var j=this.items[g][this.containers[d].floating?"left":"top"];Math.abs(j-f)<c&&(c=Math.abs(j-f),e=this.items[g])}if(e||this.options.dropOnEmpty)this.currentContainer=this.containers[d],e?this._rearrange(b,e,null,!0):this._rearrange(b,null,this.containers[d].element,!0),this._trigger("change",b,this._uiHash()),this.containers[d]._trigger("change",b,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,
this.placeholder),this.containers[d]._trigger("over",b,this._uiHash(this)),this.containers[d].containerCache.over=1}},_createHelper:function(b){var c=this.options,b=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):c.helper=="clone"?this.currentItem.clone():this.currentItem;b.parents("body").length||a(c.appendTo!="parent"?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(b[0]);if(b[0]==this.currentItem[0])this._storedCSS={width:this.currentItem[0].style.width,
height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")};(b[0].style.width==""||c.forceHelperSize)&&b.width(this.currentItem.width());(b[0].style.height==""||c.forceHelperSize)&&b.height(this.currentItem.height());return b},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" "));a.isArray(b)&&(b={left:+b[0],top:+b[1]||0});if("left"in b)this.offset.click.left=b.left+this.margins.left;if("right"in
b)this.offset.click.left=this.helperProportions.width-b.right+this.margins.left;if("top"in b)this.offset.click.top=b.top+this.margins.top;if("bottom"in b)this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=
this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),
left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;if(b.containment=="parent")b.containment=this.helper[0].parentNode;
if(b.containment=="document"||b.containment=="window")this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)){var c=a(b.containment)[0],b=a(b.containment).offset(),
d=a(c).css("overflow")!="hidden";this.containment=[b.left+(parseInt(a(c).css("borderLeftWidth"),10)||0)+(parseInt(a(c).css("paddingLeft"),10)||0)-this.margins.left,b.top+(parseInt(a(c).css("borderTopWidth"),10)||0)+(parseInt(a(c).css("paddingTop"),10)||0)-this.margins.top,b.left+(d?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(a(c).css("borderLeftWidth"),10)||0)-(parseInt(a(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,b.top+(d?Math.max(c.scrollHeight,
c.offsetHeight):c.offsetHeight)-(parseInt(a(c).css("borderTopWidth"),10)||0)-(parseInt(a(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(b,c){if(!c)c=this.position;var d=b=="absolute"?1:-1,e=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*
d-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d)}},_generatePosition:function(b){var c=this.options,d=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:
this.scrollParent,e=/(html|body)/i.test(d[0].tagName);if(this.cssPosition=="relative"&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0]))this.offset.relative=this._getRelativeOffset();var f=b.pageX,g=b.pageY;this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>
this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),c.grid&&(g=this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1],g=this.containment?!(g-this.offset.click.top<this.containment[1]||g-this.offset.click.top>this.containment[3])?g:!(g-this.offset.click.top<this.containment[1])?g-c.grid[1]:g+c.grid[1]:g,f=this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*
c.grid[0],f=this.containment?!(f-this.offset.click.left<this.containment[0]||f-this.offset.click.left>this.containment[2])?f:!(f-this.offset.click.left<this.containment[0])?f-c.grid[0]:f+c.grid[0]:f));return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&
this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_rearrange:function(a,c,d,e){d?d[0].appendChild(this.placeholder[0]):c.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?c.item[0]:c.item[0].nextSibling);this.counter=this.counter?++this.counter:1;var f=this,g=this.counter;window.setTimeout(function(){g==f.counter&&f.refreshPositions(!e)},0)},_clear:function(b,c){this.reverting=!1;var d=[];!this._noFinalSort&&this.currentItem[0].parentNode&&
this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var e in this._storedCSS)if(this._storedCSS[e]=="auto"||this._storedCSS[e]=="static")this._storedCSS[e]="";this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!c&&d.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))});(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||
this.domPosition.parent!=this.currentItem.parent()[0])&&!c&&d.push(function(a){this._trigger("update",a,this._uiHash())});if(!a.ui.contains(this.element[0],this.currentItem[0])){c||d.push(function(a){this._trigger("remove",a,this._uiHash())});for(e=this.containers.length-1;e>=0;e--)a.ui.contains(this.containers[e].element[0],this.currentItem[0])&&!c&&(d.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.containers[e])),d.push(function(a){return function(b){a._trigger("update",
b,this._uiHash(this))}}.call(this,this.containers[e])))}for(e=this.containers.length-1;e>=0;e--)if(c||d.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[e])),this.containers[e].containerCache.over)d.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[e])),this.containers[e].containerCache.over=0;this._storedCursor&&a("body").css("cursor",this._storedCursor);this._storedOpacity&&this.helper.css("opacity",
this._storedOpacity);this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex);this.dragging=!1;if(this.cancelHelperRemoval){if(!c){this._trigger("beforeStop",b,this._uiHash());for(e=0;e<d.length;e++)d[e].call(this,b);this._trigger("stop",b,this._uiHash())}return!1}c||this._trigger("beforeStop",b,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=null;if(!c){for(e=
0;e<d.length;e++)d[e].call(this,b);this._trigger("stop",b,this._uiHash())}this.fromOutside=!1;return!0},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}});a.extend(a.ui.sortable,{version:"1.8.9"})})(jQuery);
(function(a){a.widget("ui.slider",a.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var b=this,c=this.options;this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");c.disabled&&this.element.addClass("ui-slider-disabled ui-disabled");
this.range=a([]);if(c.range){if(c.range===!0){this.range=a("<div></div>");if(!c.values)c.values=[this._valueMin(),this._valueMin()];if(c.values.length&&c.values.length!==2)c.values=[c.values[0],c.values[0]]}else this.range=a("<div></div>");this.range.appendTo(this.element).addClass("ui-slider-range");(c.range==="min"||c.range==="max")&&this.range.addClass("ui-slider-range-"+c.range);this.range.addClass("ui-widget-header")}a(".ui-slider-handle",this.element).length===0&&a("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");
if(c.values&&c.values.length)for(;a(".ui-slider-handle",this.element).length<c.values.length;)a("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");this.handles=a(".ui-slider-handle",this.element).addClass("ui-state-default ui-corner-all");this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).hover(function(){c.disabled||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).focus(function(){c.disabled?
a(this).blur():(a(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),a(this).addClass("ui-state-focus"))}).blur(function(){a(this).removeClass("ui-state-focus")});this.handles.each(function(b){a(this).data("index.ui-slider-handle",b)});this.handles.keydown(function(c){var e=!0,f=a(this).data("index.ui-slider-handle"),g,j,k;if(!b.options.disabled){switch(c.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(e=
!1,!b._keySliding&&(b._keySliding=!0,a(this).addClass("ui-state-active"),g=b._start(c,f),g===!1))return}k=b.options.step;g=b.options.values&&b.options.values.length?j=b.values(f):j=b.value();switch(c.keyCode){case a.ui.keyCode.HOME:j=b._valueMin();break;case a.ui.keyCode.END:j=b._valueMax();break;case a.ui.keyCode.PAGE_UP:j=b._trimAlignValue(g+(b._valueMax()-b._valueMin())/5);break;case a.ui.keyCode.PAGE_DOWN:j=b._trimAlignValue(g-(b._valueMax()-b._valueMin())/5);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(g===
b._valueMax())return;j=b._trimAlignValue(g+k);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(g===b._valueMin())return;j=b._trimAlignValue(g-k)}b._slide(c,f,j);return e}}).keyup(function(c){var e=a(this).data("index.ui-slider-handle");if(b._keySliding)b._keySliding=!1,b._stop(c,e),b._change(c,e),a(this).removeClass("ui-state-active")});this._refreshValue();this._animateOff=!1},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");
this._mouseDestroy();return this},_mouseCapture:function(b){var c=this.options,d,e,f,g,j;if(c.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();d=this._normValueFromMouse({x:b.pageX,y:b.pageY});e=this._valueMax()-this._valueMin()+1;g=this;this.handles.each(function(b){var c=Math.abs(d-g.values(b));e>c&&(e=c,f=a(this),j=b)});c.range===!0&&this.values(1)===c.min&&(j+=1,f=a(this.handles[j]));if(this._start(b,
j)===!1)return!1;this._mouseSliding=!0;g._handleIndex=j;f.addClass("ui-state-active").focus();c=f.offset();this._clickOffset=!a(b.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:b.pageX-c.left-f.width()/2,top:b.pageY-c.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(b,j,d);return this._animateOff=!0},_mouseStart:function(){return!0},
_mouseDrag:function(a){var c=this._normValueFromMouse({x:a.pageX,y:a.pageY});this._slide(a,this._handleIndex,c);return!1},_mouseStop:function(a){this.handles.removeClass("ui-state-active");this._mouseSliding=!1;this._stop(a,this._handleIndex);this._change(a,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(a){var c;this.orientation===
"horizontal"?(c=this.elementSize.width,a=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(c=this.elementSize.height,a=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));c=a/c;c>1&&(c=1);c<0&&(c=0);this.orientation==="vertical"&&(c=1-c);a=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+c*a)},_start:function(a,c){var d={handle:this.handles[c],value:this.value()};if(this.options.values&&this.options.values.length)d.value=this.values(c),
d.values=this.values();return this._trigger("start",a,d)},_slide:function(a,c,d){var e;if(this.options.values&&this.options.values.length){e=this.values(c?0:1);if(this.options.values.length===2&&this.options.range===!0&&(c===0&&d>e||c===1&&d<e))d=e;d!==this.values(c)&&(e=this.values(),e[c]=d,a=this._trigger("slide",a,{handle:this.handles[c],value:d,values:e}),this.values(c?0:1),a!==!1&&this.values(c,d,!0))}else d!==this.value()&&(a=this._trigger("slide",a,{handle:this.handles[c],value:d}),a!==!1&&
this.value(d))},_stop:function(a,c){var d={handle:this.handles[c],value:this.value()};if(this.options.values&&this.options.values.length)d.value=this.values(c),d.values=this.values();this._trigger("stop",a,d)},_change:function(a,c){if(!this._keySliding&&!this._mouseSliding){var d={handle:this.handles[c],value:this.value()};if(this.options.values&&this.options.values.length)d.value=this.values(c),d.values=this.values();this._trigger("change",a,d)}},value:function(a){if(arguments.length)this.options.value=
this._trimAlignValue(a),this._refreshValue(),this._change(null,0);return this._value()},values:function(b,c){var d,e,f;arguments.length>1&&(this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),this._change(null,b));if(arguments.length)if(a.isArray(arguments[0])){d=this.options.values;e=arguments[0];for(f=0;f<d.length;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,f);this._refreshValue()}else return this.options.values&&this.options.values.length?this._values(b):this.value();
else return this._values()},_setOption:function(b,c){var d,e=0;if(a.isArray(this.options.values))e=this.options.values.length;a.Widget.prototype._setOption.apply(this,arguments);switch(b){case "disabled":c?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.attr("disabled","disabled"),this.element.addClass("ui-disabled")):(this.handles.removeAttr("disabled"),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();
this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(d=0;d<e;d+=1)this._change(null,d);this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var c,d;if(arguments.length)c=this.options.values[a],
c=this._trimAlignValue(c);else{c=this.options.values.slice();for(d=0;d<c.length;d+=1)c[d]=this._trimAlignValue(c[d])}return c},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var c=this.options.step>0?this.options.step:1,d=(a-this._valueMin())%c;alignValue=a-d;Math.abs(d)*2>=c&&(alignValue+=d>0?c:-c);return parseFloat(alignValue.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},
_refreshValue:function(){var b=this.options.range,c=this.options,d=this,e=!this._animateOff?c.animate:!1,f,g={},j,k,l,p;if(this.options.values&&this.options.values.length)this.handles.each(function(b){f=(d.values(b)-d._valueMin())/(d._valueMax()-d._valueMin())*100;g[d.orientation==="horizontal"?"left":"bottom"]=f+"%";a(this).stop(1,1)[e?"animate":"css"](g,c.animate);if(d.options.range===!0)if(d.orientation==="horizontal"){if(b===0)d.range.stop(1,1)[e?"animate":"css"]({left:f+"%"},c.animate);if(b===
1)d.range[e?"animate":"css"]({width:f-j+"%"},{queue:!1,duration:c.animate})}else{if(b===0)d.range.stop(1,1)[e?"animate":"css"]({bottom:f+"%"},c.animate);if(b===1)d.range[e?"animate":"css"]({height:f-j+"%"},{queue:!1,duration:c.animate})}j=f});else{k=this.value();l=this._valueMin();p=this._valueMax();f=p!==l?(k-l)/(p-l)*100:0;g[d.orientation==="horizontal"?"left":"bottom"]=f+"%";this.handle.stop(1,1)[e?"animate":"css"](g,c.animate);if(b==="min"&&this.orientation==="horizontal")this.range.stop(1,1)[e?
"animate":"css"]({width:f+"%"},c.animate);if(b==="max"&&this.orientation==="horizontal")this.range[e?"animate":"css"]({width:100-f+"%"},{queue:!1,duration:c.animate});if(b==="min"&&this.orientation==="vertical")this.range.stop(1,1)[e?"animate":"css"]({height:f+"%"},c.animate);if(b==="max"&&this.orientation==="vertical")this.range[e?"animate":"css"]({height:100-f+"%"},{queue:!1,duration:c.animate})}}});a.extend(a.ui.slider,{version:"1.8.9"})})(jQuery);
(function(a){a.widget("ui.autocomplete",{options:{appendTo:"body",delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var b=this,c=this.element[0].ownerDocument,d;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(c){if(!b.options.disabled&&!b.element.attr("readonly")){d=!1;var f=a.ui.keyCode;switch(c.keyCode){case f.PAGE_UP:b._move("previousPage",
c);break;case f.PAGE_DOWN:b._move("nextPage",c);break;case f.UP:b._move("previous",c);c.preventDefault();break;case f.DOWN:b._move("next",c);c.preventDefault();break;case f.ENTER:case f.NUMPAD_ENTER:b.menu.active&&(d=!0,c.preventDefault());case f.TAB:if(!b.menu.active)break;b.menu.select(c);break;case f.ESCAPE:b.element.val(b.term);b.close(c);break;default:clearTimeout(b.searching),b.searching=setTimeout(function(){if(b.term!=b.element.val())b.selectedItem=null,b.search(null,c)},b.options.delay)}}}).bind("keypress.autocomplete",
function(a){d&&(d=!1,a.preventDefault())}).bind("focus.autocomplete",function(){if(!b.options.disabled)b.selectedItem=null,b.previous=b.element.val()}).bind("blur.autocomplete",function(a){if(!b.options.disabled)clearTimeout(b.searching),b.closing=setTimeout(function(){b.close(a);b._change(a)},150)});this._initSource();this.response=function(){return b._response.apply(b,arguments)};this.menu=a("<ul></ul>").addClass("ui-autocomplete").appendTo(a(this.options.appendTo||"body",c)[0]).mousedown(function(c){var d=
b.menu.element[0];a(c.target).closest(".ui-menu-item").length||setTimeout(function(){a(document).one("mousedown",function(c){c.target!==b.element[0]&&c.target!==d&&!a.ui.contains(d,c.target)&&b.close()})},1);setTimeout(function(){clearTimeout(b.closing)},13)}).menu({focus:function(a,c){var d=c.item.data("item.autocomplete");!1!==b._trigger("focus",a,{item:d})&&/^key/.test(a.originalEvent.type)&&b.element.val(d.value)},selected:function(a,d){var g=d.item.data("item.autocomplete"),j=b.previous;if(b.element[0]!==
c.activeElement)b.element.focus(),b.previous=j,setTimeout(function(){b.previous=j;b.selectedItem=g},1);!1!==b._trigger("select",a,{item:g})&&b.element.val(g.value);b.term=b.element.val();b.close(a);b.selectedItem=g},blur:function(){b.menu.element.is(":visible")&&b.element.val()!==b.term&&b.element.val(b.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");a.fn.bgiframe&&this.menu.element.bgiframe()},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");
this.menu.element.remove();a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments);b==="source"&&this._initSource();b==="appendTo"&&this.menu.element.appendTo(a(c||"body",this.element[0].ownerDocument)[0]);b==="disabled"&&c&&this.xhr&&this.xhr.abort()},_initSource:function(){var b=this,c,d;a.isArray(this.options.source)?(c=this.options.source,this.source=function(b,d){d(a.ui.autocomplete.filter(c,b.term))}):typeof this.options.source==="string"?
(d=this.options.source,this.source=function(c,f){b.xhr&&b.xhr.abort();b.xhr=a.ajax({url:d,data:c,dataType:"json",success:function(a,c,d){d===b.xhr&&f(a);b.xhr=null},error:function(a){a===b.xhr&&f([]);b.xhr=null}})}):this.source=this.options.source},search:function(a,c){a=a!=null?a:this.element.val();this.term=this.element.val();if(a.length<this.options.minLength)return this.close(c);clearTimeout(this.closing);return this._trigger("search",c)===!1?void 0:this._search(a)},_search:function(a){this.pending++;
this.element.addClass("ui-autocomplete-loading");this.source({term:a},this.response)},_response:function(a){!this.options.disabled&&a&&a.length?(a=this._normalize(a),this._suggest(a),this._trigger("open")):this.close();this.pending--;this.pending||this.element.removeClass("ui-autocomplete-loading")},close:function(a){clearTimeout(this.closing);this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.deactivate(),this._trigger("close",a))},_change:function(a){this.previous!==this.element.val()&&
this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return typeof b==="string"?{label:b,value:b}:a.extend({label:b.label||b.value,value:b.value||b.label},b)})},_suggest:function(b){var c=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(c,b);this.menu.deactivate();this.menu.refresh();c.show();this._resizeMenu();c.position(a.extend({of:this.element},this.options.position))},_resizeMenu:function(){var a=
this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth(),this.element.outerWidth()))},_renderMenu:function(b,c){var d=this;a.each(c,function(a,c){d._renderItem(b,c)})},_renderItem:function(b,c){return a("<li></li>").data("item.autocomplete",c).append(a("<a></a>").text(c.label)).appendTo(b)},_move:function(a,c){if(this.menu.element.is(":visible"))if(this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a))this.element.val(this.term),this.menu.deactivate();else this.menu[a](c);
else this.search(null,c)},widget:function(){return this.menu.element}});a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(b,c){var d=RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(b,function(a){return d.test(a.label||a.value||a)})}})})(jQuery);
(function(a){a.widget("ui.menu",{_create:function(){var b=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(c){a(c.target).closest(".ui-menu-item a").length&&(c.preventDefault(),b.select(c))});this.refresh()},refresh:function(){var b=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").attr("tabindex",
-1).mouseenter(function(c){b.activate(c,a(this).parent())}).mouseleave(function(){b.deactivate()})},activate:function(a,c){this.deactivate();if(this.hasScroll()){var d=c.offset().top-this.element.offset().top,e=this.element.attr("scrollTop"),f=this.element.height();d<0?this.element.attr("scrollTop",e+d):d>=f&&this.element.attr("scrollTop",e+d-f+c.height())}this.active=c.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",a,{item:c})},deactivate:function(){if(this.active)this.active.children("a").removeClass("ui-state-hover").removeAttr("id"),
this._trigger("blur"),this.active=null},next:function(a){this.move("next",".ui-menu-item:first",a)},previous:function(a){this.move("prev",".ui-menu-item:last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(a,c,d){this.active?(a=this.active[a+"All"](".ui-menu-item").eq(0),a.length?this.activate(d,a):this.activate(d,this.element.children(c))):this.activate(d,this.element.children(c))},
nextPage:function(b){if(this.hasScroll())if(!this.active||this.last())this.activate(b,this.element.children(".ui-menu-item:first"));else{var c=this.active.offset().top,d=this.element.height(),e=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-c-d+a(this).height();return b<10&&b>-10});e.length||(e=this.element.children(".ui-menu-item:last"));this.activate(b,e)}else this.activate(b,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))},
previousPage:function(b){if(this.hasScroll())if(!this.active||this.first())this.activate(b,this.element.children(".ui-menu-item:last"));else{var c=this.active.offset().top,d=this.element.height();result=this.element.children(".ui-menu-item").filter(function(){var b=a(this).offset().top-c+d-a(this).height();return b<10&&b>-10});result.length||(result=this.element.children(".ui-menu-item:first"));this.activate(b,result)}else this.activate(b,this.element.children(".ui-menu-item").filter(!this.active||
this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element.attr("scrollHeight")},select:function(a){this._trigger("selected",a,{item:this.active})}})})(jQuery);
(function(a,b){a.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");
this.valueDiv.remove();a.Widget.prototype.destroy.apply(this,arguments)},value:function(a){if(a===b)return this._value();this._setOption("value",a);return this},_setOption:function(b,d){if(b==="value")this.options.value=d,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete");a.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var a=this.options.value;typeof a!=="number"&&(a=0);return Math.min(this.options.max,Math.max(this.min,a))},_percentage:function(){return 100*
this._value()/this.options.max},_refreshValue:function(){var a=this.value(),b=this._percentage();if(this.oldValue!==a)this.oldValue=a,this._trigger("change");this.valueDiv.toggleClass("ui-corner-right",a===this.options.max).width(b.toFixed(0)+"%");this.element.attr("aria-valuenow",a)}});a.extend(a.ui.progressbar,{version:"1.8.9"})})(jQuery);
(function(a){var b=a.browser;a.layout={browser:{mozilla:!!b.mozilla,webkit:!!b.webkit||!!b.safari,msie:!!b.msie,isIE6:!!b.msie&&b.version==6,boxModel:!1},scrollbarWidth:function(){return window.scrollbarWidth||a.layout.getScrollbarSize("width")},scrollbarHeight:function(){return window.scrollbarHeight||a.layout.getScrollbarSize("height")},getScrollbarSize:function(b){var d=a('<div style="position: absolute; top: -10000px; left: -10000px; width: 100px; height: 100px; overflow: scroll;"></div>').appendTo("body"),
e={width:d.width()-d[0].clientWidth,height:d.height()-d[0].clientHeight};d.remove();window.scrollbarWidth=e.width;window.scrollbarHeight=e.height;return b.match(/^(width|height)$/i)?e[b]:e},showInvisibly:function(b,d){if(!b)return{};b.jquery||(b=a(b));var e={display:b.css("display"),visibility:b.css("visibility")};return d||e.display=="none"?(b.css({display:"block",visibility:"hidden"}),e):{}},getElemDims:function(b){var d={},e=d.css={},f={},g,j,k=b.offset();d.offsetLeft=k.left;d.offsetTop=k.top;
a.each("Left,Right,Top,Bottom".split(","),function(k,p){g=e["border"+p]=a.layout.borderWidth(b,p);j=e["padding"+p]=a.layout.cssNum(b,"padding"+p);f[p]=g+j;d["inset"+p]=j});d.offsetWidth=b.innerWidth();d.offsetHeight=b.innerHeight();d.outerWidth=b.outerWidth();d.outerHeight=b.outerHeight();d.innerWidth=d.outerWidth-f.Left-f.Right;d.innerHeight=d.outerHeight-f.Top-f.Bottom;e.width=b.width();e.height=b.height();return d},getElemCSS:function(a,b){var e={},f=a[0].style,g=b.split(","),j="Top,Bottom,Left,Right".split(","),
k="Color,Style,Width".split(","),l,p,t,v,H,L;for(v=0;v<g.length;v++)if(l=g[v],l.match(/(border|padding|margin)$/))for(H=0;H<4;H++)if(p=j[H],l=="border")for(L=0;L<3;L++)t=k[L],e[l+p+t]=f[l+p+t];else e[l+p]=f[l+p];else e[l]=f[l];return e},cssWidth:function(b,d){var e=a.layout.borderWidth,f=a.layout.cssNum;if(d<=0)return 0;if(!a.layout.browser.boxModel)return d;e=d-e(b,"Left")-e(b,"Right")-f(b,"paddingLeft")-f(b,"paddingRight");return Math.max(0,e)},cssHeight:function(b,d){var e=a.layout.borderWidth,
f=a.layout.cssNum;if(d<=0)return 0;if(!a.layout.browser.boxModel)return d;e=d-e(b,"Top")-e(b,"Bottom")-f(b,"paddingTop")-f(b,"paddingBottom");return Math.max(0,e)},cssNum:function(b,d){b.jquery||(b=a(b));var e=a.layout.showInvisibly(b),f=parseInt(a.curCSS(b[0],d,!0),10)||0;b.css(e);return f},borderWidth:function(b,d){b.jquery&&(b=b[0]);var e="border"+d.substr(0,1).toUpperCase()+d.substr(1);return a.curCSS(b,e+"Style",!0)=="none"?0:parseInt(a.curCSS(b,e+"Width",!0),10)||0},isMouseOverElem:function(b,
d){var e=a(d||this),f=e.offset(),g=f.top,f=f.left,j=f+e.outerWidth(),e=g+e.outerHeight(),k=b.pageX,l=b.pageY;return a.layout.browser.msie&&k<0&&l<0||k>=f&&k<=j&&l>=g&&l<=e}};a.fn.layout=function(b){var d,e,f,g,j,k,l;function p(b){if(!b)return!0;var c=b.keyCode;if(c<33)return!0;var d={38:"north",40:"south",37:"west",39:"east"},e=b.shiftKey,f=b.ctrlKey,g,j,k,l;f&&c>=37&&c<=40&&w[d[c]].enableCursorHotkey?l=d[c]:(f||e)&&a.each(q.borderPanes.split(","),function(a,b){g=w[b];j=g.customHotkey;k=g.customHotkeyModifier;
if(e&&k=="SHIFT"||f&&k=="CTRL"||f&&e)if(j&&c==(isNaN(j)||j<=9?j.toUpperCase().charCodeAt(0):j))return l=b,!1});if(!l||!G[l]||!w[l].closable||h[l].isHidden)return!0;Qa(l);b.stopPropagation();return b.returnValue=!1}function t(b){this&&this.tagName&&(b=this);var c;fa(b)?c=G[b]:a(b).data("layoutRole")?c=a(b):a(b).parents().each(function(){if(a(this).data("layoutRole"))return c=a(this),!1});if(c&&c.length){var d=c.data("layoutEdge"),b=h[d];b.cssSaved&&v(d);if(b.isSliding||b.isResizing||b.isClosed)b.cssSaved=
!1;else{var e={zIndex:q.zIndex.pane_normal+2},f={},g=c.css("overflow"),j=c.css("overflowX"),k=c.css("overflowY");if(g!="visible")f.overflow=g,e.overflow="visible";if(j&&!j.match(/visible|auto/))f.overflowX=j,e.overflowX="visible";if(k&&!k.match(/visible|auto/))f.overflowY=j,e.overflowY="visible";b.cssSaved=f;c.css(e);a.each(q.allPanes.split(","),function(a,b){b!=d&&v(b)})}}}function v(b){this&&this.tagName&&(b=this);var c;fa(b)?c=G[b]:a(b).data("layoutRole")?c=a(b):a(b).parents().each(function(){if(a(this).data("layoutRole"))return c=
a(this),!1});if(c&&c.length){var b=c.data("layoutEdge"),b=h[b],d=b.cssSaved||{};!b.isSliding&&!b.isResizing&&c.css("zIndex",q.zIndex.pane_normal);c.css(d);b.cssSaved=!1}}function H(b,c,g){var h=a(b);if(h.length)if(q.borderPanes.indexOf(c)==-1)alert(d+f.toLowerCase()+": "+c);else return b=w[c].buttonClass+"-"+g,h.addClass(b+" "+b+"-"+c).data("layoutName",w.name),h;else alert(d+e+": "+b);return null}function L(a,b,c){switch(b.toLowerCase()){case "toggle":ha(a,c);break;case "open":N(a,c);break;case "close":O(a,
c);break;case "pin":y(a,c);break;case "toggle-slide":ha(a,c,!0);break;case "open-slide":N(a,c,!0)}}function ha(a,b,c){(a=H(a,b,"toggle"))&&a.click(function(a){Qa(b,!!c);a.stopPropagation()})}function N(a,b,c){(a=H(a,b,"open"))&&a.attr("title",g).click(function(a){va(b,!!c);a.stopPropagation()})}function O(a,b){var c=H(a,b,"close");c&&c.attr("title",j).click(function(a){ca(b);a.stopPropagation()})}function y(b,c){var d=H(b,c,"pin");if(d){var e=h[c];d.click(function(b){V(a(this),c,e.isSliding||e.isClosed);
e.isSliding||e.isClosed?va(c):ca(c);b.stopPropagation()});V(d,c,!e.isClosed&&!e.isSliding);q[c].pins.push(b)}}function ea(b,c){a.each(q[b].pins,function(d,e){V(a(e),b,c)})}function V(a,b,c){var d=a.attr("pin");if(!(d&&c==(d=="down"))){var d=w[b].buttonClass+"-pin",e=d+"-"+b,b=d+"-up "+e+"-up",d=d+"-down "+e+"-down";a.attr("pin",c?"down":"up").attr("title",c?k:l).removeClass(c?b:d).addClass(c?d:b)}}function n(b){for(var b=a.extend({},w.cookie,b||{}).name||w.name||"Layout",c=document.cookie,c=c?c.split(";"):
[],d,e=0,f=c.length;e<f;e++)if(d=a.trim(c[e]).split("="),d[0]==b)return u(decodeURIComponent(d[1]));return""}function W(b,c){var d=a.extend({},w.cookie,c||{}),e=d.name||w.name||"Layout",f="",g="",j=!1;d.expires.toUTCString?g=d.expires:typeof d.expires=="number"&&(g=new Date,d.expires>0?g.setDate(g.getDate()+d.expires):(g.setYear(1970),j=!0));g&&(f+=";expires="+g.toUTCString());d.path&&(f+=";path="+d.path);d.domain&&(f+=";domain="+d.domain);d.secure&&(f+=";secure");j?(h.cookie={},document.cookie=e+
"="+f):(h.cookie=oa(b||d.keys),document.cookie=e+"="+encodeURIComponent(Z(h.cookie))+f);return a.extend({},h.cookie)}function ua(b){if(b=n(b))h.cookie=a.extend({},b),na(b);return b}function na(b,c){a.extend(!0,w,b);if(h.initialized){var d,e,f=!c;a.each(q.allPanes.split(","),function(a,c){d=b[c];if(typeof d=="object")e=d.initHidden,e===!0&&Wa(c,f),e===!1&&Pa(c,!1,f),e=d.size,e>0&&ta(c,e),e=d.initClosed,e===!0&&ca(c,!1,f),e===!1&&va(c,!1,f)})}}function oa(b){var c={},d={isClosed:"initClosed",isHidden:"initHidden"},
e,f,g;if(!b)b=w.cookie.keys;a.isArray(b)&&(b=b.join(","));for(var b=b.replace(/__/g,".").split(","),j=0,k=b.length;j<k;j++)e=b[j].split("."),f=e[0],e=e[1],q.allPanes.indexOf(f)<0||(g=h[f][e],g!=void 0&&(e=="isClosed"&&h[f].isSliding&&(g=!0),(c[f]||(c[f]={}))[d[e]?d[e]:e]=g));return c}function Z(a){function b(a){var c=[],d=0,e,f,g;for(e in a)f=a[e],g=typeof f,g=="string"?f='"'+f+'"':g=="object"&&(f=b(f)),c[d++]='"'+e+'":'+f;return"{"+c.join(",")+"}"}return b(a)}function u(a){try{return window.eval("("+
a+")")||{}}catch(b){return{}}}f="Pane";g="Open";j="Close";l="Pin";k="Un-Pin";e="selector";d="Error Adding Button \n\nInvalid ";var w={name:"",containerClass:"ui-layout-container",scrollToBookmarkOnLoad:!0,resizeWithWindow:!0,resizeWithWindowDelay:200,resizeWithWindowMaxDelay:0,onresizeall_start:null,onresizeall_end:null,onload_start:null,onload_end:null,onunload_start:null,onunload_end:null,autoBindCustomButtons:!1,zIndex:null,defaults:{applyDemoStyles:!1,closable:!0,resizable:!0,slidable:!0,initClosed:!1,
initHidden:!1,contentSelector:".ui-layout-content",contentIgnoreSelector:".ui-layout-ignore",findNestedContent:!1,paneClass:"ui-layout-pane",resizerClass:"ui-layout-resizer",togglerClass:"ui-layout-toggler",buttonClass:"ui-layout-button",minSize:0,maxSize:0,spacing_open:6,spacing_closed:6,togglerLength_open:50,togglerLength_closed:50,togglerAlign_open:"center",togglerAlign_closed:"center",togglerTip_open:j,togglerTip_closed:g,togglerContent_open:"",togglerContent_closed:"",resizerDblClickToggle:!0,
autoResize:!0,autoReopen:!0,resizerDragOpacity:1,maskIframesOnResize:!0,resizeNestedLayout:!0,resizeWhileDragging:!1,resizeContentWhileDragging:!1,noRoomToOpenTip:"Not enough room to show this pane.",resizerTip:"Resize",sliderTip:"Slide Open",sliderCursor:"pointer",slideTrigger_open:"click",slideTrigger_close:"mouseleave",slideDelay_open:300,slideDelay_close:300,hideTogglerOnSlide:!1,preventQuickSlideClose:!(!a.browser.webkit&&!a.browser.safari),preventPrematureSlideClose:!1,showOverflowOnHover:!1,
enableCursorHotkey:!0,customHotkeyModifier:"SHIFT",fxName:"slide",fxSpeed:null,fxSettings:{},fxOpacityFix:!0,triggerEventsOnLoad:!1,triggerEventsWhileDragging:!0,onshow_start:null,onshow_end:null,onhide_start:null,onhide_end:null,onopen_start:null,onopen_end:null,onclose_start:null,onclose_end:null,onresize_start:null,onresize_end:null,onsizecontent_start:null,onsizecontent_end:null,onswap_start:null,onswap_end:null,ondrag_start:null,ondrag_end:null},north:{paneSelector:".ui-layout-north",size:"auto",
resizerCursor:"n-resize",customHotkey:""},south:{paneSelector:".ui-layout-south",size:"auto",resizerCursor:"s-resize",customHotkey:""},east:{paneSelector:".ui-layout-east",size:200,resizerCursor:"e-resize",customHotkey:""},west:{paneSelector:".ui-layout-west",size:200,resizerCursor:"w-resize",customHotkey:""},center:{paneSelector:".ui-layout-center",minWidth:0,minHeight:0},useStateCookie:!1,cookie:{name:"",autoSave:!0,autoLoad:!0,domain:"",path:"",expires:"",secure:!1,keys:"north.size,south.size,east.size,west.size,north.isClosed,south.isClosed,east.isClosed,west.isClosed,north.isHidden,south.isHidden,east.isHidden,west.isHidden"}},
r={slide:{all:{duration:"fast"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},drop:{all:{duration:"slow"},north:{direction:"up"},south:{direction:"down"},east:{direction:"right"},west:{direction:"left"}},scale:{all:{duration:"fast"}}},h={id:"layout"+(new Date).getTime(),initialized:!1,container:{},north:{},south:{},east:{},west:{},center:{},cookie:{}},q={allPanes:"north,south,west,east,center",borderPanes:"north,south,west,east",altSide:{north:"south",
south:"north",east:"west",west:"east"},hidden:{visibility:"hidden"},visible:{visibility:"visible"},zIndex:{pane_normal:1,resizer_normal:2,iframe_mask:2,pane_sliding:100,pane_animate:1E3,resizer_drag:1E4},resizers:{cssReq:{position:"absolute",padding:0,margin:0,fontSize:"1px",textAlign:"left",overflow:"hidden"},cssDemo:{background:"#DDD",border:"none"}},togglers:{cssReq:{position:"absolute",display:"block",padding:0,margin:0,overflow:"hidden",textAlign:"center",fontSize:"1px",cursor:"pointer",zIndex:1},
cssDemo:{background:"#AAA"}},content:{cssReq:{position:"relative"},cssDemo:{overflow:"auto",padding:"10px"},cssDemoPane:{overflow:"hidden",padding:0}},panes:{cssReq:{position:"absolute",margin:0},cssDemo:{padding:"10px",background:"#FFF",border:"1px solid #BBB",overflow:"auto"}},north:{side:"Top",sizeType:"Height",dir:"horz",cssReq:{top:0,bottom:"auto",left:0,right:0,width:"auto"},pins:[]},south:{side:"Bottom",sizeType:"Height",dir:"horz",cssReq:{top:"auto",bottom:0,left:0,right:0,width:"auto"},pins:[]},
east:{side:"Right",sizeType:"Width",dir:"vert",cssReq:{left:"auto",right:0,top:"auto",bottom:"auto",height:"auto"},pins:[]},west:{side:"Left",sizeType:"Width",dir:"vert",cssReq:{left:0,right:"auto",top:"auto",bottom:"auto",height:"auto"},pins:[]},center:{dir:"center",cssReq:{left:"auto",right:"auto",top:"auto",bottom:"auto",height:"auto",width:"auto"}}},J={data:{},set:function(a,b,c){J.clear(a);J.data[a]=setTimeout(b,c)},clear:function(a){var b=J.data;b[a]&&(clearTimeout(b[a]),delete b[a])}},fa=function(a){try{return typeof a==
"string"||typeof a=="object"&&a.constructor.toString().match(/string/i)!==null}catch(b){return!1}},T=function(a,b){return Math.max(a,b)},R=function(b){var c,d={cookie:{},defaults:{fxSettings:{}},north:{fxSettings:{}},south:{fxSettings:{}},east:{fxSettings:{}},west:{fxSettings:{}},center:{fxSettings:{}}},b=b||{};b.effects||b.cookie||b.defaults||b.north||b.south||b.west||b.east||b.center?d=a.extend(!0,d,b):a.each(b,function(a,b){c=a.split("__");if(!c[1]||d[c[0]])d[c[1]?c[0]:"defaults"][c[1]?c[1]:c[0]]=
b});return d},z=function(b,c,d){function e(g){var h=q[g];h.doCallback?(f.push(g),g=h.callback.split(",")[1],g!=c&&!a.inArray(g,f)>=0&&e(g)):(h.doCallback=!0,h.callback=b+","+c+","+(d?1:0))}var f=[];a.each(q.borderPanes.split(","),function(a,b){if(q[b].isMoving)return e(b),!1})},Ha=function(a){a=q[a];q.isLayoutBusy=!1;delete a.isMoving;if(a.doCallback&&a.callback){a.doCallback=!1;var b=a.callback.split(","),c=b[2]>0?!0:!1;b[0]=="open"?va(b[1],c):b[0]=="close"&&ca(b[1],c);if(!a.doCallback)a.callback=
null}},P=function(b,c){if(c){var d;try{if(typeof c=="function")d=c;else if(fa(c))if(c.match(/,/)){var e=c.split(",");d=eval(e[0]);if(typeof d=="function"&&e.length>1)return d(e[1])}else d=eval(c);else return;if(typeof d=="function")return b&&G[b]?d(b,G[b],a.extend({},h[b]),w[b],w.name):d(Ga,a.extend({},h),w,w.name)}catch(f){}}},Ba=function(b,c){if(!b)return{};b.jquery||(b=a(b));var d={display:b.css("display"),visibility:b.css("visibility")};return c||d.display=="none"?(b.css({display:"block",visibility:"hidden"}),
d):{}},x=function(a){if(!h.browser.mozilla){var b=G[a];h[a].tagName=="IFRAME"?b.css(q.hidden).css(q.visible):b.find("IFRAME").css(q.hidden).css(q.visible)}},aa=function(b,c){b.jquery||(b=a(b));var d=Ba(b),e=parseInt(a.curCSS(b[0],c,!0),10)||0;b.css(d);return e},D=function(b,c){b.jquery&&(b=b[0]);var d="border"+c.substr(0,1).toUpperCase()+c.substr(1);return a.curCSS(b,d+"Style",!0)=="none"?0:parseInt(a.curCSS(b,d+"Width",!0),10)||0},E=function(b,c){var d=fa(b),e=d?G[b]:a(b);isNaN(c)&&(c=d?ia(b):e.outerWidth());
if(c<=0)return 0;if(!h.browser.boxModel)return c;d=c-D(e,"Left")-D(e,"Right")-aa(e,"paddingLeft")-aa(e,"paddingRight");return T(0,d)},ba=function(b,c){var d=fa(b),e=d?G[b]:a(b);isNaN(c)&&(c=d?ia(b):e.outerHeight());if(c<=0)return 0;if(!h.browser.boxModel)return c;d=c-D(e,"Top")-D(e,"Bottom")-aa(e,"paddingTop")-aa(e,"paddingBottom");return T(0,d)},ma=function(a){var b=q[a].dir,a={minWidth:1001-E(a,1E3),minHeight:1001-ba(a,1E3)};if(b=="horz")a.minSize=a.minHeight;if(b=="vert")a.minSize=a.minWidth;return a},
pa=function(b,c,d){var e=b;fa(b)?e=G[b]:b.jquery||(e=a(b));b=ba(e,c);e.css({height:b,visibility:"visible"});b>0&&e.innerWidth()>0?d&&e.data("autoHidden")&&(e.show().data("autoHidden",!1),h.browser.mozilla||e.css(q.hidden).css(q.visible)):d&&!e.data("autoHidden")&&e.hide().data("autoHidden",!0)},ga=function(a,b,c){if(!c)c=q[a].dir;fa(b)&&b.match(/%/)&&(b=parseInt(b,10)/100);if(b===0)return 0;else if(b>=1)return parseInt(b,10);else if(b>0){var a=w,d;c=="horz"?d=M.innerHeight-(G.north?a.north.spacing_open:
0)-(G.south?a.south.spacing_open:0):c=="vert"&&(d=M.innerWidth-(G.west?a.west.spacing_open:0)-(G.east?a.east.spacing_open:0));return Math.floor(d*b)}else if(a=="center")return 0;else{d=G[a];var c=c=="horz"?"height":"width",a=Ba(d),e=d.css(c);d.css(c,"auto");b=c=="height"?d.outerHeight():d.outerWidth();d.css(c,e).css(a);return b}},ia=function(a,b){var c=G[a],d=w[a],e=h[a],f=b?d.spacing_open:0,d=b?d.spacing_closed:0;return!c||e.isHidden?0:e.isClosed||e.isSliding&&b?d:q[a].dir=="horz"?c.outerHeight()+
f:c.outerWidth()+f},U=function(a,b){var c=w[a],d=h[a],e=q[a],f=e.dir;e.side.toLowerCase();e.sizeType.toLowerCase();var e=b!=void 0?b:d.isSliding,g=c.spacing_open,j=q.altSide[a],k=h[j],l=G[j],r=!l||k.isVisible===!1||k.isSliding?0:f=="horz"?l.outerHeight():l.outerWidth(),j=(!l||k.isHidden?0:w[j][k.isClosed!==!1?"spacing_closed":"spacing_open"])||0,k=f=="horz"?M.innerHeight:M.innerWidth,l=ma("center"),l=f=="horz"?T(w.center.minHeight,l.minHeight):T(w.center.minWidth,l.minWidth),e=k-g-(e?0:ga("center",
l,f)+r+j),f=d.minSize=T(ga(a,c.minSize),ma(a).minSize),g=c.maxSize?ga(a,c.maxSize):1E5,e=Math.min(g,e),e=d.maxSize=e,d=d.resizerPosition={},g=M.insetTop,r=M.insetLeft,j=M.innerWidth,k=M.innerHeight,c=c.spacing_open;switch(a){case "north":d.min=g+f;d.max=g+e;break;case "west":d.min=r+f;d.max=r+e;break;case "south":d.min=g+k-e-c;d.max=g+k-f-c;break;case "east":d.min=r+j-e-c,d.max=r+j-f-c}},ja=function(b){var c={},d=c.css={},e={},f,g,h=b.offset();c.offsetLeft=h.left;c.offsetTop=h.top;a.each("Left,Right,Top,Bottom".split(","),
function(a,h){f=d["border"+h]=D(b,h);g=d["padding"+h]=aa(b,"padding"+h);e[h]=f+g;c["inset"+h]=g});c.offsetWidth=b.innerWidth();c.offsetHeight=b.innerHeight();c.outerWidth=b.outerWidth();c.outerHeight=b.outerHeight();c.innerWidth=c.outerWidth-e.Left-e.Right;c.innerHeight=c.outerHeight-e.Top-e.Bottom;d.width=b.width();d.height=b.height();return c},Fa=function(a,b){var c={},d=a[0].style,e=b.split(","),f="Top,Bottom,Left,Right".split(","),g="Color,Style,Width".split(","),h,j,k,l,r,F;for(l=0;l<e.length;l++)if(h=
e[l],h.match(/(border|padding|margin)$/))for(r=0;r<4;r++)if(j=f[r],h=="border")for(F=0;F<3;F++)k=g[F],c[h+j+k]=d[h+j+k];else c[h+j]=d[h+j];else c[h]=d[h];return c},F=function(b,c){var d=a(b),e=d.data("layoutRole"),f=d.data("layoutEdge"),g=w[f][e+"Class"],f="-"+f,h=d.hasClass(g+"-closed")?"-closed":"-open",j=h=="-closed"?"-open":"-closed",h=g+"-hover "+(g+f+"-hover ")+(g+h+"-hover ")+(g+f+h+"-hover ");c&&(h+=g+j+"-hover "+(g+f+j+"-hover "));e=="resizer"&&d.hasClass(g+"-sliding")&&(h+=g+"-sliding-hover "+
(g+f+"-sliding-hover "));return a.trim(h)},Q=function(b,c){var d=a(c||this);b&&d.data("layoutRole")=="toggler"&&b.stopPropagation();d.addClass(F(d))},X=function(b,c){var d=a(c||this);d.removeClass(F(d,!0))},I=function(b){a("body").disableSelection();Q(b,this)},qa=function(b,c){var d=c||this,e=a(d).data("layoutEdge"),f=e+"ResizerLeave";J.clear(e+"_openSlider");J.clear(f);c?h[e].isResizing||a("body").enableSelection():(X(b,this),J.set(f,function(){qa(b,d)},200))},Na=function(){var a=Number(w.resizeWithWindowDelay)||
100;a>0&&(J.clear("winResize"),J.set("winResize",function(){J.clear("winResize");J.clear("winResizeRepeater");Ka()},a),J.data.winResizeRepeater||Ua())},Ua=function(){var a=Number(w.resizeWithWindowMaxDelay);a>0&&J.set("winResizeRepeater",function(){Ua();Ka()},a)},Ia=function(){var a=w;h.cookie=oa();P(null,a.onunload_start);a.useStateCookie&&a.cookie.autoSave&&W();P(null,a.onunload_end||a.onunload)},ya=function(b){if(!b||b=="all")b=q.borderPanes;a.each(b.split(","),function(b,c){var d=w[c];if(d.enableCursorHotkey||
d.customHotkey)return a(document).bind("keydown."+da,p),!1})},wa=function(){function d(a){for(var b in e)a[b]!=void 0&&(a[e[b]]=a[b],delete a[b])}b=R(b);var e={applyDefaultStyles:"applyDemoStyles"};d(b.defaults);a.each(q.allPanes.split(","),function(a,e){d(b[e])});b.effects&&(a.extend(r,b.effects),delete b.effects);a.extend(w.cookie,b.cookie);a.each("name,containerClass,zIndex,scrollToBookmarkOnLoad,resizeWithWindow,resizeWithWindowDelay,resizeWithWindowMaxDelay,onresizeall,onresizeall_start,onresizeall_end,onload,onload_start,onload_end,onunload,onunload_start,onunload_end,autoBindCustomButtons,useStateCookie".split(","),
function(a,d){b[d]!==void 0?w[d]=b[d]:b.defaults[d]!==void 0&&(w[d]=b.defaults[d],delete b.defaults[d])});a.each("paneSelector,resizerCursor,customHotkey".split(","),function(a,d){delete b.defaults[d]});a.extend(!0,w.defaults,b.defaults);q.center=a.extend(!0,{},q.panes,q.center);var f=w.zIndex;if(f===0||f>0)q.zIndex.pane_normal=f,q.zIndex.resizer_normal=f+1,q.zIndex.iframe_mask=f+1;a.extend(w.center,b.center);var g=a.extend(!0,{},w.defaults,b.defaults,w.center),f="paneClass,contentSelector,applyDemoStyles,triggerEventsOnLoad,showOverflowOnHover,onresize,onresize_start,onresize_end,resizeNestedLayout,resizeContentWhileDragging,onsizecontent,onsizecontent_start,onsizecontent_end".split(",");
a.each(f,function(a,b){w.center[b]=g[b]});var h,j=w.defaults;a.each(q.borderPanes.split(","),function(d,e){q[e]=a.extend(!0,{},q.panes,q[e]);h=w[e]=a.extend(!0,{},w.defaults,w[e],b.defaults,b[e]);if(!h.paneClass)h.paneClass="ui-layout-pane";if(!h.resizerClass)h.resizerClass="ui-layout-resizer";if(!h.togglerClass)h.togglerClass="ui-layout-toggler";a.each(["_open","_close",""],function(d,f){var g="fxName"+f,m="fxSpeed"+f,k="fxSettings"+f;h[g]=b[e][g]||b[e].fxName||b.defaults[g]||b.defaults.fxName||
h[g]||h.fxName||j[g]||j.fxName||"none";var l=h[g];if(l=="none"||!a.effects||!a.effects[l]||!r[l]&&!h[k]&&!h.fxSettings)l=h[g]="none";l=r[l]||{};g=l.all||{};l=l[e]||{};h[k]=a.extend({},g,l,j.fxSettings||{},j[k]||{},h.fxSettings,h[k],b.defaults.fxSettings,b.defaults[k]||{},b[e].fxSettings,b[e][k]||{});h[m]=b[e][m]||b[e].fxSpeed||b.defaults[m]||b.defaults.fxSpeed||h[m]||h[k].duration||h.fxSpeed||h.fxSettings.duration||j.fxSpeed||j.fxSettings.duration||l.duration||g.duration||"normal"})})},jb=function(a){a=
w[a].paneSelector;if(a.substr(0,1)==="#")return ra.find(a).eq(0);else{var b=ra.children(a).eq(0);return b.length?b:ra.children("form:first").children(a).eq(0)}},bb=function(){a.each(q.allPanes.split(","),function(a,b){cb(b)});Va();a.each(q.borderPanes.split(","),function(a,b){G[b]&&h[b].isVisible&&(U(b),Da(b))});Ca("center");a.each(q.allPanes.split(","),function(a,b){var c=w[b];G[b]&&h[b].isVisible&&(c.triggerEventsOnLoad&&P(b,c.onresize_end||c.onresize),La(b))});ra.innerHeight()<2&&alert("UI Layout Initialization Warning\n\nThe layout-container \"CONTAINER\" has no height.\n\nTherefore the layout is 0-height and hence 'invisible'!".replace(/CONTAINER/,
M.ref))},cb=function(b){var c=w[b],d=h[b],e=q[b],f=e.dir,g=b=="center",j={},k=G[b],l;k?db(b):za[b]=!1;k=G[b]=jb(b);if(k.length){k.data("layoutCSS")||k.data("layoutCSS",Fa(k,"position,top,left,bottom,right,width,height,overflow,zIndex,display,backgroundColor,padding,margin,border"));k.data("parentLayout",Ga).data("layoutRole","pane").data("layoutEdge",b).css(e.cssReq).css("zIndex",q.zIndex.pane_normal).css(c.applyDemoStyles?e.cssDemo:{}).addClass(c.paneClass+" "+c.paneClass+"-"+b).bind("mouseenter."+
da,Q).bind("mouseleave."+da,X);kb(b,!1);if(!g)l=d.size=ga(b,c.size),e=ga(b,c.minSize)||1,g=ga(b,c.maxSize)||1E5,l>0&&(l=T(Math.min(l,g),e)),d.isClosed=!1,d.isSliding=!1,d.isResizing=!1,d.isHidden=!1;d.tagName=a.prop?k.prop("tagName"):k.attr("tagName");d.edge=b;d.noRoom=!1;d.isVisible=!0;switch(b){case "north":j.top=M.insetTop;j.left=M.insetLeft;j.right=M.insetRight;break;case "south":j.bottom=M.insetBottom;j.left=M.insetLeft;j.right=M.insetRight;break;case "west":j.left=M.insetLeft;break;case "east":j.right=
M.insetRight}if(f=="horz")j.height=T(1,ba(b,l));else if(f=="vert")j.width=T(1,E(b,l));k.css(j);f!="horz"&&Ca(b,!0);d.noRoom||k.css({visibility:"visible",display:"block"});c.initClosed&&c.closable?ca(b,!0,!0):(c.initHidden||c.initClosed)&&Wa(b);c.showOverflowOnHover&&k.hover(t,v);h.initialized&&(Va(b),ya(b),Ka(),d.isVisible&&(c.triggerEventsOnLoad&&P(b,c.onresize_end||c.onresize),La(b)))}else G[b]=!1},Va=function(b){if(!b||b=="all")b=q.borderPanes;a.each(b.split(","),function(b,c){var d=G[c];Y[c]=
!1;la[c]=!1;if(d){var d=w[c],e=h[c],f=d.resizerClass,g=d.togglerClass;q[c].side.toLowerCase();var j="-"+c,k=Y[c]=a("<div></div>"),m=d.closable?la[c]=a("<div></div>"):!1;!e.isVisible&&d.slidable&&k.attr("title",d.sliderTip).css("cursor",d.sliderCursor);k.attr("id",d.paneSelector.substr(0,1)=="#"?d.paneSelector.substr(1)+"-resizer":"").data("parentLayout",Ga).data("layoutRole","resizer").data("layoutEdge",c).css(q.resizers.cssReq).css("zIndex",q.zIndex.resizer_normal).css(d.applyDemoStyles?q.resizers.cssDemo:
{}).addClass(f+" "+f+j).appendTo(ra);m&&(m.attr("id",d.paneSelector.substr(0,1)=="#"?d.paneSelector.substr(1)+"-toggler":"").data("parentLayout",Ga).data("layoutRole","toggler").data("layoutEdge",c).css(q.togglers.cssReq).css(d.applyDemoStyles?q.togglers.cssDemo:{}).addClass(g+" "+g+j).appendTo(k),d.togglerContent_open&&a("<span>"+d.togglerContent_open+"</span>").data("layoutRole","togglerContent").data("layoutEdge",c).addClass("content content-open").css("display","none").appendTo(m),d.togglerContent_closed&&
a("<span>"+d.togglerContent_closed+"</span>").data("layoutRole","togglerContent").data("layoutEdge",c).addClass("content content-closed").css("display","none").appendTo(m),mb(c));sb(c);e.isVisible?fb(c):(eb(c),Ja(c,!0))}});Ra("all")},kb=function(a,b){var c=w[a],d=c.contentSelector,e=G[a],f;d&&(f=za[a]=c.findNestedContent?e.find(d).eq(0):e.children(d).eq(0));f&&f.length?(f.data("layoutCSS")||f.data("layoutCSS",Fa(f,"height")),f.css(q.content.cssReq),c.applyDemoStyles&&(f.css(q.content.cssDemo),e.css(q.content.cssDemoPane)),
h[a].content={},b!==!1&&Oa(a)):za[a]=!1},rb=function(){var b;a.each("toggle,open,close,pin,toggle-slide,open-slide".split(","),function(c,d){a.each(q.borderPanes.split(","),function(c,e){a(".ui-layout-button-"+d+"-"+e).each(function(){b=a(this).data("layoutName")||a(this).attr("layoutName");(b==void 0||b==w.name)&&L(this,d,e)})})})},sb=function(b){var c=typeof a.fn.draggable=="function",d;if(!b||b=="all")b=q.borderPanes;a.each(b.split(","),function(b,e){var f=w[e],g=h[e],j=q[e],k=j.dir=="horz"?"top":
"left",m,l;if(!c||!G[e]||!f.resizable)return f.resizable=!1,!0;var r=Y[e],F=f.resizerClass,X=F+"-drag",Q=F+"-"+e+"-drag",p=F+"-dragging",n=F+"-"+e+"-dragging",t=F+"-dragging-limit",v=F+"-"+e+"-dragging-limit",u=!1;g.isClosed||r.attr("title",f.resizerTip).css("cursor",f.resizerCursor);r.bind("mouseenter."+da,I).bind("mouseleave."+da,qa);r.draggable({containment:ra[0],axis:j.dir=="horz"?"y":"x",delay:0,distance:1,helper:"clone",opacity:f.resizerDragOpacity,addClasses:!1,zIndex:q.zIndex.resizer_drag,
start:function(){f=w[e];g=h[e];l=f.resizeWhileDragging;if(!1===P(e,f.ondrag_start))return!1;q.isLayoutBusy=!0;g.isResizing=!0;J.clear(e+"_closeSlider");U(e);m=g.resizerPosition;r.addClass(X+" "+Q);u=!1;d=a(f.maskIframesOnResize===!0?"iframe":f.maskIframesOnResize).filter(":visible");var b,c=0;d.each(function(){b="ui-layout-mask-"+ ++c;a(this).data("layoutMaskID",b);a('<div id="'+b+'" class="ui-layout-mask ui-layout-mask-'+e+'"/>').css({background:"#fff",opacity:"0.001",zIndex:q.zIndex.iframe_mask,
position:"absolute",width:this.offsetWidth+"px",height:this.offsetHeight+"px"}).css(a(this).position()).appendTo(this.parentNode)});a("body").disableSelection()},drag:function(a,b){u||(b.helper.addClass(p+" "+n).css({right:"auto",bottom:"auto"}).children().css("visibility","hidden"),u=!0,g.isSliding&&G[e].css("zIndex",q.zIndex.pane_sliding));var c=0;if(b.position[k]<m.min)b.position[k]=m.min,c=-1;else if(b.position[k]>m.max)b.position[k]=m.max,c=1;c?(b.helper.addClass(t+" "+v),window.defaultStatus=
"Panel has reached its "+(c>0&&e.match(/north|west/)||c<0&&e.match(/south|east/)?"maximum":"minimum")+" size"):(b.helper.removeClass(t+" "+v),window.defaultStatus="");l&&Na(a,b,e)},stop:function(b,c){a("body").enableSelection();window.defaultStatus="";r.removeClass(X+" "+Q);g.isResizing=!1;q.isLayoutBusy=!1;Na(b,c,e,!0)}});var Na=function(b,c,e,g){var b=c.position,c=q[e],h;switch(e){case "north":h=b.top;break;case "west":h=b.left;break;case "south":h=M.offsetHeight-b.top-f.spacing_open;break;case "east":h=
M.offsetWidth-b.left-f.spacing_open}if(g){if(a("div.ui-layout-mask").each(function(){this.parentNode.removeChild(this)}),!1===P(e,f.ondrag_end||f.ondrag))return!1}else d.each(function(){a("#"+a(this).data("layoutMaskID")).css(a(this).position()).css({width:this.offsetWidth+"px",height:this.offsetHeight+"px"})});$a(e,h-M["inset"+c.side])}})},db=function(b,c,d){if(G[b]){var e=G[b],f=za[b],g=Y[b],j=la[b],k=w[b].paneClass,l=k+"-"+b,k=[k,k+"-open",k+"-closed",k+"-sliding",l,l+"-open",l+"-closed",l+"-sliding"];
a.merge(k,F(e,!0));e&&e.length&&(c&&!e.data("layoutContainer")&&(!f||!f.length||!f.data("layoutContainer"))?e.remove():(e.removeClass(k.join(" ")).removeData("layoutParent").removeData("layoutRole").removeData("layoutEdge").removeData("autoHidden").unbind("."+da),e.data("layoutContainer")||e.css(e.data("layoutCSS")).removeData("layoutCSS"),f&&f.length&&!f.data("layoutContainer")&&f.css(f.data("layoutCSS")).removeData("layoutCSS")));j&&j.length&&j.remove();g&&g.length&&g.remove();G[b]=za[b]=Y[b]=la[b]=
!1;d||(Ka(),h[b]={})}},Wa=function(a,b){var c=w[a],d=h[a],e=G[a],f=Y[a];if(e&&!d.isHidden&&!(h.initialized&&!1===P(a,c.onhide_start)))if(d.isSliding=!1,f&&f.hide(),!h.initialized||d.isClosed){if(d.isClosed=!0,d.isHidden=!0,d.isVisible=!1,e.hide(),Ca(q[a].dir=="horz"?"all":"center"),h.initialized||c.triggerEventsOnLoad)P(a,c.onhide_end||c.onhide)}else d.isHiding=!0,ca(a,!1,b)},Pa=function(a,b,c,d){var e=h[a];if(G[a]&&e.isHidden&&!1!==P(a,w[a].onshow_start))e.isSliding=!1,e.isShowing=!0,b===!1?ca(a,
!0):va(a,!1,c,d)},Qa=function(b,c){fa(b)||(b.stopImmediatePropagation(),b=a(this).data("layoutEdge"));var d=h[fa(b)?a.trim(b):b==void 0||b==null?"":b];d.isHidden?Pa(b):d.isClosed?va(b,!!c):ca(b)},pb=function(a){var b=h[a];G[a].hide();b.isClosed=!0;b.isVisible=!1},ca=function(a,b,c,d){function e(){if(j.isClosed){Ja(a,!0);var b=q.altSide[a];h[b].noRoom&&(U(b),Da(b));if(!d&&(h.initialized||g.triggerEventsOnLoad))k||P(a,g.onclose_end||g.onclose),k&&P(a,g.onshow_end||g.onshow),l&&P(a,g.onhide_end||g.onhide)}Ha(a)}
if(h.initialized){var f=G[a],g=w[a],j=h[a],c=!c&&!j.isClosed&&g.fxName_close!="none",k=j.isShowing,l=j.isHiding;delete j.isShowing;delete j.isHiding;if(f&&(g.closable||k||l)&&(b||!j.isClosed||k))if(q.isLayoutBusy)z("close",a,b);else if(k||!1!==P(a,g.onclose_start)){q[a].isMoving=!0;q.isLayoutBusy=!0;j.isClosed=!0;j.isVisible=!1;if(l)j.isHidden=!0;else if(k)j.isHidden=!1;j.isSliding?Sa(a,!1):Ca(q[a].dir=="horz"?"all":"center",!1);eb(a);c?(Ya(a,!0),f.hide(g.fxName_close,g.fxSettings_close,g.fxSpeed_close,
function(){Ya(a,!1);e()})):(f.hide(),e())}}else pb(a)},eb=function(b){var c=Y[b],d=la[b],e=w[b],f=q[b].side.toLowerCase(),g=e.resizerClass,j=e.togglerClass,k="-"+b;c.css(f,M["inset"+q[b].side]).removeClass(g+"-open "+g+k+"-open").removeClass(g+"-sliding "+g+k+"-sliding").addClass(g+"-closed "+g+k+"-closed").unbind("dblclick."+da);e.resizable&&typeof a.fn.draggable=="function"&&c.draggable("disable").removeClass("ui-state-disabled").css("cursor","default").attr("title","");d&&(d.removeClass(j+"-open "+
j+k+"-open").addClass(j+"-closed "+j+k+"-closed").attr("title",e.togglerTip_closed),d.children(".content-open").hide(),d.children(".content-closed").css("display","block"));ea(b,!1);h.initialized&&Ra("all")},va=function(a,b,c,d){function e(){j.isVisible&&(x(a),j.isSliding||Ca(q[a].dir=="vert"?"center":"all",!1),fb(a));Ha(a)}var f=G[a],g=w[a],j=h[a],c=!c&&j.isClosed&&g.fxName_open!="none",k=j.isShowing;delete j.isShowing;if(f&&(g.resizable||g.closable||k)&&(!j.isVisible||j.isSliding))if(j.isHidden&&
!k)Pa(a,!0);else if(q.isLayoutBusy)z("open",a,b);else if(U(a,b),!1!==P(a,g.onopen_start))if(j.minSize>j.maxSize)ea(a,!1),!d&&g.noRoomToOpenTip&&alert(g.noRoomToOpenTip);else{q[a].isMoving=!0;q.isLayoutBusy=!0;b?Sa(a,!0):j.isSliding?Sa(a,!1):g.slidable&&Ja(a,!1);j.noRoom=!1;Da(a);j.isVisible=!0;j.isClosed=!1;if(k)j.isHidden=!1;c?(Ya(a,!0),f.show(g.fxName_open,g.fxSettings_open,g.fxSpeed_open,function(){Ya(a,!1);e()})):(f.show(),e())}},fb=function(b,c){var d=G[b],e=Y[b],f=la[b],g=w[b],j=h[b],k=q[b].side.toLowerCase(),
l=g.resizerClass,r=g.togglerClass,F="-"+b;e.css(k,M["inset"+q[b].side]+ia(b)).removeClass(l+"-closed "+l+F+"-closed").addClass(l+"-open "+l+F+"-open");j.isSliding?e.addClass(l+"-sliding "+l+F+"-sliding"):e.removeClass(l+"-sliding "+l+F+"-sliding");g.resizerDblClickToggle&&e.bind("dblclick",Qa);X(0,e);g.resizable&&typeof a.fn.draggable=="function"?e.draggable("enable").css("cursor",g.resizerCursor).attr("title",g.resizerTip):j.isSliding||e.css("cursor","default");f&&(f.removeClass(r+"-closed "+r+F+
"-closed").addClass(r+"-open "+r+F+"-open").attr("title",g.togglerTip_open),X(0,f),f.children(".content-closed").hide(),f.children(".content-open").css("display","block"));ea(b,!j.isSliding);a.extend(j,ja(d));h.initialized&&(Ra("all"),Oa(b,!0));if(!c&&(h.initialized||g.triggerEventsOnLoad)&&d.is(":visible"))P(b,g.onopen_end||g.onopen),j.isShowing&&P(b,g.onshow_end||g.onshow),h.initialized&&(P(b,g.onresize_end||g.onresize),La(b))},lb=function(b){function c(){f.isClosed?q[e].isMoving||va(e,!0):Sa(e,
!0)}var d=fa(b)?null:b,e=d?a(this).data("layoutEdge"):b,f=h[e],b=w[e].slideDelay_open;d&&d.stopImmediatePropagation();f.isClosed&&d&&d.type=="mouseenter"&&b>0?J.set(e+"_openSlider",c,b):c()},Xa=function(b){function c(){f.isClosed?Sa(e,!1):q[e].isMoving||ca(e)}var d=fa(b)?null:b,e=d?a(this).data("layoutEdge"):b,b=w[e],f=h[e],g=q[e].isMoving?1E3:300;if(!f.isClosed&&!f.isResizing)if(b.slideTrigger_close=="click")c();else if(!b.preventQuickSlideClose||!q.isLayoutBusy)if(!b.preventPrematureSlideClose||
!d||!a.layout.isMouseOverElem(d,G[e]))d?J.set(e+"_closeSlider",c,T(b.slideDelay_close,g)):c()},Ya=function(a,b){var c=G[a];if(b)c.css({zIndex:q.zIndex.pane_animate}),a=="south"?c.css({top:M.insetTop+M.innerHeight-c.outerHeight()}):a=="east"&&c.css({left:M.insetLeft+M.innerWidth-c.outerWidth()});else{c.css({zIndex:h[a].isSliding?q.zIndex.pane_sliding:q.zIndex.pane_normal});a=="south"?c.css({top:"auto"}):a=="east"&&c.css({left:"auto"});var d=w[a];h.browser.msie&&d.fxOpacityFix&&d.fxName_open!="slide"&&
c.css("filter")&&c.css("opacity")==1&&c[0].style.removeAttribute("filter")}},Ja=function(a,b){var c=w[a],d=Y[a],e=c.slideTrigger_open.toLowerCase();if(d&&(!b||c.slidable)){if(e.match(/mouseover/))e=c.slideTrigger_open="mouseenter";else if(!e.match(/click|dblclick|mouseenter/))e=c.slideTrigger_open="click";d[b?"bind":"unbind"](e+"."+da,lb).css("cursor",b?c.sliderCursor:"default").attr("title",b?c.sliderTip:"")}},Sa=function(a,b){function c(b){J.clear(a+"_closeSlider");b.stopPropagation()}var d=w[a],
e=h[a],f=q.zIndex,g=d.slideTrigger_close.toLowerCase(),j=b?"bind":"unbind",k=G[a],l=Y[a];e.isSliding=b;J.clear(a+"_closeSlider");b&&Ja(a,!1);k.css("zIndex",b?f.pane_sliding:f.pane_normal);l.css("zIndex",b?f.pane_sliding:f.resizer_normal);if(!g.match(/click|mouseleave/))g=d.slideTrigger_close="mouseleave";l[j](g,Xa);g=="mouseleave"&&(k[j]("mouseleave."+da,Xa),l[j]("mouseenter."+da,c),k[j]("mouseenter."+da,c));b?g=="click"&&!d.resizable&&(l.css("cursor",b?d.sliderCursor:"default"),l.attr("title",b?
d.togglerTip_open:"")):J.clear(a+"_closeSlider")},Da=function(a,b,c,d){var b=w[a],e=h[a],f=q[a],g=G[a],j=Y[a],k=f.dir=="vert",l=!1;if(a=="center"||k&&e.noVerticalRoom)if((l=e.maxHeight>0)&&e.noRoom){g.show();j&&j.show();e.isVisible=!0;e.noRoom=!1;if(k)e.noVerticalRoom=!1;x(a)}else if(!l&&!e.noRoom)g.hide(),j&&j.hide(),e.isVisible=!1,e.noRoom=!0;if(a!="center")if(e.minSize<=e.maxSize){if(e.size>e.maxSize?ta(a,e.maxSize,c,d):e.size<e.minSize?ta(a,e.minSize,c,d):j&&g.is(":visible")&&(c=f.side.toLowerCase(),
d=e.size+M["inset"+f.side],aa(j,c)!=d&&j.css(c,d)),e.noRoom)e.wasOpen&&b.closable?b.autoReopen?va(a,!1,!0,!0):e.noRoom=!1:Pa(a,e.wasOpen,!0,!0)}else if(!e.noRoom)e.noRoom=!0,e.wasOpen=!e.isClosed&&!e.isSliding,e.isClosed||(b.closable?ca(a,!0,!0):Wa(a,!0))},$a=function(a,b,c){var d=w[a],e=d.resizeWhileDragging&&!q.isLayoutBusy;d.autoResize=!1;ta(a,b,c,e)},ta=function(b,c,d,e){var f=w[b],g=h[b],j=G[b],k=Y[b],l=q[b].side.toLowerCase(),r="inset"+q[b].side,F=q.isLayoutBusy&&!f.triggerEventsWhileDragging,
I;U(b);I=g.size;c=ga(b,c);c=T(c,ga(b,f.minSize));c=Math.min(c,g.maxSize);if(c<g.minSize)Da(b,!1,d);else if(e||c!=I)!d&&h.initialized&&g.isVisible&&P(b,f.onresize_start),j.css(q[b].sizeType.toLowerCase(),T(1,q[b].dir=="horz"?ba(b,c):E(b,c))),g.size=c,a.extend(g,ja(j)),k&&j.is(":visible")&&k.css(l,c+M[r]),Oa(b),!d&&!F&&h.initialized&&g.isVisible&&(P(b,f.onresize_end||f.onresize),La(b)),d||(g.isSliding||Ca(q[b].dir=="horz"?"all":"center",F,e),Ra("all")),b=q.altSide[b],c<I&&h[b].noRoom&&(U(b),Da(b,!1,
d))},Ca=function(b,c,d){if(!b||b=="all")b="east,west,center";a.each(b.split(","),function(b,e){if(G[e]){var f=w[e],g=h[e],j=G[e],k=!0,l={},k={top:ia("north",!0),bottom:ia("south",!0),left:ia("west",!0),right:ia("east",!0),width:0,height:0};k.width=M.innerWidth-k.left-k.right;k.height=M.innerHeight-k.bottom-k.top;k.top+=M.insetTop;k.bottom+=M.insetBottom;k.left+=M.insetLeft;k.right+=M.insetRight;a.extend(g,ja(j));if(e=="center"){if(!d&&g.isVisible&&k.width==g.outerWidth&&k.height==g.outerHeight)return!0;
a.extend(g,ma(e),{maxWidth:k.width,maxHeight:k.height});l=k;l.width=E(e,k.width);l.height=ba(e,k.height);k=l.width>0&&l.height>0;if(!k&&!h.initialized&&f.minWidth>0){var m=f.minWidth-g.outerWidth,r=w.east.minSize||0,F=w.west.minSize||0,q=h.east.size,I=h.west.size,X=q,Q=I;m>0&&h.east.isVisible&&q>r&&(X=T(q-r,q-m),m-=q-X);m>0&&h.west.isVisible&&I>F&&(Q=T(I-F,I-m),m-=I-Q);if(m==0){q!=r&&ta("east",X,!0);I!=F&&ta("west",Q,!0);Ca("center",c,d);return}}}else{g.isVisible&&!g.noVerticalRoom&&a.extend(g,ja(j),
ma(e));if(!d&&!g.noVerticalRoom&&k.height==g.outerHeight)return!0;l.top=k.top;l.bottom=k.bottom;l.height=ba(e,k.height);g.maxHeight=T(0,l.height);k=g.maxHeight>0;if(!k)g.noVerticalRoom=!0}k?(!c&&h.initialized&&P(e,f.onresize_start),j.css(l),g.noRoom&&!g.isClosed&&!g.isHidden&&Da(e),g.isVisible&&(a.extend(g,ja(j)),h.initialized&&Oa(e))):!g.noRoom&&g.isVisible&&Da(e);if(!g.isVisible)return!0;if(e=="center")g=h.browser,g=g.isIE6||g.msie&&!g.boxModel,G.north&&(g||h.north.tagName=="IFRAME")&&G.north.css("width",
E(G.north,M.innerWidth)),G.south&&(g||h.south.tagName=="IFRAME")&&G.south.css("width",E(G.south,M.innerWidth));!c&&h.initialized&&(P(e,f.onresize_end||f.onresize),La(e))}})},Ka=function(){a.extend(h.container,ja(ra));if(M.outerHeight){if(!1===P(null,w.onresizeall_start))return!1;var b,c,d;a.each(["south","north","east","west"],function(a,b){G[b]&&(d=h[b],c=w[b],c.autoResize&&d.size!=c.size?ta(b,c.size,!0,!0):(U(b),Da(b,!1,!0,!0)))});Ca("all",!0,!0);Ra("all");c=w;a.each(q.allPanes.split(","),function(a,
d){if((b=G[d])&&h[d].isVisible)P(d,c[d].onresize_end||c[d].onresize),La(d)});P(null,c.onresizeall_end||c.onresizeall)}},La=function(a){var b=G[a],c=za[a];w[a].resizeNestedLayout&&(b.data("layoutContainer")?b.layout().resizeAll():c&&c.data("layoutContainer")&&c.layout().resizeAll())},Oa=function(b,c){if(!b||b=="all")b=q.allPanes;a.each(b.split(","),function(a,b){function d(a){return T(k.css.paddingBottom,parseInt(a.css("marginBottom"),10)||0)}function e(){var a=w[b].contentIgnoreSelector,a=g.nextAll().not(a||
":lt(0)"),c=a.filter(":visible"),f=c.filter(":last");l={top:g[0].offsetTop,height:g.outerHeight(),numFooters:a.length,hiddenFooters:a.length-c.length,spaceBelow:0};l.spaceAbove=l.top;l.bottom=l.top+l.height;l.spaceBelow=f.length?f[0].offsetTop+f.outerHeight()-l.bottom+d(f):d(g)}var f=G[b],g=za[b],j=w[b],k=h[b],l=k.content;if(!f||!g||!f.is(":visible"))return!0;if(!1!==P(null,j.onsizecontent_start)){if(!q.isLayoutBusy||l.top==void 0||c||j.resizeContentWhileDragging)e(),l.hiddenFooters>0&&f.css("overflow")==
"hidden"&&(f.css("overflow","visible"),e(),f.css("overflow","hidden"));f=k.innerHeight-(l.spaceAbove-k.css.paddingTop)-(l.spaceBelow-k.css.paddingBottom);if(!g.is(":visible")||l.height!=f)pa(g,f,!0),l.height=f;h.initialized&&(P(b,j.onsizecontent_end||j.onsizecontent),La(b))}})},Ra=function(b){if(!b||b=="all")b=q.borderPanes;a.each(b.split(","),function(b,c){var d=w[c],e=h[c],f=G[c],g=Y[c],j=la[c],k;if(f&&g){var l=q[c].dir,m=e.isClosed?"_closed":"_open",r=d["spacing"+m],F=d["togglerAlign"+m],m=d["togglerLength"+
m],I;if(r==0)g.hide();else{!e.noRoom&&!e.isHidden&&g.show();l=="horz"?(I=f.outerWidth(),e.resizerLength=I,g.css({width:T(1,E(g,I)),height:T(0,ba(g,r)),left:aa(f,"left")})):(I=f.outerHeight(),e.resizerLength=I,g.css({height:T(1,ba(g,I)),width:T(0,E(g,r)),top:M.insetTop+ia("north",!0)}));X(d,g);if(j){if(m==0||e.isSliding&&d.hideTogglerOnSlide){j.hide();return}else j.show();if(!(m>0)||m=="100%"||m>I)m=I,F=0;else if(fa(F))switch(F){case "top":case "left":F=0;break;case "bottom":case "right":F=I-m;break;
default:F=Math.floor((I-m)/2)}else f=parseInt(F,10),F=F>=0?f:I-m+f;if(l=="horz"){var Q=E(j,m);j.css({width:T(0,Q),height:T(1,ba(j,r)),left:F,top:0});j.children(".content").each(function(){k=a(this);k.css("marginLeft",Math.floor((Q-k.outerWidth())/2))})}else{var p=ba(j,m);j.css({height:T(0,p),width:T(1,E(j,r)),top:F,left:0});j.children(".content").each(function(){k=a(this);k.css("marginTop",Math.floor((p-k.outerHeight())/2))})}X(0,j)}if(!h.initialized&&(d.initHidden||e.noRoom))g.hide(),j&&j.hide()}}})},
mb=function(a){var b=la[a],c=w[a];if(b)c.closable=!0,b.bind("click."+da,function(b){b.stopPropagation();Qa(a)}).bind("mouseenter."+da,Q).bind("mouseleave."+da,X).css("visibility","visible").css("cursor","pointer").attr("title",h[a].isClosed?c.togglerTip_closed:c.togglerTip_open).show()},ra=a(this).eq(0);if(!ra.length)return null;if(ra.data("layoutContainer")&&ra.data("layout"))return ra.data("layout");var G={},za={},Y={},la={},M=h.container,da=h.id,Ga={options:w,state:h,container:ra,panes:G,contents:za,
resizers:Y,togglers:la,toggle:Qa,hide:Wa,show:Pa,open:va,close:ca,slideOpen:lb,slideClose:Xa,slideToggle:function(a){Qa(a,!0)},initContent:kb,sizeContent:Oa,sizePane:$a,swapPanes:function(b,c){function d(b){var c=G[b],e=za[b];return!c?!1:{pane:b,P:c?c[0]:!1,C:e?e[0]:!1,state:a.extend({},h[b]),options:a.extend({},w[b])}}function e(b,c){if(b){var d=b.P,f=b.C,g=b.pane,k=q[c],l=k.side.toLowerCase(),r="inset"+k.side,m=a.extend({},h[c]),F=w[c],I={resizerCursor:F.resizerCursor};a.each("fxName,fxSpeed,fxSettings".split(","),
function(a,b){I[b]=F[b];I[b+"_open"]=F[b+"_open"];I[b+"_close"]=F[b+"_close"]});G[c]=a(d).data("layoutEdge",c).css(q.hidden).css(k.cssReq);za[c]=f?a(f):!1;w[c]=a.extend({},b.options,I);h[c]=a.extend({},b.state);d.className=d.className.replace(RegExp(F.paneClass+"-"+g,"g"),F.paneClass+"-"+c);Va(c);k.dir!=q[g].dir?(d=j[c]||0,U(c),d=T(d,h[c].minSize),$a(c,d,!0)):Y[c].css(l,M[r]+(h[c].isVisible?ia(c):0));b.state.isVisible&&!m.isVisible?fb(c,!0):(eb(c),Ja(c,!0));b=null}}h[b].edge=c;h[c].edge=b;var f=!1;
!1===P(b,w[b].onswap_start)&&(f=!0);!f&&!1===P(c,w[c].onswap_start)&&(f=!0);if(f)h[b].edge=b,h[c].edge=c;else{var f=d(b),g=d(c),j={};j[b]=f?f.state.size:0;j[c]=g?g.state.size:0;G[b]=!1;G[c]=!1;h[b]={};h[c]={};la[b]&&la[b].remove();la[c]&&la[c].remove();Y[b]&&Y[b].remove();Y[c]&&Y[c].remove();Y[b]=Y[c]=la[b]=la[c]=!1;e(f,c);e(g,b);f=g=j=null;G[b]&&G[b].css(q.visible);G[c]&&G[c].css(q.visible);Ka();P(b,w[b].onswap_end||w[b].onswap);P(c,w[c].onswap_end||w[c].onswap)}},resizeAll:Ka,destroy:function(){a(window).unbind("."+
da);a(document).unbind("."+da);a.each(q.allPanes.split(","),function(a,b){db(b,!1,!0)});var b=ra.removeData("layout").removeData("layoutContainer").removeClass(w.containerClass);!b.data("layoutEdge")&&b.data("layoutCSS")&&b.css(b.data("layoutCSS")).removeData("layoutCSS");M.tagName=="BODY"&&(b=a("html")).data("layoutCSS")&&b.css(b.data("layoutCSS")).removeData("layoutCSS");Ia()},addPane:cb,removePane:db,setSizeLimits:U,bindButton:L,addToggleBtn:ha,addOpenBtn:N,addCloseBtn:O,addPinBtn:y,allowOverflow:t,
resetOverflow:v,encodeJSON:Z,decodeJSON:u,getState:oa,getCookie:n,saveCookie:W,deleteCookie:function(){W("",{expires:-1})},loadCookie:ua,loadState:na,cssWidth:E,cssHeight:ba,enableClosable:mb,disableClosable:function(a,b){var c=la[a];if(c)w[a].closable=!1,h[a].isClosed&&va(a,!1,!0),c.unbind("."+da).css("visibility",b?"hidden":"visible").css("cursor","default").attr("title","")},enableSlidable:function(a){var b=Y[a];if(b&&b.data("draggable"))w[a].slidable=!0,s.isClosed&&Ja(a,!0)},disableSlidable:function(a){var b=
Y[a];if(b)w[a].slidable=!1,h[a].isSliding?ca(a,!1,!0):(Ja(a,!1),b.css("cursor","default").attr("title",""),X(null,b[0]))},enableResizable:function(a){var b=Y[a],c=w[a];if(b&&b.data("draggable"))c.resizable=!0,b.draggable("enable").bind("mouseenter."+da,I).bind("mouseleave."+da,qa),h[a].isClosed||b.css("cursor",c.resizerCursor).attr("title",c.resizerTip)},disableResizable:function(a){var b=Y[a];if(b&&b.data("draggable"))w[a].resizable=!1,b.draggable("disable").unbind("."+da).css("cursor","default").attr("title",
""),X(null,b[0])}};(function(){wa();var b=w;if(!1===P(null,b.onload_start))return!1;if(!jb("center").length)return alert("UI Layout Initialization Error\n\nThe center-pane element does not exist.\n\nThe center-pane is a required element."),null;b.useStateCookie&&b.cookie.autoLoad&&ua();h.browser={mozilla:a.browser.mozilla,webkit:a.browser.webkit||a.browser.safari,msie:a.browser.msie,isIE6:a.browser.msie&&a.browser.version==6,boxModel:a.support.boxModel};var c=ra,d=M.tagName=a.prop?c.prop("tagName"):
c.attr("tagName"),e=d=="BODY",f={};M.selector=c.selector.split(".slice")[0];M.ref=d+"/"+M.selector;c.data("layout",Ga).data("layoutContainer",da).addClass(w.containerClass);c.data("layoutCSS")||(e?(f=a.extend(Fa(c,"position,margin,padding,border"),{height:c.css("height"),overflow:c.css("overflow"),overflowX:c.css("overflowX"),overflowY:c.css("overflowY")}),d=a("html"),d.data("layoutCSS",{height:"auto",overflow:d.css("overflow"),overflowX:d.css("overflowX"),overflowY:d.css("overflowY")})):f=Fa(c,"position,margin,padding,border,top,bottom,left,right,width,height,overflow,overflowX,overflowY"),
c.data("layoutCSS",f));try{if(e)a("html").css({height:"100%",overflow:"hidden",overflowX:"hidden",overflowY:"hidden"}),a("body").css({position:"relative",height:"100%",overflow:"hidden",overflowX:"hidden",overflowY:"hidden",margin:0,padding:0,border:"none"});else{var f={overflow:"hidden"},g=c.css("position");c.css("height");if(!c.data("layoutRole")&&(!g||!g.match(/fixed|absolute|relative/)))f.position="relative";c.css(f);c.is(":visible")&&c.innerHeight()<2&&alert("UI Layout Initialization Warning\n\nThe layout-container \"CONTAINER\" has no height.\n\nTherefore the layout is 0-height and hence 'invisible'!".replace(/CONTAINER/,
M.ref))}}catch(j){}a.extend(h.container,ja(c));bb();Oa();if(b.scrollToBookmarkOnLoad)c=self.location,c.hash&&c.replace(c.hash);ya();b.autoBindCustomButtons&&rb();b.resizeWithWindow&&!ra.data("layoutRole")&&a(window).bind("resize."+da,Na);a(window).bind("unload."+da,Ia);h.initialized=!0;P(null,b.onload_end||b.onload)})();return Ga}})(jQuery);
(function(a){function b(a){return(a=/^\s*?[\+-]?(\d*\.?\d*?)\s*?$/.exec(a))&&a.length>0?a[1]:!1}function c(b,c){var f=!1;a.each(b,function(a,b){f||(f=b==c)});return f}a.tinysort={id:"TinySort",version:"1.0.4",defaults:{order:"asc",attr:"",place:"start",returns:!1}};a.fn.extend({tinysort:function(d,e){d&&typeof d!="string"&&(e=d,d=null);var f=a.extend({},a.tinysort.defaults,e),g={};this.each(function(b){var c=!d||d==""?a(this):a(this).find(d),e=f.order=="rand"?""+Math.random():f.attr==""?c.text():
c.attr(f.attr),j=a(this).parent();g[j]||(g[j]={s:[],n:[]});c.length>0?g[j].s.push({s:e,e:a(this),n:b}):g[j].n.push({e:a(this),n:b})});for(var j in g){var k=g[j];k.s.sort(function(a,c){var d=a.s.toLowerCase?a.s.toLowerCase():a.s,e=c.s.toLowerCase?c.s.toLowerCase():c.s;b(a.s)&&b(c.s)&&(d=parseFloat(a.s),e=parseFloat(c.s));return(f.order=="asc"?1:-1)*(d<e?-1:d>e?1:0)})}var l=[];for(j in g){var k=g[j],p=[],t=a(this).length;switch(f.place){case "first":a.each(k.s,function(a,b){t=Math.min(t,b.n)});break;
case "org":a.each(k.s,function(a,b){p.push(b.n)});break;case "end":t=k.n.length;break;default:t=0}for(var v=[0,0],H=0;H<a(this).length;H++){var L=H>=t&&H<t+k.s.length;c(p,H)&&(L=!0);var ha=(L?k.s:k.n)[v[L?0:1]].e;ha.parent().append(ha);(L||!f.returns)&&l.push(ha.get(0));v[L?0:1]++}}return this.pushStack(l)}});a.fn.TinySort=a.fn.Tinysort=a.fn.tsort=a.fn.tinysort})(jQuery);
(function(){jQuery.each({getSelection:function(){var a=this.jquery?this[0]:this;return("selectionStart"in a&&function(){var b=a.selectionEnd-a.selectionStart;return{start:a.selectionStart,end:a.selectionEnd,length:b,text:a.value.substr(a.selectionStart,b)}}||document.selection&&function(){a.focus();var b=document.selection.createRange();if(b==null)return{start:0,end:a.value.length,length:0};var c=a.createTextRange(),d=c.duplicate();c.moveToBookmark(b.getBookmark());d.setEndPoint("EndToStart",c);return{start:d.text.length,
end:d.text.length+b.text.length,length:b.text.length,text:b.text}}||function(){return{start:0,end:a.value.length,length:0}})()},replaceSelection:function(a){var b=this.jquery?this[0]:this,c=a||"";return("selectionStart"in b&&function(){b.value=b.value.substr(0,b.selectionStart)+c+b.value.substr(b.selectionEnd,b.value.length);return this}||document.selection&&function(){b.focus();document.selection.createRange().text=c;return this}||function(){b.value+=c;return this})()}},function(a){jQuery.fn[a]=
this})})();
(function(){jQuery.color={};jQuery.color.make=function(a,c,d,e){var f={};f.r=a||0;f.g=c||0;f.b=d||0;f.a=e!=null?e:1;f.add=function(a,b){for(var c=0;c<a.length;++c)f[a.charAt(c)]+=b;return f.normalize()};f.scale=function(a,b){for(var c=0;c<a.length;++c)f[a.charAt(c)]*=b;return f.normalize()};f.toString=function(){return f.a>=1?"rgb("+[f.r,f.g,f.b].join(",")+")":"rgba("+[f.r,f.g,f.b,f.a].join(",")+")"};f.normalize=function(){function a(b,c,d){return c<b?b:c>d?d:c}f.r=a(0,parseInt(f.r),255);f.g=a(0,
parseInt(f.g),255);f.b=a(0,parseInt(f.b),255);f.a=a(0,f.a,1);return f};f.clone=function(){return jQuery.color.make(f.r,f.b,f.g,f.a)};return f.normalize()};jQuery.color.extract=function(a,c){var d;do{d=a.css(c).toLowerCase();if(d!=""&&d!="transparent")break;a=a.parent()}while(!jQuery.nodeName(a.get(0),"body"));d=="rgba(0, 0, 0, 0)"&&(d="transparent");return jQuery.color.parse(d)};jQuery.color.parse=function(b){var c,d=jQuery.color.make;if(c=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(b))return d(parseInt(c[1],
10),parseInt(c[2],10),parseInt(c[3],10));if(c=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(b))return d(parseInt(c[1],10),parseInt(c[2],10),parseInt(c[3],10),parseFloat(c[4]));if(c=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(b))return d(parseFloat(c[1])*2.55,parseFloat(c[2])*2.55,parseFloat(c[3])*2.55);if(c=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(b))return d(parseFloat(c[1])*
2.55,parseFloat(c[2])*2.55,parseFloat(c[3])*2.55,parseFloat(c[4]));if(c=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(b))return d(parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16));if(c=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(b))return d(parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16));b=jQuery.trim(b).toLowerCase();return b=="transparent"?d(255,255,255,0):(c=a[b],d(c[0],c[1],c[2]))};var a={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,
0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,
211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})();
(function(a){function b(b,e,f,g){function j(a,b){for(var b=[U].concat(b),c=0;c<a.length;++c)a[c].apply(this,b)}function k(b){for(var c=[],d=0;d<b.length;++d){var e=a.extend(!0,{},z.series);b[d].data?(e.data=b[d].data,delete b[d].data,a.extend(!0,e,b[d]),b[d].data=e.data):e.data=b[d];c.push(e)}R=c;c=R.length;d=[];e=[];for(b=0;b<R.length;++b){var f=R[b].color;f!=null&&(--c,typeof f=="number"?e.push(f):d.push(a.color.parse(R[b].color)))}for(b=0;b<e.length;++b)c=Math.max(c,e[b]+1);d=[];for(b=e=0;d.length<
c;)f=z.colors.length==b?a.color.make(100,100,100):a.color.parse(z.colors[b]),f.scale("rgb",1+(e%2==1?-1:1)*Math.ceil(e/2)*0.2),d.push(f),++b,b>=z.colors.length&&(b=0,++e);for(b=c=0;b<R.length;++b){e=R[b];if(e.color==null)e.color=d[c].toString(),++c;else if(typeof e.color=="number")e.color=d[e.color].toString();if(e.lines.show==null){var g,f=!0;for(g in e)if(e[g].show){f=!1;break}if(f)e.lines.show=!0}e.xaxis=l(e,"xaxis");e.yaxis=l(e,"yaxis")}p()}function l(a,b){var c=a[b];return!c||c==1?D[b]:typeof c==
"number"?D[b.charAt(0)+c+b.slice(1)]:c}function p(){function a(b,c,d){if(c<b.datamin)b.datamin=c;if(d>b.datamax)b.datamax=d}var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d,e,f,g,h,k,l,r,q,p,n;for(r in D)D[r].datamin=b,D[r].datamax=c,D[r].used=!1;for(d=0;d<R.length;++d)h=R[d],h.datapoints={points:[]},j(ia.processRawData,[h,h.data,h.datapoints]);for(d=0;d<R.length;++d){h=R[d];var t=h.data,J=h.datapoints.format;if(!J)J=[],J.push({x:!0,number:!0,required:!0}),J.push({y:!0,number:!0,required:!0}),
h.bars.show&&J.push({y:!0,number:!0,required:!1,defaultValue:0}),h.datapoints.format=J;if(h.datapoints.pointsize==null){if(h.datapoints.pointsize==null)h.datapoints.pointsize=J.length;l=h.datapoints.pointsize;k=h.datapoints.points;insertSteps=h.lines.show&&h.lines.steps;h.xaxis.used=h.yaxis.used=!0;for(e=f=0;e<t.length;++e,f+=l){n=t[e];var v=n==null;if(!v)for(g=0;g<l;++g){q=n[g];if(p=J[g])if(p.number&&q!=null&&(q=+q,isNaN(q)&&(q=null)),q==null&&(p.required&&(v=!0),p.defaultValue!=null))q=p.defaultValue;
k[f+g]=q}if(v)for(g=0;g<l;++g)q=k[f+g],q!=null&&(p=J[g],p.x&&a(h.xaxis,q,q),p.y&&a(h.yaxis,q,q)),k[f+g]=null;else if(insertSteps&&f>0&&k[f-l]!=null&&k[f-l]!=k[f]&&k[f-l+1]!=k[f+1]){for(g=0;g<l;++g)k[f+l+g]=k[f+g];k[f+1]=k[f-l+1];f+=l}}}}for(d=0;d<R.length;++d)h=R[d],j(ia.processDatapoints,[h,h.datapoints]);for(d=0;d<R.length;++d){h=R[d];k=h.datapoints.points;l=h.datapoints.pointsize;n=f=b;v=t=c;for(e=0;e<k.length;e+=l)if(k[e]!=null)for(g=0;g<l;++g)if(q=k[e+g],p=J[g])p.x&&(q<f&&(f=q),q>t&&(t=q)),p.y&&
(q<n&&(n=q),q>v&&(v=q));h.bars.show&&(e=h.bars.align=="left"?0:-h.bars.barWidth/2,h.bars.horizontal?(n+=e,v+=e+h.bars.barWidth):(f+=e,t+=e+h.bars.barWidth));a(h.xaxis,f,t);a(h.yaxis,n,v)}for(r in D){if(D[r].datamin==b)D[r].datamin=null;if(D[r].datamax==c)D[r].datamax=null}}function t(){function c(a,b){function d(a){return a}var e,f,g=b.transform||d,h=b.inverseTransform;a==D.xaxis||a==D.x2axis?(e=a.scale=pa/(g(a.max)-g(a.min)),f=g(a.min),a.p2c=g==d?function(a){return(a-f)*e}:function(a){return(g(a)-
f)*e},a.c2p=h?function(a){return h(f+a/e)}:function(a){return f+a/e}):(e=a.scale=ga/(g(a.max)-g(a.min)),f=g(a.max),a.p2c=g==d?function(a){return(f-a)*e}:function(a){return(f-g(a))*e},a.c2p=h?function(a){return h(f-a/e)}:function(a){return f-a/e})}function e(c,f){var g,h=[],j;c.labelWidth=f.labelWidth;c.labelHeight=f.labelHeight;if(c==D.xaxis||c==D.x2axis){if(c.labelWidth==null)c.labelWidth=ba/(c.ticks.length>0?c.ticks.length:1);if(c.labelHeight==null){h=[];for(g=0;g<c.ticks.length;++g)(j=c.ticks[g].label)&&
h.push('<div class="tickLabel" style="float:left;width:'+c.labelWidth+'px">'+j+"</div>");if(h.length>0)g=a('<div style="position:absolute;top:-10000px;width:10000px;font-size:smaller">'+h.join("")+'<div style="clear:left"></div></div>').appendTo(b),c.labelHeight=g.height(),g.remove()}}else if(c.labelWidth==null||c.labelHeight==null){for(g=0;g<c.ticks.length;++g)(j=c.ticks[g].label)&&h.push('<div class="tickLabel">'+j+"</div>");if(h.length>0){g=a('<div style="position:absolute;top:-10000px;font-size:smaller">'+
h.join("")+"</div>").appendTo(b);if(c.labelWidth==null)c.labelWidth=g.width();if(c.labelHeight==null)c.labelHeight=g.find("div").height();g.remove()}}if(c.labelWidth==null)c.labelWidth=0;if(c.labelHeight==null)c.labelHeight=0}function f(){var a=z.grid.borderWidth;for(i=0;i<R.length;++i)a=Math.max(a,2*(R[i].points.radius+R[i].points.lineWidth/2));E.left=E.right=E.top=E.bottom=a;var b=z.grid.labelMargin+z.grid.borderWidth;if(D.xaxis.labelHeight>0)E.bottom=Math.max(a,D.xaxis.labelHeight+b);if(D.yaxis.labelWidth>
0)E.left=Math.max(a,D.yaxis.labelWidth+b);if(D.x2axis.labelHeight>0)E.top=Math.max(a,D.x2axis.labelHeight+b);if(D.y2axis.labelWidth>0)E.right=Math.max(a,D.y2axis.labelWidth+b);pa=ba-E.left-E.right;ga=ma-E.bottom-E.top}for(var g in D)v(D[g],z[g]);if(z.grid.show){for(g in D)H(D[g],z[g]),L(D[g],z[g]),e(D[g],z[g]);f()}else E.left=E.right=E.top=E.bottom=0,pa=ba,ga=ma;for(g in D)c(D[g],z[g]);z.grid.show&&y();na()}function v(a,b){var c=+(b.min!=null?b.min:a.datamin),d=+(b.max!=null?b.max:a.datamax),e=d-
c;if(e==0){if(e=d==0?1:0.01,b.min==null&&(c-=e),b.max==null||b.min!=null)d+=e}else{var f=b.autoscaleMargin;f!=null&&(b.min==null&&(c-=e*f,c<0&&a.datamin!=null&&a.datamin>=0&&(c=0)),b.max==null&&(d+=e*f,d>0&&a.datamax!=null&&a.datamax<=0&&(d=0)))}a.min=c;a.max=d}function H(b,d){var e;e=typeof d.ticks=="number"&&d.ticks>0?d.ticks:b==D.xaxis||b==D.x2axis?0.3*Math.sqrt(ba):0.3*Math.sqrt(ma);var f=(b.max-b.min)/e,g,h;if(d.mode=="time"){var j={second:1E3,minute:6E4,hour:36E5,day:864E5,month:2592E6,year:525949.2*
6E4};h=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[0.25,"month"],[0.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]];e=0;d.minTickSize!=null&&(e=typeof d.tickSize=="number"?d.tickSize:d.minTickSize[0]*j[d.minTickSize[1]]);for(g=0;g<h.length-1;++g)if(f<(h[g][0]*j[h[g][1]]+h[g+1][0]*j[h[g+1][1]])/2&&h[g][0]*
j[h[g][1]]>=e)break;e=h[g][0];g=h[g][1];g=="year"&&(h=Math.pow(10,Math.floor(Math.log(f/j.year)/Math.LN10)),f=f/j.year/h,e=f<1.5?1:f<3?2:f<7.5?5:10,e*=h);d.tickSize&&(e=d.tickSize[0],g=d.tickSize[1]);f=function(a){var b=[],d=a.tickSize[0],e=a.tickSize[1],f=new Date(a.min),g=d*j[e];e=="second"&&f.setUTCSeconds(c(f.getUTCSeconds(),d));e=="minute"&&f.setUTCMinutes(c(f.getUTCMinutes(),d));e=="hour"&&f.setUTCHours(c(f.getUTCHours(),d));e=="month"&&f.setUTCMonth(c(f.getUTCMonth(),d));e=="year"&&f.setUTCFullYear(c(f.getUTCFullYear(),
d));f.setUTCMilliseconds(0);g>=j.minute&&f.setUTCSeconds(0);g>=j.hour&&f.setUTCMinutes(0);g>=j.day&&f.setUTCHours(0);g>=j.day*4&&f.setUTCDate(1);g>=j.year&&f.setUTCMonth(0);var h=0,k=Number.NaN,l;do if(l=k,k=f.getTime(),b.push({v:k,label:a.tickFormatter(k,a)}),e=="month")if(d<1){f.setUTCDate(1);var r=f.getTime();f.setUTCMonth(f.getUTCMonth()+1);var q=f.getTime();f.setTime(k+h*j.hour+(q-r)*d);h=f.getUTCHours();f.setUTCHours(0)}else f.setUTCMonth(f.getUTCMonth()+d);else e=="year"?f.setUTCFullYear(f.getUTCFullYear()+
d):f.setTime(k+g);while(k<a.max&&k!=l);return b};h=function(b,c){var e=new Date(b);if(d.timeformat!=null)return a.plot.formatDate(e,d.timeformat,d.monthNames);var f=c.tickSize[0]*j[c.tickSize[1]],g=c.max-c.min,h=d.twelveHourClock?" %p":"";fmt=f<j.minute?"%h:%M:%S"+h:f<j.day?g<2*j.day?"%h:%M"+h:"%b %d %h:%M"+h:f<j.month?"%b %d":f<j.year?g<j.year?"%b":"%b %y":"%y";return a.plot.formatDate(e,fmt,d.monthNames)}}else{var k=d.tickDecimals,l=-Math.floor(Math.log(f)/Math.LN10);k!=null&&l>k&&(l=k);h=Math.pow(10,
-l);f/=h;if(f<1.5)e=1;else if(f<3){if(e=2,f>2.25&&(k==null||l+1<=k))e=2.5,++l}else e=f<7.5?5:10;e*=h;if(d.minTickSize!=null&&e<d.minTickSize)e=d.minTickSize;if(d.tickSize!=null)e=d.tickSize;b.tickDecimals=Math.max(0,k!=null?k:l);f=function(a){var b=[],d=c(a.min,a.tickSize),e=0,f=Number.NaN,g;do g=f,f=d+e*a.tickSize,b.push({v:f,label:a.tickFormatter(f,a)}),++e;while(f<a.max&&f!=g);return b};h=function(a,b){return a.toFixed(b.tickDecimals)}}b.tickSize=g?[e,g]:e;b.tickGenerator=f;b.tickFormatter=a.isFunction(d.tickFormatter)?
function(a,b){return""+d.tickFormatter(a,b)}:h}function L(b,c){b.ticks=[];if(b.used){if(c.ticks==null)b.ticks=b.tickGenerator(b);else if(typeof c.ticks=="number"){if(c.ticks>0)b.ticks=b.tickGenerator(b)}else if(c.ticks){var d=c.ticks;a.isFunction(d)&&(d=d({min:b.min,max:b.max}));var e,f;for(e=0;e<d.length;++e){var g=null,h=d[e];typeof h=="object"?(f=h[0],h.length>1&&(g=h[1])):f=h;g==null&&(g=b.tickFormatter(f,b));b.ticks[e]={v:f,label:g}}}if(c.autoscaleMargin!=null&&b.ticks.length>0){if(c.min==null)b.min=
Math.min(b.min,b.ticks[0].v);if(c.max==null&&b.ticks.length>1)b.max=Math.max(b.max,b.ticks[b.ticks.length-1].v)}}}function ha(){x.clearRect(0,0,ba,ma);var a=z.grid;a.show&&!a.aboveData&&O();for(var b=0;b<R.length;++b){var c=R[b];c.lines.show&&ea(c);c.bars.show&&W(c);c.points.show&&V(c)}j(ia.draw,[x]);a.show&&a.aboveData&&O()}function N(a,b){var c=b+"axis",d=b+"2axis",e,f;a[c]?(e=D[c],f=a[c].from,c=a[c].to):a[d]?(e=D[d],f=a[d].from,c=a[d].to):(e=D[c],f=a[b+"1"],c=a[b+"2"]);return f!=null&&c!=null&&
f>c?{from:c,to:f,axis:e}:{from:f,to:c,axis:e}}function O(){var b;x.save();x.translate(E.left,E.top);if(z.grid.backgroundColor)x.fillStyle=T(z.grid.backgroundColor,ga,0,"rgba(255, 255, 255, 0)"),x.fillRect(0,0,pa,ga);var c=z.grid.markings;if(c){a.isFunction(c)&&(c=c({xmin:D.xaxis.min,xmax:D.xaxis.max,ymin:D.yaxis.min,ymax:D.yaxis.max,xaxis:D.xaxis,yaxis:D.yaxis,x2axis:D.x2axis,y2axis:D.y2axis}));for(b=0;b<c.length;++b){var d=c[b],e=N(d,"x"),f=N(d,"y");if(e.from==null)e.from=e.axis.min;if(e.to==null)e.to=
e.axis.max;if(f.from==null)f.from=f.axis.min;if(f.to==null)f.to=f.axis.max;if(!(e.to<e.axis.min||e.from>e.axis.max||f.to<f.axis.min||f.from>f.axis.max))if(e.from=Math.max(e.from,e.axis.min),e.to=Math.min(e.to,e.axis.max),f.from=Math.max(f.from,f.axis.min),f.to=Math.min(f.to,f.axis.max),!(e.from==e.to&&f.from==f.to))e.from=e.axis.p2c(e.from),e.to=e.axis.p2c(e.to),f.from=f.axis.p2c(f.from),f.to=f.axis.p2c(f.to),e.from==e.to||f.from==f.to?(x.beginPath(),x.strokeStyle=d.color||z.grid.markingsColor,x.lineWidth=
d.lineWidth||z.grid.markingsLineWidth,x.moveTo(e.from,f.from),x.lineTo(e.to,f.to),x.stroke()):(x.fillStyle=d.color||z.grid.markingsColor,x.fillRect(e.from,f.to,e.to-e.from,f.from-f.to))}}x.lineWidth=1;x.strokeStyle=z.grid.tickColor;x.beginPath();d=D.xaxis;for(b=0;b<d.ticks.length;++b)c=d.ticks[b].v,c<=d.min||c>=D.xaxis.max||(x.moveTo(Math.floor(d.p2c(c))+x.lineWidth/2,0),x.lineTo(Math.floor(d.p2c(c))+x.lineWidth/2,ga));d=D.yaxis;for(b=0;b<d.ticks.length;++b)c=d.ticks[b].v,c<=d.min||c>=d.max||(x.moveTo(0,
Math.floor(d.p2c(c))+x.lineWidth/2),x.lineTo(pa,Math.floor(d.p2c(c))+x.lineWidth/2));d=D.x2axis;for(b=0;b<d.ticks.length;++b)c=d.ticks[b].v,c<=d.min||c>=d.max||(x.moveTo(Math.floor(d.p2c(c))+x.lineWidth/2,-5),x.lineTo(Math.floor(d.p2c(c))+x.lineWidth/2,5));d=D.y2axis;for(b=0;b<d.ticks.length;++b)c=d.ticks[b].v,c<=d.min||c>=d.max||(x.moveTo(pa-5,Math.floor(d.p2c(c))+x.lineWidth/2),x.lineTo(pa+5,Math.floor(d.p2c(c))+x.lineWidth/2));x.stroke();if(z.grid.borderWidth)b=z.grid.borderWidth,x.lineWidth=b,
x.strokeStyle=z.grid.borderColor,x.strokeRect(-b/2,-b/2,pa+b,ga+b);x.restore()}function y(){function a(b,d){for(var e=0;e<b.ticks.length;++e){var f=b.ticks[e];f.label&&!(f.v<b.min||f.v>b.max)&&c.push(d(f,b))}}b.find(".tickLabels").remove();var c=['<div class="tickLabels" style="font-size:smaller;color:'+z.grid.color+'">'],e=z.grid.labelMargin+z.grid.borderWidth;a(D.xaxis,function(a,b){return'<div style="position:absolute;top:'+(E.top+ga+e)+"px;left:"+Math.round(E.left+b.p2c(a.v)-b.labelWidth/2)+"px;width:"+
b.labelWidth+'px;text-align:center" class="tickLabel">'+a.label+"</div>"});a(D.yaxis,function(a,b){return'<div style="position:absolute;top:'+Math.round(E.top+b.p2c(a.v)-b.labelHeight/2)+"px;right:"+(E.right+pa+e)+"px;width:"+b.labelWidth+'px;text-align:right" class="tickLabel">'+a.label+"</div>"});a(D.x2axis,function(a,b){return'<div style="position:absolute;bottom:'+(E.bottom+ga+e)+"px;left:"+Math.round(E.left+b.p2c(a.v)-b.labelWidth/2)+"px;width:"+b.labelWidth+'px;text-align:center" class="tickLabel">'+
a.label+"</div>"});a(D.y2axis,function(a,b){return'<div style="position:absolute;top:'+Math.round(E.top+b.p2c(a.v)-b.labelHeight/2)+"px;left:"+(E.left+pa+e)+"px;width:"+b.labelWidth+'px;text-align:left" class="tickLabel">'+a.label+"</div>"});c.push("</div>");b.append(c.join(""))}function ea(a){function b(a,c,d,e,f){var g=a.points,a=a.pointsize,h=null,j=null;x.beginPath();for(var k=a;k<g.length;k+=a){var l=g[k-a],r=g[k-a+1],q=g[k],p=g[k+1];if(!(l==null||q==null)){if(r<=p&&r<f.min){if(p<f.min)continue;
l=(f.min-r)/(p-r)*(q-l)+l;r=f.min}else if(p<=r&&p<f.min){if(r<f.min)continue;q=(f.min-r)/(p-r)*(q-l)+l;p=f.min}if(r>=p&&r>f.max){if(p>f.max)continue;l=(f.max-r)/(p-r)*(q-l)+l;r=f.max}else if(p>=r&&p>f.max){if(r>f.max)continue;q=(f.max-r)/(p-r)*(q-l)+l;p=f.max}if(l<=q&&l<e.min){if(q<e.min)continue;r=(e.min-l)/(q-l)*(p-r)+r;l=e.min}else if(q<=l&&q<e.min){if(l<e.min)continue;p=(e.min-l)/(q-l)*(p-r)+r;q=e.min}if(l>=q&&l>e.max){if(q>e.max)continue;r=(e.max-l)/(q-l)*(p-r)+r;l=e.max}else if(q>=l&&q>e.max){if(l>
e.max)continue;p=(e.max-l)/(q-l)*(p-r)+r;q=e.max}(l!=h||r!=j)&&x.moveTo(e.p2c(l)+c,f.p2c(r)+d);h=q;j=p;x.lineTo(e.p2c(q)+c,f.p2c(p)+d)}}x.stroke()}function c(a,b,d){var e=a.points,a=a.pointsize,f=Math.min(Math.max(0,d.min),d.max),g;g=0;for(var h=!1,j=a;j<e.length;j+=a){var k=e[j-a],l=e[j-a+1],r=e[j],q=e[j+1];if(h&&k!=null&&r==null)x.lineTo(b.p2c(g),d.p2c(f)),x.fill(),h=!1;else if(!(k==null||r==null)){if(k<=r&&k<b.min){if(r<b.min)continue;l=(b.min-k)/(r-k)*(q-l)+l;k=b.min}else if(r<=k&&r<b.min){if(k<
b.min)continue;q=(b.min-k)/(r-k)*(q-l)+l;r=b.min}if(k>=r&&k>b.max){if(r>b.max)continue;l=(b.max-k)/(r-k)*(q-l)+l;k=b.max}else if(r>=k&&r>b.max){if(k>b.max)continue;q=(b.max-k)/(r-k)*(q-l)+l;r=b.max}h||(x.beginPath(),x.moveTo(b.p2c(k),d.p2c(f)),h=!0);if(l>=d.max&&q>=d.max)x.lineTo(b.p2c(k),d.p2c(d.max)),x.lineTo(b.p2c(r),d.p2c(d.max)),g=r;else if(l<=d.min&&q<=d.min)x.lineTo(b.p2c(k),d.p2c(d.min)),x.lineTo(b.p2c(r),d.p2c(d.min)),g=r;else{var p=k,n=r;if(l<=q&&l<d.min&&q>=d.min)k=(d.min-l)/(q-l)*(r-k)+
k,l=d.min;else if(q<=l&&q<d.min&&l>=d.min)r=(d.min-l)/(q-l)*(r-k)+k,q=d.min;if(l>=q&&l>d.max&&q<=d.max)k=(d.max-l)/(q-l)*(r-k)+k,l=d.max;else if(q>=l&&q>d.max&&l<=d.max)r=(d.max-l)/(q-l)*(r-k)+k,q=d.max;k!=p&&(g=l<=d.min?d.min:d.max,x.lineTo(b.p2c(p),d.p2c(g)),x.lineTo(b.p2c(k),d.p2c(g)));x.lineTo(b.p2c(k),d.p2c(l));x.lineTo(b.p2c(r),d.p2c(q));r!=n&&(g=q<=d.min?d.min:d.max,x.lineTo(b.p2c(r),d.p2c(g)),x.lineTo(b.p2c(n),d.p2c(g)));g=Math.max(r,n)}}}h&&(x.lineTo(b.p2c(g),d.p2c(f)),x.fill())}x.save();
x.translate(E.left,E.top);x.lineJoin="round";var d=a.lines.lineWidth,e=a.shadowSize;if(d>0&&e>0){x.lineWidth=e;x.strokeStyle="rgba(0,0,0,0.1)";var f=Math.PI/18;b(a.datapoints,Math.sin(f)*(d/2+e/2),Math.cos(f)*(d/2+e/2),a.xaxis,a.yaxis);x.lineWidth=e/2;b(a.datapoints,Math.sin(f)*(d/2+e/4),Math.cos(f)*(d/2+e/4),a.xaxis,a.yaxis)}x.lineWidth=d;x.strokeStyle=a.color;if(e=ua(a.lines,a.color,0,ga))x.fillStyle=e,c(a.datapoints,a.xaxis,a.yaxis);d>0&&b(a.datapoints,0,0,a.xaxis,a.yaxis);x.restore()}function V(a){function b(a,
c,d,e,f,g,h){for(var j=a.points,a=a.pointsize,k=0;k<j.length;k+=a){var l=j[k],r=j[k+1];if(!(l==null||l<g.min||l>g.max||r<h.min||r>h.max)){x.beginPath();x.arc(g.p2c(l),h.p2c(r)+e,c,0,f,!1);if(d)x.fillStyle=d,x.fill();x.stroke()}}}x.save();x.translate(E.left,E.top);var c=a.lines.lineWidth,d=a.shadowSize,e=a.points.radius;if(c>0&&d>0)d/=2,x.lineWidth=d,x.strokeStyle="rgba(0,0,0,0.1)",b(a.datapoints,e,null,d+d/2,Math.PI,a.xaxis,a.yaxis),x.strokeStyle="rgba(0,0,0,0.2)",b(a.datapoints,e,null,d/2,Math.PI,
a.xaxis,a.yaxis);x.lineWidth=c;x.strokeStyle=a.color;b(a.datapoints,e,ua(a.points,a.color),0,2*Math.PI,a.xaxis,a.yaxis);x.restore()}function n(a,b,c,d,e,f,g,h,j,k,l){var r,q,p,n;l?(n=q=p=!0,r=!1,l=c,c=b+d,e=b+e,a<l&&(b=a,a=l,l=b,r=!0,q=!1)):(r=q=p=!0,n=!1,l=a+d,a+=e,e=c,c=b,c<e&&(b=c,c=e,e=b,n=!0,p=!1));if(!(a<h.min||l>h.max||c<j.min||e>j.max)){if(l<h.min)l=h.min,r=!1;if(a>h.max)a=h.max,q=!1;if(e<j.min)e=j.min,n=!1;if(c>j.max)c=j.max,p=!1;l=h.p2c(l);e=j.p2c(e);a=h.p2c(a);c=j.p2c(c);if(g)k.beginPath(),
k.moveTo(l,e),k.lineTo(l,c),k.lineTo(a,c),k.lineTo(a,e),k.fillStyle=g(e,c),k.fill();if(r||q||p||n)k.beginPath(),k.moveTo(l,e+f),r?k.lineTo(l,c+f):k.moveTo(l,c+f),p?k.lineTo(a,c+f):k.moveTo(a,c+f),q?k.lineTo(a,e+f):k.moveTo(a,e+f),n?k.lineTo(l,e+f):k.moveTo(l,e+f),k.stroke()}}function W(a){x.save();x.translate(E.left,E.top);x.lineWidth=a.bars.lineWidth;x.strokeStyle=a.color;var b=a.bars.align=="left"?0:-a.bars.barWidth/2;(function(b,c,d,e,f,g,h){for(var j=b.points,b=b.pointsize,k=0;k<j.length;k+=b)j[k]!=
null&&n(j[k],j[k+1],j[k+2],c,d,e,f,g,h,x,a.bars.horizontal)})(a.datapoints,b,b+a.bars.barWidth,0,a.bars.fill?function(b,c){return ua(a.bars,a.color,b,c)}:null,a.xaxis,a.yaxis);x.restore()}function ua(b,c,d,e){var f=b.fill;if(!f)return null;if(b.fillColor)return T(b.fillColor,d,e,c);b=a.color.parse(c);b.a=typeof f=="number"?f:0.4;b.normalize();return b.toString()}function na(){b.find(".legend").remove();if(z.legend.show){var c=[],e=!1,f=z.legend.labelFormatter,g,h;for(i=0;i<R.length;++i)if(g=R[i],
h=g.label)i%z.legend.noColumns==0&&(e&&c.push("</tr>"),c.push("<tr>"),e=!0),f&&(h=f(h,g)),c.push('<td class="legendColorBox"><div style="border:1px solid '+z.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+g.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+h+"</td>");e&&c.push("</tr>");if(c.length!=0)if(e='<table style="font-size:smaller;color:'+z.grid.color+'">'+c.join("")+"</table>",z.legend.container!=null)a(z.legend.container).html(e);
else if(c="",f=z.legend.position,g=z.legend.margin,g[0]==null&&(g=[g,g]),f.charAt(0)=="n"?c+="top:"+(g[1]+E.top)+"px;":f.charAt(0)=="s"&&(c+="bottom:"+(g[1]+E.bottom)+"px;"),f.charAt(1)=="e"?c+="right:"+(g[0]+E.right)+"px;":f.charAt(1)=="w"&&(c+="left:"+(g[0]+E.left)+"px;"),e=a('<div class="legend">'+e.replace('style="','style="position:absolute;'+c+";")+"</div>").appendTo(b),z.legend.backgroundOpacity!=0){f=z.legend.backgroundColor;if(f==null)f=(f=z.grid.backgroundColor)&&typeof f=="string"?a.color.parse(f):
a.color.extract(e,"background-color"),f.a=1,f=f.toString();g=e.children();a('<div style="position:absolute;width:'+g.width()+"px;height:"+g.height()+"px;"+c+"background-color:"+f+';"> </div>').prependTo(e).css("opacity",z.legend.backgroundOpacity)}}}function oa(a){z.grid.hoverable&&u("plothover",a,function(a){return a.hoverable!=!1})}function Z(a){u("plotclick",a,function(a){return a.clickable!=!1})}function u(a,c,e){var f=Ba.offset(),g={pageX:c.pageX,pageY:c.pageY},j=c.pageX-f.left-E.left,c=c.pageY-
f.top-E.top;if(D.xaxis.used)g.x=D.xaxis.c2p(j);if(D.yaxis.used)g.y=D.yaxis.c2p(c);if(D.x2axis.used)g.x2=D.x2axis.c2p(j);if(D.y2axis.used)g.y2=D.y2axis.c2p(c);var k=z.grid.mouseActiveRadius,l=k*k+1,r=null,p,n;for(p=0;p<R.length;++p)if(e(R[p])){var t=R[p],J=t.xaxis,v=t.yaxis,u=t.datapoints.points,w=t.datapoints.pointsize,fa=J.c2p(j),L=v.c2p(c),T=k/J.scale,x=k/v.scale;if(t.lines.show||t.points.show)for(n=0;n<u.length;n+=w){var H=u[n],y=u[n+1];if(H!=null&&!(H-fa>T||H-fa<-T||y-L>x||y-L<-x))H=Math.abs(J.p2c(H)-
j),y=Math.abs(v.p2c(y)-c),y=H*H+y*y,y<=l&&(l=y,r=[p,n/w])}if(t.bars.show&&!r){J=t.bars.align=="left"?0:-t.bars.barWidth/2;t=J+t.bars.barWidth;for(n=0;n<u.length;n+=w)if(H=u[n],y=u[n+1],v=u[n+2],H!=null&&(R[p].bars.horizontal?fa<=Math.max(v,H)&&fa>=Math.min(v,H)&&L>=y+J&&L<=y+t:fa>=H+J&&fa<=H+t&&L>=Math.min(v,y)&&L<=Math.max(v,y)))r=[p,n/w]}}r?(p=r[0],n=r[1],w=R[p].datapoints.pointsize,e={datapoint:R[p].datapoints.points.slice(n*w,(n+1)*w),dataIndex:n,series:R[p],seriesIndex:p}):e=null;if(e)e.pageX=
parseInt(e.series.xaxis.p2c(e.datapoint[0])+f.left+E.left),e.pageY=parseInt(e.series.yaxis.p2c(e.datapoint[1])+f.top+E.top);if(z.grid.autoHighlight){for(f=0;f<ja.length;++f)j=ja[f],j.auto==a&&(!e||!(j.series==e.series&&j.point==e.datapoint))&&q(j.series,j.point);e&&h(e.series,e.datapoint,a)}b.trigger(a,[g,e])}function w(){Fa||(Fa=setTimeout(r,30))}function r(){Fa=null;aa.save();aa.clearRect(0,0,ba,ma);aa.translate(E.left,E.top);var b,c;for(b=0;b<ja.length;++b)if(c=ja[b],c.series.bars.show)fa(c.series,
c.point);else{var d=c.series,e=c.point;c=e[0];var e=e[1],f=d.xaxis,g=d.yaxis;if(!(c<f.min||c>f.max||e<g.min||e>g.max)){var h=d.points.radius+d.points.lineWidth/2;aa.lineWidth=h;aa.strokeStyle=a.color.parse(d.color).scale("a",0.5).toString();d=1.5*h;aa.beginPath();aa.arc(f.p2c(c),g.p2c(e),d,0,2*Math.PI,!1);aa.stroke()}}aa.restore();j(ia.drawOverlay,[aa])}function h(a,b,c){typeof a=="number"&&(a=R[a]);typeof b=="number"&&(b=a.data[b]);var d=J(a,b);if(d==-1)ja.push({series:a,point:b,auto:c}),w();else if(!c)ja[d].auto=
!1}function q(a,b){a==null&&b==null&&(ja=[],w());typeof a=="number"&&(a=R[a]);typeof b=="number"&&(b=a.data[b]);var c=J(a,b);c!=-1&&(ja.splice(c,1),w())}function J(a,b){for(var c=0;c<ja.length;++c){var d=ja[c];if(d.series==a&&d.point[0]==b[0]&&d.point[1]==b[1])return c}return-1}function fa(b,c){aa.lineWidth=b.bars.lineWidth;aa.strokeStyle=a.color.parse(b.color).scale("a",0.5).toString();var d=a.color.parse(b.color).scale("a",0.5).toString(),e=b.bars.align=="left"?0:-b.bars.barWidth/2;n(c[0],c[1],
c[2]||0,e,e+b.bars.barWidth,0,function(){return d},b.xaxis,b.yaxis,aa,b.bars.horizontal)}function T(b,c,d,e){if(typeof b=="string")return b;else{for(var c=x.createLinearGradient(0,d,0,c),d=0,f=b.colors.length;d<f;++d){var g=b.colors[d];typeof g!="string"&&(g=a.color.parse(e).scale("rgb",g.brightness),g.a*=g.opacity,g=g.toString());c.addColorStop(d/(f-1),g)}return c}}var R=[],z={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",
container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:0.85},xaxis:{mode:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,tickDecimals:null,tickSize:null,minTickSize:null,monthNames:null,timeformat:null,twelveHourClock:!1},yaxis:{autoscaleMargin:0.02},x2axis:{autoscaleMargin:null},y2axis:{autoscaleMargin:0.02},series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff"},
lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1},shadowSize:3},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,tickColor:"rgba(0,0,0,0.15)",labelMargin:5,borderWidth:2,borderColor:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},hooks:{}},Ha=null,P=null,Ba=null,x=null,aa=null,D={xaxis:{},yaxis:{},x2axis:{},y2axis:{}},
E={left:0,right:0,top:0,bottom:0},ba=0,ma=0,pa=0,ga=0,ia={processOptions:[],processRawData:[],processDatapoints:[],draw:[],bindEvents:[],drawOverlay:[]},U=this;U.setData=k;U.setupGrid=t;U.draw=ha;U.getPlaceholder=function(){return b};U.getCanvas=function(){return Ha};U.getPlotOffset=function(){return E};U.width=function(){return pa};U.height=function(){return ga};U.offset=function(){var a=Ba.offset();a.left+=E.left;a.top+=E.top;return a};U.getData=function(){return R};U.getAxes=function(){return D};
U.getOptions=function(){return z};U.highlight=h;U.unhighlight=q;U.triggerRedrawOverlay=w;U.pointOffset=function(a){return{left:parseInt(l(a,"xaxis").p2c(+a.x)+E.left),top:parseInt(l(a,"yaxis").p2c(+a.y)+E.top)}};U.hooks=ia;(function(){for(var b=0;b<g.length;++b){var c=g[b];c.init(U);c.options&&a.extend(!0,z,c.options)}})(U);(function(b){a.extend(!0,z,b);if(z.grid.borderColor==null)z.grid.borderColor=z.grid.color;if(z.xaxis.noTicks&&z.xaxis.ticks==null)z.xaxis.ticks=z.xaxis.noTicks;if(z.yaxis.noTicks&&
z.yaxis.ticks==null)z.yaxis.ticks=z.yaxis.noTicks;if(z.grid.coloredAreas)z.grid.markings=z.grid.coloredAreas;if(z.grid.coloredAreasColor)z.grid.markingsColor=z.grid.coloredAreasColor;z.lines&&a.extend(!0,z.series.lines,z.lines);z.points&&a.extend(!0,z.series.points,z.points);z.bars&&a.extend(!0,z.series.bars,z.bars);if(z.shadowSize)z.series.shadowSize=z.shadowSize;for(var c in ia)z.hooks[c]&&z.hooks[c].length&&(ia[c]=ia[c].concat(z.hooks[c]));j(ia.processOptions,[z])})(f);(function(){function c(b,
d){var e=document.createElement("canvas");e.width=b;e.height=d;a.browser.msie&&(e=window.G_vmlCanvasManager.initElement(e));return e}ba=b.width();ma=b.height();b.html("");b.css("position")=="static"&&b.css("position","relative");if(ba<=0||ma<=0)throw"Invalid dimensions for plot, width = "+ba+", height = "+ma;a.browser.msie&&window.G_vmlCanvasManager.init_(document);Ha=a(c(ba,ma)).appendTo(b).get(0);x=Ha.getContext("2d");P=a(c(ba,ma)).css({position:"absolute",left:0,top:0}).appendTo(b).get(0);aa=P.getContext("2d");
aa.stroke()})();k(e);t();ha();Ba=a([P,Ha]);z.grid.hoverable&&Ba.mousemove(oa);z.grid.clickable&&Ba.click(Z);j(ia.bindEvents,[Ba]);var ja=[],Fa=null}function c(a,b){return b*Math.floor(a/b)}a.plot=function(c,e,f){return new b(a(c),e,f,a.plot.plugins)};a.plot.plugins=[];a.plot.formatDate=function(a,b,c){var g=function(a){a=""+a;return a.length==1?"0"+a:a},j=[],k=!1,l=a.getUTCHours(),p=l<12;c==null&&(c="Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","));b.search(/%p|%P/)!=-1&&(l>12?l-=12:l==
0&&(l=12));for(var t=0;t<b.length;++t){var v=b.charAt(t);if(k){switch(v){case "h":v=""+l;break;case "H":v=g(l);break;case "M":v=g(a.getUTCMinutes());break;case "S":v=g(a.getUTCSeconds());break;case "d":v=""+a.getUTCDate();break;case "m":v=""+(a.getUTCMonth()+1);break;case "y":v=""+a.getUTCFullYear();break;case "b":v=""+c[a.getUTCMonth()];break;case "p":v=p?"am":"pm";break;case "P":v=p?"AM":"PM"}j.push(v);k=!1}else v=="%"?k=!0:j.push(v)}return j.join("")}})(jQuery);
(function(a){function b(b,d){this.$element=a(b);this.options=d;this.enabled=!0;this.fixTitle()}b.prototype={show:function(){var b=this.getTitle();if(b&&this.enabled){var d=this.tip();d.find(".tipsy-inner")[this.options.html?"html":"text"](b);d[0].className="tipsy";d.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);var b=a.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),e=d[0].offsetWidth,f=d[0].offsetHeight,
g=typeof this.options.gravity=="function"?this.options.gravity.call(this.$element[0]):this.options.gravity,j;switch(g.charAt(0)){case "n":j={top:b.top+b.height+this.options.offset,left:b.left+b.width/2-e/2-this.options.offsetOpposite};break;case "s":j={top:b.top-f-this.options.offset,left:b.left+b.width/2-e/2-this.options.offsetOpposite};break;case "e":j={top:b.top+b.height/2-f/2-this.options.offsetOpposite,left:b.left-e-this.options.offset};break;case "w":j={top:b.top+b.height/2-f/2-this.options.offsetOpposite,
left:b.left+b.width+this.options.offset}}if(g.length==2)j.left=g.charAt(1)=="w"?b.left+b.width/2-15-this.options.offsetOpposite:b.left+b.width/2-e+15-this.options.offsetOpposite;d.css(j).addClass("tipsy-"+g);this.options.fade?d.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):d.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){a(this).remove()}):this.tip().remove()},
fixTitle:function(){var a=this.$element;if(a.attr("title")||typeof a.attr("original-title")!="string")a.attr("original-title",a.attr("title")||"").removeAttr("title")},getTitle:function(){var a,b=this.$element,e=this.options;this.fixTitle();e=this.options;typeof e.title=="string"?a=b.attr(e.title=="title"?"original-title":e.title):typeof e.title=="function"&&(a=e.title.call(b[0]));return(a=(""+a).replace(/(^\s*|\s*$)/,""))||e.fallback},tip:function(){if(!this.$tip)this.$tip=a('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>');
return this.$tip},validate:function(){if(!this.$element[0].parentNode)this.hide(),this.options=this.$element=null},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}};a.fn.tipsy=function(c){function d(d){var e=a.data(d,"tipsy");e||(e=new b(d,a.fn.tipsy.elementOptions(d,c)),a.data(d,"tipsy",e));return e}function e(){var a=d(this);a.hoverState="in";c.delayIn==0?a.show():(a.fixTitle(),setTimeout(function(){a.hoverState=="in"&&a.show()},
c.delayIn))}function f(){var a=d(this);a.hoverState="out";c.delayOut==0?a.hide():setTimeout(function(){a.hoverState=="out"&&a.hide()},c.delayOut)}if(c===!0)return this.data("tipsy");else if(typeof c=="string"){var g=this.data("tipsy");if(g)g[c]();return this}c=a.extend({},a.fn.tipsy.defaults,c);c.live||this.each(function(){d(this)});if(c.trigger!="manual"){var g=c.live?"live":"bind",j=c.trigger=="hover"?"mouseleave":"blur";this[g](c.trigger=="hover"?"mouseenter":"focus",e)[g](j,f)}return this};a.fn.tipsy.defaults=
{delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,offset:0,offsetOpposite:0,opacity:0.8,title:"title",trigger:"hover"};a.fn.tipsy.elementOptions=function(b,d){return a.metadata?a.extend({},d,a(b).metadata()):d};a.fn.tipsy.autoNS=function(){return a(this).offset().top>a(document).scrollTop()+a(window).height()/2?"s":"n"};a.fn.tipsy.autoWE=function(){return a(this).offset().left>a(document).scrollLeft()+a(window).width()/2?"e":"w"}})(jQuery);
window.Inflector={small:"(a|an|and|as|at|but|by|en|for|if|in|of|on|or|the|to|v[.]?|via|vs[.]?)",punct:"([!\"#$%&'()*+,./:;<=>?@[\\\\\\]^_`{|}~-]*)",titleize:function(a){for(var a=a.replace(/[-.\/_]/g," ").replace(/\s+/gm," "),b=this.capitalize,c=[],d=/[:.;?!] |(?: |^)["\u00d2]/g,e=0;;){var f=d.exec(a);c.push(a.substring(e,f?f.index:a.length).replace(/\b([A-Za-z][a-z.'\u00d5]*)\b/g,function(a){return/[A-Za-z]\.[A-Za-z]/.test(a)?a:b(a)}).replace(RegExp("\\b"+this.small+"\\b","ig"),this.lowercase).replace(RegExp("^"+
this.punct+this.small+"\\b","ig"),function(a,c,d){return c+b(d)}).replace(RegExp("\\b"+this.small+this.punct+"$","ig"),b));e=d.lastIndex;if(f)c.push(f[0]);else break}return c.join("").replace(/ V(s?)\. /ig," v$1. ").replace(/(['\u00d5])S\b/ig,"$1s").replace(/\b(AT&T|Q&A)\b/ig,function(a){return a.toUpperCase()})},trim:function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},trimExcerpt:function(a){a=a.replace(/^([^<>]{0,100}?[.,!]|[^<>\s]+)/g,"");a=a.replace(/(([.,!]\s?)[^<>]{0,100}?|[^<>\s]+)$/g,
"$2");return"&hellip;"+a+"&hellip;"},camelize:function(a){var b=a.split("-"),c=b.length;if(c==1)return b[0];for(var a=a.charAt(0)=="-"?b[0].charAt(0).toUpperCase()+b[0].substring(1):b[0],d=1;d<c;d++)a+=b[d].charAt(0).toUpperCase()+b[d].substring(1);return a},lowercase:function(a){return a.toLowerCase()},capitalize:function(a){return a.charAt(0).toUpperCase()+a.substring(1).toLowerCase()},underscore:function(a){return a.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,
"$1_$2").replace(/-/g,"_").toLowerCase()},spacify:function(a){return a.replace(/_/g," ")},dasherize:function(a){return a.replace(/_/g,"-")},singularize:function(a){return a.replace(/s$/,"")},pluralize:function(a,b){return b==1?a:a=="person"?"people":a.match(/y$/i)?a.replace(/y$/i,"ies"):a+"s"},classify:function(a){return this.camelize(this.capitalize(this.dasherize(this.singularize(a))))},possessivize:function(a){var b=a.charAt(a.length-1)=="s";return a+(b?"'":"'s")},truncate:function(a,b,c){b=b||
30;c=_.isUndefined(c)?"...":c;return a.length>b?a.slice(0,b-c.length)+c:a},sluggify:function(a){return $.trim(a.replace(/['"]+/g,"").replace(/\W+/g," ")).toLowerCase().replace(/\s+/g,"-")},commify:function(a,b){var c=[];_.each(a,function(d,e){b.quote&&(d='"'+d+'"');c.push(d);c.push(e==a.length-1?"":e==a.length-2&&b.conjunction?", "+b.conjunction+" ":", ")});return c.join("")},commas:function(a){var b=/(\d+)(\d{3})/;a+="";a=a.split(".");whole=a[0];for(decimal=a.length>1?"."+a[1]:"";b.test(whole);)whole=
whole.replace(b,"$1,$2");return whole+decimal},bytesToMB:function(a){var b=Math.round(a/1024*100)*0.01,a="KB";b>1E3&&(b=Math.round(b*0.1)*0.01,a="MB");b=b.toString().split(".");b=b[0]+(b.length>1?"."+b[1].substr(0,1):"");return b+" "+a},normalizeUrl:function(a){a=Inflector.trim(a);return!a?null:/^https?:\/\//.test(a)?a:"http://"+a},stripTags:function(a){return a.replace(/<\w+(\s+("[^"]*"|'[^']*'|[^>])+)?>|<\/\w+>/gi,"")},escapeRegExp:function(a){return a.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")}};
(function(){function a(b,c,d){if(b===c)return b!==0||1/b==1/c;if(b==null||c==null)return b===c;if(b._chain)b=b._wrapped;if(c._chain)c=c._wrapped;if(n.isFunction(b.isEqual))return b.isEqual(c);if(n.isFunction(c.isEqual))return c.isEqual(b);var e=typeof b;if(e!=typeof c)return!1;if(!b!=!c)return!1;if(n.isNaN(b))return n.isNaN(c);var f=n.isString(b),g=n.isString(c);if(f||g)return f&&g&&String(b)==String(c);f=n.isNumber(b);g=n.isNumber(c);if(f||g)return f&&g&&+b==+c;f=n.isBoolean(b);g=n.isBoolean(c);
if(f||g)return f&&g&&+b==+c;f=n.isDate(b);g=n.isDate(c);if(f||g)return f&&g&&b.getTime()==c.getTime();f=n.isRegExp(b);g=n.isRegExp(c);if(f||g)return f&&g&&b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase;if(e!="object")return!1;if(b.length!==c.length)return!1;if(b.constructor!==c.constructor)return!1;for(e=d.length;e--;)if(d[e]==b)return!0;d.push(b);var e=0,f=!0,j;for(j in b)if(l.call(b,j)&&(e++,!(f=l.call(c,j)&&a(b[j],c[j],d))))break;if(f){for(j in c)if(l.call(c,
j)&&!e--)break;f=!e}d.pop();return f}var b=this,c=b._,d={},e=Array.prototype,f=Object.prototype,g=e.slice,j=e.unshift,k=f.toString,l=f.hasOwnProperty,p=e.forEach,t=e.map,v=e.reduce,H=e.reduceRight,L=e.filter,ha=e.every,N=e.some,O=e.indexOf,y=e.lastIndexOf,f=Array.isArray,ea=Object.keys,V=Function.prototype.bind,n=function(a){return new Z(a)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports)exports=module.exports=n;exports._=n}else typeof define==="function"&&define.amd?
define("underscore",function(){return n}):b._=n;n.VERSION="1.2.1";var W=n.each=n.forEach=function(a,b,c){if(a!=null)if(p&&a.forEach===p)a.forEach(b,c);else if(a.length===+a.length)for(var e=0,f=a.length;e<f;e++){if(e in a&&b.call(c,a[e],e,a)===d)break}else for(e in a)if(l.call(a,e)&&b.call(c,a[e],e,a)===d)break};n.map=function(a,b,c){var d=[];if(a==null)return d;if(t&&a.map===t)return a.map(b,c);W(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)});return d};n.reduce=n.foldl=n.inject=function(a,b,c,d){var e=
c!==void 0;a==null&&(a=[]);if(v&&a.reduce===v)return d&&(b=n.bind(b,d)),e?a.reduce(b,c):a.reduce(b);W(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c};n.reduceRight=n.foldr=function(a,b,c,d){a==null&&(a=[]);if(H&&a.reduceRight===H)return d&&(b=n.bind(b,d)),c!==void 0?a.reduceRight(b,c):a.reduceRight(b);a=(n.isArray(a)?a.slice():n.toArray(a)).reverse();return n.reduce(a,b,c,d)};n.find=n.detect=function(a,b,c){var d;
ua(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0});return d};n.filter=n.select=function(a,b,c){var d=[];if(a==null)return d;if(L&&a.filter===L)return a.filter(b,c);W(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)});return d};n.reject=function(a,b,c){var d=[];if(a==null)return d;W(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)});return d};n.every=n.all=function(a,b,c){var b=b||n.identity,e=!0;if(a==null)return e;if(ha&&a.every===ha)return a.every(b,c);W(a,function(a,f,g){if(!(e=e&&b.call(c,
a,f,g)))return d});return e};var ua=n.some=n.any=function(a,b,c){var b=b||n.identity,e=!1;if(a==null)return e;if(N&&a.some===N)return a.some(b,c);W(a,function(a,f,g){if(e|=b.call(c,a,f,g))return d});return!!e};n.include=n.contains=function(a,b){var c=!1;if(a==null)return c;return O&&a.indexOf===O?a.indexOf(b)!=-1:c=ua(a,function(a){if(a===b)return!0})};n.invoke=function(a,b){var c=g.call(arguments,2);return n.map(a,function(a){return(b.call?b||a:a[b]).apply(a,c)})};n.pluck=function(a,b){return n.map(a,
function(a){return a[b]})};n.max=function(a,b,c){if(!b&&n.isArray(a))return Math.max.apply(Math,a);if(!b&&n.isEmpty(a))return-Infinity;var d={computed:-Infinity};W(a,function(a,e,f){e=b?b.call(c,a,e,f):a;e>=d.computed&&(d={value:a,computed:e})});return d.value};n.min=function(a,b,c){if(!b&&n.isArray(a))return Math.min.apply(Math,a);if(!b&&n.isEmpty(a))return Infinity;var d={computed:Infinity};W(a,function(a,e,f){e=b?b.call(c,a,e,f):a;e<d.computed&&(d={value:a,computed:e})});return d.value};n.shuffle=
function(a){var b=[],c;W(a,function(a,d){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)});return b};n.sortBy=function(a,b,c){return n.pluck(n.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")};n.groupBy=function(a,b){var c={},d=n.isFunction(b)?b:function(a){return a[b]};W(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)});return c};n.sortedIndex=function(a,b,c){c||(c=n.identity);
for(var d=0,e=a.length;d<e;){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d};n.toArray=function(a){return!a?[]:a.toArray?a.toArray():n.isArray(a)?g.call(a):n.isArguments(a)?g.call(a):n.values(a)};n.size=function(a){return n.toArray(a).length};n.first=n.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]};n.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))};n.last=function(a,b,c){return b!=null&&!c?g.call(a,a.length-b):a[a.length-1]};n.rest=n.tail=function(a,b,c){return g.call(a,
b==null||c?1:b)};n.compact=function(a){return n.filter(a,function(a){return!!a})};n.flatten=function(a,b){return n.reduce(a,function(a,c){if(n.isArray(c))return a.concat(b?c:n.flatten(c));a[a.length]=c;return a},[])};n.without=function(a){return n.difference(a,g.call(arguments,1))};n.uniq=n.unique=function(a,b,c){var c=c?n.map(a,c):a,d=[];n.reduce(c,function(c,e,f){if(0==f||(b===!0?n.last(c)!=e:!n.include(c,e)))c[c.length]=e,d[d.length]=a[f];return c},[]);return d};n.union=function(){return n.uniq(n.flatten(arguments,
!0))};n.intersection=n.intersect=function(a){var b=g.call(arguments,1);return n.filter(n.uniq(a),function(a){return n.every(b,function(b){return n.indexOf(b,a)>=0})})};n.difference=function(a,b){return n.filter(a,function(a){return!n.include(b,a)})};n.zip=function(){for(var a=g.call(arguments),b=n.max(n.pluck(a,"length")),c=Array(b),d=0;d<b;d++)c[d]=n.pluck(a,""+d);return c};n.indexOf=function(a,b,c){if(a==null)return-1;var d;if(c)return c=n.sortedIndex(a,b),a[c]===b?c:-1;if(O&&a.indexOf===O)return a.indexOf(b);
for(c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1};n.lastIndexOf=function(a,b){if(a==null)return-1;if(y&&a.lastIndexOf===y)return a.lastIndexOf(b);for(var c=a.length;c--;)if(a[c]===b)return c;return-1};n.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0);for(var c=arguments[2]||1,d=Math.max(Math.ceil((b-a)/c),0),e=0,f=Array(d);e<d;)f[e++]=a,a+=c;return f};var na=function(){};n.bind=function(a,b){var c,d;if(a.bind===V&&V)return V.apply(a,g.call(arguments,1));if(!n.isFunction(a))throw new TypeError;
d=g.call(arguments,2);return c=function(){if(!(this instanceof c))return a.apply(b,d.concat(g.call(arguments)));na.prototype=a.prototype;var e=new na,f=a.apply(e,d.concat(g.call(arguments)));return Object(f)===f?f:e}};n.bindAll=function(a){var b=g.call(arguments,1);b.length==0&&(b=n.functions(a));W(b,function(b){a[b]=n.bind(a[b],a)});return a};n.memoize=function(a,b){var c={};b||(b=n.identity);return function(){var d=b.apply(this,arguments);return l.call(c,d)?c[d]:c[d]=a.apply(this,arguments)}};n.delay=
function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)};n.defer=function(a){return n.delay.apply(n,[a,1].concat(g.call(arguments,1)))};n.throttle=function(a,b){var c,d,e,f,g;g=n.debounce(function(){f=!1},b);return function(){d=this;e=arguments;var j;c||(c=setTimeout(function(){c=null;a.apply(d,e);g()},b));f||a.apply(d,e);g&&g();f=!0}};n.debounce=function(a,b){var c;return function(){var d=this,e=arguments;clearTimeout(c);c=setTimeout(function(){c=null;a.apply(d,
e)},b)}};n.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;return c=a.apply(this,arguments)}};n.wrap=function(a,b){return function(){var c=[a].concat(g.call(arguments));return b.apply(this,c)}};n.compose=function(){var a=g.call(arguments);return function(){for(var b=g.call(arguments),c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}};n.after=function(a,b){return function(){if(--a<1)return b.apply(this,arguments)}};n.keys=ea||function(a){if(a!==Object(a))throw new TypeError("Invalid object");
var b=[],c;for(c in a)l.call(a,c)&&(b[b.length]=c);return b};n.values=function(a){return n.map(a,n.identity)};n.functions=n.methods=function(a){var b=[],c;for(c in a)n.isFunction(a[c])&&b.push(c);return b.sort()};n.extend=function(a){W(g.call(arguments,1),function(b){for(var c in b)b[c]!==void 0&&(a[c]=b[c])});return a};n.defaults=function(a){W(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])});return a};n.clone=function(a){return!n.isObject(a)?a:n.isArray(a)?a.slice():n.extend({},
a)};n.tap=function(a,b){b(a);return a};n.isEqual=function(b,c){return a(b,c,[])};n.isEmpty=function(a){if(n.isArray(a)||n.isString(a))return a.length===0;for(var b in a)if(l.call(a,b))return!1;return!0};n.isElement=function(a){return!!(a&&a.nodeType==1)};n.isArray=f||function(a){return k.call(a)=="[object Array]"};n.isObject=function(a){return a===Object(a)};n.isArguments=k.call(arguments)=="[object Arguments]"?function(a){return k.call(a)=="[object Arguments]"}:function(a){return!(!a||!l.call(a,
"callee"))};n.isFunction=function(a){return k.call(a)=="[object Function]"};n.isString=function(a){return k.call(a)=="[object String]"};n.isNumber=function(a){return k.call(a)=="[object Number]"};n.isNaN=function(a){return a!==a};n.isBoolean=function(a){return a===!0||a===!1||k.call(a)=="[object Boolean]"};n.isDate=function(a){return k.call(a)=="[object Date]"};n.isRegExp=function(a){return k.call(a)=="[object RegExp]"};n.isNull=function(a){return a===null};n.isUndefined=function(a){return a===void 0};
n.noConflict=function(){b._=c;return this};n.identity=function(a){return a};n.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)};n.escape=function(a){return(""+a).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};n.mixin=function(a){W(n.functions(a),function(b){w(b,n[b]=a[b])})};var oa=0;n.uniqueId=function(a){var b=oa++;return a?a+b:b};n.templateSettings={evaluate:/<%([\s\S]+?)%>/g,
interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};n.template=function(a,b){var c=n.templateSettings,c="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape,function(a,b){return"',_.escape("+b.replace(/\\'/g,"'")+"),'"}).replace(c.interpolate,function(a,b){return"',"+b.replace(/\\'/g,"'")+",'"}).replace(c.evaluate||null,function(a,b){return"');"+b.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,
"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",c=new Function("obj",c);return b?c(b):c};var Z=function(a){this._wrapped=a};n.prototype=Z.prototype;var u=function(a,b){return b?n(a).chain():a},w=function(a,b){Z.prototype[a]=function(){var a=g.call(arguments);j.call(a,this._wrapped);return u(b.apply(n,a),this._chain)}};n.mixin(n);W("pop,push,reverse,shift,sort,splice,unshift".split(","),function(a){var b=e[a];Z.prototype[a]=function(){b.apply(this._wrapped,arguments);return u(this._wrapped,
this._chain)}});W(["concat","join","slice"],function(a){var b=e[a];Z.prototype[a]=function(){return u(b.apply(this._wrapped,arguments),this._chain)}});Z.prototype.chain=function(){this._chain=!0;return this};Z.prototype.value=function(){return this._wrapped}})();
(function(a){if(typeof _!="undefined")var b=_().reverse,c=_.include;var d=String.prototype.trim,e=function(a,b){for(var c=[];b>0;c[--b]=a);return c.join("")},f=function(a){return function(){for(var b=Array.prototype.slice.call(arguments),c=0;c<b.length;c++)b[c]=b[c]==null?"":""+b[c];return a.apply(null,b)}},g=function(){function a(b){return Object.prototype.toString.call(b).slice(8,-1).toLowerCase()}var b=function(){b.cache.hasOwnProperty(arguments[0])||(b.cache[arguments[0]]=b.parse(arguments[0]));
return b.format.call(null,b.cache[arguments[0]],arguments)};b.format=function(b,c){var d=1,f=b.length,j="",l=[],N,O,y,ea;for(N=0;N<f;N++)if(j=a(b[N]),j==="string")l.push(b[N]);else if(j==="array"){y=b[N];if(y[2]){j=c[d];for(O=0;O<y[2].length;O++){if(!j.hasOwnProperty(y[2][O]))throw g('[_.sprintf] property "%s" does not exist',y[2][O]);j=j[y[2][O]]}}else j=y[1]?c[y[1]]:c[d++];if(/[^s]/.test(y[8])&&a(j)!="number")throw g("[_.sprintf] expecting number but found %s",a(j));switch(y[8]){case "b":j=j.toString(2);
break;case "c":j=String.fromCharCode(j);break;case "d":j=parseInt(j,10);break;case "e":j=y[7]?j.toExponential(y[7]):j.toExponential();break;case "f":j=y[7]?parseFloat(j).toFixed(y[7]):parseFloat(j);break;case "o":j=j.toString(8);break;case "s":j=(j=String(j))&&y[7]?j.substring(0,y[7]):j;break;case "u":j=Math.abs(j);break;case "x":j=j.toString(16);break;case "X":j=j.toString(16).toUpperCase()}j=/[def]/.test(y[8])&&y[3]&&j>=0?"+"+j:j;O=y[4]?y[4]=="0"?"0":y[4].charAt(1):" ";ea=y[6]-String(j).length;
O=y[6]?e(O,ea):"";l.push(y[5]?j+O:O+j)}return l.join("")};b.cache={};b.parse=function(a){for(var b=[],c=[],d=0;a;){if((b=/^[^\x25]+/.exec(a))!==null)c.push(b[0]);else if((b=/^\x25{2}/.exec(a))!==null)c.push("%");else if((b=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(a))!==null){if(b[2]){d|=1;var e=[],f=b[2],g=[];if((g=/^([a-z_][a-z_\d]*)/i.exec(f))!==null)for(e.push(g[1]);(f=f.substring(g[0].length))!=="";)if((g=/^\.([a-z_][a-z_\d]*)/i.exec(f))!==null)e.push(g[1]);
else if((g=/^\[(\d+)\]/.exec(f))!==null)e.push(g[1]);else throw"[_.sprintf] huh?";else throw"[_.sprintf] huh?";b[2]=e}else d|=2;if(d===3)throw"[_.sprintf] mixing positional and named placeholders is not (yet) supported";c.push(b)}else throw"[_.sprintf] huh?";a=a.substring(b[0].length)}return c};return b}(),j={isBlank:f(function(a){return/^\s*$/.test(a)}),stripTags:f(function(a){return a.replace(/<\/?[^>]+>/ig,"")}),capitalize:f(function(a){return a.charAt(0).toUpperCase()+a.substring(1).toLowerCase()}),
chop:f(function(a,b){for(var b=b*1||0||a.length,c=[],d=0;d<a.length;)c.push(a.slice(d,d+b)),d+=b;return c}),clean:f(function(a){return j.strip(a.replace(/\s+/g," "))}),count:f(function(a,b){for(var c=0,d,e=0;e<a.length;)d=a.indexOf(b,e),d>=0&&c++,e=e+(d>=0?d:0)+b.length;return c}),chars:f(function(a){return a.split("")}),escapeHTML:f(function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}),unescapeHTML:f(function(a){return a.replace(/&lt;/g,
"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&amp;/g,"&")}),escapeRegExp:f(function(a){return a.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")}),insert:f(function(a,b,c){a=a.split("");a.splice(b*1||0,0,c);return a.join("")}),includes:f(function(a,b){return a.indexOf(b)!==-1}),include:function(a,b){return!c||/string|number/.test(typeof a)?this.includes(a,b):c(a,b)},join:f(function(a){var b=Array.prototype.slice.call(arguments);return b.join(b.shift())}),lines:f(function(a){return a.split("\n")}),
reverse:function(a){return!b||/string|number/.test(typeof a)?Array.prototype.reverse.apply(String(a).split("")).join(""):b.call(_(a))},splice:f(function(a,b,c,d){a=a.split("");a.splice(b*1||0,c*1||0,d);return a.join("")}),startsWith:f(function(a,b){return a.length>=b.length&&a.substring(0,b.length)===b}),endsWith:f(function(a,b){return a.length>=b.length&&a.substring(a.length-b.length)===b}),succ:f(function(a){var b=a.split("");b.splice(a.length-1,1,String.fromCharCode(a.charCodeAt(a.length-1)+1));
return b.join("")}),titleize:f(function(a){for(var a=a.split(" "),b,c=0;c<a.length;c++)b=a[c].split(""),typeof b[0]!=="undefined"&&(b[0]=b[0].toUpperCase()),c+1===a.length?a[c]=b.join(""):a[c]=b.join("")+" ";return a.join("")}),camelize:f(function(a){return j.trim(a).replace(/(\-|_|\s)+(.)?/g,function(a,b,c){return c?c.toUpperCase():""})}),underscored:function(a){return j.trim(a).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/\-|\s+/g,"_").toLowerCase()},dasherize:function(a){return j.trim(a).replace(/([a-z\d])([A-Z]+)/g,
"$1-$2").replace(/^([A-Z]+)/,"-$1").replace(/\_|\s+/g,"-").toLowerCase()},trim:f(function(a,b){if(!b&&d)return d.call(a);b=b?j.escapeRegExp(b):"\\s";return a.replace(RegExp("^["+b+"]+|["+b+"]+$","g"),"")}),ltrim:f(function(a,b){b=b?j.escapeRegExp(b):"\\s";return a.replace(RegExp("^["+b+"]+","g"),"")}),rtrim:f(function(a,b){b=b?j.escapeRegExp(b):"\\s";return a.replace(RegExp("["+b+"]+$","g"),"")}),truncate:f(function(a,b,c){b=b*1||0;return a.length>b?a.slice(0,b)+(c||"..."):a}),prune:f(function(a,
b,c){var c=c||"...",b=b*1||0,d="",d=a.substring(b-1,b+1).search(/^\w\w$/)===0?j.rtrim(a.slice(0,b).replace(/([\W][\w]*)$/,"")):j.rtrim(a.slice(0,b)),d=d.replace(/\W+$/,"");return d.length+c.length>a.length?a:d+c}),words:function(a,b){return String(a).split(b||" ")},pad:f(function(a,b,c,d){var f="",f=0,b=b*1||0;c?c.length>1&&(c=c.charAt(0)):c=" ";switch(d){case "right":f=b-a.length;f=e(c,f);a+=f;break;case "both":f=b-a.length;f={left:e(c,Math.ceil(f/2)),right:e(c,Math.floor(f/2))};a=f.left+a+f.right;
break;default:f=b-a.length,f=e(c,f),a=f+a}return a}),lpad:function(a,b,c){return j.pad(a,b,c)},rpad:function(a,b,c){return j.pad(a,b,c,"right")},lrpad:function(a,b,c){return j.pad(a,b,c,"both")},sprintf:g,vsprintf:function(a,b){b.unshift(a);return g.apply(null,b)},toNumber:function(a,b){var c;c=(a*1||0).toFixed(b*1||0)*1||0;return!(c===0&&a!=="0"&&a!==0)?c:Number.NaN},strRight:f(function(a,b){var c=!b?-1:a.indexOf(b);return c!=-1?a.slice(c+b.length,a.length):a}),strRightBack:f(function(a,b){var c=
!b?-1:a.lastIndexOf(b);return c!=-1?a.slice(c+b.length,a.length):a}),strLeft:f(function(a,b){var c=!b?-1:a.indexOf(b);return c!=-1?a.slice(0,c):a}),strLeftBack:f(function(a,b){var c=a.lastIndexOf(b);return c!=-1?a.slice(0,c):a})};j.strip=j.trim;j.lstrip=j.ltrim;j.rstrip=j.rtrim;j.center=j.lrpad;j.ljust=j.lpad;j.rjust=j.rpad;typeof module!=="undefined"&&module.exports?module.exports=j:typeof a._!=="undefined"?a._.mixin(j):a._=j})(this||window);
NEWSBLUR.utils={compute_story_score:function(a){var b=0,c=Math.max(a.intelligence.title,a.intelligence.author,a.intelligence.tags),d=Math.min(a.intelligence.title,a.intelligence.author,a.intelligence.tags);c>0?b=c:d<0&&(b=d);b==0&&(b=a.intelligence.feed);return b},generate_gradient:function(a,b){if(!a)return"";var c=a.favicon_color;if(!c)return"";var d=parseInt(c.substr(0,2),16),e=parseInt(c.substr(2,2),16),c=parseInt(c.substr(4,2),16);if(b=="border")return["1px solid rgb(",[parseInt(d*0.75,10),parseInt(e*
0.75,10),parseInt(c*0.75,10)].join(","),")"].join("");else if(b=="webkit")return["-webkit-gradient(linear,left bottom,left top,color-stop(0, rgba(",[d,e,c,255].join(","),")),color-stop(1, rgba(",[d+35,e+35,c+35,255].join(","),")))"].join("");else if(b=="moz")return["-moz-linear-gradient(center bottom,rgb(",[d,e,c].join(","),") 0%,rgb(",[d+35,e+35,c+35].join(","),") 100%)"].join("")},is_feed_floater_gradient_light:function(a){if(!a)return!1;var b=a.favicon_color;if(!b)return!1;var a=parseInt(b.substr(0,
2),16)/255,c=parseInt(b.substr(2,2),16)/255,b=parseInt(b.substr(4,2),16)/255;return $.textColor({r:a,g:c,b:b})!="white"},make_folders:function(a){var a=a.get_folders(),b=$.make("select",{className:"NB-folders"}),c=$.make("option",{value:""},"Top Level");b.append(c);return b=this.make_folder_options(b,a,"-")},make_folder_options:function(a,b,c){for(var d in b){var e=b[d];if(typeof e=="object")for(var f in e){var g=e[f],j=$.make("option",{value:f},c+" "+f);a.append(j);a=this.make_folder_options(a,g,
c+"-")}}return a}};NEWSBLUR.AssetModel=function(){var a=null;return{reader:function(){a||(a=new NEWSBLUR.AssetModel.Reader);a.init();return a}}}();NEWSBLUR.AssetModel.Reader=function(){this.defaults={classifiers:{titles:{},tags:{},authors:{},feeds:{}}};this.feeds={};this.favicons={};this.folders=[];this.stories={};this.story_keys={};this.queued_read_stories={};this.classifiers={};this.starred_stories=[];this.read_stories_river_count=this.starred_count=0;this.flags={favicons_fetching:!1}};
NEWSBLUR.AssetModel.Reader.prototype={init:function(){this.ajax={};this.ajax.queue=$.manageAjax.create("queue",{queue:!1});this.ajax.queue_clear=$.manageAjax.create("queue_clear",{queue:"clear"});this.ajax.feed=$.manageAjax.create("feed",{queue:"clear",abortOld:!0,domCompleteTrigger:!0});this.ajax.feed_page=$.manageAjax.create("feed_page",{queue:!1,abortOld:!0,abortIsNoSuccess:!1,domCompleteTrigger:!0});this.ajax.statistics=$.manageAjax.create("statistics",{queue:"clear",abortOld:!0});$.ajaxSettings.traditional=
!0},make_request:function(a,b,c,d,e){var e=$.extend({ajax_group:"queue",traditional:!0,domSuccessTrigger:!0,preventDoubleRequests:!1},e),f=e.request_type||"POST",g=!1;e.ajax_group=="feed"&&(g=!0);e.ajax_group=="statistics"&&(g=!0,f="GET");g&&this.ajax[e.ajax_group].clear(!0);this.ajax[e.ajax_group].add(_.extend({url:a,data:b,type:f,beforeSend:function(){$.isFunction(e.beforeSend)&&e.beforeSend();return!0},success:function(a){$.isFunction(c)&&c(a)},error:function(a,b,e){NEWSBLUR.log(["AJAX Error",
b,e]);$.isFunction(d)?d():$.isFunction(c)&&(a="Please create an account. Not much to do without an account.",NEWSBLUR.Globals.is_authenticated&&(a="Sorry, there was an unhandled error."),c({message:a}))}},e))},mark_story_as_read:function(a,b,c){var d=this,e=!1,f=this.get_story(a),e=f.read_status;f.read_status=1;!e&&NEWSBLUR.Globals.is_authenticated&&(b in this.queued_read_stories||(this.queued_read_stories[b]=[]),this.queued_read_stories[b].push(a),this.make_request("/reader/mark_story_as_read",{story_id:this.queued_read_stories[b],
feed_id:b},null,null,{ajax_group:"queue_clear",traditional:!0,beforeSend:function(){d.queued_read_stories[b]=[]}}));this.read_stories_river_count+=1;$.isFunction(c)&&c(e)},mark_story_as_unread:function(a,b,c){for(s in this.stories)if(this.stories[s].id==a){this.stories[s].read_status=0;break}NEWSBLUR.Globals.is_authenticated&&this.make_request("/reader/mark_story_as_unread",{story_id:a,feed_id:b},null,null,{});$.isFunction(c)&&c()},mark_story_as_starred:function(a,b,c){this.starred_count+=1;this.get_story(a).starred=
!0;this.make_request("/reader/mark_story_as_starred",{story_id:a,feed_id:b},c)},mark_story_as_unstarred:function(a,b){this.starred_count-=1;this.get_story(a).starred=!1;this.make_request("/reader/mark_story_as_unstarred",{story_id:a},b)},mark_feed_as_read:function(a,b){this.make_request("/reader/mark_feed_as_read",{feed_id:_.isArray(a)?_.select(a,function(a){return a}):[a]},b)},load_feeds:function(a,b){var c=this,d={};NEWSBLUR.Flags.start_import_from_google_reader&&(d.include_favicons=!0);this.make_request("/reader/feeds",
d,function(b){var d=function(a){a=_.flatten(_.map(a,_.values));return _.flatten(_.map(a,function(a){return!_.isNumber(a)&&a?d(a):a}))},g=d({root:b.folders});_.each(b.feeds,function(a,b){if(_.contains(g,parseInt(b,10)))c.feeds[b]=a,a.favicon_fetching&&(c.flags.favicons_fetching=!0)});c.folders=b.folders;c.starred_count=b.starred_count;_.isEqual(c.favicons,{})||_.each(c.feeds,function(a){if(c.favicons[a.id])a.favicon=c.favicons[a.id]});a()},b,{request_type:"GET"})},load_feeds_flat:function(a,b){var c=
this;this.make_request("/reader/feeds",{flat:!0,include_favicons:!0},function(b){var e=function(a){a=_.flatten(_.map(a,_.values));return _.flatten(_.map(a,function(a){return!_.isNumber(a)&&a?e(a):a}))},f=e({root:b.flat_folders});_.each(b.feeds,function(a,b){if(_.contains(f,parseInt(b,10)))c.feeds[b]=a,a.favicon_fetching&&(c.flags.favicons_fetching=!0)});c.folders=b.flat_folders;c.starred_count=b.starred_count;_.isEqual(c.favicons,{})||_.each(c.feeds,function(a){if(c.favicons[a.id])a.favicon=c.favicons[a.id]});
a()},b,{request_type:"GET"})},load_feed_favicons:function(a,b,c){var d=_.bind(function(b){this.favicons=b;_.isEqual(this.feeds,{})||_.each(this.feeds,_.bind(function(a){if(b[a.id])a.favicon=b[a.id]},this));a()},this),c={load_all:c};b&&(c.feed_ids=_.compact(_.map(this.feeds,function(a){return!a.favicon&&a.id})));this.make_request("/reader/favicons",c,d,d,{request_type:"GET"})},load_feed:function(a,b,c,d){var e=this;(this.feed_id=a)&&this.make_request("/reader/feed/"+a,{page:b,feed_address:this.feeds[a].feed_address},
function(b){return e.load_feed_precallback(b,a,d,c)},$.noop,{ajax_group:b>1?"feed_page":"feed",request_type:"GET"})},load_feed_precallback:function(a,b,c,d){var e=this;if(a.dupe_feed_id&&this.feed_id==a.dupe_feed_id)b=a.dupe_feed_id;if(b==this.feed_id){if(a&&d){this.stories=a.stories;this.feed_tags=a.feed_tags||{};this.feed_authors=a.feed_authors||{};this.feed_id=b;_.includes(b,":")?_.extend(this.classifiers,a.classifiers):this.classifiers[b]=_.extend({},this.defaults.classifiers,a.classifiers);this.starred_stories=
a.starred_stories;this.story_keys={};for(var f in a.stories)this.story_keys[a.stories[f].id]=!0;if(a.feed_address)this.feeds[b].feed_address=a.feed_address}else if(a)a.stories=_.select(a.stories,function(a){if(!e.story_keys[a.id])return e.stories.push(a),e.story_keys[a.id]=!0});$.isFunction(c)&&c(a,d)}},load_canonical_feed:function(a,b){var c=_.bind(function(c){this.feeds[c.id]=c;this.feed_tags=c.feed_tags||{};this.feed_authors=c.feed_authors||{};this.feed_id=a;this.classifiers[a]=c.classifiers||
this.defaults.classifiers;b&&b()},this);this.make_request("/rss_feeds/feed/"+a,{},c,$.noop,{request_type:"GET"})},fetch_starred_stories:function(a,b,c){var d=this;this.feed_id="starred";this.make_request("/reader/starred_stories",{page:a},function(a){return d.load_feed_precallback(a,"starred",b,c)},$.noop,{ajax_group:a?"feed_page":"feed",request_type:"GET"})},fetch_river_stories:function(a,b,c,d,e){var f=this;if(e||!c)this.read_stories_river_count=0;this.feed_id=a;this.make_request("/reader/river_stories",
{feeds:b,page:c,read_stories_count:this.read_stories_river_count,new_flag:!0},function(b){return f.load_feed_precallback(b,a,d,e)},$.noop,{ajax_group:c?"feed_page":"feed",request_type:"GET"})},get_feeds_trainer:function(a,b){var c={};a&&(c.feed_id=a);this.make_request("/reader/feeds_trainer",c,b,null,{ajax_group:"feed",request_type:"GET"})},retrain_all_sites:function(a){var b={};NEWSBLUR.Globals.is_authenticated?this.make_request("/reader/retrain_all_sites",b,a,null):$.isFunction(a)&&a()},refresh_feeds:function(a,
b,c){var d=this,e=function(b){d.post_refresh_feeds(b,a)},f={};b&&(f.check_fetch_status=b);if(this.flags.favicons_fetching)b=_.compact(_.map(this.feeds,function(a,b){if(a.favicon_fetching&&a.active)return b})),b.length&&(f.favicons_fetching=b);c&&(f.feed_id=c);(NEWSBLUR.Globals.is_authenticated||c)&&this.make_request("/reader/refresh_feeds",f,e)},post_refresh_feeds:function(a,b){var c=[],d;for(d in a.feeds)if(this.feeds[d]){var e=!1;d=parseInt(d,10);var f=a.feeds[d];f.id&&d!=f.id&&(NEWSBLUR.log(["Dupe feed being refreshed",
d,f.id,this.feeds[d]]),this.feeds[f.id]=this.feeds[d]);for(var g in f)this.feeds[d][g]!=f[g]&&(this.feeds[d][g]=f[g],NEWSBLUR.log(["Different",g,this.feeds[d],f]),e=!0);if(f.has_exception&&!this.feeds[d].has_exception||this.feeds[d].has_exception&&!f.has_exception)e=!0,this.feeds[d].has_exception=!!f.has_exception;if(f.favicon)this.feeds[d].favicon=f.favicon,this.feeds[d].favicon_color=f.favicon_color,this.feeds[d].favicon_fetching=!1,e=!0;e&&!(d in c)&&c.push(d)}b(c)},refresh_feed:function(a,b){var c=
this,d;a&&this.make_request("/reader/feed/"+a,{page:0,feed_address:this.feeds[a].feed_address},function(d){c.load_feed_precallback(d,a,b)},null,{ajax_group:"feed_page",request_type:"GET"})},count_unfetched_feeds:function(){var a={unfetched_feeds:0,fetched_feeds:0},b;for(b in this.feeds){var c=this.feeds[b];c.active&&(c.not_yet_fetched?a.unfetched_feeds+=1:a.fetched_feeds+=1)}return a},set_feed:function(a,b){return this.feeds[a]=b},get_feed:function(a){return this.feeds[a]},get_feeds:function(){return this.feeds},
get_folders:function(){return this.folders},get_feed_tags:function(){return this.feed_tags},get_feed_authors:function(){return this.feed_authors},get_story:function(a){for(s in this.stories)if(this.stories[s].id==a)return this.stories[s];return null},save_classifier:function(a,b){NEWSBLUR.Globals.is_authenticated?this.make_request("/classifier/save",a,b):$.isFunction(b)&&b()},get_feed_classifier:function(a,b){this.make_request("/classifier/"+a,{},b,null,{ajax_group:"feed",request_type:"GET"})},delete_feed:function(a,
b,c,d){d||delete this.feeds[a];NEWSBLUR.Globals.is_authenticated?this.make_request("/reader/delete_feed",{feed_id:a,in_folder:b},c,null):$.isFunction(c)&&c()},delete_folder:function(a,b,c,d){NEWSBLUR.Globals.is_authenticated?this.make_request("/reader/delete_folder",{folder_name:a,in_folder:b,feed_id:c},d,null):$.isFunction(d)&&d()},rename_feed:function(a,b,c){this.feeds[a].feed_title=b;NEWSBLUR.Globals.is_authenticated?this.make_request("/reader/rename_feed",{feed_id:a,feed_title:b},c,null):$.isFunction(c)&&
c()},rename_folder:function(a,b,c,d){NEWSBLUR.Globals.is_authenticated?this.make_request("/reader/rename_folder",{folder_name:a,new_folder_name:b,in_folder:c},d,null):$.isFunction(d)&&d()},save_add_url:function(a,b,c){this.make_request("/reader/add_url/",{url:a,folder:b},c,function(){c({message:NEWSBLUR.Globals.is_anonymous?"Please create an account. Not much to do without an account.":"There was a problem trying to add this site. Please try a different URL."})})},save_add_folder:function(a,b,c){this.make_request("/reader/add_folder/",
{folder:a,parent_folder:b},c,function(){c({message:NEWSBLUR.Globals.is_anonymous?"Please create an account. Not much to do without an account.":"There was a problem trying to add this folder. Please try a different URL."})})},preference:function(a,b,c){if(typeof b=="undefined")return a=NEWSBLUR.Preferences[a],/\d+/.test(a)?parseInt(a,10):a;if(NEWSBLUR.Preferences[a]==b)return $.isFunction(c)&&c();NEWSBLUR.Preferences[a]=b;var d={};d[a]=b;this.make_request("/profile/set_preference",d,c,null)},save_preferences:function(a,
b){_.each(a,function(a,b){NEWSBLUR.Preferences[b]=a});this.make_request("/profile/set_preference",a,b,null)},save_account_settings:function(a,b){this.make_request("/profile/set_account_settings",a,b,null)},view_setting:function(a,b,c){if(typeof b=="undefined")return NEWSBLUR.Preferences.view_settings[a+""]||NEWSBLUR.Preferences.default_view;NEWSBLUR.Preferences.view_settings[a+""]=b;this.make_request("/profile/set_view_setting",{feed_id:a+"",feed_view_setting:b},c,null)},collapsed_folders:function(a,
b,c){var d=NEWSBLUR.Preferences.collapsed_folders,e=!1;if(b&&!_.contains(NEWSBLUR.Preferences.collapsed_folders,a))NEWSBLUR.Preferences.collapsed_folders.push(a),e=!0;else if(!b&&_.contains(NEWSBLUR.Preferences.collapsed_folders,a))NEWSBLUR.Preferences.collapsed_folders=_.without(d,a),e=!0;e&&this.make_request("/profile/set_collapsed_folders",{collapsed_folders:$.toJSON(NEWSBLUR.Preferences.collapsed_folders)},c,null)},save_mark_read:function(a,b){this.make_request("/reader/mark_all_as_read",{days:a},
b)},get_features_page:function(a,b){this.make_request("/reader/features",{page:a},b,b,{request_type:"GET"})},load_recommended_feed:function(a,b,c,d,e){this.make_request("/recommendations/load_recommended_feed",{page:a,refresh:b,unmoderated:c},d,e,{request_type:"GET"})},approve_feed_in_moderation_queue:function(a,b,c){this.make_request("/recommendations/approve_feed",{feed_id:a,date:b,unmoderated:!0},c,{request_type:"GET"})},decline_feed_in_moderation_queue:function(a,b){this.make_request("/recommendations/decline_feed",
{feed_id:a,unmoderated:!0},b,{request_type:"GET"})},load_dashboard_graphs:function(a,b){this.make_request("/statistics/dashboard_graphs",{},a,b,{request_type:"GET"})},save_feed_order:function(a,b){this.make_request("/reader/save_feed_order",{folders:$.toJSON(a)},b)},get_feed_statistics:function(a,b){this.make_request("/rss_feeds/statistics/"+a,{},b,b,{ajax_group:"statistics",requesst_type:"GET"})},get_feed_recommendation_info:function(a,b){this.make_request("/recommendations/load_feed_info/"+a,{},
b,b,{ajax_group:"statistics",request_type:"GET"})},start_import_from_google_reader:function(a){this.make_request("/import/import_from_google_reader/",{},a)},save_recommended_site:function(a,b){NEWSBLUR.Globals.is_authenticated?this.make_request("/recommendations/save_recommended_feed",a,b):$.isFunction(b)&&b()},save_exception_retry:function(a,b){var c=this;this.make_request("/rss_feeds/exception_retry",{feed_id:a,reset_fetch:!(!this.feeds[a].has_feed_exception&&!this.feeds[a].has_page_exception)},
function(a){c.post_refresh_feeds(a,b)})},save_exception_change_feed_link:function(a,b,c){var d=this;NEWSBLUR.Globals.is_authenticated?this.make_request("/rss_feeds/exception_change_feed_link",{feed_id:a,feed_link:b},function(b){d.post_refresh_feeds(b,c);NEWSBLUR.reader.force_feed_refresh(a)}):$.isFunction(c)&&c()},save_exception_change_feed_address:function(a,b,c){var d=this;NEWSBLUR.Globals.is_authenticated?this.make_request("/rss_feeds/exception_change_feed_address",{feed_id:a,feed_address:b},function(b){d.post_refresh_feeds(b,
c);NEWSBLUR.reader.force_feed_refresh(a)}):$.isFunction(c)&&c()},save_feed_chooser:function(a,b){NEWSBLUR.Globals.is_authenticated?this.make_request("/reader/save_feed_chooser",{approved_feeds:_.select(a,function(a){return a})},b):$.isFunction(b)&&b()},send_story_email:function(a,b,c){NEWSBLUR.Globals.is_authenticated?this.make_request("/reader/send_story_email",a,b,c,{timeout:6E3}):b({code:-1,message:"You must be logged in to send a story over email."})},load_tutorial:function(a,b){this.make_request("/reader/load_tutorial",
a,b)},recalculate_story_scores:function(a){_.each(this.stories,_.bind(function(b,c){if(b.story_feed_id==a)this.stories[c].intelligence.title=0,_.each(this.classifiers[a].titles,_.bind(function(a,e){if(this.stories[c].intelligence.title<=0&&b.story_title&&b.story_title.indexOf(e)!=-1)this.stories[c].intelligence.title=a},this)),this.stories[c].intelligence.author=0,_.each(this.classifiers[a].authors,_.bind(function(a,e){if(this.stories[c].intelligence.author<=0&&b.story_authors&&b.story_authors.indexOf(e)!=
-1)this.stories[c].intelligence.author=a},this)),this.stories[c].intelligence.tags=0,_.each(this.classifiers[a].tags,_.bind(function(a,e){if(this.stories[c].intelligence.tags<=0&&b.story_tags&&_.contains(b.story_tags,e))this.stories[c].intelligence.tags=a},this)),this.stories[c].intelligence.feed=0,_.each(this.classifiers[a].feeds,_.bind(function(a,e){if(this.stories[c].intelligence.feed<=0&&b.story_feed_id==e)this.stories[c].intelligence.feed=a},this))},this))}};
(function(a){NEWSBLUR.Reader=function(){this.model=NEWSBLUR.AssetModel.reader();this.story_view="page";this.$s={$body:a("body"),$feed_list:a("#feed_list"),$story_titles:a("#story_titles"),$content_pane:a(".content-pane"),$story_taskbar:a("#story_taskbar"),$story_pane:a("#story_pane .NB-story-pane-container"),$feed_view:a(".NB-feed-story-view"),$feed_stories:a(".NB-feed-stories"),$feed_iframe:a(".NB-feed-iframe"),$story_iframe:a(".NB-story-iframe"),$intelligence_slider:a(".NB-intelligence-slider"),
$mouse_indicator:a("#mouse-indicator"),$feed_link_loader:a("#NB-feeds-list-loader"),$feeds_progress:a("#NB-progress"),$dashboard:a(".NB-feeds-header-dashboard"),$river_header:a(".NB-feeds-header-river"),$starred_header:a(".NB-feeds-header-starred"),$tryfeed_header:a(".NB-feeds-header-tryfeed"),$taskbar:a(".taskbar_nav"),$feed_floater:a(".NB-feed-story-view-floater")};this.flags={feed_view_images_loaded:{},bouncing_callout:!1,has_unfetched_feeds:!1,count_unreads_after_import_working:!1,import_from_google_reader_working:!1,
favicons_downloaded:!1};this.locks={};this.counts={feature_page:0,unfetched_feeds:0,fetched_feeds:0,page_fill_outs:0,recommended_feed_page:0};this.cache={iframe_stories:{},feed_view_stories:{},iframe_story_positions:{},feed_view_story_positions:{},iframe_story_positions_keys:[],feed_view_story_positions_keys:[],river_feeds_with_unreads:[],mouse_position_y:parseInt(this.model.preference("lock_mouse_indicator"),10),$feed_in_feed_list:{},$feed_counts_in_feed_list:{}};this.layout={};this.constants={FEED_REFRESH_INTERVAL:6E4,
FILL_OUT_PAGES:8,RIVER_STORIES_FOR_STANDARD_ACCOUNT:12};a(window).bind("resize.reader",_.throttle(a.rescope(this.resize_window,this),1E3));this.$s.$body.bind("dblclick.reader",a.rescope(this.handle_dblclicks,this));this.$s.$body.bind("click.reader",a.rescope(this.handle_clicks,this));this.$s.$body.live("contextmenu.reader",a.rescope(this.handle_rightclicks,this));this.$s.$story_titles.scroll(a.rescope(this.handle_scroll_story_titles,this));this.$s.$feed_stories.scroll(a.rescope(this.handle_scroll_feed_view,
this));this.$s.$feed_stories.bind("mousemove",a.rescope(this.handle_mousemove_feed_view,this));this.handle_keystrokes();this.load_javascript_elements_on_page();this.unload_feed_iframe();this.unload_story_iframe();this.apply_resizable_layout();this.add_body_classes();NEWSBLUR.Flags.start_import_from_google_reader?this.start_import_from_google_reader():this.load_feeds();this.cornerize_buttons();this.setup_feed_page_iframe_load();this.load_intelligence_slider();this.handle_mouse_indicator_hover();this.position_mouse_indicator();
this.handle_login_and_signup_forms();this.iframe_buster_buster();this.apply_story_styling();this.apply_tipsy_titles();this.load_recommended_feeds();this.setup_dashboard_graphs();this.setup_howitworks_hovers();this.load_url_next_param()};NEWSBLUR.Reader.prototype={load_javascript_elements_on_page:function(){a(".NB-javascript").removeClass("NB-javascript")},resize_window:function(){var a,c=this.story_view;this.flags.page_view_showing_feed_view?(c="feed",a="page"):this.flags.feed_view_showing_story_view&&
(a=c="story");this.flags.scrolling_by_selecting_story_title=!0;clearTimeout(this.locks.scrolling);this.locks.scrolling=_.delay(_.bind(function(){this.flags.scrolling_by_selecting_story_title=!1},this),1E3);this.switch_taskbar_view(c,a);this.check_story_titles_last_story();this.flags.fetch_story_locations_in_feed_view=this.flags.fetch_story_locations_in_feed_view||_.throttle(_.bind(this.fetch_story_locations_in_feed_view,this),2E3);this.flags.fetch_story_locations_in_feed_view()},apply_resizable_layout:function(b){var c=
this.model.preference("story_pane_anchor"),d=!a(".right-pane").is(":visible");if(b){this.layout.contentLayout&&this.layout.contentLayout.destroy();this.layout.rightLayout&&this.layout.rightLayout.destroy();this.layout.leftCenterLayout&&this.layout.leftCenterLayout.destroy();this.layout.leftLayout&&this.layout.leftLayout.destroy();this.layout.outerLayout&&this.layout.outerLayout.destroy();var e=a.make("div").append(this.$s.$feed_stories.children()),f=a.make("div").append(this.$s.$story_titles.children())}a(".right-pane").removeClass("NB-story-pane-west").removeClass("NB-story-pane-north").removeClass("NB-story-pane-south").addClass("NB-story-pane-"+
c);this.layout.outerLayout=this.$s.$body.layout({closable:!0,center__paneSelector:".right-pane",west__paneSelector:".left-pane",west__size:this.model.preference("feed_pane_size"),west__onresize_end:a.rescope(this.save_feed_pane_size,this),spacing_open:4,resizerDragOpacity:0.6,resizeWhileDragging:!0,enableCursorHotkey:!1});this.layout.leftLayout=a(".left-pane").layout({closable:!1,resizeWhileDragging:!0,fxName:"scale",fxSettings:{duration:500,easing:"easeInOutQuint"},north__paneSelector:".left-north",
north__size:18,north__resizeable:!1,north__spacing_open:0,center__paneSelector:".left-center",center__resizable:!1,south__paneSelector:".left-south",south__size:31,south__resizable:!1,south__spacing_open:0,enableCursorHotkey:!1});this.layout.leftCenterLayout=a(".left-center").layout({closable:!1,slidable:!1,resizeWhileDragging:!0,center__paneSelector:".left-center-content",center__resizable:!1,south__paneSelector:".left-center-footer",south__size:"auto",south__resizable:!1,south__slidable:!0,south__spacing_open:0,
south__spacing_closed:0,south__closable:!0,south__initClosed:!0,fxName:"slide",fxSpeed:1E3,fxSettings:{duration:1E3,easing:"easeInOutQuint"},enableCursorHotkey:!1});var g={resizeWhileDragging:!0,center__paneSelector:".content-pane",spacing_open:c=="west"?4:10,resizerDragOpacity:0.6,enableCursorHotkey:!1};g[c+"__paneSelector"]=".right-north";g[c+"__size"]=this.model.preference("story_titles_pane_size");g[c+"__onresize_end"]=a.rescope(this.save_story_titles_pane_size,this);this.layout.rightLayout=a(".right-pane").layout(g);
g={resizeWhileDragging:!0,center__paneSelector:".content-center",spacing_open:0,resizerDragOpacity:0.6,enableCursorHotkey:!1};c=="west"?(g.north__paneSelector=".content-north",g.north__size=30):(g[c+"__paneSelector"]=".content-north",g[c+"__size"]=30);this.layout.contentLayout=this.$s.$content_pane.layout(g);b?(this.$s.$feed_stories.append(e.children()),this.$s.$story_titles.append(f.children()),this.resize_window(),d&&a(".right-pane").hide()):a(".right-pane").hide()},apply_tipsy_titles:function(){this.model.preference("show_tooltips")?
(a(".NB-taskbar-sidebar-toggle-close").tipsy({gravity:"se",delayIn:375}),a(".NB-taskbar-sidebar-toggle-open").tipsy({gravity:"sw",delayIn:375}),a(".NB-task-add").tipsy({gravity:"sw",delayIn:375}),a(".NB-task-manage").tipsy({gravity:"s",delayIn:375})):(a(".NB-taskbar-sidebar-toggle-close").tipsy("disable"),a(".NB-taskbar-sidebar-toggle-open").tipsy("disable"),a(".NB-task-add").tipsy("disable"),a(".NB-task-manage").tipsy("disable"))},save_feed_pane_size:function(b,c,d,e){b=e.size;a("#NB-splash").css("left",
b);this.flags.set_feed_pane_size=this.flags.set_feed_pane_size||_.debounce(_.bind(function(){this.model.preference("feed_pane_size",this.layout.outerLayout.state.west.size);this.flags.set_feed_pane_size=null},this),1E3);this.flags.set_feed_pane_size()},save_story_titles_pane_size:function(){this.flags.scrolling_by_selecting_story_title=!0;clearTimeout(this.locks.scrolling);var a=0;this.story_view=="feed"?a=this.$s.$feed_iframe.width():this.story_view=="story"&&(a=2*this.$s.$feed_iframe.width());this.$s.$story_pane.css("left",
-1*a);this.flags.set_story_titles_size=this.flags.set_story_titles_size||_.debounce(_.bind(function(){this.model.preference("story_titles_pane_size",this.layout.rightLayout.state[this.model.preference("story_pane_anchor")].size);this.flags.set_story_titles_size=null;this.locks.scrolling=_.delay(_.bind(function(){this.flags.scrolling_by_selecting_story_title=!1},this),100)},this),1E3);this.flags.set_story_titles_size();this.flags.resize_window=this.flags.resize_window||_.debounce(_.bind(function(){this.resize_window();
this.flags.resize_window=null},this),10);this.flags.resize_window()},cornerize_buttons:function(){a(".button").corner()},add_body_classes:function(){this.$s.$body.toggleClass("NB-is-premium",NEWSBLUR.Globals.is_premium);this.$s.$body.toggleClass("NB-is-anonymous",NEWSBLUR.Globals.is_anonymous);this.$s.$body.toggleClass("NB-is-authenticated",NEWSBLUR.Globals.is_authenticated)},hide_splash_page:function(){a(".right-pane").show();a("#NB-splash").hide();a(".NB-splash-info").hide();a("#NB-splash-overlay").hide();
this.$s.$body.layout().resizeAll();this.$s.$dashboard.addClass("NB-active");NEWSBLUR.Globals.is_anonymous&&this.setup_ftux_signup_callout()},show_splash_page:function(){this.reset_feed();this.unload_feed_iframe();this.unload_story_iframe();this.mark_feed_as_selected(null,null);a(".right-pane").hide();a(".NB-splash-info").show();a("#NB-splash").show();a("#NB-splash-overlay").show();this.$s.$dashboard.removeClass("NB-active")},iframe_buster_buster:function(){var b=this,c=0;window.onbeforeunload=function(){c++};
clearInterval(this.locks.iframe_buster_buster);this.locks.iframe_buster_buster=setInterval(function(){if(c>0&&(c-=2,!b.flags.iframe_view_loaded&&!b.flags.iframe_view_not_busting&&_.contains(["page","story"],b.story_view)&&b.active_feed))a(".task_view_feed").click(),a(".NB-feed-frame").attr("src",""),window.top.location="/reader/buster"},1)},add_url_from_querystring:function(){if(!this.flags.added_url_from_querystring){var b=a.getQueryString("url");this.flags.added_url_from_querystring=!0;b&&this.open_add_feed_modal({url:b})}},
load_url_next_param:function(){var b=a.getQueryString("next");b=="optout"?this.open_account_modal({animate_email:!0}):b=="goodies"?this.open_goodies_modal():b=="password"&&this.open_account_modal({change_password:!0});window.history.replaceState&&window.history.replaceState({},null,"/")},animate_progress_bar:function(a,c,d){var e=this,d=d||0,c=parseFloat(Math.max(1,parseInt(c,10)),10);time=d>90?c/5:d>80?c/12:d>70?c/30:d>60?c/80:d>50?c/120:d>40?c/160:d>30?c/200:d>20?c/300:d>10?c/400:c/500;d<=100&&
(this.locks.animate_progress_bar=setTimeout(function(){d+=1;a.progressbar({value:d});e.animate_progress_bar(a,c,d)},time*1E3))},get_current_story_from_story_titles:function(b){var c=this.$s.$feed_view,b=b||a(".NB-feed-story",c),d=this.active_story,e;d&&b.each(function(){if(a(this).data("story")==d.id)return e=a(this),!1});return e},get_current_story_id:function(){var a=this.get_current_story_from_story_titles();return a&&a.data("story_id")},find_feed_in_feed_list:function(b){if(_.contains(this.cache.$feed_in_feed_list,
b))return this.cache.$feed_in_feed_list[b];var c=this.$s.$feed_list,d=a([]);a(".feed",c).each(function(){parseInt(a(this).attr("data-id"),10)==b&&d.push(a(this).get(0))});return this.cache.$feed_in_feed_list[b]=d},find_folder_in_feed_list:function(b){var c=this.$s.$feed_list,d=a([]);a(".folder_title_text",c).each(function(){a(this).text()==b&&d.push(a(this).parents("li.folder").eq(0)[0])});return d},find_story_in_story_titles:function(b){var c=this.model.get_story(b),b=a(".story",this.$s.$story_titles),
d;c&&b.each(function(){var b=a(this);if(b.data("story_id")==c.id)return d=b,!1});return d},find_story_in_feed_view:function(b){if(b){for(var c=a(".NB-feed-story",this.$s.$feed_view),d,e=0,f=c.length;e<f;e++)if(c.eq(e).data("story")==b.id){d=c.eq(e);break}return d}},find_story_in_feed_iframe:function(b,c){if(!b)return a([]);var c=c||this.$s.$feed_iframe.contents(),d=a([]);if(this.flags.iframe_story_locations_fetched||b.id in this.cache.iframe_stories)return this.cache.iframe_stories[b.id];var e=b.story_title.replace(/&nbsp;|[^a-z0-9-,]/gi,
""),f=function(b,c){if(b&&b.nodeType==3)b.data.replace(/&nbsp;|[^a-z0-9-,]/gi,"").indexOf(c)>=0&&d.push(a(b).parent());else if(b&&b.nodeType==1&&b.childNodes&&!/(script|style)/i.test(b.tagName))for(var e=0;e<b.childNodes.length;++e)e+=f(b.childNodes[e],c);return 0};f(c.find("body")[0],e);d=d.filter(function(){return a(this).is(":visible")});if(!d.length)this.cache.iframe.headers=this.cache.iframe.headers||a("h1,h2,h3,h4,h5,h6",c).filter(":visible"),this.cache.iframe.headers.each(function(){pos=a(this).text().replace(/&nbsp;|[^a-z0-9-,]/gi,
"").indexOf(e);if(pos>=0)return d.push(a(this)),!1});if(!d.length)this.cache.iframe.posts=this.cache.iframe.posts||a(".entry,.post,.postProp,#postContent,.article",c).filter(":visible"),this.cache.iframe.posts.each(function(){pos=a(this).text().replace(/&nbsp;|[^a-z0-9-,]/gi,"").indexOf(e);if(pos>=0)return d.push(a(this)),!1});var g=0,j=a([]);d.each(function(){var b=a(this),c=parseInt(b.css("font-size"),10);c>g&&(g=c,j=a([]));c==g&&j.push(b)});var k=a([]);if(j.length>1){var l=100;j.each(function(){var c=
a(this),d=c.text(),d=Math.abs(d.length-b.story_title.length);d<l&&(l=d,k=c)})}k.length||(k=j[0]);if(k&&k.length){var p=this;this.cache.iframe_stories[b.id]=k;var t=parseInt(k.offset().top,10);this.cache.iframe_story_positions[t]=b;this.cache.iframe_story_positions_keys.push(t);if(!this.flags.iframe_view_not_busting){var v=this.active_feed;_.delay(function(){v==p.active_feed&&(p.flags.iframe_view_not_busting=!0)},1E3)}}return k},get_feed_ids_in_folder:function(b){var c=this,b=b||this.$s.$feed_list;
a(".feed:not(.NB-empty)",b);return _.compact(_.map(a(".feed:not(.NB-empty)",b),function(b){b=parseInt(a(b).attr("data-id"),10);if(c.model.get_feed(b).active)return b}))},show_next_story:function(b){var c=this.$s.$story_titles,d=a(".selected:first",c),e;d.length?b==1?e=d.nextAll(".story:visible").eq(0):b==-1&&(e=d.prevAll(".story:visible").eq(0)):e=d=a(".story:first",c);if(b=e.data("story_id"))b=this.model.get_story(b),this.push_current_story_on_history(),this.open_story(b,e),this.scroll_story_titles_to_show_selected_story_title(e)},
show_next_unread_story:function(){var b=this.$s.$story_titles,c=a(".selected",b);if(this.get_unread_count(!0))if(c.length?(b=c.nextAll(".story:not(.read):visible").eq(0),b.length||(b=c.prevAll(".story:not(.read):visible").eq(0))):b=a(".story:not(.read):visible:first",b),b&&b.length){if(this.counts.find_next_unread_on_page_of_feed_stories_load=0,c=b.data("story_id"))c=this.model.get_story(c),this.push_current_story_on_history(),this.open_story(c,b),this.scroll_story_titles_to_show_selected_story_title(b)}else this.counts.find_next_unread_on_page_of_feed_stories_load<
this.constants.FILL_OUT_PAGES&&(this.counts.find_next_unread_on_page_of_feed_stories_load+=1,this.load_page_of_feed_stories())},open_next_unread_story_across_feeds:function(){if(!this.active_feed||!this.get_unread_count(!0)){var a=this.get_next_unread_feed(1);this.open_feed(parseInt(a.attr("data-id"),10),!0,a)}this.show_next_unread_story()},show_last_unread_story:function(){var b=this.$s.$story_titles,c=a(".selected",b),d,e=this.get_unread_count(!0);NEWSBLUR.log(["show_last_unread_story",e,c]);if(e)if(a(".story:not(.read):visible",
b).length>=e&&(d=a(".story:not(.read):visible:last",b)),d&&d.length){if(this.counts.find_last_unread_on_page_of_feed_stories_load=0,b=d.data("story_id"))b=this.model.get_story(b),this.push_current_story_on_history(),this.open_story(b,d),this.scroll_story_titles_to_show_selected_story_title(d)}else this.counts.find_last_unread_on_page_of_feed_stories_load<this.constants.FILL_OUT_PAGES&&(this.counts.find_last_unread_on_page_of_feed_stories_load+=1,this.load_page_of_feed_stories())},show_previous_story:function(){if(this.cache.previous_stories_stack.length){var a=
this.cache.previous_stories_stack.pop();if(a.length&&!a.is(":visible"))this.show_previous_story();else{var c=a.data("story_id");c&&(this.open_story(this.model.get_story(c),a),this.scroll_story_titles_to_show_selected_story_title(a))}}},scroll_story_titles_to_show_selected_story_title:function(a){var c=this.$s.$story_titles;if(!c.isScrollVisible(a)){c.position();var a=a.position().top,d=c.scrollTop(),e=c.outerHeight();c.scrollTop(a+d-e/5)}},show_next_feed:function(a,c){var d=this.$s.$feed_list,e=this.get_next_feed(a,
c),f=parseInt(e.attr("data-id"),10);if(f&&f==this.active_feed)this.show_next_feed(a,e);else if(f){var g=d.scrollTop()+e.offset().top-e.outerHeight(),j=d.height()-100;scroll=g>j?g:0;d.scrollTop(scroll);this.open_feed(f,!1,e,350)}},get_next_feed:function(b,c){var d=this.$s.$feed_list,c=c||a(".selected",d),e=a(".feed:visible:not(.NB-empty)",d).add(".feed.selected");c.length?(e.each(function(a){if(this==c[0])return current_feed=a,!1}),d=e.eq((current_feed+b)%e.length)):d=c=a(".feed:visible:not(.NB-empty)",
d)[b==1?"first":"last"]();return d},get_next_unread_feed:function(b,c){var d=this.$s.$feed_list,c=c||a(".selected",d),e=this.get_unread_view_name(),d=a(".feed:visible:not(.NB-empty)",d).filter(function(){var b=a(this);if(e=="positive")return b.is(".unread_positive");else if(e=="neutral")return b.is(".unread_positive,.unread_neutral");else if(e=="negative")return b.is(".unread_positive,.unread_neutral,.unread_negative")}).add(".feed.selected");c.length?(d.each(function(a){if(this==c[0])return current_feed=
a,!1}),d=d.eq((current_feed+b)%d.length)):d=d.first();return d},get_current_folder:function(){var b=a(".folder.NB-selected",this.$s.$feed_list);if(b.length)return b.eq(0)},navigate_story_titles_to_story:function(a){if(a){var c=this.find_story_in_story_titles(a.id);if(c&&c.length&&c.is(":visible")&&!c.hasClass("selected")&&(this.scroll_story_titles_to_show_selected_story_title(c),this.active_story!=a))this.push_current_story_on_history(),this.active_story=a,this.mark_story_title_as_selected(c),this.mark_story_as_read(a.id),
this.mark_story_as_read_in_feed_view(a,{animate:this.story_view=="feed"})}},mark_story_as_read_in_feed_view:function(a){a&&($story=this.cache.feed_view_stories[a.id]||this.find_story_in_feed_view(a))&&$story.addClass("read")},page_in_story:function(a,c){var d=this.$s.$story_pane.height(),d=parseInt(d*a,10),e="+";c==-1&&(e="-");this.story_view=="page"?this.$s.$feed_iframe.scrollTo({top:e+"="+d,left:"+=0"},260):this.story_view=="feed"&&this.$s.$feed_stories.scrollTo({top:e+"="+d,left:"+=0"},370)},push_current_story_on_history:function(){var b=
a(".selected",this.$s.$story_titles);b.length&&this.cache.previous_stories_stack.push(b)},load_feeds:function(){if(a("#feed_list").length)a(".NB-callout-ftux .NB-callout-text").text("Loading feeds..."),this.$s.$feed_link_loader.css({display:"block"}),this.flags.favicons_downloaded=!1,this.model.load_feeds(a.rescope(this.make_feeds,this))},make_feeds:function(){var b=this.$s.$feed_list,c=this.model.folders;b.empty();this.$s.$story_taskbar.css({display:"block"});this.flags.has_chosen_feeds=this.detect_all_inactive_feeds();
var d=this.make_feeds_folder(c,0);b.css({display:"block",opacity:0});b.html(d);this.count_collapsed_unread_stories();b.animate({opacity:1},{duration:700});this.hover_over_feed_titles(b);this.$s.$feed_link_loader.fadeOut(250);c.length&&(a(".NB-task-manage").removeClass("NB-disabled"),a(".NB-callout-ftux").fadeOut(500));if(NEWSBLUR.Globals.is_authenticated&&this.flags.has_chosen_feeds)_.delay(_.bind(this.start_count_unreads_after_import,this),1E3),this.force_feeds_refresh(a.rescope(this.finish_count_unreads_after_import,
this),!0);else if(!this.flags.has_chosen_feeds&&this.flags.favicons_downloaded&&c.length){_.defer(_.bind(this.open_feedchooser_modal,this),100);return}else NEWSBLUR.Globals.is_authenticated&&!c.length&&this.setup_ftux_add_feed_callout();c.length&&(this.load_sortable_feeds(),this.update_header_counts(),_.delay(_.bind(this.update_starred_count,this),250));this.flags.showing_feed_in_tryfeed_view&&(this.hide_tryfeed_view(),this.force_feed_refresh());this.add_url_from_querystring();_.defer(_.bind(function(){this.model.load_feed_favicons(a.rescope(this.make_feed_favicons,
this),this.flags.favicons_downloaded,this.flags.has_chosen_feeds);this.setup_socket_realtime_unread_counts()},this))},make_feed_favicons:function(){var b=this.model;this.flags.favicons_downloaded=!0;a(".feed_favicon",this.$s.$feed_list).each(function(){var c=a(this),d=c.closest(".feed").attr("data-id");c.attr("src",a.favicon(b.get_feed(d).favicon))});!this.flags.has_chosen_feeds&&this.model.folders.length&&_.defer(_.bind(this.open_feedchooser_modal,this),100)},sort_items:function(a){var c=this,d=
this.model.preference("feed_order");if(d=="ALPHABETICAL"||!d)return a.sort(function(a,b){var d,j;_.isNumber(a)&&(d=c.model.get_feed(a));_.isNumber(b)&&(j=c.model.get_feed(b));if(d&&j)return d.feed_title.toLowerCase()>j.feed_title.toLowerCase()?1:-1;else if(d&&!j)return-1;else if(!d&&j)return 1;else if(!d&&!j&&!_.isNumber(a)&&!_.isNumber(b))return d=_.keys(a)[0],j=_.keys(b)[0],d.toLowerCase()>j.toLowerCase()?1:-1});else if(d=="MOSTUSED")return a.sort(function(a,b){var d,j;_.isNumber(a)&&(d=c.model.get_feed(a));
_.isNumber(b)&&(j=c.model.get_feed(b));if(d&&j)return d.feed_opens<j.feed_opens?1:d.feed_opens>j.feed_opens?-1:d.feed_title.toLowerCase()>j.feed_title.toLowerCase()?1:-1;else if(d&&!j)return-1;else if(!d&&j)return 1;else if(!d&&!j&&!_.isNumber(a)&&!_.isNumber(b))return d=_.keys(a)[0],j=_.keys(b)[0],d.toLowerCase()>j.toLowerCase()?1:-1})},sort_feeds:function(b){a(".feed",b).tsort(".feed_title");a(".folder",b).tsort(".folder_title_text")},detect_all_inactive_feeds:function(){return _.any(this.model.feeds,
function(a){return a.active})},make_feeds_folder:function(a,c){var d="",a=this.sort_items(a),e;for(e in a){var f=a[e];if(typeof f=="number"){if(f=this.model.get_feed(f)){var g=this.make_feed_title_template(f,"feed",c);d+=g;f.not_yet_fetched&&(this.flags.has_unfetched_feeds=!0)}}else if(typeof f=="object"&&f)for(var j in f){var g=_.contains(NEWSBLUR.Preferences.collapsed_folders,j),k=f[j],l=_.template('                        <li class="folder">                          <div class="folder_title <% if (depth == 0) { %>NB-toplevel<% } %>">                            <div class="NB-folder-icon"></div>                            <div class="NB-feedlist-collapse-icon" title="<% if (is_collapsed) { %>Expand Folder<% } else {%>Collapse Folder<% } %>"></div>                            <div class="NB-feedlist-manage-icon"></div>                            <span class="folder_title_text"><%= folder_title %></span>                          </div>                          <ul class="folder" <% if (is_collapsed) { %>style="display: none"<% } %>>                        ',
{depth:c,folder_title:j,is_collapsed:g});d+=l+this.make_feeds_folder(k,c+1,g)+"</ul></li>"}}d+='<li class="feed NB-empty"></li>';return d},make_feed_title_template:function(a,c,d){var e="",f="";a.ps&&(e+=" unread_positive");a.nt&&(e+=" unread_neutral");a.ng&&(e+=" unread_negative");a.has_exception&&a.exception_type=="feed"&&(f+=" NB-feed-exception");a.not_yet_fetched&&!a.has_exception&&(f+=" NB-feed-unfetched");a.active||(f+=" NB-feed-inactive");var g=this.make_feed_counts_floater(a.ps,a.nt,a.ng,
!0);return _.template('            <<%= list_type %> class="feed <%= unread_class %> <%= exception_class %> <% if (toplevel) { %>NB-toplevel<% } %>" data-id="<%= feed.id %>">              <div class="feed_counts">                <%= feed_counts_floater %>              </div>              <img class="feed_favicon" src="<%= $.favicon(feed.favicon, true) %>">              <span class="feed_title">                <%= feed.feed_title %>                <% if (type == "story") { %>                  <span class="NB-feedbar-train-feed" title="Train Intelligence"></span>                  <span class="NB-feedbar-statistics" title="Statistics"></span>                <% } %>              </span>              <% if (type == "story") { %>                <div class="NB-feedbar-last-updated">                  <span class="NB-feedbar-last-updated-label">Updated:</span>                  <span class="NB-feedbar-last-updated-date">                    <% if (feed.updated) { %>                      <%= feed.updated %> ago                    <% } else { %>                      Loading...                    <% } %>                  </span>                </div>                <div class="NB-feedbar-mark-feed-read">Mark All as Read</div>              <% } %>              <div class="NB-feed-exception-icon"></div>              <div class="NB-feed-unfetched-icon"></div>              <div class="NB-feedlist-manage-icon"></div>            </<%= list_type %>>            ',
{feed:a,type:c,feed_counts_floater:g,unread_class:e,exception_class:f,toplevel:d==0,list_type:c=="feed"?"li":"div"})},make_feed_counts_floater:function(b,c,d,e){var f="";b&&(f+=" unread_positive");c&&(f+=" unread_neutral");d&&(f+=" unread_negative");b=_.template('            <div class="feed_counts_floater <%= unread_class %>">              <span class="unread_count unread_count_positive <% if (positive_count) { %>unread_count_full<% } else { %>unread_count_empty<% } %>">                <%= positive_count %>              </span>              <span class="unread_count unread_count_neutral <% if (neutral_count) { %>unread_count_full<% } else { %>unread_count_empty<% } %>">                <%= neutral_count %>              </span>              <span class="unread_count unread_count_negative <% if (negative_count) { %>unread_count_full<% } else { %>unread_count_empty<% } %>">                <%= negative_count %>              </span>            </div>            ',
{positive_count:b,neutral_count:c,negative_count:d,unread_class:f});e||(b=a(b));return b},load_sortable_feeds:function(){var a=this;this.$s.$feed_list.sortable({items:".feed,li.folder",connectWith:"ul.folder,.feed.NB-empty",placeholder:"NB-feeds-list-highlight",axis:"y",distance:4,cursor:"move",containment:".NB-feedlist",tolerance:"pointer",scrollSensitivity:35,start:function(c,d){a.flags.sorting_feed=!0;d.placeholder.attr("class",d.item.attr("class")+" NB-feeds-list-highlight");d.item.addClass("NB-feed-sorting");
a.$s.$feed_list.addClass("NB-feed-sorting");d.item.is(".folder")?(d.placeholder.html(d.item.children().clone()),d.item.data("previously_collapsed",d.item.data("collapsed")),a.collapse_folder(d.item.children(".folder_title"),!0),a.collapse_folder(d.placeholder.children(".folder_title"),!0),d.item.css("height",d.item.children(".folder_title").outerHeight(!0)+"px"),d.helper.css("height",d.helper.children(".folder_title").outerHeight(!0)+"px")):d.placeholder.html(d.item.children().clone())},change:function(c,
d){var e=d.placeholder.closest("ul.folder");a.sort_feeds(e)},stop:function(c,d){setTimeout(function(){a.flags.sorting_feed=!1},100);d.item.removeClass("NB-feed-sorting");a.$s.$feed_list.removeClass("NB-feed-sorting");a.sort_feeds(c.target);a.save_feed_order();d.item.css({backgroundColor:"#D7DDE6"}).animate({backgroundColor:"#F0F076"},{duration:800}).animate({backgroundColor:"#D7DDE6"},{duration:1E3});d.item.is(".folder")&&!d.item.data("previously_collapsed")&&(a.collapse_folder(d.item.children(".folder_title")),
a.collapse_folder(d.placeholder.children(".folder_title")))}})},save_feed_order:function(){var a=function(c){for(var d=[],c=c.children("li.folder, .feed"),e=0,f=c.length;e<f;e++){var g=c.eq(e);if(g.hasClass("feed"))(g=parseInt(g.attr("data-id"),10))&&d.push(g);else if(g.hasClass("folder")){var j=g.find(".folder_title_text").eq(0).text(),k={};k[j]=a(g.children("ul.folder").eq(0));d.push(k)}}return d};this.model.save_feed_order(a(this.$s.$feed_list))},count_collapsed_unread_stories:function(){var b=
this;_.each(NEWSBLUR.Preferences.collapsed_folders,_.bind(function(b){var d=a(".folder_title_text",this.$s.$feed_list).filter(function(){return a.trim(a(this).text())==a.trim(b)}).closest(".folder_title");this.collapse_folder(d,!0);var e=d.parent("li.folder").children("ul.folder");this.show_collapsed_folder_count(d,e,{skip_animation:!0})},this));this.model.preference("folder_counts")&&a(".folder_title",this.$s.$feed_list).each(function(){var c=a(this);if(!_.contains(NEWSBLUR.Preferences.collapsed_folders,
c.text())){var d=c.parent("li.folder").children("ul.folder");b.show_collapsed_folder_count(c,d,{skip_animation:!0})}})},collapse_folder:function(b,c){var d=this,e=b.parent("li.folder"),f=e.children("ul.folder");if(c||f.length&&f.eq(0).is(":visible")&&!e.data("collapsed"))this.model.collapsed_folders(a(".folder_title_text",b).text(),!0),e.data("collapsed",!0).addClass("NB-folder-collapsed"),f.animate({opacity:0},{queue:!1,duration:c?0:200,complete:function(){d.show_collapsed_folder_count(b,f);f.slideUp({duration:270,
easing:"easeOutQuart"})}});else if(f.length&&(e.data("collapsed")||!f.eq(0).is(":visible")))this.model.collapsed_folders(a(".folder_title_text",b).text(),!1),e.data("collapsed",!1).removeClass("NB-folder-collapsed"),this.model.preference("folder_counts")||this.hide_collapsed_folder_count(b),f.css({opacity:0}).slideDown({duration:240,easing:"easeInOutCubic",complete:function(){f.animate({opacity:1},{queue:!1,duration:200})}})},show_collapsed_folder_count:function(b,c,d){var d=d||{},e=a(".feed_counts_floater",
b);e.remove();var c=a("li.feed",c).not(".NB-feed-inactive"),f=a(".NB-feedlist-collapse-icon",b),g=0,j=0,k=0;a(".unread_count_positive.unread_count_full",c).each(function(){g+=parseInt(a(this).text(),10)});a(".unread_count_neutral.unread_count_full",c).each(function(){j+=parseInt(a(this).text(),10)});a(".unread_count_negative.unread_count_full",c).each(function(){k+=parseInt(a(this).text(),10)});b.hasClass("NB-hover")&&(f.animate({opacity:0},{duration:d.skip_animation?0:100}),b.addClass("NB-feedlist-folder-title-recently-collapsed"),
b.one("mouseover",function(){f.css({opacity:""});b.removeClass("NB-feedlist-folder-title-recently-collapsed")}));e=this.make_feed_counts_floater(g,j,k);b.prepend(e.css({opacity:0}));e.animate({opacity:1},{duration:d.skip_animation?0:400})},hide_collapsed_folder_count:function(b){var c=a(".feed_counts_floater",b),d=a(".NB-feedlist-collapse-icon",b);c.animate({opacity:0},{duration:300});d.animate({opacity:0.6},{duration:400});b.removeClass("NB-feedlist-folder-title-recently-collapsed");b.one("mouseover",
function(){d.css({opacity:""})})},hover_over_feed_titles:function(b){var c=this,b=b||this.$s.$feed_list,b=b.is(".feed")?b:a(".feed, .folder_title",b);b.unbind("mouseenter").unbind("mouseleave");b.hover(function(){if(!c.$s.$feed_list.hasClass("NB-feed-sorting")){var b=a(this);b.offset().top>a(window).height()-270&&b.addClass("NB-hover-inverse")}},function(){a(this).removeClass("NB-hover-inverse")})},show_feed_chooser_button:function(){var b=this.$s.$feeds_progress;a(".NB-progress-bar",b);a(".NB-progress-title",
b).text("Get Started");a(".NB-progress-counts",b).hide();a(".NB-progress-percentage",b).hide();b.addClass("NB-progress-error").addClass("NB-progress-big");a(".NB-progress-link",b).html(a.make("a",{href:"#",className:"NB-splash-link NB-menu-manage-feedchooser"},"Choose your 64"));this.show_progress_bar()},hide_feed_chooser_button:function(){var b=this.$s.$feeds_progress;a(".NB-progress-bar",b);b.removeClass("NB-progress-error").removeClass("NB-progress-big");this.hide_progress_bar()},check_feed_fetch_progress:function(){a.extend(this.counts,
{unfetched_feeds:0,fetched_feeds:0});if(this.flags.has_unfetched_feeds){var b=this.model.count_unfetched_feeds();this.counts.unfetched_feeds=b.unfetched_feeds;this.counts.fetched_feeds=b.fetched_feeds;this.counts.unfetched_feeds==0?(this.flags.has_unfetched_feeds=!1,this.hide_unfetched_feed_progress()):(this.flags.has_unfetched_feeds=!0,this.show_unfetched_feed_progress())}},show_progress_bar:function(){var a=this.$s.$feeds_progress.parents(".left-center").layout();if(!this.flags.showing_progress_bar)this.flags.showing_progress_bar=
!0,a.open("south");a.sizePane("south")},hide_progress_bar:function(a){a&&this.model.preference("hide_fetch_progress",!0);this.flags.showing_progress_bar=!1;this.$s.$feeds_progress.parents(".left-center").layout().close("south")},show_unfetched_feed_progress:function(){var b=this,c=this.$s.$feeds_progress,d=parseInt(this.counts.fetched_feeds/(this.counts.unfetched_feeds+this.counts.fetched_feeds)*100,10);a(".NB-progress-title",c).text("Fetching your feeds");a(".NB-progress-counts",c).show();a(".NB-progress-counts-fetched",
c).text(this.counts.fetched_feeds);a(".NB-progress-counts-total",c).text(this.counts.unfetched_feeds+this.counts.fetched_feeds);a(".NB-progress-percentage",c).show().text(d+"%");a(".NB-progress-bar",c).progressbar({value:d});!c.is(":visible")&&!this.model.preference("hide_fetch_progress")&&setTimeout(function(){b.show_progress_bar()},1E3);this.setup_feed_refresh(!0)},hide_unfetched_feed_progress:function(a){a&&this.model.preference("hide_fetch_progress",!0);this.setup_feed_refresh();this.hide_progress_bar()},
switch_preferences_hide_read_feeds:function(){var b=parseInt(this.model.preference("hide_read_feeds"),10),c=a(".NB-feeds-header-sites");this.model.preference("show_tooltips")&&(b?(c.tipsy("hide"),c.attr("title","Show only unread stories")):(c.tipsy("hide"),c.attr("title","Show all sites")),c.tipsy("show"));this.model.preference("hide_read_feeds",b?0:1);this.switch_feed_view_unread_view()},reset_feed:function(){a.extend(this.flags,{iframe_story_locations_fetched:!1,iframe_view_loaded:!1,iframe_view_not_busting:!1,
feed_view_images_loaded:{},feed_view_positions_calculated:!1,scrolling_by_selecting_story_title:!1,switching_to_feed_view:!1,page_view_showing_feed_view:!1,feed_view_showing_story_view:!1,iframe_fetching_story_locations:!1,story_titles_loaded:!1,iframe_prevented_from_loading:!1,pause_feed_refreshing:!1,feed_list_showing_manage_menu:!1,unread_threshold_temporarily:null,river_view:!1,non_premium_river_view:!1});a.extend(this.cache,{iframe:{},iframe_stories:{},feed_view_stories:{},iframe_story_positions:{},
feed_view_story_positions:{},iframe_story_positions_keys:[],feed_view_story_positions_keys:[],previous_stories_stack:[],river_feeds_with_unreads:[],mouse_position_y:parseInt(this.model.preference("lock_mouse_indicator"),10),prefetch_last_story:0,prefetch_iteration:0,feed_title_floater_feed_id:null,feed_title_floater_story_id:null,last_feed_view_story_feed_id:null,$feed_in_feed_list:{},$feed_counts_in_feed_list:{}});a.extend(this.counts,{page_fill_outs:0,find_next_unread_on_page_of_feed_stories_load:0,
find_last_unread_on_page_of_feed_stories_load:0});this.active_story=this.active_feed=null;this.$s.$story_titles.data("page",1);this.$s.$story_titles.data("feed_id",null);this.$s.$feed_stories.scrollTop(0);this.$s.$feed_stories.empty();this.$s.$story_titles.empty();this.$s.$starred_header.removeClass("NB-selected");this.$s.$river_header.removeClass("NB-selected");this.$s.$tryfeed_header.removeClass("NB-selected");a(".NB-selected",this.$s.$feed_list).removeClass("NB-selected");this.$s.$body.removeClass("NB-view-river");
a(".task_view_page",this.$s.$taskbar).removeClass("NB-disabled");a(".task_view_page",this.$s.$taskbar).removeClass("NB-task-return");this.hide_content_pane_feed_counter();this.flags.showing_feed_in_tryfeed_view&&this.hide_tryfeed_view()},open_feed:function(b,c,d,e){var f=this,g=this.$s.$story_titles;this.flags.opening_feed=!0;if(b!=this.active_feed||c)g.empty().scrollTop(0),this.reset_feed(),this.hide_splash_page(),this.next_feed=this.active_feed=b,this.show_stories_progress_bar(),g.data("page",1),
g.data("feed_id",b),this.iframe_scroll=null,this.set_correct_story_view_for_feed(b),d=d||a(".feed.selected",this.$s.$feed_list).eq(0),this.mark_feed_as_selected(b,d),this.show_feed_title_in_stories(b),this.show_feedbar_loading(),this.switch_taskbar_view(this.story_view),_.delay(_.bind(function(){(!e||b==f.next_feed)&&this.model.load_feed(b,1,!0,a.rescope(this.post_open_feed,this))},this),e||0),!this.story_view||this.story_view=="page"?_.delay(_.bind(function(){(!e||b==this.next_feed)&&this.load_feed_iframe(b)},
this),e||0):(this.unload_feed_iframe(),this.flags.iframe_prevented_from_loading=!0),this.setup_mousemove_on_views()},post_open_feed:function(b,c,d){if(!c)return this.open_feed(this.active_feed,!0);var e=c.stories,b=c.feed_id;if(c.dupe_feed_id&&this.active_feed==c.dupe_feed_id)this.active_feed=c.feed_id;if(this.active_feed==b)this.flags.opening_feed=!1,this.flags.feed_view_positions_calculated=!1,this.story_titles_clear_loading_endbar(),this.create_story_titles(e),this.make_story_feed_entries(e,d),
this.show_feed_hidden_story_title_indicator(!0),this.show_story_titles_above_intelligence_level({animate:!1}),this.fill_out_story_titles(),a(".NB-feedbar-last-updated-date").text(c.last_update+" ago"),this.counts.find_next_unread_on_page_of_feed_stories_load?this.show_next_unread_story(!0):this.counts.find_last_unread_on_page_of_feed_stories_load&&this.show_last_unread_story(!0),this.flags.story_titles_loaded=!0,d?this.story_view=="page"?this.flags.iframe_view_loaded?(d=this.$s.$feed_iframe.contents(),
this.fetch_story_locations_in_story_frame(0,!0,d)):_.delay(_.bind(function(){this.prefetch_story_locations_in_story_frame()},this),250):this.story_view=="feed"?this.prefetch_story_locations_in_feed_view():this.story_view=="story"&&this.show_next_story(1):(c=this.cache.iframe_story_positions_keys.length,this.flags.iframe_story_locations_fetched=!1,d=this.$s.$feed_iframe.contents(),this.fetch_story_locations_in_story_frame(c,!1,d),(this.story_view=="feed"||this.flags.page_view_showing_feed_view)&&this.prefetch_story_locations_in_feed_view()),
this.flags.open_unread_stories_in_tabs&&_.defer(_.bind(this.open_unread_stories_in_tabs,this)),this.hide_stories_progress_bar(),this.flags.showing_feed_in_tryfeed_view&&this.show_tryfeed_add_button(),this.make_content_pane_feed_counter(b)},setup_mousemove_on_views:function(){var b=this.$s.$feed_iframe.contents();b.unbind("scroll").scroll(a.rescope(this.handle_scroll_feed_iframe,this));this.hide_mouse_indicator();b.unbind("mousemove.reader").bind("mousemove.reader",a.rescope(this.handle_mousemove_iframe_view,
this));this.$s.$content_pane.unbind("mouseleave.reader").bind("mouseleave.reader",a.rescope(this.hide_mouse_indicator,this));this.$s.$content_pane.unbind("mouseenter.reader").bind("mouseenter.reader",a.rescope(this.show_mouse_indicator,this))},set_correct_story_view_for_feed:function(b,c){var d=this.model.get_feed(b),c=c||this.model.view_setting(b);d&&d.has_exception&&d.exception_type=="page"?(c=="page"&&(c="feed"),a(".task_view_page").addClass("NB-exception-page")):a(".task_view_page").removeClass("NB-exception-page");
this.story_view=c},update_header_counts:function(b){if(!b)(b=_.select(this.model.feeds,function(a){return a.active}).length)&&a(".NB-feeds-header-right .NB-feeds-header-sites").text(b+Inflector.pluralize(" site",b));var c=_.reduce(this.model.feeds,function(a,b){b.active&&(a.positive+=b.ps,a.neutral+=b.nt,a.negative+=b.ng);return a},{positive:0,negative:0,neutral:0});_(["positive","neutral","negative"]).each(function(b){var e=a(".NB-feeds-header-"+b);e.text(c[b]);e.toggleClass("NB-empty",c[b]==0)})},
update_starred_count:function(){var b=this.model.starred_count,c=a(".NB-feeds-header-count",this.$s.$starred_header),d=this.$s.$starred_header.closest(".NB-feeds-header-container");b<=0?(this.$s.$starred_header.addClass("NB-empty"),c.text(""),d.slideUp(350)):b>0&&(c.text(b),this.$s.$starred_header.removeClass("NB-empty"),d.slideDown(350))},open_starred_stories:function(){var b=this.$s.$story_titles;b.empty().scrollTop("0px");this.reset_feed();this.hide_splash_page();this.active_feed="starred";b.data("page",
1);b.data("feed_id",null);this.iframe_scroll=null;this.mark_feed_as_selected(null,null);this.show_correct_feed_in_feed_title_floater();this.$s.$starred_header.addClass("NB-selected");this.$s.$body.addClass("NB-view-river");this.flags.river_view=!0;a(".task_view_page",this.$s.$taskbar).addClass("NB-disabled");(b=NEWSBLUR.Preferences.view_settings[this.active_feed])||(b="feed");this.set_correct_story_view_for_feed(this.active_feed,b);this.show_feedbar_loading();this.switch_taskbar_view(this.story_view);
this.setup_mousemove_on_views();this.model.fetch_starred_stories(1,_.bind(this.post_open_starred_stories,this),!0)},post_open_starred_stories:function(a,c){if(this.active_feed=="starred")this.flags.feed_view_positions_calculated=!1,this.story_titles_clear_loading_endbar(),this.create_story_titles(a.stories,{river_stories:!0}),this.make_story_feed_entries(a.stories,c,{river_stories:!0}),this.show_story_titles_above_intelligence_level({animate:!1}),this.flags.story_titles_loaded=!0,this.prefetch_story_locations_in_feed_view(),
this.fill_out_story_titles()},open_river_stories:function(b,c){var d=this.$s.$story_titles,b=b||this.$s.$feed_list;d.empty().scrollTop("0px");this.reset_feed();this.hide_splash_page();c?(this.active_feed="river:"+c,b.addClass("NB-selected")):(this.active_feed="river:",this.$s.$river_header.addClass("NB-selected"));d.data("page",1);d.data("feed_id",null);this.iframe_scroll=null;this.flags.opening_feed=!0;this.mark_feed_as_selected(null,null);this.show_correct_feed_in_feed_title_floater();this.$s.$body.addClass("NB-view-river");
this.flags.river_view=!0;a(".task_view_page",this.$s.$taskbar).addClass("NB-disabled");(d=NEWSBLUR.Preferences.view_settings[this.active_feed])||(d="feed");this.set_correct_story_view_for_feed(this.active_feed,d);this.show_feedbar_loading();this.switch_taskbar_view(this.story_view);this.setup_mousemove_on_views();d=this.list_feeds_with_unreads_in_folder(b,!1,!0);this.cache.river_feeds_with_unreads=d;this.show_stories_progress_bar(d.length);this.model.fetch_river_stories(this.active_feed,d,1,_.bind(this.post_open_river_stories,
this),!0)},post_open_river_stories:function(a,c){if(this.active_feed&&this.active_feed.indexOf("river:")!=-1)!NEWSBLUR.Globals.is_premium&&NEWSBLUR.Globals.is_authenticated&&this.flags.river_view&&this.active_feed.indexOf("river:")!=-1&&(this.flags.non_premium_river_view=!0),this.flags.opening_feed=!1,this.flags.feed_view_positions_calculated=!1,this.story_titles_clear_loading_endbar(),this.create_story_titles(a.stories,{river_stories:!0}),this.make_story_feed_entries(a.stories,c,{river_stories:!0}),
this.show_story_titles_above_intelligence_level({animate:!1}),this.flags.story_titles_loaded=!0,this.counts.find_next_unread_on_page_of_feed_stories_load?this.show_next_unread_story(!0):this.counts.find_last_unread_on_page_of_feed_stories_load&&this.show_last_unread_story(!0),this.fill_out_story_titles(),this.prefetch_story_locations_in_feed_view(),this.hide_stories_progress_bar()},list_feeds_with_unreads_in_folder:function(b,c,d){var e=this.model,f=this.get_unread_view_name(),b=b||this.$s.$feed_list;
a(".feed:not(.NB-empty)",b);return _.compact(_.map(a(".feed:not(.NB-empty)",b),function(b){var b=parseInt(a(b).attr("data-id"),10),j=e.get_feed(b);if(j)if(c&&!d)return j.ps+j.nt+j.ng;else if(c&&d){if(f=="positive")return j.ps;if(f=="neutral")return j.ps+j.nt;if(f=="negative")return j.ps+j.nt+j.ng}else if(!c&&d){if(f=="positive")return j.ps&&b;if(f=="neutral")return(j.ps||j.nt)&&b;if(f=="negative")return(j.ps||j.nt||j.ng)&&b}else return(j.ps||j.nt||j.ng)&&b}))},show_stories_progress_bar:function(b){var c=
a.make("div",{className:"NB-river-progress"},[a.make("div",{className:"NB-river-progress-text"}),a.make("div",{className:"NB-river-progress-bar"})]).css({opacity:0});this.$s.$story_taskbar.append(c);c.animate({opacity:1},{duration:500,queue:!1});var d=a(".NB-river-progress-bar",c),b=b?b:this.get_unread_count(!1)/10;this.animate_progress_bar(d,b);a(".NB-river-progress-text",c).text("Fetching stories");d=c.width();d=this.$s.$story_taskbar.width()/2-d/2;c.css({left:d})},hide_stories_progress_bar:function(){var b=
a(".NB-river-progress",this.$s.$story_taskbar);b.stop().animate({opacity:0},{duration:250,queue:!1,complete:function(){b.remove()}})},open_story:function(a,c){var d;if(this.active_story!=a){this.active_story=a;this.mark_story_title_as_selected(c);this.mark_story_as_read_in_feed_view(a,{animate:!0});this.unload_story_iframe();clearTimeout(this.locks.scrolling);_.contains(["feed","page"],this.story_view)&&(this.flags.scrolling_by_selecting_story_title=!0);d=this.find_story_in_feed_view(a);if(this.story_view==
"page"){var e=this.find_story_in_feed_iframe(a);!e||!e.length||!this.flags.story_titles_loaded?(this.switch_to_correct_view(!1),this.scroll_to_story_in_story_feed(a,d),this.show_stories_preference_in_feed_view(!0)):(d=this.scroll_to_story_in_iframe(a,e),this.switch_to_correct_view(d))}else this.story_view=="feed"?(this.switch_to_correct_view(),this.scroll_to_story_in_story_feed(a,d),this.show_stories_preference_in_feed_view(!0)):this.story_view=="story"&&this.open_story_in_story_view(a);_.defer(_.bind(this.mark_story_as_read,
this,a.id))}},switch_to_correct_view:function(a){if(a===!1){if(this.story_view=="page"&&!this.flags.page_view_showing_feed_view)this.flags.page_view_showing_feed_view=!0,this.flags.feed_view_showing_story_view=!1,this.switch_taskbar_view("feed","page"),this.show_stories_preference_in_feed_view()}else if(this.story_view=="page"&&this.flags.page_view_showing_feed_view)this.flags.page_view_showing_feed_view=!1,this.flags.feed_view_showing_story_view=!1,this.switch_taskbar_view("page");else if(this.flags.feed_view_showing_story_view)this.flags.page_view_showing_feed_view=
!1,this.flags.feed_view_showing_story_view=!1,this.switch_taskbar_view(this.story_view,!0)},scroll_to_story_in_story_feed:function(b,c,d){var e=this,f=this.$s.$feed_view,g=this.$s.$feed_stories;if(!b||!c||!c.length)c=a(".story:first",f),b=this.model.get_story(c.data("story"));if(b&&c&&c.length){this.model.preference("animations")||(d=!0);if(c&&c.length)if(d||this.story_view=="feed"&&this.model.preference("feed_view_single_story")||this.story_view=="page"&&!this.flags.page_view_showing_feed_view)this.locks.scrolling=
setTimeout(function(){e.flags.scrolling_by_selecting_story_title=!1},100),g.scrollTo(c,{duration:0,axis:"y",offset:0});else if(this.story_view=="feed"||this.flags.page_view_showing_feed_view)g.scrollable().stop(),g.scrollTo(c,{duration:340,axis:"y",easing:"easeInOutQuint",offset:0,queue:!1,onAfter:function(){e.locks.scrolling=setTimeout(function(){e.flags.scrolling_by_selecting_story_title=!1},100)}});b=c.parents(".NB-feed-story-view").scrollTop();return c.offset().top+b}},scroll_to_story_in_iframe:function(a,
c,d){var e=this,a=this.$s.$feed_iframe;this.model.preference("animations")||(d=!0);return c&&c.length?(d||this.story_view=="feed"||this.story_view=="story"||this.flags.page_view_showing_feed_view?(a.scrollTo(c,{duration:0,axis:"y",offset:-24}),e.locks.scrolling=setTimeout(function(){e.flags.scrolling_by_selecting_story_title=!1},100)):this.story_view=="page"&&(a.scrollable().stop(),a.scrollTo(c,{duration:380,axis:"y",easing:"easeInOutQuint",offset:-24,queue:!1,onAfter:function(){e.locks.scrolling=
setTimeout(function(){e.flags.scrolling_by_selecting_story_title=!1},100)}})),d=c.parents(".NB-feed-story-view").scrollTop(),c.offset().top+d):!1},prefetch_story_locations_in_story_frame:function(){var b=this,c=this.model.stories,d=this.$s.$feed_iframe.contents(),e=3;this.cache.prefetch_iteration+=1;if(!this.flags.iframe_fetching_story_locations&&!this.flags.iframe_story_locations_fetched){d.unbind("scroll").scroll(a.rescope(this.handle_scroll_feed_iframe,this));d.unbind("mousemove.reader").bind("mousemove.reader",
a.rescope(this.handle_mousemove_iframe_view,this));var f=this.cache.iframe_story_positions_keys.length,g=_.last(this.cache.iframe_story_positions_keys),j=this.cache.iframe_story_positions[g],k;j&&(k=this.find_story_in_feed_iframe(j,d));var l;k&&k.length&&((l=parseInt(k.offset().top,10)==g)||a.extend(this.cache,{iframe_stories:{},iframe_story_positions:{},iframe_story_positions_keys:[]}));for(var p in c)if(!(l&&parseInt(p,10)<f)&&(g=this.find_story_in_feed_iframe(c[p],d),!g||!g.length||this.flags.iframe_fetching_story_locations||
this.flags.iframe_story_locations_fetched||parseInt(g.offset().top,10)>this.cache.prefetch_iteration*2E3)){if(g&&g.length)break;if(e)e-=1;else break}}!this.flags.iframe_fetching_story_locations&&!this.flags.iframe_story_locations_fetched&&setTimeout(function(){!b.flags.iframe_fetching_story_locations&&!b.flags.iframe_story_locations_fetched&&b.prefetch_story_locations_in_story_frame()},1E3)},fetch_story_locations_in_story_frame:function(b,c,d){var e=this,f=this.model.stories;b||(b=0);var g=f[b];d||
(d=this.$s.$feed_iframe.contents());this.flags.iframe_fetching_story_locations=!0;this.flags.iframe_story_locations_fetched=!1;c&&a.extend(this.cache,{iframe_stories:{},iframe_story_positions:{},iframe_story_positions_keys:[]});g&&g.story_feed_id==this.active_feed?(this.find_story_in_feed_iframe(g,d),setTimeout(function(){f.length-1>=b+1&&(b<3||e.cache.iframe_stories[f[b].id]&&e.cache.iframe_stories[f[b].id].length||e.cache.iframe_stories[f[b-1].id]&&e.cache.iframe_stories[f[b-1].id].length||e.cache.iframe_stories[f[b-
2].id]&&e.cache.iframe_stories[f[b-2].id].length)?(e.fetch_story_locations_in_story_frame(b+1,!1,d),e.flags.iframe_story_locations_fetched=!1):(NEWSBLUR.log(["iFrame view entirely loaded",b-2+" stories",e.cache.iframe_stories]),e.flags.iframe_story_locations_fetched=!0,e.flags.iframe_fetching_story_locations=!1,clearInterval(e.flags.iframe_scroll_snapback_check))},20)):g&&g.story_feed_id!=this.active_feed&&NEWSBLUR.log(["Switched off iframe early"])},open_story_link:function(a){window.open(a.story_permalink,
"_blank");window.focus()},mark_story_title_as_selected:function(b){a(".selected",this.$s.$story_titles).removeClass("selected");b.addClass("selected")},mark_story_as_read:function(a){var c=this,d=this.find_story_in_story_titles(a),e=parseInt(d.data("feed_id"),10)||this.active_feed;this.model.mark_story_as_read(a,e,function(d){c.update_read_count(a,e,!1,d)})},mark_story_as_unread:function(a,c){var d=this,c=c||this.model.get_story(a).story_feed_id;this.model.mark_story_as_unread(a,c,function(){d.update_read_count(a,
c,!0)})},update_read_count:function(b,c,d,e){if(!e){var e=this.model.get_feed(c),f=this.find_feed_in_feed_list(c),g=this.cache.$feed_counts_in_feed_list[c]||a(".feed_counts_floater",f),j=this.find_story_in_story_titles(b),k=this.$s.$content_pane,l=a(".feed_counts_floater",k),b=this.get_unread_view_name();this.cache.$feed_counts_in_feed_list[c]=g;j.toggleClass("read",!d);if(j.is(".NB-story-positive"))c=Math.max(e.ps+(d?1:-1),0),e.ps=c,a(".unread_count_positive",f).text(c),a(".unread_count_positive",
k).text(c),c==0?(f.removeClass("unread_positive"),g.removeClass("unread_positive")):(f.addClass("unread_positive"),g.addClass("unread_positive"));else if(j.is(".NB-story-neutral"))c=Math.max(e.nt+(d?1:-1),0),e.nt=c,a(".unread_count_neutral",f).text(c),a(".unread_count_neutral",k).text(c),c==0?(f.removeClass("unread_neutral"),g.removeClass("unread_neutral")):(f.addClass("unread_neutral"),g.addClass("unread_neutral"));else if(j.is(".NB-story-negative"))c=Math.max(e.ng+(d?1:-1),0),e.ng=c,a(".unread_count_negative",
f).text(c),a(".unread_count_negative",k).text(c),c==0?(f.removeClass("unread_negative"),g.removeClass("unread_negative")):(f.addClass("unread_negative"),g.addClass("unread_negative"));_.defer(function(){l.animate({opacity:1},{duration:250,queue:!1});_.delay(function(){l.animate({opacity:0.1},{duration:250,queue:!1})},400)});if(!f.is(":visible")||this.model.preference("folder_counts"))c=f.closest("li.folder:visible").children(".folder_title"),d=c.closest("li.folder").children("ul.folder, .feed"),this.show_collapsed_folder_count(c,
d);(b=="positive"&&e.ps==0||b=="neutral"&&e.ps==0&&e.nt==0||b=="negative"&&e.ps==0&&e.nt==0&&e.ng==0)&&_.delay(function(){l.animate({top:a("#story_taskbar").height()},{duration:500,queue:!1,easing:"easeOutQuint"})},500);this.update_header_counts(!0)}},mark_feed_as_read:function(a){a=a||this.active_feed;this.mark_feed_as_read_update_counts(a);this.model.mark_feed_as_read([a]);this.update_header_counts(!0);if(this.model.preference("folder_counts")){var a=this.find_feed_in_feed_list(a).closest("li.folder:visible").children(".folder_title"),
c=a.closest("li.folder").children("ul.folder, .feed");this.show_collapsed_folder_count(a,c)}},mark_folder_as_read:function(b,c){var c=c||this.get_current_folder(),b=b||a(".folder_title_text",c).eq(0).text(),d=this.get_feed_ids_in_folder(c);_.each(d,_.bind(function(a){this.mark_feed_as_read_update_counts(a)},this));this.mark_feed_as_read_update_counts(null,c);this.model.mark_feed_as_read(d);this.update_header_counts(!0);_.includes(this.active_feed,b)&&(a(".story:not(.read)",this.$s.$story_titles).addClass("read"),
_.each(this.model.stories,_.bind(function(a){this.mark_story_as_read_in_feed_view(a)},this)))},mark_feed_as_read_update_counts:function(b,c){if(b){var d=this.model.get_feed(b);if(!d)return;var e=this.find_feed_in_feed_list(b),f=a(".feed_counts_floater",e),g=this.$s.$content_pane,j=this.$s.$story_titles;d.ps=0;d.nt=0;d.ng=0;a(".unread_count_neutral",e).text(0);a(".unread_count_positive",e).text(0);a(".unread_count_negative",e).text(0);b==this.active_feed&&(a(".unread_count_neutral",g).text(0),a(".unread_count_positive",
g).text(0),a(".unread_count_negative",g).text(0),a(".story:not(.read)",j).addClass("read"));e.removeClass("unread_neutral");e.removeClass("unread_positive");e.removeClass("unread_negative");f.removeClass("unread_neutral");f.removeClass("unread_positive");f.removeClass("unread_negative")}c&&(a(".unread_count_neutral",c).text(0),a(".unread_count_positive",c).text(0),a(".unread_count_negative",c).text(0),f=a(".feed_counts_floater",c),f.removeClass("unread_neutral"),f.removeClass("unread_positive"),f.removeClass("unread_negative"))},
open_story_trainer:function(a,c){a=a||this.get_current_story_id();c=c||a&&this.model.get_story(a).story_feed_id;if(a&&c)NEWSBLUR.classifier=new NEWSBLUR.ReaderClassifierStory(a,c,{feed_loaded:!this.flags.river_view})},mark_story_as_starred:function(b,c){var d=this.model.get_story(b),e=a(".NB-storytitles-star",c);c.addClass("NB-story-starred");e.attr({title:"Saved!"});e.tipsy({gravity:"sw",fade:!0,trigger:"manual",offsetOpposite:-1});e.tipsy("enable");e.tipsy("show");_.delay(function(){e.tipsy("hide");
e.tipsy("disable")},850);this.model.mark_story_as_starred(b,d.story_feed_id,function(){});this.update_starred_count()},mark_story_as_unstarred:function(b,c){var d=a(".NB-storytitles-star",c);c.one("mouseout",function(){c.removeClass("NB-unstarred")});d.attr({title:"Removed"});d.tipsy({gravity:"sw",fade:!0,trigger:"manual",offsetOpposite:-1});d.tipsy("enable");d.tipsy("show");_.delay(function(){d.tipsy("hide");d.tipsy("disable")},850);c.removeClass("NB-story-starred");this.model.mark_story_as_unstarred(b,
function(){});this.update_starred_count()},send_story_to_instapaper:function(a){var c=this.model.get_story(a),c=["http://www.instapaper.com/edit?url=",encodeURIComponent(c.story_permalink),"&title=",encodeURIComponent(c.story_title)].join("");window.open(c,"_blank");this.mark_story_as_read(a)},send_story_to_readitlater:function(a){var c=this.model.get_story(a),c=["https://readitlaterlist.com/save?url=",encodeURIComponent(c.story_permalink),"&title=",encodeURIComponent(c.story_title)].join("");window.open(c,
"_blank");this.mark_story_as_read(a)},send_story_to_readability:function(a){var c=this.model.get_story(a),c=["https://readability.com/save?url=",encodeURIComponent(c.story_permalink),"&title=",encodeURIComponent(c.story_title)].join("");window.open(c,"_blank");this.mark_story_as_read(a)},send_story_to_twitter:function(a){var c=this.model.get_story(a),c=["http://twitter.com/?status=",encodeURIComponent(c.story_title),": ",encodeURIComponent(c.story_permalink)].join("");window.open(c,"_blank");this.mark_story_as_read(a)},
send_story_to_facebook:function(a){var c=this.model.get_story(a),c=["http://www.facebook.com/sharer.php?src=newsblur&v=3.14159265&i=1.61803399&u=",encodeURIComponent(c.story_permalink),"&t=",encodeURIComponent(c.story_title)].join("");window.open(c,"_blank");this.mark_story_as_read(a)},send_story_to_email:function(a){NEWSBLUR.reader_send_email=new NEWSBLUR.ReaderSendEmail(a);this.mark_story_as_read(a)},hide_content_pane_feed_counter:function(){a(".feed_counts_floater",this.$s.$content_pane).remove()},
make_content_pane_feed_counter:function(b){var c=this.$s.$content_pane,b=b||this.active_feed,b=this.model.get_feed(b),d=this.make_feed_counts_floater(b.ps,b.nt,b.ng);d.css({opacity:0});a(".feed_counts_floater",c).remove();this.$s.$story_taskbar.append(d);_.delay(function(){d.animate({opacity:0.1},{duration:1E3,queue:!1})},500);a(".unread_count",c).corner("4px");b=a(".feed_counts_floater",c).width();b=c.width()/2-b/2;a(".feed_counts_floater",c).css({left:b})},create_story_titles:function(a,c){var d=
this.$s.$story_titles,c=c||{};for(s in a){if(this.flags.non_premium_river_view&&d.children(":visible").length>=this.constants.RIVER_STORIES_FOR_STANDARD_ACCOUNT){this.append_story_titles_endbar();break}var e=this.make_story_title(a[s],c);d.append(e)}(!a||a.length==0)&&this.append_story_titles_endbar();this.hover_story_titles()},make_story_title:function(b,c){var d=this.model.preference("unread_view"),e=b.read_status?" read ":"",f=NEWSBLUR.utils.compute_story_score(b),g="neutral",j=b.starred?" NB-story-starred ":
"";if(c.river_stories)var k=this.model.get_feed(b.story_feed_id);f>0&&(g="positive");f<0&&(g="negative");var l=a.make("span",{className:"NB-storytitles-tags"}),p;for(p in b.story_tags){p=a.make("span",{className:"NB-storytitles-tag"},b.story_tags[p]).corner("4px");l.append(p);break}e=a.make("div",{className:"story "+e+j+"NB-story-"+g},[a.make("div",{className:"NB-storytitles-sentiment"}),a.make("a",{href:b.story_permalink,className:"story_title"},[c.river_stories&&k&&a.make("div",{className:"NB-story-feed"},
[a.make("img",{className:"feed_favicon",src:a.favicon(k.favicon)}),a.make("span",{className:"feed_title"},k.feed_title)]),a.make("div",{className:"NB-storytitles-star"}),a.make("span",{className:"NB-storytitles-title"},b.story_title),a.make("span",{className:"NB-storytitles-author"},b.story_authors),l]),a.make("span",{className:"story_date"},b.short_parsed_date),a.make("span",{className:"story_id"},""+b.id),a.make("div",{className:"NB-story-manage-icon"})]).data("story_id",b.id).data("feed_id",b.story_feed_id);
d>f&&e.css({display:"none"});this.model.preference("show_tooltips")&&a(".NB-story-sentiment",e).tipsy({delayIn:375,gravity:"s"});return e},hover_story_titles:function(){var b=a("#story_titles .story,.NB-feedbar .feed");b.unbind("mouseenter").unbind("mouseleave");b.hover(function(){var b=a(this),d=b.hasClass("story")?150:270;b.offset().top>a(window).height()-d&&b.addClass("NB-hover-inverse")},function(){a(this).removeClass("NB-hover-inverse")})},story_titles_clear_loading_endbar:function(){var b=a(".NB-story-titles-end-stories-line",
this.$s.$story_titles);b.length&&(b.remove(),clearInterval(this.feed_stories_loading))},recalculate_story_scores:function(b){b=b||this.active_feed;this.model.recalculate_story_scores(b);var c=_.bind(function(c,e){var f=this.model.get_story(e);if(f.story_feed_id==b){var g=NEWSBLUR.utils.compute_story_score(f);c.removeClass("NB-story-positive").removeClass("NB-story-neutral").removeClass("NB-story-negative");g>0?c.addClass("NB-story-positive"):g==0?c.addClass("NB-story-neutral"):g<0&&c.addClass("NB-story-negative");
NEWSBLUR.log(["story recalculation",f,f.read_status,c]);a(".NB-feed-story-tags",c).replaceWith(this.make_story_feed_tags(f));a(".NB-feed-story-author",c).replaceWith(this.make_story_feed_author(f));a(".NB-feed-story-title",c).replaceWith(this.make_story_feed_title(f));this.model.preference("new_window")==1&&a("a",c).attr("target","_blank")}},this);_.each(this.cache.feed_view_stories,_.bind(function(a,b){c(a,b)}));a(".story",this.$s.$story_titles).each(function(){var b=a(this),e=b.data("story_id");
c(b,e)})},unload_feed_iframe:function(){var b=this.$s.$feed_iframe,c=a(".NB-taskbar .task_view_page");c.removeClass("NB-disabled");c.removeClass("NB-task-return");this.flags.iframe_view_loaded=!1;this.flags.iframe_story_locations_fetched=!1;this.flags.iframe_prevented_from_loading=!1;a.extend(this.cache,{iframe_stories:{},iframe_story_positions:{},iframe_story_positions_keys:[]});b.removeAttr("src");b.empty();this.$s.$story_iframe.attr("src","");this.$s.$story_iframe.empty()},load_feed_iframe:function(a){var a=
a||this.active_feed,c=this,d=this.$s.$feed_iframe;this.unload_feed_iframe();a?d.data("feed_id",a):a=d.data("feed_id");this.flags.iframe_scroll_snap_back_prepared=!0;this.iframe_link_attacher_num_links=0;d.removeAttr("src").attr({src:"/reader/page/"+a});this.flags.iframe_view_loaded?this.fetch_story_locations_in_story_frame(0,!0,this.$s.$feed_iframe.contents()):_.delay(_.bind(function(){this.prefetch_story_locations_in_story_frame()},this),500);d.ready(function(){setTimeout(function(){d.load(function(){c.return_to_snapback_position(!0)})},
50);c.flags.iframe_scroll_snapback_check=setInterval(function(){c.iframe_scroll&&c.flags.iframe_scroll_snap_back_prepared?c.return_to_snapback_position():clearInterval(c.flags.iframe_scroll_snapback_check)},500);if(d.attr("src").indexOf("/reader/page/"+a)!=-1){var e=function(){var a=d.contents().find("a").length;if(c.iframe_link_attacher_num_links!=a)c.iframe_link_attacher_num_links=a,d.contents().find("a").unbind("click.NB-taskbar").bind("click.NB-taskbar",function(){c.taskbar_show_return_to_page()})};
clearInterval(c.iframe_link_attacher);c.iframe_link_attacher=setInterval(e,2E3);e();d.load(function(){clearInterval(c.iframe_link_attacher)})}})},return_to_snapback_position:function(a){var c=this.$s.$feed_iframe;if(this.iframe_scroll&&this.flags.iframe_scroll_snap_back_prepared&&c.contents().scrollTop()==0&&(c.contents().scrollTop(this.iframe_scroll),a))this.flags.iframe_scroll_snap_back_prepared=!1,clearInterval(self.flags.iframe_scroll_snapback_check)},setup_feed_page_iframe_load:function(){var b=
this,c=this.$s.$feed_iframe;c.removeAttr("src").load(function(){b.flags.iframe_view_loaded=!0;try{var d=c.contents();d.find("a").unbind("click.NB-taskbar").bind("click.NB-taskbar",function(c){var e=a(this).attr("href");if(e.indexOf("#")==0)return c.preventDefault(),c=a("a[name="+e.substr(1)+"], [id="+e.substr(1)+"]",d),d.scrollTo(c,{duration:600,axis:"y",easing:"easeInOutQuint",offset:0,queue:!1}),!1;b.taskbar_show_return_to_page()});d.unbind("scroll").scroll(a.rescope(b.handle_scroll_feed_iframe,
b));d.unbind("mousemove.reader").bind("mousemove.reader",a.rescope(b.handle_mousemove_iframe_view,b));b.flags.story_titles_loaded&&b.fetch_story_locations_in_story_frame(0,!0,d)}catch(e){}})},taskbar_show_return_to_page:function(){a(".NB-feed-frame");_.delay(function(){var b=a(".NB-feed-frame"),c=a(".NB-taskbar .task_view_page");try{if(NEWSBLUR.log(["return",b.contents().find("body")]),b.contents().find("body").length)return!1}catch(d){c.addClass("NB-task-return")}finally{c.addClass("NB-task-return")}},
1E3)},load_page_of_feed_stories:function(b){var c=this.$s.$story_titles,d=c.data("feed_id"),e=c.data("page");this.flags.opening_feed||(b||this.show_feedbar_loading(),c.data("page",e+1),this.active_feed=="starred"?this.model.fetch_starred_stories(e+1,_.bind(this.post_open_starred_stories,this),!1):this.flags.river_view?this.model.fetch_river_stories(this.active_feed,this.cache.river_feeds_with_unreads,e+1,_.bind(this.post_open_river_stories,this),!1):this.model.load_feed(d,e+1,!1,a.rescope(this.post_open_feed,
this)))},fill_out_story_titles:function(){var b=a(".story:visible:last",this.$s.$story_titles),c=this.$s.$story_titles.height();if(!a(".NB-story-titles-end-stories-line").length&&(b.length==0||a("#story_titles").scrollTop()==0&&b.position().top+b.height()-13<c))this.counts.page_fill_outs<this.constants.FILL_OUT_PAGES?(this.counts.page_fill_outs+=1,_.delay(_.bind(this.load_page_of_feed_stories,this,!0),250)):this.append_story_titles_endbar()},show_feedbar_loading:function(){var b=this.$s.$story_titles,
c=a(".NB-story-titles-end-stories-line");c.length||(c=a.make("div",{className:"NB-story-titles-end-stories-line"}));c.css({background:"#E1EBFF"});b.append(c);c.animate({backgroundColor:"#5C89C9"},{duration:750}).animate({backgroundColor:"#E1EBFF"},750);this.feed_stories_loading=setInterval(function(){c.animate({backgroundColor:"#5C89C9"},{duration:750}).animate({backgroundColor:"#E1EBFF"},750)},1500)},show_feed_title_in_stories:function(b){var c=this.$s.$story_titles;if(b=this.model.get_feed(b))b=
a.make("div",{className:"NB-feedbar"},[a(this.make_feed_title_template(b,"story")),a.make("span",{className:"feed_id"},""+b.id)]).hover(function(){a(this).addClass("NB-feedbar-hover")},function(){a(this).removeClass("NB-feedbar-hover")}),this.model.preference("show_tooltips")&&a(".NB-feedbar-train-feed, .NB-feedbar-statistics",b).tipsy({gravity:"s",delayIn:375}),c.prepend(b),a(".unread_count",b).corner("4px")},show_feed_hidden_story_title_indicator:function(b){if(!b||!this.flags.unread_threshold_temporarily){this.flags.unread_threshold_temporarily=
null;var c=this.$s.$story_titles,b=this.active_feed,d=this.model.get_feed(b),e=this.get_unread_view_name(),f=a(".NB-story-title-indicator",c);_.any(this.model.stories,_.bind(function(a){a=NEWSBLUR.utils.compute_story_score(a);if(e=="positive")return a<=0;else if(e=="neutral")return a<0},this))&&(f.length?(c=this.make_feed_counts_floater(d.ps,d.nt,d.ng),a(".feed_counts_floater",f).replaceWith(c),this.cache.$feed_counts_in_feed_list[b]=null,f.css({opacity:1})):d&&(f=a.make("div",{className:"NB-story-title-indicator"},
[this.make_feed_counts_floater(d.ps,d.nt,d.ng),a.make("span",{className:"NB-story-title-indicator-text"},"show hidden stories")]).css({opacity:0}),a(".NB-feedbar .feed .feed_title",this.$story_titles).prepend(f),_.delay(function(){f.animate({opacity:1},{duration:1E3,easing:"easeOutCubic"})},500)),f.removeClass("unread_threshold_positive").removeClass("unread_threshold_neutral").removeClass("unread_threshold_negative").addClass("unread_threshold_"+e))}},check_story_titles_last_story:function(){var b=
this.$s.$story_titles;if(!a(".NB-story-titles-end-stories-line",b).length){var c=a("#story_titles .story").last(),b=b.position().top,c=(c.offset()&&c.offset().top)+c.height()-b,b=a("#story_titles").height();a("#story_titles").scrollTop();b+13>=c&&this.load_page_of_feed_stories()}},show_hidden_story_titles:function(){this.model.get_feed(this.active_feed);var b=a(".NB-story-title-indicator",this.$s.$story_titles),c=b.hasClass("unread_threshold_positive")?"positive":"neutral",d=_.any(this.model.stories,
_.bind(function(a){a=NEWSBLUR.utils.compute_story_score(a);if(c=="positive")return a==0;else if(c=="neutral")return a<0},this)),e=c=="positive"&&_.any(this.model.stories,_.bind(function(a){return NEWSBLUR.utils.compute_story_score(a)<0},this));c=="positive"&&d&&e?(this.flags.unread_threshold_temporarily="neutral",this.show_story_titles_above_intelligence_level({unread_view_name:"neutral",animate:!0,follow:!0,temporary:!0}),b.removeClass("unread_threshold_positive").addClass("unread_threshold_neutral")):
(this.flags.unread_threshold_temporarily="negative",this.show_story_titles_above_intelligence_level({unread_view_name:"negative",animate:!0,follow:!0,temporary:!0}),b.removeClass("unread_threshold_positive").removeClass("unread_threshold_neutral").addClass("unread_threshold_negative"),b.animate({opacity:0},{duration:500}))},open_feed_link:function(a){if(!a)a=this.active_feed;this.mark_feed_as_read(a);a=this.model.get_feed(a);window.open(a.feed_link,"_blank")},open_story_in_new_tab:function(a){if(a=
a||this.get_current_story_id())a=this.model.get_story(a),window.open(a.story_permalink,"_blank"),window.focus()},open_unread_stories_in_tabs:function(a){a=a||this.active_feed;if(this.active_feed==a)this.flags.open_unread_stories_in_tabs=!1,_.each(this.model.stories,function(a){NEWSBLUR.log(["story",a,!a.read_status]);a.read_status||(window.open(a.story_permalink,"_blank"),window.focus())}),this.mark_feed_as_read(a);else{this.flags.open_unread_stories_in_tabs=!0;var c=this.find_feed_in_feed_list(a);
this.open_feed(a,!1,c)}},mark_feed_as_selected:function(b,c){c===void 0&&(c=a(".feed.selected",this.$feed_list).eq(0));a("#feed_list .selected").removeClass("selected");a("#feed_list .after_selected").removeClass("after_selected");c&&(c.addClass("selected"),c.parent(".feed").next(".feed").children("a").addClass("after_selected"))},open_feed_intelligence_modal:function(a,c,d){if(c=c||this.active_feed)NEWSBLUR.classifier=new NEWSBLUR.ReaderClassifierFeed(c,{score:a,feed_loaded:d})},open_trainer_modal:function(a){NEWSBLUR.classifier=
new NEWSBLUR.ReaderClassifierTrainer({score:a})},open_recommend_modal:function(a){NEWSBLUR.recommend_feed=new NEWSBLUR.ReaderRecommendFeed(a)},open_tutorial_modal:function(){NEWSBLUR.tutorial=new NEWSBLUR.ReaderTutorial},hide_tutorial:function(){var b=a(".NB-module-tutorial");this.model.preference("tutorial_finished",!0);b.animate({opacity:0},{duration:500,complete:function(){b.slideUp(350)}})},hide_mobile:function(){var b=a(".NB-module-mobile");this.model.preference("hide_mobile",!0);b.animate({opacity:0},
{duration:500,complete:function(){b.slideUp(350)}})},make_story_feed_entries:function(b,c,d){var e=this.$s.$feed_view,f=this.$s.$feed_stories,g=this;this.model.preference("unread_view");var j=this.model.get_feed(this.active_feed),d=d||{};c&&!d.refresh_load&&a(".NB-feed-story-endbar",e).remove();for(var k in b){if(this.flags.non_premium_river_view&&f.children(":visible").length>=this.constants.RIVER_STORIES_FOR_STANDARD_ACCOUNT){this.append_story_titles_endbar();this.append_river_premium_only_notification();
break}var e=b[k],l=!1;d.river_stories&&(j=this.model.get_feed(e.story_feed_id));var p=e.read_status?" read ":"",t=NEWSBLUR.utils.compute_story_score(e),v="neutral",H=d.river_stories?" NB-river-story ":"";t>0&&(v="positive");t<0&&(v="negative");e.story_content.indexOf("<ins")!=-1&&(l=!0);!l&&this.model.preference("hide_story_changes")&&e.story_content.indexOf("<del")!=-1&&(l=!0);p=a.make("li",{className:"NB-feed-story "+p+H+" NB-story-"+v},[a.make("div",{className:"NB-feed-story-header"},[a.make("div",
{className:"NB-feed-story-header-feed"},[d.river_stories&&j&&a.make("div",{className:"NB-feed-story-feed"},[a.make("img",{className:"feed_favicon",src:a.favicon(j.favicon)}),a.make("span",{className:"feed_title"},j.feed_title)])]).css("background-image",NEWSBLUR.utils.generate_gradient(j,"webkit")).css("background-image",NEWSBLUR.utils.generate_gradient(j,"moz")).css("borderBottom",NEWSBLUR.utils.generate_gradient(j,"border")).css("borderTop",NEWSBLUR.utils.generate_gradient(j,"border")).toggleClass("NB-inverse",
NEWSBLUR.utils.is_feed_floater_gradient_light(j)),a.make("div",{className:"NB-feed-story-header-info"},[e.story_authors&&this.make_story_feed_author(e),e.story_tags&&e.story_tags.length&&this.make_story_feed_tags(e),a.make("div",{className:"NB-feed-story-title-container"},[a.make("div",{className:"NB-feed-story-sentiment"}),a.make("div",{className:"NB-feed-story-manage-icon"}),this.make_story_feed_title(e)]),e.long_parsed_date&&a.make("span",{className:"NB-feed-story-date"},[l&&a.make("div",{className:"NB-feed-story-hide-changes",
title:(this.model.preference("hide_story_changes")?"Show":"Hide")+" story modifications"}),e.long_parsed_date]),e.starred_date&&a.make("span",{className:"NB-feed-story-starred-date"},e.starred_date)])]),a.make("div",{className:"NB-feed-story-content"},this.make_story_content(e.story_content))]).data("story",e.id).data("story_id",e.id).data("feed_id",e.story_feed_id);l&&this.model.preference("show_tooltips")&&a(".NB-feed-story-hide-changes",p).tipsy({delayIn:375});l&&this.model.preference("hide_story_changes")&&
(a("ins",p).css({"text-decoration":"none"}),a("del",p).css({display:"none"}));this.model.preference("new_window")==1&&a("a",p).attr("target","_blank");d.refresh_load?f.prepend(p):f.append(p);this.cache.last_feed_view_story_feed_id=e.story_feed_id;this.cache.feed_view_stories[e.id]=p;(l=a("img",p).length)?(this.flags.feed_view_images_loaded[e.id]=!1,function(b,c,d){a("img",b).load(function(){d==1?g.flags.feed_view_images_loaded[c.id]=!0:d--;return!0})}(p,e,l)):this.flags.feed_view_images_loaded[e.id]=
!0}(!b||!b.length)&&this.fetch_story_locations_in_feed_view();this.append_feed_view_story_endbar();this.hover_story_feed_titles();c&&this.show_stories_preference_in_feed_view(!0)},make_story_content:function(b){return a("<div>").html(b).autolink()},make_story_feed_title:function(b){var c=b.story_title;_.each(this.model.classifiers[b.story_feed_id]&&this.model.classifiers[b.story_feed_id].titles||[],function(a,b){c.indexOf(b)!=-1&&(c=c.replace(b,'<span class="NB-score-'+a+'">'+b+"</span>"))});return a.make("a",
{className:"NB-feed-story-title",href:b.story_permalink},c)},make_story_feed_author:function(b){var c=this.model.classifiers[b.story_feed_id]&&this.model.classifiers[b.story_feed_id].authors[b.story_authors];return a.make("div",{className:"NB-feed-story-author "+(!!c&&"NB-score-"+c||"")},b.story_authors).data("author",b.story_authors)},make_story_feed_tags:function(b){var c=this.model.classifiers[b.story_feed_id]&&this.model.classifiers[b.story_feed_id].tags||{};return a.make("div",{className:"NB-feed-story-tags"},
_.map(b.story_tags,function(b){var e=c[b];return a.make("div",{className:"NB-feed-story-tag "+(!!e&&"NB-score-"+e||"")},b).data("tag",b)}))},hover_story_feed_titles:function(){var b=a(".NB-feed-story-header-info");b.unbind("mouseenter").unbind("mouseleave");b.hover(function(){var b=a(this),d=b.hasClass("story")?150:270;b.offset().top>a(window).height()-d&&b.closest(".NB-feed-story").addClass("NB-hover-inverse")},function(){a(this).closest(".NB-feed-story").removeClass("NB-hover-inverse")})},preserve_classifier_color:function(b,
c,d,e){var f;a(".NB-feed-story-"+c,b).each(function(){if(a(this).data(c)==d)return f=a(this),!1});f.removeClass("NB-score-now-1").removeClass("NB-score-now--1").removeClass("NB-score-now-0").addClass("NB-score-now-"+e).one("mouseleave",function(){f.removeClass("NB-score-now-"+e)});_.defer(function(){f.one("mouseenter",function(){f.removeClass("NB-score-now-"+e)})})},save_classifier:function(a,c,d,e,f){var g={feed_id:e};d==0?g["remove_like_"+a]=c:d==1?g["like_"+a]=c:d==-1&&(g["dislike_"+a]=c);this.model.classifiers[e][a+
"s"][c]=d;this.model.save_classifier(g,_.bind(function(){this.force_feeds_refresh(f,!0,e)},this));this.recalculate_story_scores(e)},show_correct_feed_in_feed_title_floater:function(b){var c,d;if(b&&this.cache.feed_title_floater_feed_id!=b.story_feed_id){var e=this.$s.$feed_floater;c=this.find_story_in_feed_view(b);d=a(".NB-feed-story-header-feed",c);var f=d.clone();if(!f.find(".NB-feed-story-feed").length){var g=this.model.get_feed(b.story_feed_id);g&&f.append(a.make("div",{className:"NB-feed-story-feed"},
[a.make("img",{className:"feed_favicon",src:a.favicon(g.favicon)}),a.make("span",{className:"feed_title"},g.feed_title)]))}e.empty().append(f);this.cache.feed_title_floater_feed_id=b.story_feed_id;e.width(d.outerWidth())}else if(!b)this.$s.$feed_floater.empty(),this.cache.feed_title_floater_feed_id=null;if(b&&this.cache.feed_title_floater_story_id!=b.id)c=c||this.find_story_in_feed_view(b),d=d||a(".NB-feed-story-header-feed",c),a(".NB-floater").removeClass("NB-floater"),d.addClass("NB-floater"),this.cache.feed_title_floater_story_id=
b.id;else if(!b)this.cache.feed_title_floater_story_id=null},apply_story_styling:function(a){var c=this.$s.$body;c.removeClass("NB-theme-sans-serif");c.removeClass("NB-theme-serif");NEWSBLUR.Preferences.story_styling=="sans-serif"?c.addClass("NB-theme-sans-serif"):NEWSBLUR.Preferences.story_styling=="serif"&&c.addClass("NB-theme-serif");a&&this.show_story_titles_above_intelligence_level({animate:!0,follow:!0})},hide_story_changes:function(b){var c=a(".NB-feed-story-hide-changes",b);this.model.preference("hide_story_changes")?
(a("ins",b).css({"text-decoration":"underline"}),a("del",b).css({display:"inline"})):(a("ins",b).css({"text-decoration":"none"}),a("del",b).css({display:"none"}));c.css("opacity",1).fadeOut(400);c.tipsy("hide").tipsy("disable")},prefetch_story_locations_in_feed_view:function(){var b=this,c=this.model.stories;if(!this.flags.feed_view_positions_calculated){a.extend(this.cache,{feed_view_story_positions:{},feed_view_story_positions_keys:[]});for(var d in c){var e=c[d],f=b.cache.feed_view_stories[e.id];
this.determine_feed_view_story_position(f,e);if(!f||!f.length||this.flags.feed_view_positions_calculated)break}}_.all(this.flags.feed_view_images_loaded)&&(_.keys(this.flags.feed_view_images_loaded).length>0||this.cache.feed_view_story_positions_keys.length>0)&&this.fetch_story_locations_in_feed_view();this.flags.feed_view_positions_calculated||setTimeout(function(){b.flags.feed_view_positions_calculated||b.prefetch_story_locations_in_feed_view()},2E3)},fetch_story_locations_in_feed_view:function(){var b=
this.model.stories;if(b&&b.length){a.extend(this.cache,{feed_view_story_positions:{},feed_view_story_positions_keys:[]});for(var c in b){var d=b[c];this.determine_feed_view_story_position(this.cache.feed_view_stories[d.id],d)}this.flags.feed_view_positions_calculated=!0;NEWSBLUR.log(["Feed view entirely loaded",this.model.stories.length+" stories"])}},determine_feed_view_story_position:function(a,c){if(a&&a.is(":visible")){var d=parseInt(a.position().top,10),e=parseInt(a.offsetParent().scrollTop(),
10);d+=e;this.cache.feed_view_story_positions[d]=c;this.cache.feed_view_story_positions_keys.push(d);this.cache.feed_view_story_positions_keys.sort(function(a,b){return a-b})}},append_feed_view_story_endbar:function(){var b=this.$s.$feed_stories,c=a.make("div",{className:"NB-feed-story-endbar"});b.find(".NB-feed-story-endbar").remove();b.append(c)},append_story_titles_endbar:function(){var b=this.$s.$story_titles,c=a.make("div",{className:"NB-story-titles-end-stories-line"});a(".NB-story-titles-end-stories-line",
b).length||b.append(c)},append_river_premium_only_notification:function(){var b=this.$s.$story_titles,c=a.make("div",{className:"NB-feed-story-premium-only"},[a.make("div",{className:"NB-feed-story-premium-only-divider"}),a.make("div",{className:"NB-feed-story-premium-only-text"},["The full River of News is a ",a.make("a",{href:"#",className:"NB-splash-link"},"premium feature"),"."])]);a(".NB-feed-story-premium-only",b).remove();b.append(c)},switch_taskbar_view:function(b,c){var d=this,e=this.$s.$story_pane,
f=this.model.get_feed(this.active_feed);if(b=="page"&&f&&f.has_exception&&f.exception_type=="page")this.open_feed_exception_modal(this.active_feed);else if(!a(".task_button_view.task_view_"+b).hasClass("NB-disabled")){var f=a(".NB-taskbar .task_button_view"),g=this.$s.$feed_iframe,j=a(".NB-taskbar .NB-task-view-page-to-feed-arrow"),k=a(".NB-taskbar .NB-task-view-feed-to-story-arrow");!c&&this.story_view!=b&&this.model.view_setting(this.active_feed,b);j.hide();k.hide();this.flags.page_view_showing_feed_view=
!1;c=="page"?(j.show(),this.flags.page_view_showing_feed_view=!0):c=="story"?(k.show(),this.flags.feed_view_showing_story_view=!0):(f.removeClass("NB-active"),a(".task_button_view.task_view_"+b).addClass("NB-active"),this.story_view=b);b=="page"?(this.flags.iframe_prevented_from_loading&&this.load_feed_iframe(this.active_feed),this.scroll_to_story_in_iframe(this.active_story,this.find_story_in_feed_iframe(this.active_story),!0),e.animate({left:0},{easing:"easeInOutQuint",duration:this.model.preference("animations")?
550:0,queue:!1})):b=="feed"?(this.active_story&&this.scroll_to_story_in_story_feed(this.active_story,this.find_story_in_feed_view(this.active_story),!0),e.animate({left:-1*g.width()},{easing:"easeInOutQuint",duration:this.model.preference("animations")?550:0,queue:!1}),this.flags.switching_to_feed_view=!0,setTimeout(function(){d.flags.switching_to_feed_view=!1},100),this.show_stories_preference_in_feed_view(),this.flags.feed_view_positions_calculated||this.prefetch_story_locations_in_feed_view()):
b=="story"&&(e.animate({left:-2*g.width()},{easing:"easeInOutQuint",duration:this.model.preference("animations")?550:0,queue:!1}),this.load_story_iframe(),this.active_story||this.show_next_story(1))}},switch_taskbar_view_direction:function(b){var c=a(".taskbar_nav_view .NB-active"),d;b==-1?c.hasClass("task_view_page")||(c.hasClass("task_view_feed")?d="page":c.hasClass("task_view_story")&&(d="feed")):b==1&&(c.hasClass("task_view_page")?d="feed":c.hasClass("task_view_feed")?d="story":c.hasClass("task_view_story"));
d&&this.switch_taskbar_view(d)},show_stories_preference_in_feed_view:function(b){var c=a(".NB-feed-story",this.$s.$feed_view),d=this.$s.$feed_stories;this.active_story&&this.model.preference("feed_view_single_story")?(d.removeClass("NB-feed-view-feed").addClass("NB-feed-view-story"),c.css({display:"none"}),b&&this.$s.$feed_stories.scrollTop("0px"),(b=this.get_current_story_from_story_titles(c))&&b.length&&b.css({display:"block"}),this.flags.feed_view_positions_calculated=!1):(d.removeClass("NB-feed-view-story").addClass("NB-feed-view-feed"),
b||this.show_story_titles_above_intelligence_level({animate:!1}));this.cache.story_pane_position=null},open_story_in_story_view:function(a,c){if(!a)a=this.active_story;this.switch_taskbar_view("story",c?"story":!1);this.load_story_iframe(a,a.story_feed_id)},load_story_iframe:function(a,c){if(a=a||this.active_story){var c=c||this.active_feed,d=this.$s.$story_iframe;if(d.attr("src")!=a.story_permalink)this.unload_story_iframe(),c?d.data("feed_id",c):d.data("feed_id"),this.flags.iframe_scroll_snap_back_prepared=
!0,this.iframe_link_attacher_num_links=0,d.removeAttr("src").attr({src:a.story_permalink})}},unload_story_iframe:function(){var a=this.$s.$story_iframe;a.empty();a.removeAttr("src").attr({src:"about:blank"})},open_add_feed_modal:function(b){clearInterval(this.flags.bouncing_callout);a.modal.close();NEWSBLUR.add_feed=new NEWSBLUR.ReaderAddFeed(b)},open_manage_feed_modal:function(a){a=a||this.active_feed;NEWSBLUR.manage_feed=new NEWSBLUR.ReaderManageFeed(a)},open_mark_read_modal:function(){NEWSBLUR.mark_read=
new NEWSBLUR.ReaderMarkRead},open_keyboard_shortcuts_modal:function(){NEWSBLUR.keyboard=new NEWSBLUR.ReaderKeyboard},open_goodies_modal:function(){NEWSBLUR.goodies=new NEWSBLUR.ReaderGoodies},open_preferences_modal:function(){NEWSBLUR.preferences=new NEWSBLUR.ReaderPreferences},open_account_modal:function(a){NEWSBLUR.account=new NEWSBLUR.ReaderAccount(a)},open_feedchooser_modal:function(){NEWSBLUR.feedchooser=new NEWSBLUR.ReaderFeedchooser},open_feed_exception_modal:function(a){NEWSBLUR.feed_exception=
new NEWSBLUR.ReaderFeedException(a)},open_feed_statistics_modal:function(a){a=a||this.active_feed;NEWSBLUR.statistics=new NEWSBLUR.ReaderStatistics(a)},close_sidebar:function(){this.$s.$body.layout().close("west");this.resize_window();this.flags.sidebar_closed=!0;a(".NB-taskbar-sidebar-toggle-open").stop().animate({left:-1},{duration:1E3,easing:"easeOutQuint",queue:!1})},open_sidebar:function(){this.$s.$body.layout().open("west");this.resize_window();this.flags.sidebar_closed=!1;a(".NB-taskbar-sidebar-toggle-open").stop().css({left:-24})},
make_manage_menu:function(b,c,d,e,f){var g;if(b=="site")c=!NEWSBLUR.Globals.is_premium&&NEWSBLUR.Globals.is_authenticated,g=a.make("ul",{className:"NB-menu-manage"},[a.make("li",{className:"NB-menu-manage-site-info"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("span",{className:"NB-menu-manage-title"},"Manage NewsBlur")]).corner("tl tr 8px"),a.make("li",{className:"NB-menu-separator"}),a.make("li",{className:"NB-menu-manage-account"},[a.make("div",{className:"NB-menu-manage-image"}),
a.make("div",{className:"NB-menu-manage-title"},"My Account")]),a.make("li",{className:"NB-menu-manage-preferences"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Preferences")]),a.make("li",{className:"NB-menu-separator"}),a.make("li",{className:"NB-menu-manage-keyboard"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Keyboard shortcuts")]),a.make("li",{className:"NB-menu-manage-tutorial"},[a.make("div",
{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Tutorial")]),a.make("li",{className:"NB-menu-separator"}),a.make("li",{className:"NB-menu-manage-mark-read NB-menu-manage-site-mark-read"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Mark everything as read"),a.make("div",{className:"NB-menu-manage-subtitle"},"Choose how many days back.")]),a.make("li",{className:"NB-menu-manage-trainer"},[a.make("div",{className:"NB-menu-manage-image"}),
a.make("div",{className:"NB-menu-manage-title"},"Intelligence Trainer"),a.make("div",{className:"NB-menu-manage-subtitle"},"Accurate filters are happy filters.")]),a.make("li",{className:"NB-menu-manage-goodies"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Goodies"),a.make("div",{className:"NB-menu-manage-subtitle"},"Extensions and extras.")]),c&&a.make("li",{className:"NB-menu-manage-feedchooser"},[a.make("div",{className:"NB-menu-manage-image"}),
a.make("div",{className:"NB-menu-manage-title"},"Choose Your 64"),a.make("div",{className:"NB-menu-manage-subtitle"},"Enable the sites you want.")])]),g.addClass("NB-menu-manage-notop");else if(b=="feed"){g=this.model.get_feed(c);if(!g)return;d=this.get_unread_count(!0,c);Math.min(25,d);g=a.make("ul",{className:"NB-menu-manage"},[a.make("li",{className:"NB-menu-separator-inverse"}),g.has_exception&&a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-feed-exception"},[a.make("div",{className:"NB-menu-manage-image"}),
a.make("div",{className:"NB-menu-manage-title"},"Fix this misbehaving site")]),g.has_exception&&a.make("li",{className:"NB-menu-separator-inverse"}),g.exception_type!="feed"&&a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-mark-read NB-menu-manage-feed-mark-read"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Mark as read")]),a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-feed-reload"},[a.make("div",{className:"NB-menu-manage-image"}),
a.make("div",{className:"NB-menu-manage-title"},"Insta-fetch stories")]),a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-feed-stats"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Statistics")]),a.make("li",{className:"NB-menu-separator"}),a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-feed-train"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Intelligence trainer"),a.make("div",
{className:"NB-menu-manage-subtitle"},"What you like and dislike.")]),a.make("li",{className:"NB-menu-separator"}),a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-feed-recommend"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Recommend this site")]),a.make("li",{className:"NB-menu-separator"}),a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-move NB-menu-manage-feed-move"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",
{className:"NB-menu-manage-title"},"Move to folder")]),a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-confirm NB-menu-manage-feed-move-confirm NB-modal-submit"},[a.make("div",{className:"NB-menu-manage-confirm-position"},[a.make("div",{className:"NB-menu-manage-move-save NB-menu-manage-feed-move-save NB-modal-submit-green NB-modal-submit-button"},"Save"),a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-add-folders"},NEWSBLUR.utils.make_folders(this.model))])]),
a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-rename NB-menu-manage-feed-rename"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Rename this site")]),a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-confirm NB-menu-manage-feed-rename-confirm NB-modal-submit"},[a.make("div",{className:"NB-menu-manage-confirm-position"},[a.make("div",{className:"NB-menu-manage-rename-save NB-menu-manage-feed-rename-save NB-modal-submit-green NB-modal-submit-button"},
"Save"),a.make("div",{className:"NB-menu-manage-image"}),a.make("input",{name:"new_title",className:"NB-menu-manage-title",value:g.feed_title})])]),a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-delete NB-menu-manage-feed-delete"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Delete this site")]),a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-delete-confirm NB-menu-manage-feed-delete-confirm"},[a.make("div",{className:"NB-menu-manage-image"}),
a.make("div",{className:"NB-menu-manage-title"},"Really delete?")])]);g.data("feed_id",c);g.data("$feed",f);c&&d==0&&(a(".NB-menu-manage-feed-mark-read",g).addClass("NB-disabled"),a(".NB-menu-manage-feed-unreadtabs",g).addClass("NB-disabled"))}else if(b=="folder")g=a.make("ul",{className:"NB-menu-manage"},[a.make("li",{className:"NB-menu-separator-inverse"}),a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-mark-read NB-menu-manage-folder-mark-read"},[a.make("div",{className:"NB-menu-manage-image"}),
a.make("div",{className:"NB-menu-manage-title"},"Mark folder as read")]),a.make("li",{className:"NB-menu-separator"}),a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-move NB-menu-manage-folder-move"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Move to folder")]),a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-confirm NB-menu-manage-folder-move-confirm NB-modal-submit"},[a.make("div",{className:"NB-menu-manage-confirm-position"},
[a.make("div",{className:"NB-menu-manage-move-save NB-menu-manage-folder-move-save NB-modal-submit-green NB-modal-submit-button"},"Save"),a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-add-folders"},NEWSBLUR.utils.make_folders(this.model))])]),a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-rename NB-menu-manage-folder-rename"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Rename this folder")]),a.make("li",
{className:"NB-menu-manage-feed NB-menu-manage-confirm NB-menu-manage-folder-rename-confirm NB-modal-submit"},[a.make("div",{className:"NB-menu-manage-confirm-position"},[a.make("div",{className:"NB-menu-manage-rename-save NB-menu-manage-folder-rename-save NB-modal-submit-green NB-modal-submit-button"},"Save"),a.make("div",{className:"NB-menu-manage-image"}),a.make("input",{name:"new_title",className:"NB-menu-manage-title",value:c})])]),a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-delete NB-menu-manage-folder-delete"},
[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Delete this folder")]),a.make("li",{className:"NB-menu-manage-feed NB-menu-manage-delete-confirm NB-menu-manage-folder-delete-confirm"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Really delete?")])]),g.data("folder_name",c),g.data("$folder",f);else if(b=="story"){g=this.model.get_feed(c);var j=this.model.get_story(d);g=j.starred?"Remove bookmark":
"Save This Story";g=a.make("ul",{className:"NB-menu-manage NB-menu-manage-story "+(j.starred?"NB-story-starred":"")},[a.make("li",{className:"NB-menu-separator"}),a.make("li",{className:"NB-menu-manage-story-open"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Open")]),a.make("li",{className:"NB-menu-separator"}),a.make("li",{className:"NB-menu-manage-story-star"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},
g)]),a.make("li",{className:"NB-menu-manage-story-thirdparty"},[NEWSBLUR.Preferences.story_share_facebook&&a.make("div",{className:"NB-menu-manage-thirdparty-icon NB-menu-manage-thirdparty-facebook"}).bind("mouseenter",_.bind(function(b){a(b.target).siblings(".NB-menu-manage-title").text("Send to Facebook").parent().addClass("NB-menu-manage-highlight-facebook")},this)).bind("mouseleave",_.bind(function(b){a(b.target).siblings(".NB-menu-manage-title").text("Send to Instapaper").parent().removeClass("NB-menu-manage-highlight-facebook")},
this)),NEWSBLUR.Preferences.story_share_twitter&&a.make("div",{className:"NB-menu-manage-thirdparty-icon NB-menu-manage-thirdparty-twitter"}).bind("mouseenter",_.bind(function(b){a(b.target).siblings(".NB-menu-manage-title").text("Send to Twitter").parent().addClass("NB-menu-manage-highlight-twitter")},this)).bind("mouseleave",_.bind(function(b){a(b.target).siblings(".NB-menu-manage-title").text("Send to Instapaper").parent().removeClass("NB-menu-manage-highlight-twitter")},this)),NEWSBLUR.Preferences.story_share_readitlater&&
a.make("div",{className:"NB-menu-manage-thirdparty-icon NB-menu-manage-thirdparty-readitlater"}).bind("mouseenter",_.bind(function(b){a(b.target).siblings(".NB-menu-manage-title").text("Read It Later").parent().addClass("NB-menu-manage-highlight-readitlater")},this)).bind("mouseleave",_.bind(function(b){a(b.target).siblings(".NB-menu-manage-title").text("Send to Instapaper").parent().removeClass("NB-menu-manage-highlight-readitlater")},this)),NEWSBLUR.Preferences.story_share_email&&a.make("div",{className:"NB-menu-manage-thirdparty-icon NB-menu-manage-thirdparty-email"}).bind("mouseenter",
_.bind(function(b){a(b.target).siblings(".NB-menu-manage-title").text("Send to email").parent().addClass("NB-menu-manage-highlight-email")},this)).bind("mouseleave",_.bind(function(b){a(b.target).siblings(".NB-menu-manage-title").text("Send to Instapaper").parent().removeClass("NB-menu-manage-highlight-email")},this)),a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Send to Instapaper")]).bind("click",_.bind(function(b){b.preventDefault();b.stopPropagation();
b=a(b.target);b.hasClass("NB-menu-manage-thirdparty-facebook")?this.send_story_to_facebook(j.id):b.hasClass("NB-menu-manage-thirdparty-twitter")?this.send_story_to_twitter(j.id):b.hasClass("NB-menu-manage-thirdparty-readitlater")?this.send_story_to_readitlater(j.id):b.hasClass("NB-menu-manage-thirdparty-readability")?this.send_story_to_readability(j.id):b.hasClass("NB-menu-manage-thirdparty-email")?this.send_story_to_email(j.id):this.send_story_to_instapaper(j.id)},this)),a.make("li",{className:"NB-menu-separator"}),
a.make("li",{className:"NB-menu-manage-story-train"},[a.make("div",{className:"NB-menu-manage-image"}),a.make("div",{className:"NB-menu-manage-title"},"Intelligence trainer"),a.make("div",{className:"NB-menu-manage-subtitle"},"What you like and dislike.")])]);g.data("feed_id",c);g.data("story_id",d);g.data("$story",f)}e&&g.addClass("NB-inverse");return g},show_manage_menu:function(b,c,d){var e=this,d=_.extend({toplevel:!1,inverse:!1},d),f=a(".NB-menu-manage-container");clearTimeout(this.flags.closed_manage_menu);
if(c&&c[0]==f.data("item")&&parseInt(f.css("opacity"),10)==1)this.hide_manage_menu(b,c);else if(this.hide_manage_menu(b,c),!c.hasClass("NB-empty")){c.addClass("NB-showing-menu");var g,j,k;b=="folder"?(g=a(".folder_title_text",c).eq(0).text(),j=d.inverse||a(".folder_title",c).hasClass("NB-hover-inverse")):b=="feed"?(g=c&&parseInt(c.attr("data-id"),10),j=d.inverse||c.hasClass("NB-hover-inverse")):b=="story"?(k=c.data("story_id"),c.hasClass("NB-hover-inverse")&&(j=!0)):b=="site"&&(a(".NB-task-manage").tipsy("hide"),
a(".NB-task-manage").tipsy("disable"));d=d.toplevel||c.hasClass("NB-toplevel")||c.children(".folder_title").hasClass("NB-toplevel");g=this.make_manage_menu(b,g,k,j,c);f.empty().append(g);f.data("item",c&&c[0]);a(".NB-task-manage").parents(".NB-taskbar").css("z-index",2);if(b=="site")f.align(a(".NB-task-manage"),"-bottom -left",{top:-32,left:-2}),a(".NB-task-manage").addClass("NB-hover"),f.corner("tl tr 8px");else if(b=="feed"||b=="folder"||b=="story"){var l,p;j?(g=c,b=="feed"?(l=d?0:-20,p=d?21:21):
b=="folder"?(l=d?0:-20,p=d?24:24,g=a(".folder_title",c)):b=="story"&&(l=4,p=24,g=a(".NB-story-manage-icon,.NB-feed-story-manage-icon",c)),f.align(g,"-bottom -left",{top:-1*p,left:l}),f.corner("br 8px"),a("li",f).each(function(){a(this).prependTo(a(this).parent())})):(g=c,b=="feed"?(l=d?2:-18,p=d?21:21,g=a(".NB-feedlist-manage-icon",c)):b=="folder"?(l=d?2:-20,p=d?22:21):b=="story"&&(l=4,p=18,g=a(".NB-story-manage-icon,.NB-feed-story-manage-icon",c)),f.align(g,"-top -left",{top:p,left:l}),f.corner("tr 8px"))}f.stop().css({display:"block",
opacity:1});if(b=="feed"||b=="folder"||b=="story")l=a.make("div",{className:"NB-menu-manage-arrow"}),j?(l.corner("bl br 5px"),f.append(l),l.addClass("NB-inverse")):(l.corner("tl tr 5px"),f.prepend(l));_.defer(function(){a(document).bind("click.menu",function(a){a.button!=2&&e.hide_manage_menu(b,c,!1)})});f.hover(function(){clearTimeout(e.flags.closed_manage_menu)},function(){clearTimeout(e.flags.closed_manage_menu);e.flags.closed_manage_menu=setTimeout(function(){e.flags.closed_manage_menu&&e.hide_manage_menu(b,
c,!0)},1E3)});var t;this.flags.feed_list_showing_manage_menu=!0;b=="feed"?t=this.$s.$feed_list.parent():b=="story"&&(t=this.$s.$story_titles.add(this.$s.$feed_stories));t&&t.unbind("scroll.manage_menu").bind("scroll.manage_menu",function(){e.flags.feed_list_showing_manage_menu?e.hide_manage_menu(b,c,!0):t.unbind("scroll.manage_menu")})}},hide_manage_menu:function(b,c,d){var e=a(".NB-menu-manage-container");e.outerHeight();if(!this.flags.showing_confirm_input_on_manage_menu||!d)clearTimeout(this.flags.closed_manage_menu),
this.flags.feed_list_showing_manage_menu=!1,a(document).unbind("click.menu"),e.uncorner(),this.model.preference("show_tooltips")&&a(".NB-task-manage").tipsy("enable"),c.removeClass("NB-showing-menu"),d?e.stop().animate({opacity:0},{duration:250,queue:!1,complete:function(){e.css({display:"none",opacity:0})}}):e.css({display:"none",opacity:0}),a(".NB-task-manage").removeClass("NB-hover")},show_confirm_delete_menu_item:function(){var b=a(".NB-menu-manage-feed-delete,.NB-menu-manage-folder-delete"),
c=a(".NB-menu-manage-feed-delete-confirm,.NB-menu-manage-folder-delete-confirm");b.addClass("NB-menu-manage-feed-delete-cancel");a(".NB-menu-manage-title",b).text("Cancel delete");c.slideDown(500)},hide_confirm_delete_menu_item:function(){var b=a(".NB-menu-manage-feed-delete,.NB-menu-manage-folder-delete"),c=a(".NB-menu-manage-feed-delete-confirm,.NB-menu-manage-folder-delete-confirm");b.removeClass("NB-menu-manage-feed-delete-cancel");var d=b.hasClass("NB-menu-manage-folder-delete")?"Delete this folder":
"Delete this site";a(".NB-menu-manage-title",b).text(d);c.slideUp(500)},manage_menu_delete_feed:function(a,c){var d=this,e=a||this.active_feed,c=c||this.find_feed_in_feed_list(e),f=c.parents("li.folder").eq(0).find(".folder_title_text").eq(0).text(),g=this.find_feed_in_feed_list(e).length>1;this.model.delete_feed(e,f,function(){d.delete_feed(e,c)},g)},manage_menu_delete_folder:function(a,c){var d=this,e="",f=c.parents("li.folder"),g=this.get_feed_ids_in_folder(c);f.length&&(e=f.eq(0).find(".folder_title_text").eq(0).text());
this.model.delete_folder(a,e,g,function(){d.delete_folder(a,c)})},delete_feed:function(a,c){c=c||this.find_feed_in_feed_list(a);c.slideUp(500);this.active_feed==parseInt(c.attr("data-id"),10)&&(this.reset_feed(),this.show_splash_page());this.update_header_counts()},delete_folder:function(a,c){var d=this,e=this.get_feed_ids_in_folder(c);c.length&&c.slideUp(500);_.each(e,_.bind(function(a){if(d.active_feed==a)return this.reset_feed(),this.show_splash_page(),!1},this));this.update_header_counts()},show_confirm_move_menu_item:function(b,
c){var d=a(".NB-menu-manage-feed-move,.NB-menu-manage-folder-move"),e=a(".NB-menu-manage-feed-move-confirm,.NB-menu-manage-folder-move-confirm"),f=a(".NB-menu-manage-confirm-position",e),g=a("select",e),j="";c.closest("li.folder").length&&(j=c.eq(0).closest("li.folder").find(".folder_title_text").eq(0).text());d.addClass("NB-menu-manage-feed-move-cancel");a(".NB-menu-manage-title",d).text("Cancel move");f.css("position","relative");d=e.height();f.css("position","absolute");e.css({height:0,display:"block"}).animate({height:d},
{duration:500,easing:"easeOutQuart"});a("select",e).focus().select();this.flags.showing_confirm_input_on_manage_menu=!0;console.log(["$select",g,a("option",g)]);a("option",g).each(function(){console.log(["show_confirm_move_menu_item",j,a(this).attr("value")]);if(a(this).attr("value")==j)return a(this).attr("selected","selected"),!1})},hide_confirm_move_menu_item:function(b){var c=a(".NB-menu-manage-feed-move,.NB-menu-manage-folder-move"),d=a(".NB-menu-manage-feed-move-confirm,.NB-menu-manage-folder-move-confirm");
c.removeClass("NB-menu-manage-feed-move-cancel");var e="Move to folder";b?(e="Moved",c.addClass("NB-active")):c.removeClass("NB-active");a(".NB-menu-manage-title",c).text(e);d.slideUp(500);this.flags.showing_confirm_input_on_manage_menu=!1},manage_menu_move_feed:function(b,c){var d=b||this.active_feed,c=c||this.find_feed_in_feed_list(d),e=c.closest("li.folder"),f=a(".NB-menu-manage-feed-move-confirm select").val();if(f.length<=0)return this.hide_confirm_move_menu_item();e.length&&c.eq(0).closest("li.folder").find(".folder_title_text").eq(0).text();
this.model.move_feed_to_folder(d,f,function(){});this.hide_confirm_move_menu_item(!0)},manage_menu_move_folder:function(b,c){var d="",e=c.closest("li.folder"),f=a(".NB-menu-manage-folder-move-confirm select").val();if(f.length<=0)return this.hide_confirm_move_menu_item();e.length&&(d=e.find(".folder_title_text").eq(0).text());this.model.move_folder_to_folder(b,f,d,function(){});this.hide_confirm_move_menu_item(!0)},show_confirm_rename_menu_item:function(){var b=this,c=a(".NB-menu-manage-feed-rename,.NB-menu-manage-folder-rename"),
d=a(".NB-menu-manage-feed-rename-confirm,.NB-menu-manage-folder-rename-confirm"),e=a(".NB-menu-manage-confirm-position",d);c.addClass("NB-menu-manage-feed-rename-cancel");a(".NB-menu-manage-title",c).text("Cancel rename");e.css("position","relative");c=d.height();e.css("position","absolute");d.css({height:0,display:"block"}).animate({height:c},{duration:500,easing:"easeOutQuart"});a("input",d).focus().select();this.flags.showing_confirm_input_on_manage_menu=!0;a(".NB-menu-manage-feed-rename-confirm input.NB-menu-manage-title").bind("keyup",
"return",function(c){var d=a(c.target),c=d.closest(".NB-menu-manage").data("feed_id"),d=d.closest(".NB-menu-manage").data("$feed");b.manage_menu_rename_feed(c,d)});a(".NB-menu-manage-folder-rename-confirm input.NB-menu-manage-title").bind("keyup","return",function(c){var d=a(c.target),c=d.parents(".NB-menu-manage").data("folder_name"),d=d.parents(".NB-menu-manage").data("$folder");b.manage_menu_rename_folder(c,d)})},hide_confirm_rename_menu_item:function(b){var c=a(".NB-menu-manage-feed-rename,.NB-menu-manage-folder-rename"),
d=a(".NB-menu-manage-feed-rename-confirm,.NB-menu-manage-folder-rename-confirm");c.removeClass("NB-menu-manage-feed-rename-cancel");var e=c.hasClass("NB-menu-manage-folder-rename")?"Rename this folder":"Rename this site";b?(e="Renamed",c.addClass("NB-active")):c.removeClass("NB-active");a(".NB-menu-manage-title",c).text(e);d.slideUp(500);this.flags.showing_confirm_input_on_manage_menu=!1},manage_menu_rename_feed:function(b,c){var d=b||this.active_feed,c=c||this.find_feed_in_feed_list(d),e=a(".NB-menu-manage-feed-rename-confirm .NB-menu-manage-title").val();
if(e.length<=0)return this.hide_confirm_rename_menu_item();this.model.rename_feed(d,e,function(){});a(".feed_title",c).text(e);d==this.active_feed&&a(".feed_title",this.$s.$story_titles).text(e);this.hide_confirm_rename_menu_item(!0)},manage_menu_rename_folder:function(b,c){var d="",e=c.parents("li.folder"),f=a(".NB-menu-manage-folder-rename-confirm .NB-menu-manage-title").val();if(f.length<=0)return this.hide_confirm_rename_menu_item();e.length&&(d=e.eq(0).find(".folder_title_text").eq(0).text());
this.model.rename_folder(b,f,d,function(){});NEWSBLUR.log(["rename",c,f]);a(".folder_title_text",c).text(f);this.hide_confirm_rename_menu_item(!0);a(".NB-menu-manage-folder-rename").parents(".NB-menu-manage").data("folder_name",f)},load_intelligence_slider:function(){var a=this,c=this.$s.$intelligence_slider,d=this.model.preference("unread_view");this.switch_feed_view_unread_view(d);c.slider({range:"max",min:-1,max:1,step:1,value:d,slide:function(c,d){a.switch_feed_view_unread_view(d.value)},stop:function(c,
d){a.slide_intelligence_slider(d.value)}})},slide_intelligence_slider:function(a){this.model.preference("unread_view")!=a&&this.model.preference("unread_view",a);this.flags.feed_view_positions_calculated=!1;this.switch_feed_view_unread_view(a);this.show_feed_hidden_story_title_indicator();this.show_story_titles_above_intelligence_level({animate:!0,follow:!0})},move_intelligence_slider:function(a){var c=this.$s.$intelligence_slider,a=this.model.preference("unread_view")+a;c.slider({value:a});this.slide_intelligence_slider(a)},
switch_feed_view_unread_view:function(b){_.isNumber(b)||(b=this.model.preference("unread_view"));var c=this.$s.$feed_list,b=this.get_unread_view_name(b),d=a(".task_story_next_unread"),e=a(".NB-story-title-indicator",this.$story_titles),f=a(".NB-feeds-header-sites");c.removeClass("unread_view_positive").removeClass("unread_view_neutral").removeClass("unread_view_negative").addClass("unread_view_"+b);NEWSBLUR.Preferences.hide_read_feeds==1?(f.attr("title","Show all sites"),this.$s.$body.addClass("NB-feedlist-hide-read-feeds")):
(f.attr("title","Show only unread stories"),this.$s.$body.removeClass("NB-feedlist-hide-read-feeds"));this.model.preference("show_tooltips")&&f.tipsy({gravity:"n",delayIn:375});d.removeClass("task_story_next_positive").removeClass("task_story_next_neutral").removeClass("task_story_next_negative").addClass("task_story_next_"+b);e.removeClass("unread_threshold_positive").removeClass("unread_threshold_neutral").removeClass("unread_threshold_negative").addClass("unread_threshold_"+b)},get_unread_view_name:function(a){typeof a==
"undefined"&&(a=this.model.preference("unread_view"));return a>0?"positive":a<0?"negative":"neutral"},get_unread_count:function(b,c){var d=0,c=c||this.active_feed;if(c!="starred")if(this.flags.river_view)return d=c=="river:"?this.$s.$feed_list:a("li.folder.NB-selected"),d=this.list_feeds_with_unreads_in_folder(d,!0,b),_.reduce(d,function(a,b){return a+b},0);else{var e=this.model.get_feed(c);if(b){var f=this.get_unread_view_name();f=="positive"?d=e.ps:f=="neutral"?d=e.ps+e.nt:f=="negative"&&(d=e.ps+
e.nt+e.ng)}else d=e.ng+e.nt+e.ps;return d}},show_story_titles_above_intelligence_level:function(b){var b=a.extend({},{unread_view_name:null,animate:!0,follow:!0,temporary:!1},b),c=this,d=b.unread_view_name||this.get_unread_view_name(),e,f;if(this.flags.unread_threshold_temporarily)d=this.flags.unread_threshold_temporarily,b.temporary=!0;d=="positive"?(e=a(".story,.NB-feed-story").filter(".NB-story-positive"),f=a(".story,.NB-feed-story").filter(".NB-story-neutral,.NB-story-negative")):d=="neutral"?
(e=a(".story,.NB-feed-story").filter(".NB-story-positive,.NB-story-neutral"),f=a(".story,.NB-feed-story").filter(".NB-story-negative"),b.temporary?e.filter(".NB-story-neutral").addClass("NB-story-hidden-visible"):e.filter(".NB-story-hidden-visible").removeClass("NB-story-hidden-visible")):d=="negative"&&(e=a(".story,.NB-feed-story").filter(".NB-story-positive,.NB-story-neutral,.NB-story-negative"),f=a(),b.temporary?e.filter(".NB-story-negative,.NB-story-neutral:not(:visible)").addClass("NB-story-hidden-visible"):
e.filter(".NB-story-hidden-visible").removeClass("NB-story-hidden-visible"));if((this.story_view=="feed"||this.flags.page_view_showing_feed_view)&&this.model.preference("feed_view_single_story")){var g=this.active_story;if((d=g&&a(".NB-feed-story").filter(function(){return a(this).data("story_id")==g.id}))&&d.length)e=e.not(".NB-feed-story").add(d),f=f.add(".NB-feed-story").not(e)}b.animate||(f.css({display:"none"}),e.css({display:"block"}),this.check_story_titles_last_story());this.story_view=="feed"&&
!this.model.preference("feed_view_single_story")&&(e.filter(":visible").length!=e.length||f.filter(":visible").length!=0)&&setTimeout(function(){c.flags.feed_view_positions_calculated=!1;c.prefetch_story_locations_in_feed_view()},500);b.animate&&b.follow&&(this.model.preference("animations")?(f.slideUp(500,function(){c.check_story_titles_last_story()}),e.slideDown(500)):(f.css({display:"none"}),e.css({display:"block"}),this.check_story_titles_last_story()),setTimeout(function(){if(c.active_story){var a=
c.find_story_in_story_titles(c.active_story.id);if(a&&a.length&&a.is(":visible")){var b=c.active_story;c.active_story=null;c.open_story(b,a);c.scroll_story_titles_to_show_selected_story_title(a)}}},this.model.preference("animations")?550:0))},force_instafetch_stories:function(a){var a=a||this.active_feed,c=this.find_feed_in_feed_list(a);c.addClass("NB-feed-unfetched").removeClass("NB-feed-exception");this.model.save_exception_retry(a,_.bind(this.force_feed_refresh,this,a,c))},setup_socket_realtime_unread_counts:function(a){if(a&&
!this.socket)this.socket=this.socket||io.connect("http://"+window.location.hostname+":8888"),this.socket.on("connect",_.bind(function(){this.socket.emit("subscribe:feeds",_.keys(this.model.feeds));this.socket.on("feed:update",_.bind(function(a,b){console.log(["Feed update",a,b]);this.force_feeds_refresh(!1,!1,parseInt(a,10))},this));this.flags.feed_refreshing_in_realtime=!0;this.setup_feed_refresh()},this))},setup_feed_refresh:function(a){var c=this,d=this.constants.FEED_REFRESH_INTERVAL,e=_.size(this.model.feeds);
NEWSBLUR.Globals.is_premium||(d*=2);e>250&&(d*=4);e>500&&(d*=1.5);this.flags.feed_refreshing_in_realtime&&(d*=20);a&&e<250?d=6E3:a&&e<500&&(d=15E3);clearInterval(this.flags.feed_refresh);this.flags.feed_refresh=setInterval(function(){c.flags.pause_feed_refreshing||c.model.refresh_feeds(_.bind(function(a){c.post_feed_refresh(a)},c),c.flags.has_unfetched_feeds)},d)},force_feed_refresh:function(b,c){var d=this,b=b||this.active_feed,c=c||this.find_feed_in_feed_list(b);this.force_feeds_refresh(function(e){e=
a(d.make_feed_title_template(e[b],"feed"));c.hasClass("NB-toplevel")&&e.addClass("NB-toplevel");c.replaceWith(e);d.cache.$feed_in_feed_list[b]=null;d.hover_over_feed_titles(e);d.active_feed==b&&d.open_feed(b,!0,e)},!1,b)},force_feeds_refresh:function(a,c,d){a?this.cache.refresh_callback=a:delete this.cache.refresh_callback;this.flags.pause_feed_refreshing=!0;this.model.refresh_feeds(_.bind(function(a){this.post_feed_refresh(a,c,d)},this),this.flags.has_unfetched_feeds,d)},post_feed_refresh:function(b,
c,d){var e=this.model.feeds;this.cache.refresh_callback&&a.isFunction(this.cache.refresh_callback)&&(this.cache.refresh_callback(e),delete this.cache.refresh_callback);for(var f in b){var e=b[f],g=this.model.get_feed(e);if(g){var j=a(this.make_feed_title_template(g,"feed")),k=this.find_feed_in_feed_list(e);e==this.active_feed?(NEWSBLUR.log(["UPDATING INLINE",g.feed_title,j,k,c]),c?(k.hasClass("NB-toplevel")&&j.addClass("NB-toplevel"),k.replaceWith(j),this.cache.$feed_in_feed_list[e]=null,this.mark_feed_as_selected(this.active_feed,
j),d||this.recalculate_story_scores(e),this.show_feed_hidden_story_title_indicator(),this.make_content_pane_feed_counter()):(this.model.feeds[e].ps=parseInt(a(".unread_count_positive",k).text(),10),this.model.feeds[e].nt=parseInt(a(".unread_count_neutral",k).text(),10),this.model.feeds[e].ng=parseInt(a(".unread_count_negative",k).text(),10))):(this.flags.has_unfetched_feeds||NEWSBLUR.log(["UPDATING",g.feed_title,j,k]),k.hasClass("NB-toplevel")&&j.addClass("NB-toplevel"),k.replaceWith(j),this.cache.$feed_in_feed_list[e]=
null,function(a){a.css({backgroundColor:"#D7DDE6"});a.animate({backgroundColor:"#F0F076"},{duration:800,queue:!1,complete:function(){a.animate({backgroundColor:"#D7DDE6"},{duration:1E3,queue:!1})}})}(j));this.hover_over_feed_titles(j)}}this.check_feed_fetch_progress();this.update_header_counts();this.count_collapsed_unread_stories();this.flags.pause_feed_refreshing=!1},post_refresh_active_feed:function(b,c){var d=c.stories,e=this.active_feed,f=[],g=a(".story:first",this.$s.$story_titles),j;for(j in d){e=
d[j].story_feed_id;break}if(this.active_feed==e){for(j in this.model.stories){var k=this.model.stories[j],d=this.find_story_in_story_titles(k.id),e=this.find_story_in_feed_view(k);d&&d.length?(k=NEWSBLUR.utils.compute_story_score(k),d.removeClass("NB-story-neutral").removeClass("NB-story-negative").removeClass("NB-story-positive"),e.removeClass("NB-story-neutral").removeClass("NB-story-negative").removeClass("NB-story-positive"),k<0?(d.addClass("NB-story-negative"),e.addClass("NB-story-negative")):
k>0?(d.addClass("NB-story-positive"),e.addClass("NB-story-positive")):k==0&&(d.addClass("NB-story-neutral"),e.addClass("NB-story-neutral"))):(f.unshift(k),$new_story=this.make_story_title(k),$new_story.css({display:"none"}),g.before($new_story),NEWSBLUR.log(["New story",$new_story,g]))}if(f.length)this.make_story_feed_entries(f,!1,{refresh_load:!0}),this.flags.feed_view_positions_calculated=!1;this.show_story_titles_above_intelligence_level({animate:!0,follow:!1})}this.update_header_counts()},hide_mouse_indicator:function(){var a=
this;if(!this.flags.mouse_indicator_hidden)this.flags.mouse_indicator_hidden=!0,this.$s.$mouse_indicator.animate({opacity:0,left:-10},{duration:200,queue:!1,complete:function(){a.flags.mouse_indicator_hidden=!0}})},show_mouse_indicator:function(){var a=this;if(this.flags.mouse_indicator_hidden)this.flags.mouse_indicator_hidden=!1,this.$s.$mouse_indicator.animate({opacity:1,left:0},{duration:200,queue:!1,complete:function(){a.flags.mouse_indicator_hidden=!1}})},handle_mouse_indicator_hover:function(){var b=
this,c=a(".NB-callout-mouse-indicator");a(".NB-callout-text",c).text("Lock");c.corner("5px");this.$s.$mouse_indicator.hover(function(){parseInt(b.model.preference("lock_mouse_indicator"),10)?a(".NB-callout-text",c).text("Unlock"):a(".NB-callout-text",c).text("Lock");b.flags.still_hovering_on_mouse_indicator=!0;setTimeout(function(){b.flags.still_hovering_on_mouse_indicator&&c.css({display:"block"}).animate({opacity:1,left:"20px"},{duration:200,queue:!1})},50)},function(){b.flags.still_hovering_on_mouse_indicator=
!1;c.animate({opacity:0,left:"-100px"},{duration:200,queue:!1})})},lock_mouse_indicator:function(){var b=this,c=a(".NB-callout-mouse-indicator");parseInt(b.model.preference("lock_mouse_indicator"),10)?(b.model.preference("lock_mouse_indicator",0),a(".NB-callout-text",c).text("Unlocked")):(b.model.preference("lock_mouse_indicator",this.cache.mouse_position_y),a(".NB-callout-text",c).text("Locked"));setTimeout(function(){b.flags.still_hovering_on_mouse_indicator=!0;c.fadeOut(200)},500)},position_mouse_indicator:function(){var a=
parseInt(this.model.preference("lock_mouse_indicator"),10);a==0?a=50:a-=8;this.$s.$mouse_indicator.css("top",a)},handle_login_and_signup_forms:function(){var b=a(".NB-signup-hidden"),c=a("input[name=signup-username]");c.bind("focus",function(){b.slideDown(300)}).bind("blur",function(){c.val().length<1&&b.slideUp(300)})},load_feature_page:function(b){var c=this,d=a(".NB-module-features"),e=a(".NB-module-features .NB-module-next-page"),f=a(".NB-module-features .NB-module-previous-page");d.addClass("NB-loading");
b==-1&&!this.counts.feature_page?d.removeClass("NB-loading"):b==1&&this.flags.features_last_page?d.removeClass("NB-loading"):this.model.get_features_page(this.counts.feature_page+b,function(g){d.removeClass("NB-loading");c.counts.feature_page+=b;var j=a.make("table",{className:"NB-features",cellSpacing:0,cellPadding:0}),k;for(k in g){if(k==3)break;var l=g[k],l=a.make("tr",{className:"NB-module-feature"},[a.make("td",{className:"NB-module-feature-date"},l.date),a.make("td",{className:"NB-module-feature-description"},
l.description)]);j.append(l)}a(".NB-module-features .NB-features").replaceWith(j);g.length<4?(e.addClass("NB-disabled"),c.flags.features_last_page=!0):(e.removeClass("NB-disabled"),c.flags.features_last_page=!1);c.counts.feature_page>0?f.removeClass("NB-disabled"):f.addClass("NB-disabled")})},setup_howitworks_hovers:function(){a(".NB-module-howitworks .NB-module-page-indicator").bind("mouseenter",_.bind(function(b){this.load_howitworks_page(a(b.target).prevAll(".NB-module-page-indicator").length)},
this))},load_howitworks_page:function(b){var c=a(".NB-module-howitworks .NB-module-next-page"),d=a(".NB-module-howitworks .NB-module-previous-page"),e=a(".NB-howitworks-page"),f=a(".NB-module-howitworks .NB-module-page-indicator"),g=e.length;b!=-1&&!(b>=g)&&(e.removeClass("NB-active"),f.removeClass("NB-active"),e.eq(b).addClass("NB-active"),f.eq(b).addClass("NB-active"),b>=g-1?c.addClass("NB-disabled"):c.removeClass("NB-disabled"),b<=0?d.addClass("NB-disabled"):d.removeClass("NB-disabled"))},setup_ftux_add_feed_callout:function(){var b=
this;a(".NB-callout-ftux .NB-callout-text").text("First things first...");a(".NB-callout-ftux").corner("5px");a(".NB-callout-ftux").css({opacity:0,display:"block"}).animate({opacity:1,bottom:6},{duration:750,easing:"easeInOutQuint"}).each(function(){var c=a(this);b.flags.bouncing_callout=setInterval(function(){c.animate({bottom:"+=2px"},{duration:200,easing:"easeInOutQuint"}).animate({bottom:"+=0px"},{duration:50}).animate({bottom:"-=2px"},{duration:200,easing:"easeInOutQuint"})},1E3)})},setup_ftux_signup_callout:function(){var b=
this;b.flags.bouncing_callout||(a(".NB-callout-ftux-signup .NB-callout-text").text("Signup"),a(".NB-callout-ftux-signup").corner("5px"),a(".NB-callout-ftux-signup").css({opacity:0,display:"block"}).animate({opacity:1,bottom:36},{duration:750,easing:"easeInOutQuint"}).each(function(){var c=a(this);b.flags.bouncing_callout=setInterval(function(){c.animate({bottom:"+=2px"},{duration:200,easing:"easeInOutQuint"}).animate({bottom:"+=0px"},{duration:50}).animate({bottom:"-=2px"},{duration:200,easing:"easeInOutQuint"})},
1E4)}))},start_import_from_google_reader:function(){var b=this.$s.$feeds_progress,c=a(".NB-progress-bar",b);this.flags.import_from_google_reader_working=!0;a(".NB-progress-title",b).text("Importing from Google Reader");a(".NB-progress-counts",b).hide();a(".NB-progress-percentage",b).hide();c.progressbar({value:0});this.animate_progress_bar(c,4);this.model.start_import_from_google_reader(a.rescope(this.finish_import_from_google_reader,this));this.show_progress_bar()},finish_import_from_google_reader:function(b,
c){var d=this.$s.$feeds_progress,e=a(".NB-progress-bar",d);this.flags.import_from_google_reader_working=!1;clearTimeout(this.locks.animate_progress_bar);c.code>=1?(e.progressbar({value:100}),this.load_feeds()):(NEWSBLUR.log(["Import Error!",c]),this.$s.$feed_link_loader.fadeOut(250),d.addClass("NB-progress-error"),a(".NB-progress-title",d).text("Error importing Google Reader"),a(".NB-progress-link",d).html(a.make("a",{href:NEWSBLUR.URLs["google-reader-authorize"],className:"NB-splash-link"},"Try importing again")),
a(".left-center-footer").css("height","auto"))},start_count_unreads_after_import:function(){var b=this,c=this.$s.$feeds_progress,d=a(".NB-progress-bar",c),e=_.keys(this.model.feeds).length;if(this.flags.pause_feed_refreshing)this.flags.count_unreads_after_import_working=!0,a(".NB-progress-title",c).text("Counting is difficult"),a(".NB-progress-counts",c).hide(),a(".NB-progress-percentage",c).hide(),d.progressbar({value:0}),setTimeout(function(){b.flags.count_unreads_after_import_working&&(b.animate_progress_bar(d,
e/10),b.show_progress_bar())},500)},finish_count_unreads_after_import:function(){a(".NB-progress-bar",this.$s.$feeds_progress).progressbar({value:100});this.flags.count_unreads_after_import_working=!1;clearTimeout(this.locks.animate_progress_bar);this.$s.$feed_link_loader.fadeOut(250);this.setup_feed_refresh();this.flags.has_unfetched_feeds||this.hide_progress_bar()},load_recommended_feeds:function(){clearInterval(this.locks.load_recommended_feed);this.locks.load_recommended_feed=setInterval(_.bind(function(){this.load_recommended_feed(0,
!0)},this),6E5)},load_feed_in_tryfeed_view:function(b,c){var c=c||{},d=a(".NB-module-recommended"),e=this.$s.$tryfeed_header.closest(".NB-feeds-header-container"),c={feed_id:b,feed_title:c.feed_title||a(".NB-recommended-title",d).text(),favicon:c.favicon?a.favicon(c.favicon):a(".NB-recommended-favicon",d).attr("src"),feed_address:c.feed_address};this.reset_feed();this.model.set_feed(b,c);a(".NB-feeds-header-title",this.$s.$tryfeed_header).text(c.feed_title);a(".NB-feeds-header-icon",this.$s.$tryfeed_header).attr("src",
c.favicon);e.slideDown(350,_.bind(function(){this.open_feed(b);this.flags.showing_feed_in_tryfeed_view=!0;this.$s.$tryfeed_header.addClass("NB-selected")},this))},hide_tryfeed_view:function(){this.$s.$tryfeed_header.closest(".NB-feeds-header-container").slideUp(350);this.$s.$story_taskbar.find(".NB-tryfeed-add").remove();this.flags.showing_feed_in_tryfeed_view=!1},show_tryfeed_add_button:function(){if(!this.$s.$story_taskbar.find(".NB-tryfeed-add:visible").length){var b=a.make("div",{className:"NB-modal-submit"},
[a.make("div",{className:"NB-tryfeed-add NB-modal-submit-green NB-modal-submit-button"},"Add")]).css({opacity:0});this.$s.$story_taskbar.find(".NB-taskbar").append(b);b.animate({opacity:1},{duration:600})}},add_recommended_feed:function(a){this.open_add_feed_modal({url:this.model.get_feed(a?a:this.active_feed).feed_address})},approve_feed_in_moderation_queue:function(b){var c=this,d=a(".NB-module-recommended.NB-recommended-unmoderated");d.addClass("NB-loading");var e=a(".NB-recommended-moderation-date").val();
this.model.approve_feed_in_moderation_queue(b,e,function(a){a&&(d.removeClass("NB-loading"),d.replaceWith(a),c.load_javascript_elements_on_page())})},decline_feed_in_moderation_queue:function(b){var c=this,d=a(".NB-module-recommended.NB-recommended-unmoderated");d.addClass("NB-loading");this.model.decline_feed_in_moderation_queue(b,function(a){a&&(d.removeClass("NB-loading"),d.replaceWith(a),c.load_javascript_elements_on_page())})},load_recommended_feed:function(b,c,d){var e=this,f=d?a(".NB-module-recommended.NB-recommended-unmoderated"):
a(".NB-module-recommended:not(.NB-recommended-unmoderated)");f.addClass("NB-loading");b=b||0;this.model.load_recommended_feed(this.counts.recommended_feed_page+b,!!c,d,function(a){a&&(e.counts.recommended_feed_page+=b,f.removeClass("NB-loading"),f.replaceWith(a),e.load_javascript_elements_on_page())},a.noop)},setup_dashboard_graphs:function(){clearInterval(this.locks.load_dashboard_graphs);this.locks.load_dashboard_graphs=setInterval(_.bind(function(){this.load_dashboard_graphs()},this),6E5)},load_dashboard_graphs:function(){var b=
this,c=a(".NB-module-stats");c.addClass("NB-loading");this.model.load_dashboard_graphs(function(a){a&&(c.removeClass("NB-loading"),c.replaceWith(a),b.load_javascript_elements_on_page())},a.noop)},handle_clicks:function(b,c){var d=this,e=!1;a.targetIs(c,{tagSelector:"#feed_list .NB-feedlist-manage-icon"},function(a){c.preventDefault();d.flags.sorting_feed||(e=!0,a.parent().hasClass("feed")?d.show_manage_menu("feed",a.closest(".feed")):(a=a.closest(".folder"),d.show_manage_menu("folder",a),a.addClass("NB-hover")))});
if(!e&&(a.targetIs(c,{tagSelector:"#feed_list .feed.NB-feed-exception"},function(a){c.preventDefault();if(!d.flags.sorting_feed){var b=parseInt(a.attr("data-id"),10);e=!0;d.open_feed_exception_modal(b,a)}}),!e&&(a.targetIs(c,{tagSelector:"#feed_list .feed:not(.NB-empty)"},function(a){c.preventDefault();if(!d.flags.sorting_feed){var b=parseInt(a.attr("data-id"),10);NEWSBLUR.hotkeys.command?d.open_unread_stories_in_tabs(b):d.open_feed(b,!1,a)}}),a.targetIs(c,{tagSelector:"#feed_list .folder_title .NB-feedlist-collapse-icon"},
function(a){c.preventDefault();e=!0;a=a.closest(".folder_title");d.flags.sorting_feed||d.collapse_folder(a)}),!e))){a.targetIs(c,{tagSelector:"#feed_list .folder_title"},function(a){c.preventDefault();var b=a.closest("li.folder"),a=a.find(".folder_title_text").text();d.open_river_stories(b,a)});a.targetIs(c,{tagSelector:".NB-feedbar .NB-feedlist-manage-icon"},function(a){c.preventDefault();d.show_manage_menu("feed",a.closest(".feed"),{toplevel:!0})});a.targetIs(c,{tagSelector:".NB-feedbar-mark-feed-read"},
function(a){c.preventDefault();var b=parseInt(a.closest(".feed").attr("data-id"),10);d.mark_feed_as_read(b,a);a.fadeOut(400)});a.targetIs(c,{tagSelector:".NB-feedbar-statistics"},function(){d.open_feed_statistics_modal()});a.targetIs(c,{tagSelector:".NB-feedbar-train-feed"},function(){c.preventDefault();a(".NB-task-manage").hasClass("NB-disabled")||d.open_feed_intelligence_modal(1,this.active_feed,!0)});a.targetIs(c,{tagSelector:".NB-story-title-indicator"},function(){c.preventDefault();d.show_hidden_story_titles()});
a.targetIs(c,{tagSelector:".NB-feeds-header-starred"},function(){c.preventDefault();d.open_starred_stories()});a.targetIs(c,{tagSelector:".NB-feeds-header-river"},function(){c.preventDefault();d.open_river_stories()});a.targetIs(c,{tagSelector:".NB-feed-like"},function(){c.preventDefault();d.open_feed_intelligence_modal(1)});a.targetIs(c,{tagSelector:".NB-feed-dislike"},function(){c.preventDefault();d.open_feed_intelligence_modal(-1)});var f=!1;a.targetIs(c,{tagSelector:".NB-story-manage-icon"},function(a){c.preventDefault();
f=!0;d.show_manage_menu("story",a.closest(".story"))});a.targetIs(c,{tagSelector:".NB-feed-story-manage-icon"},function(a){c.preventDefault();f=!0;d.show_manage_menu("story",a.closest(".NB-feed-story"))});a.targetIs(c,{tagSelector:".NB-menu-manage-story-open"},function(a){c.preventDefault();a=a.closest(".NB-menu-manage-story").data("story_id");d.open_story_in_new_tab(a);f=!0});a.targetIs(c,{tagSelector:".NB-menu-manage-story-star"},function(a){c.preventDefault();var a=a.closest(".NB-menu-manage-story").data("story_id"),
b=d.find_story_in_story_titles(a);b.hasClass("NB-story-starred")?d.mark_story_as_unstarred(a,b):d.mark_story_as_starred(a,b);f=!0});a.targetIs(c,{tagSelector:".NB-feed-story-hide-changes"},function(a){c.preventDefault();a=a.closest(".NB-feed-story");d.hide_story_changes(a);f=!0});if(f)return!1;a.targetIs(c,{tagSelector:".NB-feed-story-tag"},function(a){c.preventDefault();var b=a.closest(".NB-feed-story"),e=b.data("feed_id"),f=a.data("tag"),a=a.hasClass("NB-score-1")?-1:a.hasClass("NB-score--1")?0:
1;d.save_classifier("tag",f,a,e);d.preserve_classifier_color(b,"tag",f,a)});a.targetIs(c,{tagSelector:".NB-feed-story-author"},function(a){c.preventDefault();var b=a.closest(".NB-feed-story"),e=b.data("feed_id"),f=a.data("author"),a=a.hasClass("NB-score-1")?-1:a.hasClass("NB-score--1")?0:1;d.save_classifier("author",f,a,e);d.preserve_classifier_color(b,"author",f,a)});a.targetIs(c,{tagSelector:".story"},function(b){c.preventDefault();var e=a(".story_id",b).text();d.push_current_story_on_history();
NEWSBLUR.hotkeys.command?d.open_story_in_new_tab(e,b):(e=d.model.get_story(e),d.open_story(e,b))});a.targetIs(c,{tagSelector:"a.mark_story_as_read"},function(a){c.preventDefault();a=a.attr("href").slice(1).split("/");d.mark_story_as_read(a)});a.targetIs(c,{tagSelector:".NB-feed-story-premium-only a"},function(){c.preventDefault();d.open_feedchooser_modal()});a.targetIs(c,{tagSelector:".NB-task-add"},function(){c.preventDefault();d.open_add_feed_modal()});a.targetIs(c,{tagSelector:".NB-task-manage"},
function(a){c.preventDefault();a.hasClass("NB-disabled")||d.show_manage_menu("site",a)});a.targetIs(c,{tagSelector:".NB-taskbar-sidebar-toggle-close"},function(){c.preventDefault();d.close_sidebar()});a.targetIs(c,{tagSelector:".NB-taskbar-sidebar-toggle-open"},function(){c.preventDefault();d.open_sidebar()});a.targetIs(c,{tagSelector:".NB-menu-manage-feed-train"},function(a){c.preventDefault();a.hasClass("NB-disabled")||(a=a.parents(".NB-menu-manage").data("feed_id"),d.open_feed_intelligence_modal(1,
a,!1))});a.targetIs(c,{tagSelector:".NB-menu-manage-feed-recommend"},function(a){c.preventDefault();a=a.parents(".NB-menu-manage").data("feed_id");d.open_recommend_modal(a)});a.targetIs(c,{tagSelector:".NB-menu-manage-story-train"},function(a){c.preventDefault();if(!a.hasClass("NB-disabled")){var b=a.closest(".NB-menu-manage").data("feed_id"),a=a.closest(".NB-menu-manage").data("story_id");d.open_story_trainer(a,b)}});a.targetIs(c,{tagSelector:".NB-menu-manage-trainer"},function(a){c.preventDefault();
a.hasClass("NB-disabled")||d.open_trainer_modal()});a.targetIs(c,{tagSelector:".NB-menu-manage-tutorial"},function(a){c.preventDefault();a.hasClass("NB-disabled")||d.open_tutorial_modal()});a.targetIs(c,{tagSelector:".NB-menu-manage-feed-stats"},function(a){c.preventDefault();a.hasClass("NB-disabled")||(a=a.parents(".NB-menu-manage").data("feed_id"),NEWSBLUR.log(["statistics feed_id",a]),d.open_feed_statistics_modal(a))});a.targetIs(c,{tagSelector:".NB-menu-manage-feed-reload"},function(a){c.preventDefault();
a.hasClass("NB-disabled")||(a=a.parents(".NB-menu-manage").data("feed_id"),d.force_instafetch_stories(a))});a.targetIs(c,{tagSelector:".NB-menu-manage-delete"},function(a){c.preventDefault();c.stopPropagation();a.hasClass("NB-menu-manage-feed-delete-cancel")||a.hasClass("NB-menu-manage-folder-delete-cancel")?d.hide_confirm_delete_menu_item():d.show_confirm_delete_menu_item()});a.targetIs(c,{tagSelector:".NB-menu-manage-feed-delete-confirm"},function(a){c.preventDefault();var b=a.parents(".NB-menu-manage").data("feed_id"),
a=a.parents(".NB-menu-manage").data("$feed");d.manage_menu_delete_feed(b,a)});a.targetIs(c,{tagSelector:".NB-menu-manage-folder-delete-confirm"},function(a){c.preventDefault();var b=a.parents(".NB-menu-manage").data("folder_name"),a=a.parents(".NB-menu-manage").data("$folder");d.manage_menu_delete_folder(b,a)});a.targetIs(c,{tagSelector:".NB-menu-manage-move"},function(a){c.preventDefault();c.stopPropagation();var b=a.parents(".NB-menu-manage").data("feed_id"),e=a.parents(".NB-menu-manage").data("$feed"),
f=a.parents(".NB-menu-manage").data("folder_name"),p=a.parents(".NB-menu-manage").data("$folder");a.hasClass("NB-menu-manage-feed-move-cancel")||a.hasClass("NB-menu-manage-folder-move-cancel")?d.hide_confirm_move_menu_item():d.show_confirm_move_menu_item(b||f,e||p)});a.targetIs(c,{tagSelector:".NB-menu-manage-folder-move-save"},function(a){c.preventDefault();c.stopPropagation();var b=a.parents(".NB-menu-manage").data("folder_name"),a=a.parents(".NB-menu-manage").data("$folder");d.manage_menu_rename_folder(b,
a)});a.targetIs(c,{tagSelector:".NB-menu-manage-feed-move-save"},function(a){c.preventDefault();c.stopPropagation();var b=a.parents(".NB-menu-manage").data("feed_id"),a=a.parents(".NB-menu-manage").data("$feed");d.manage_menu_move_feed(b,a)});a.targetIs(c,{tagSelector:".NB-menu-manage-feed-move-confirm"},function(){c.preventDefault();c.stopPropagation()});a.targetIs(c,{tagSelector:".NB-menu-manage-folder-move-confirm"},function(){c.preventDefault();c.stopPropagation()});a.targetIs(c,{tagSelector:".NB-menu-manage-rename"},
function(a){c.preventDefault();c.stopPropagation();a.hasClass("NB-menu-manage-feed-rename-cancel")||a.hasClass("NB-menu-manage-folder-rename-cancel")?d.hide_confirm_rename_menu_item():d.show_confirm_rename_menu_item()});a.targetIs(c,{tagSelector:".NB-menu-manage-folder-rename-save"},function(a){c.preventDefault();c.stopPropagation();var b=a.parents(".NB-menu-manage").data("folder_name"),a=a.parents(".NB-menu-manage").data("$folder");d.manage_menu_rename_folder(b,a)});a.targetIs(c,{tagSelector:".NB-menu-manage-feed-rename-save"},
function(a){c.preventDefault();c.stopPropagation();var b=a.parents(".NB-menu-manage").data("feed_id"),a=a.parents(".NB-menu-manage").data("$feed");d.manage_menu_rename_feed(b,a)});a.targetIs(c,{tagSelector:".NB-menu-manage-feed-rename-confirm"},function(){c.preventDefault();c.stopPropagation()});a.targetIs(c,{tagSelector:".NB-menu-manage-folder-rename-confirm"},function(){c.preventDefault();c.stopPropagation()});a.targetIs(c,{tagSelector:".NB-menu-manage-feed-mark-read"},function(a){c.preventDefault();
a=a.parents(".NB-menu-manage").data("feed_id");d.mark_feed_as_read(a)});a.targetIs(c,{tagSelector:".NB-menu-manage-folder-mark-read"},function(a){c.preventDefault();var b=a.parents(".NB-menu-manage").data("folder_name"),a=a.parents(".NB-menu-manage").data("$folder");d.mark_folder_as_read(b,a)});a.targetIs(c,{tagSelector:".NB-menu-manage-site-mark-read"},function(a){c.preventDefault();a.hasClass("NB-disabled")||d.open_mark_read_modal()});a.targetIs(c,{tagSelector:".NB-menu-manage-keyboard"},function(a){c.preventDefault();
a.hasClass("NB-disabled")||d.open_keyboard_shortcuts_modal()});a.targetIs(c,{tagSelector:".NB-menu-manage-feed-exception"},function(a){c.preventDefault();var b=a.parents(".NB-menu-manage").data("feed_id");d.open_feed_exception_modal(b,a)});a.targetIs(c,{tagSelector:".NB-menu-manage-goodies"},function(a){c.preventDefault();a.hasClass("NB-disabled")||d.open_goodies_modal()});a.targetIs(c,{tagSelector:".NB-menu-manage-preferences"},function(a){c.preventDefault();a.hasClass("NB-disabled")||d.open_preferences_modal()});
a.targetIs(c,{tagSelector:".NB-menu-manage-account"},function(a){c.preventDefault();a.hasClass("NB-disabled")||d.open_account_modal()});a.targetIs(c,{tagSelector:".NB-menu-manage-feedchooser"},function(a){c.preventDefault();a.hasClass("NB-disabled")||d.open_feedchooser_modal()});a.targetIs(c,{tagSelector:".NB-module-account-upgrade"},function(a){c.preventDefault();a.hasClass("NB-disabled")||d.open_feedchooser_modal()});a.targetIs(c,{tagSelector:".NB-module-account-train"},function(a){c.preventDefault();
a.hasClass("NB-disabled")||d.open_trainer_modal()});a.targetIs(c,{tagSelector:".NB-module-launch-tutorial"},function(a){c.preventDefault();a.hasClass("NB-disabled")||d.open_tutorial_modal()});a.targetIs(c,{tagSelector:".NB-module-tutorial-hide"},function(a){c.preventDefault();a.hasClass("NB-disabled")||d.hide_tutorial()});a.targetIs(c,{tagSelector:".NB-module-mobile-hide"},function(a){c.preventDefault();a.hasClass("NB-disabled")||d.hide_mobile()});a.targetIs(c,{tagSelector:".NB-menu-manage-story-unread"},
function(a){c.preventDefault();var b=a.closest(".NB-menu-manage").data("feed_id"),a=a.closest(".NB-menu-manage").data("story_id");d.mark_story_as_unread(a,b)});a.targetIs(c,{tagSelector:".task_view_page:not(.NB-task-return)"},function(){c.preventDefault();d.switch_taskbar_view("page")});a.targetIs(c,{tagSelector:".task_view_feed"},function(){c.preventDefault();d.switch_taskbar_view("feed")});a.targetIs(c,{tagSelector:".task_view_story"},function(){c.preventDefault();d.switch_taskbar_view("story")});
a.targetIs(c,{tagSelector:".NB-task-return"},function(){c.preventDefault();d.load_feed_iframe()});a.targetIs(c,{tagSelector:".task_button_story.task_story_next_unread"},function(){c.preventDefault();d.open_next_unread_story_across_feeds()});a.targetIs(c,{tagSelector:".task_button_story.task_story_next"},function(){c.preventDefault();d.show_next_story(1)});a.targetIs(c,{tagSelector:".task_button_story.task_story_previous"},function(){c.preventDefault();d.show_previous_story()});a.targetIs(c,{tagSelector:".task_button_signup"},
function(){c.preventDefault();d.show_splash_page()});a.targetIs(c,{tagSelector:".NB-feeds-header-sites"},function(){c.preventDefault();e=!0;d.switch_preferences_hide_read_feeds()});e||(a.targetIs(c,{tagSelector:".NB-feeds-header-dashboard"},function(){c.preventDefault();d.show_splash_page()}),a.targetIs(c,{tagSelector:".NB-recommended-statistics"},function(b){c.preventDefault();var e=b.closest(".NB-recommended").attr("data-feed-id");a(".NB-module-recommended").addClass("NB-loading");d.model.load_canonical_feed(e,
function(){a(".NB-module-recommended").removeClass("NB-loading");d.open_feed_statistics_modal(e)})}),a.targetIs(c,{tagSelector:".NB-recommended-intelligence"},function(b){c.preventDefault();var e=b.closest(".NB-recommended").attr("data-feed-id");a(".NB-module-recommended").addClass("NB-loading");d.model.load_canonical_feed(e,function(){a(".NB-module-recommended").removeClass("NB-loading");d.open_feed_intelligence_modal(1,e)})}),a.targetIs(c,{tagSelector:".NB-recommended-try"},function(a){c.preventDefault();
a=a.closest(".NB-recommended").attr("data-feed-id");d.load_feed_in_tryfeed_view(a)}),a.targetIs(c,{tagSelector:".NB-recommended-add"},function(b){c.preventDefault();var e=b.closest(".NB-recommended").attr("data-feed-id");a(".NB-module-recommended").addClass("NB-loading");d.model.load_canonical_feed(e,function(){a(".NB-module-recommended").removeClass("NB-loading");d.add_recommended_feed(e)})}),a.targetIs(c,{tagSelector:".NB-recommended-decline"},function(a){c.preventDefault();a=a.closest(".NB-recommended").attr("data-feed-id");
d.decline_feed_in_moderation_queue(a)}),a.targetIs(c,{tagSelector:".NB-recommended-approve"},function(a){c.preventDefault();a=a.closest(".NB-recommended").attr("data-feed-id");d.approve_feed_in_moderation_queue(a)}),a.targetIs(c,{tagSelector:".NB-module-recommended .NB-module-next-page"},function(a){c.preventDefault();a.hasClass("NB-disabled")||(console.log(["parent",a.closest(".NB-module-recommended"),a.closest(".NB-module-recommended").hasClass("NB-recommended-unmoderated")]),a=a.closest(".NB-module-recommended").hasClass("NB-recommended-unmoderated"),
d.load_recommended_feed(1,!1,a))}),a.targetIs(c,{tagSelector:".NB-module-recommended .NB-module-previous-page"},function(a){c.preventDefault();if(!a.hasClass("NB-disabled")){var b=a.closest(".NB-module-recommended").hasClass("NB-recommended-unmoderated");console.log(["parent",a.closest(".NB-module-recommended")]);d.load_recommended_feed(-1,!1,b)}}),a.targetIs(c,{tagSelector:".NB-tryfeed-add"},function(){c.preventDefault();d.add_recommended_feed(d.active_feed)}),a.targetIs(c,{tagSelector:"#mouse-indicator"},
function(){c.preventDefault();d.lock_mouse_indicator()}),a.targetIs(c,{tagSelector:".NB-progress-close"},function(){c.preventDefault();d.hide_unfetched_feed_progress(!0)}),a.targetIs(c,{tagSelector:".NB-module-next-page",childOf:".NB-module-features"},function(){c.preventDefault();d.load_feature_page(1)}),a.targetIs(c,{tagSelector:".NB-module-previous-page",childOf:".NB-module-features"},function(){c.preventDefault();d.load_feature_page(-1)}),a.targetIs(c,{tagSelector:".NB-module-next-page",childOf:".NB-module-howitworks"},
function(){c.preventDefault();var b=a(".NB-howitworks-page.NB-active").prevAll(".NB-howitworks-page").length;d.load_howitworks_page(b+1)}),a.targetIs(c,{tagSelector:".NB-module-previous-page",childOf:".NB-module-howitworks"},function(){c.preventDefault();var b=a(".NB-howitworks-page.NB-active").prevAll(".NB-howitworks-page").length;d.load_howitworks_page(b-1)}),a.targetIs(c,{tagSelector:".NB-module-page-indicator",childOf:".NB-module-howitworks"},function(a){c.preventDefault();a=a.prevAll(".NB-module-page-indicator").length;
d.load_howitworks_page(a)}),a.targetIs(c,{tagSelector:".NB-splash-meta-about"},function(){c.preventDefault();NEWSBLUR.about=new NEWSBLUR.About}),a.targetIs(c,{tagSelector:".NB-splash-meta-faq"},function(){c.preventDefault();NEWSBLUR.faq=new NEWSBLUR.Faq}))}},handle_dblclicks:function(b,c){var d=this,e=!1;a.targetIs(c,{tagSelector:"#feed_list .NB-feedlist-manage-icon"},function(){c.preventDefault();c.stopPropagation();e=!0});e||(a.targetIs(c,{tagSelector:"#feed_list .feed.NB-feed-exception"},function(){c.preventDefault();
c.stopPropagation();exception=!0}),e||(a.targetIs(c,{tagSelector:"#story_titles .story"},function(b){c.preventDefault();c.stopPropagation();b=a(".story_id",b).text();b=d.model.get_story(b);d.open_story_in_story_view(b,!0)}),a.targetIs(c,{tagSelector:"#feed_list .feed"},function(a){c.preventDefault();c.stopPropagation();var b=parseInt(a.attr("data-id"),10);d.open_feed_link(b,a)})))},handle_rightclicks:function(b,c){var d=this;a.targetIs(c,{tagSelector:".feed",childOf:"#feed_list"},function(a){c.preventDefault();
d.show_manage_menu("feed",a)});a.targetIs(c,{tagSelector:".folder_title",childOf:"#feed_list"},function(a){c.preventDefault();d.show_manage_menu("folder",a.closest("li.folder"))});a.targetIs(c,{tagSelector:".story",childOf:"#story_titles"},function(a){c.preventDefault();d.show_manage_menu("story",a)});a.targetIs(c,{tagSelector:".NB-feed-story-header",childOf:"#story_pane"},function(a){c.preventDefault();d.show_manage_menu("story",a.closest(".NB-feed-story"))});a.targetIs(c,{tagSelector:".NB-menu-manage"},
function(){c.preventDefault()});a.targetIs(c,{tagSelector:".NB-menu-manage-arrow"},function(){c.preventDefault()})},handle_scroll_story_titles:function(){this.check_story_titles_last_story()},handle_scroll_feed_iframe:function(){if(this.story_view=="page"&&!this.flags.page_view_showing_feed_view&&!this.flags.scrolling_by_selecting_story_title){var b=this.cache.mouse_position_y+this.$s.$feed_iframe.contents().scrollTop(),c=this.cache.iframe_story_positions_keys,d=a.closest(b,c);this.navigate_story_titles_to_story(this.cache.iframe_story_positions[c[d]]);
if(!this.flags.iframe_scroll_snap_back_prepared)this.iframe_scroll=b-this.cache.mouse_position_y;this.flags.iframe_scroll_snap_back_prepared=!1}},handle_mousemove_iframe_view:function(b,c){var d=this;this.show_mouse_indicator();if(!parseInt(this.model.preference("lock_mouse_indicator"),10)){var e=this.$s.$feed_iframe.contents().scrollTop();this.cache.mouse_position_y=c.pageY-e;this.$s.$mouse_indicator.css("top",this.cache.mouse_position_y-8);setTimeout(function(){d.flags.mousemove_timeout=!1},40);
if(!this.flags.mousemove_timeout&&!this.flags.scrolling_by_selecting_story_title){var f=this.cache.iframe_story_positions_keys,e=a.closest(this.cache.mouse_position_y+e,f),f=this.cache.iframe_story_positions[f[e]];this.flags.mousemove_timeout=!0;this.navigate_story_titles_to_story(f)}}},handle_mousemove_feed_view:function(b,c){var d=this;if(this.model.preference("feed_view_single_story"))return this.hide_mouse_indicator();else this.show_mouse_indicator();if(!parseInt(this.model.preference("lock_mouse_indicator"),
10)){this.cache.mouse_position_y=c.pageY;if(this.cache.story_pane_position==null)this.cache.story_pane_position=this.$s.$feed_stories.offsetParent().offset().top;this.$s.$mouse_indicator.css("top",this.cache.mouse_position_y-this.cache.story_pane_position-8);if(!this.flags.mousemove_timeout&&(setTimeout(function(){d.flags.mousemove_timeout=!1},40),!this.flags.mousemove_timeout&&!this.flags.switching_to_feed_view&&!this.flags.scrolling_by_selecting_story_title&&this.story_view!="story")){var e=this.cache.story_pane_position,
f=this.cache.mouse_position_y+this.$s.$feed_stories.scrollTop()-e,e=this.cache.feed_view_story_positions_keys,f=a.closest(f,e),e=this.cache.feed_view_story_positions[e[f]];this.flags.mousemove_timeout=!0;e!=this.active_story&&this.navigate_story_titles_to_story(e)}}},handle_scroll_feed_view:function(){if((this.story_view=="feed"||this.story_view=="page"&&this.flags.page_view_showing_feed_view)&&!this.flags.switching_to_feed_view&&!this.flags.scrolling_by_selecting_story_title&&!this.model.preference("feed_view_single_story")){var b=
this.cache.mouse_position_y+this.$s.$feed_stories.scrollTop(),c=this.cache.feed_view_story_positions_keys,b=a.closest(b-this.cache.story_pane_position,c),c=this.cache.feed_view_story_positions[c[b]];this.navigate_story_titles_to_story(c)}if(this.flags.river_view&&!this.model.preference("feed_view_single_story"))this.flags.scrolling_by_selecting_story_title?c=this.active_story:(b=Math.max(1,this.$s.$feed_stories.scrollTop()),c=this.cache.feed_view_story_positions_keys,b=a.closest(b,c),c=this.cache.feed_view_story_positions[c[b]]),
this.show_correct_feed_in_feed_title_floater(c)},handle_keystrokes:function(){var b=this,c=a(document);NEWSBLUR.hotkeys.initialize();c.bind("keydown","?",function(a){a.preventDefault();b.open_keyboard_shortcuts_modal()});c.bind("keydown","shift+/",function(a){a.preventDefault();b.open_keyboard_shortcuts_modal()});c.bind("keydown","down",function(a){a.preventDefault();b.show_next_story(1)});c.bind("keydown","up",function(a){a.preventDefault();b.show_next_story(-1)});c.bind("keydown","j",function(a){a.preventDefault();
b.show_next_story(1)});c.bind("keydown","k",function(a){a.preventDefault();b.show_next_story(-1)});c.bind("keydown","shift+j",function(a){a.preventDefault();b.show_next_feed(1)});c.bind("keydown","shift+k",function(a){a.preventDefault();b.show_next_feed(-1)});c.bind("keydown","shift+down",function(a){a.preventDefault();b.show_next_feed(1)});c.bind("keydown","shift+up",function(a){a.preventDefault();b.show_next_feed(-1)});c.bind("keydown","left",function(a){a.preventDefault();b.switch_taskbar_view_direction(-1)});
c.bind("keydown","right",function(a){a.preventDefault();b.switch_taskbar_view_direction(1)});c.bind("keydown","h",function(a){a.preventDefault();b.switch_taskbar_view_direction(-1)});c.bind("keydown","l",function(a){a.preventDefault();b.switch_taskbar_view_direction(1)});c.bind("keydown","r",function(a){a.preventDefault();b.open_river_stories()});c.bind("keydown","enter",function(a){a.preventDefault();b.open_story_in_story_view(null,!0)});c.bind("keydown","return",function(a){a.preventDefault();b.open_story_in_story_view(null,
!0)});c.bind("keydown","space",function(a){a.preventDefault();b.page_in_story(0.4,1)});c.bind("keydown","shift+space",function(a){a.preventDefault();b.page_in_story(0.6,-1)});c.bind("keydown","u",function(a){a.preventDefault();b.flags.sidebar_closed?b.open_sidebar():b.close_sidebar()});c.bind("keydown","n",function(a){a.preventDefault();b.open_next_unread_story_across_feeds()});c.bind("keydown","m",function(a){a.preventDefault();b.show_last_unread_story()});c.bind("keydown","b",function(a){a.preventDefault();
b.show_previous_story()});c.bind("keydown","s",function(a){a.preventDefault();if(b.active_story){var a=b.active_story.id,c=b.find_story_in_story_titles(a);c.hasClass("NB-story-starred")?b.mark_story_as_unstarred(a,c):b.mark_story_as_starred(a,c)}});c.bind("keypress","+",function(a){a.preventDefault();b.move_intelligence_slider(1)});c.bind("keypress","-",function(a){a.preventDefault();b.move_intelligence_slider(-1)});c.bind("keypress","d",function(a){a.preventDefault();b.show_splash_page()});c.bind("keypress",
"t",function(a){a.preventDefault();b.open_story_trainer()});c.bind("keypress","f",function(a){a.preventDefault();b.open_feed_intelligence_modal(1)});c.bind("keypress","o",function(a){a.preventDefault();b.open_story_in_new_tab()});c.bind("keydown","shift+a",function(a){a.preventDefault();b.flags.river_view?b.mark_folder_as_read():b.mark_feed_as_read()});c.bind("keydown","shift+e",function(a){a.preventDefault();b.open_river_stories()})}}})(jQuery);
NEWSBLUR.generate_bookmarklet=function(){return $.make("a",{className:"NB-goodies-bookmarklet-button",href:"javascript:function newsblur_bookmarklet() { var d=document,z=d.createElement('scr'+'ipt'),b=d.body,l=d.location; try{ if(!b) { throw(0); } d.title = '(Adding...) ' + d.title; z.setAttribute('src',l.protocol+'//"+NEWSBLUR.URLs.domain+"/api/add_site_load_script/"+NEWSBLUR.Globals.secret_token+"?url='+encodeURIComponent(l.href)+'&time='+(new Date().getTime())); b.appendChild(z); } catch(e) {alert('Please wait until the page has loaded.');}}newsblur_bookmarklet();void(0)"},
"Subscribe in NewsBlur")};NEWSBLUR.Modal=function(a){this.options=$.extend({},{},a);this.model=NEWSBLUR.AssetModel.reader();this.runner()};
NEWSBLUR.Modal.prototype={runner:function(){},open_modal:function(){var a=this;this.$modal.modal({minWidth:600,maxWidth:600,overlayClose:!0,onOpen:function(b){b.overlay.fadeIn(200,function(){b.container.fadeIn(200);b.data.fadeIn(200,function(){if(a.options.onOpen)a.options.onOpen()});setTimeout(function(){$(window).resize()})})},onShow:function(){$("#simplemodal-container").corner("6px");if(a.options.onShow)a.options.onShow()},onClose:function(a,c){a.data.hide().empty().remove();a.container.hide().empty().remove();
a.overlay.fadeOut(200,function(){a.overlay.empty().remove();$.modal.close(c)});$(".NB-modal-holder").empty().remove()}})},resize:function(){$(window).trigger("resize.simplemodal")},close:function(a){$(".NB-modal-loading",this.$modal).removeClass("NB-active");$.modal.close(a)}};
NEWSBLUR.ReaderClassifierTrainer=function(a){this.flags={publisher:!0,story:!1,modal_loading:!1,modal_loaded:!1};this.cache={};this.trainer_iterator=-1;this.feed_id=null;this.options=$.extend({},{training:!0},a);this.model=NEWSBLUR.AssetModel.reader();this.runner_trainer()};
NEWSBLUR.ReaderClassifierFeed=function(a,b){this.flags={publisher:!0,story:!1,modal_loading:!1,modal_loaded:!1};this.cache={};this.feed_id=a;this.trainer_iterator=-1;this.options=$.extend({},{training:!1,feed_loaded:!0},b);this.model=NEWSBLUR.AssetModel.reader();this.runner_feed()};
NEWSBLUR.ReaderClassifierStory=function(a,b,c){this.flags={publisher:!1,story:!0,modal_loading:!1,modal_loaded:!1};this.cache={};this.story_id=a;this.feed_id=b;this.trainer_iterator=-1;this.options=$.extend({},{feed_loaded:!0},c);this.model=NEWSBLUR.AssetModel.reader();this.runner_story()};
var classifier_prototype={runner_trainer:function(a){if(!a)this.user_classifiers={};this.make_trainer_intro();this.get_feeds_trainer();this.handle_cancel();this.open_modal();this.$modal.parent().bind("click.reader_classifer",$.rescope(this.handle_clicks,this))},runner_feed:function(){this.model.classifiers[this.feed_id]||(this.model.classifiers[this.feed_id]=_.extend({},this.model.defaults.classifiers));this.user_classifiers=this.options.feed_loaded?this.model.classifiers[this.feed_id]:{};this.find_story_and_feed();
this.make_modal_feed();this.make_modal_title();this.handle_cancel();this.open_modal();this.$modal.parent().bind("click.reader_classifer",$.rescope(this.handle_clicks,this));this.options.feed_loaded||_.defer(_.bind(function(){this.load_single_feed_trainer()},this))},runner_story:function(){this.model.classifiers[this.feed_id]||(this.model.classifiers[this.feed_id]=_.extend({},this.model.defaults.classifiers));this.user_classifiers=this.options.feed_loaded?this.model.classifiers[this.feed_id]:{};this.find_story_and_feed();
this.make_modal_story();this.handle_text_highlight();this.make_modal_title();this.handle_cancel();this.open_modal();this.$modal.parent().bind("click.reader_classifer",$.rescope(this.handle_clicks,this));this.options.feed_loaded||_.defer(_.bind(function(){this.load_single_feed_trainer()},this))},load_previous_feed_in_trainer:function(){this.trainer_iterator-=1;var a=this.trainer_data[this.trainer_iterator];!a||this.trainer_iterator<0?(this.make_trainer_intro(),this.reload_modal()):(this.feed_id=a.feed_id,
this.load_feed(a))},load_next_feed_in_trainer:function(){var a=this.trainer_data.length;this.trainer_iterator+=1;var b=this.trainer_data[this.trainer_iterator];!b||this.trainer_iterator>=a?(this.make_trainer_outro(),this.reload_modal(),this.load_feeds_trainer(null,this.trainer_data)):(this.feed_id=b.feed_id,this.load_feed(b))},load_feed:function(a){this.feed_id=a.feed_id;this.feed=this.model.get_feed(this.feed_id);this.feed_tags=a.feed_tags;this.feed_authors=a.feed_authors;this.user_classifiers=a.classifiers;
this.feed.num_subscribers=a.num_subscribers;this.options.feed_loaded=!0;this.model.classifiers[this.feed_id]||(this.model.classifiers[this.feed_id]=_.extend({},this.model.defaults.classifiers));this.feed_id in this.cache?this.$modal=this.cache[this.feed_id]:(this.flags.story?(this.make_modal_story(),this.handle_text_highlight()):this.flags.publisher&&(this.make_modal_feed(),this.make_modal_trainer_count()),this.make_modal_title());this.reload_modal()},reload_modal:function(a){this.flags.modal_loading=
setInterval(_.bind(function(){if(this.flags.modal_loaded)clearInterval(this.flags.modal_loading),$(".NB-modal").empty().append(this.$modal.children()),this.$modal=$(".NB-modal"),$(window).trigger("resize.simplemodal"),this.handle_cancel(),this.$modal.parent().scrollTop(0),a&&a()},this),125)},get_feeds_trainer:function(){this.model.get_feeds_trainer(null,$.rescope(this.load_feeds_trainer,this))},load_feeds_trainer:function(a,b){var c=$(".NB-modal-submit-begin",this.$modal);this.trainer_data=b;!b||
!b.length?(this.make_trainer_outro(),this.reload_modal()):c.text("Begin Training").addClass("NB-modal-submit-green").removeClass("NB-modal-submit-close").removeClass("NB-disabled")},retrain_all_sites:function(){$(".NB-modal-submit-reset",this.$modal).text("Rewinding...").attr("disabled",!0).addClass("NB-disabled");this.model.retrain_all_sites(_.bind(function(a){this.load_feeds_trainer(null,a);this.load_next_feed_in_trainer()},this))},find_story_and_feed:function(){if(this.story_id)this.story=this.model.get_story(this.story_id);
this.feed=this.model.get_feed(this.feed_id);if(this.options.feed_loaded&&this.feed)this.feed_tags=this.model.get_feed_tags(),this.feed_authors=this.model.get_feed_authors(),$(".NB-modal-subtitle .NB-modal-feed-image",this.$modal).attr("src",$.favicon(this.feed.favicon)),$(".NB-modal-subtitle .NB-modal-feed-title",this.$modal).html(this.feed.feed_title),$(".NB-modal-subtitle .NB-modal-feed-subscribers",this.$modal).html(Inflector.commas(this.feed.num_subscribers*4852)+" subscribers")},load_single_feed_trainer:function(){var a=
this;$(".NB-modal-loading",this.$modal).addClass("NB-active");this.model.get_feeds_trainer(this.feed_id,function(b){(a.trainer_data=b)&&b.length&&a.load_feed(b[0])})},make_trainer_intro:function(){this.$modal=$.make("div",{className:"NB-modal-classifiers NB-modal NB-modal-trainer"},[$.make("h2",{className:"NB-modal-title"},"Intelligence Trainer"),$.make("h3",{className:"NB-modal-subtitle"},"Here's what to do:"),$.make("ol",{className:"NB-trainer-points"},[$.make("li",[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+
"/img/reader/sample_classifier_tag.png",style:"float: right;margin-top: 4px;",width:155,height:17}),$.make("b","You will see a bunch of tags and authors.")," Sites will be ordered by popularity. Click on what you like and don't like."]),$.make("li",[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/intelligence_slider_all.png",style:"float: right",width:127,height:92}),$.make("b","The intelligence slider filters stories."),$.make("img",{className:"NB-trainer-bullet",src:NEWSBLUR.Globals.MEDIA_URL+
"/img/icons/silk/bullet_green.png"})," are stories you like",$.make("br"),$.make("img",{className:"NB-trainer-bullet",src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/bullet_yellow.png"})," are stories you have not yet rated",$.make("br"),$.make("img",{className:"NB-trainer-bullet",src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/bullet_red.png"})," are stories you don't like"]),$.make("li",[$.make("b","Stop any time you like.")," You can always come back to this trainer."]),$.make("li",[$.make("b",
"Don't worry if you don't know what you like right now.")," Just skip the site. You can train directly in the Feed view."])]),!NEWSBLUR.Globals.is_authenticated&&$.make("div",{className:"NB-trainer-not-authenticated"},"Please create an account and add sites you read. Then you can train them."),$.make("div",{className:"NB-modal-submit"},[!NEWSBLUR.Globals.is_authenticated&&$.make("a",{href:"#",className:"NB-modal-submit-close NB-modal-submit-button"},"Close"),NEWSBLUR.Globals.is_authenticated&&$.make("a",
{href:"#",className:"NB-modal-submit-begin NB-modal-submit-button NB-modal-submit-close NB-disabled"},"Loading Training...")])])},make_trainer_outro:function(){this.$modal=$.make("div",{className:"NB-modal-classifiers NB-modal NB-modal-trainer"},[$.make("h2",{className:"NB-modal-title"},"Congratulations! You're done."),$.make("h3",{className:"NB-modal-subtitle"},"Here's what happens next:"),$.make("ol",{className:"NB-trainer-points"},[$.make("li",[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/sample_classifier_tag.png",
style:"float: right",width:135,height:20}),$.make("b","You can change your opinions.")," You can click the ",$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/thumbs_up.png",style:"vertical-align: middle;padding: 0 8px 0 2px",width:14,height:20}),$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/thumbs_down.png",style:"vertical-align: top; padding: 0",width:14,height:20})," buttons next to stories as you read them."]),$.make("li",[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/intelligence_slider_positive.png",
style:"float: right",width:114,height:29}),$.make("b","As a reminder, use the intelligence slider to select a filter:"),$.make("img",{className:"NB-trainer-bullet",src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/bullet_red.png"})," are stories you don't like",$.make("br"),$.make("img",{className:"NB-trainer-bullet",src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/bullet_yellow.png"})," are stories you have not yet rated",$.make("br"),$.make("img",{className:"NB-trainer-bullet",src:NEWSBLUR.Globals.MEDIA_URL+
"/img/icons/silk/bullet_green.png"})," are stories you like"]),$.make("li",[$.make("b","You can also filter out stories you don't want to read.")," As great as finding good stuff is, you can just as easily ignore the stories you do not like."])]),$.make("div",{className:"NB-modal-submit"},[$.make("a",{href:"#",className:"NB-modal-submit-button NB-modal-submit-reset"},$.entity("&laquo;")+" Retrain all sites"),$.make("a",{href:"#",className:"NB-modal-submit-end NB-modal-submit-button"},"Close Training and Start Reading")])])},
make_modal_feed:function(){var a=this.feed;this.$modal=$.make("div",{className:"NB-modal-classifiers NB-modal "+(this.options.training&&"NB-modal-trainer")},[$.make("div",{className:"NB-modal-loading"}),$.make("h2",{className:"NB-modal-title"},""),$.make("h2",{className:"NB-modal-subtitle"},[this.options.training&&$.make("div",{className:"NB-classifier-trainer-counts"}),$.make("img",{className:"NB-modal-feed-image feed_favicon",src:$.favicon(this.feed.favicon)}),$.make("div",{className:"NB-modal-feed-heading"},
[$.make("span",{className:"NB-modal-feed-title"},this.feed.feed_title),$.make("span",{className:"NB-modal-feed-subscribers"},Inflector.commas(this.feed.num_subscribers)+Inflector.pluralize(" subscriber",this.feed.num_subscribers))])]),this.options.feed_loaded&&$.make("form",{method:"post",className:"NB-publisher"},[!_.isEmpty(this.user_classifiers.titles)&&$.make("div",{className:"NB-modal-field NB-fieldset NB-classifiers"},[$.make("h5","Titles and Phrases"),$.make("div",{className:"NB-classifier-titles NB-fieldset-fields NB-classifiers"},
this.make_user_titles())]),this.feed_authors.length&&$.make("div",{className:"NB-modal-field NB-fieldset NB-classifiers"},[$.make("h5","Authors"),$.make("div",{className:"NB-classifier-authors NB-fieldset-fields NB-classifiers"},this.make_authors(this.feed_authors).concat(this.make_user_authors()))]),this.feed_tags.length&&$.make("div",{className:"NB-modal-field NB-fieldset NB-classifiers"},[$.make("h5","Categories &amp; Tags"),$.make("div",{className:"NB-classifier-tags NB-fieldset-fields NB-classifiers"},
this.make_tags(this.feed_tags).concat(this.make_user_tags()))]),$.make("div",{className:"NB-modal-field NB-fieldset NB-classifiers"},[$.make("h5","Everything by This Publisher"),$.make("div",{className:"NB-fieldset-fields NB-classifiers"},this.make_publisher(a))]),this.options.training&&$.make("div",{className:"NB-modal-submit"},[$.make("input",{name:"feed_id",value:this.feed_id,type:"hidden"}),$.make("a",{href:"#",className:"NB-modal-submit-button NB-modal-submit-back"},$.entity("&laquo;")+" Back"),
$.make("a",{href:"#",className:"NB-modal-submit-button NB-modal-submit-green NB-modal-submit-next NB-modal-submit-save"},"Save & Next "+$.entity("&raquo;")),$.make("a",{href:"#",className:"NB-modal-submit-button NB-modal-submit-close"},"Close")]),!this.options.training&&$.make("div",{className:"NB-modal-submit"},[$.make("input",{name:"story_id",value:this.story_id,type:"hidden"}),$.make("input",{name:"feed_id",value:this.feed_id,type:"hidden"}),$.make("input",{type:"submit",disabled:"true",className:"NB-modal-submit-save NB-modal-submit-green NB-disabled",
value:"Check what you like above..."})," or ",$.make("a",{href:"#",className:"NB-modal-cancel"},"cancel")])])])},make_modal_story:function(){var a=this.story,b=this.feed;a.story_title=$("<div/>").html(a.story_title).text();this.$modal=$.make("div",{className:"NB-modal-classifiers NB-modal"},[$.make("h2",{className:"NB-modal-title"}),this.options.feed_loaded&&$.make("form",{method:"post"},[a.story_title&&$.make("div",{className:"NB-modal-field NB-fieldset"},[$.make("h5","Story Title"),$.make("div",
{className:"NB-fieldset-fields NB-classifiers"},[$.make("input",{type:"text",value:a.story_title,className:"NB-classifier-title-highlight"}),this.make_classifier('<span class="NB-classifier-title-placeholder">Highlight phrases to look for in future stories</span>',"","title"),$.make("span",this.make_user_titles(a.story_title))])]),a.story_authors&&$.make("div",{className:"NB-modal-field NB-fieldset"},[$.make("h5","Story Author"),$.make("div",{className:"NB-fieldset-fields NB-classifiers"},this.make_authors([a.story_authors]))]),
a.story_tags.length&&$.make("div",{className:"NB-modal-field NB-fieldset"},[$.make("h5","Story Categories &amp; Tags"),$.make("div",{className:"NB-classifier-tags NB-fieldset-fields NB-classifiers"},this.make_tags(a.story_tags))]),$.make("div",{className:"NB-modal-field NB-fieldset"},[$.make("h5","Everything by This Publisher"),$.make("div",{className:"NB-fieldset-fields NB-classifiers"},this.make_publisher(b))]),$.make("div",{className:"NB-modal-submit"},[$.make("input",{name:"story_id",value:this.story_id,
type:"hidden"}),$.make("input",{name:"feed_id",value:this.feed_id,type:"hidden"}),$.make("input",{type:"submit",disabled:"true",className:"NB-modal-submit-save NB-modal-submit-green NB-disabled",value:"Check what you like above..."})," or ",$.make("a",{href:"#",className:"NB-modal-cancel"},"cancel")])])])},make_modal_title:function(){var a=$(".NB-modal-title",this.$modal),b=$.make("div",["What do you ",$.make("b",{className:"NB-classifier-title-like"},"like")," and ",$.make("b",{className:"NB-classifier-title-dislike"},
"dislike")," about this ",this.flags.publisher&&"site",this.flags.story&&"story","?"]);a.html(b)},make_modal_trainer_count:function(){var a=this.trainer_iterator+1,b=this.trainer_data.length;$(".NB-classifier-trainer-counts",this.$modal).html(a+"/"+b)},make_user_titles:function(a){var b=[],c=_.keys(this.user_classifiers.titles);_.each(c,_.bind(function(c){if(!a||a.indexOf(c)!=-1)c=this.make_classifier(c,c,"title"),b.push(c)},this));return b},make_authors:function(a){var b=[],c;for(c in a){var d=a[c];
if(typeof d=="string")var e=d,f;else e=d[0],f=d[1];e&&(d=this.make_classifier(e,e,"author",f),b.push(d))}return b},make_user_authors:function(){var a=_.keys(this.user_classifiers.authors),b=_.map(this.feed_authors,function(a){return a[0]});return this.make_authors(_.reduce(a,function(a,d){return!_.contains(b,d)?a.concat(d):a},[]))},make_tags:function(a){var b=[],c;for(c in a){var d=a[c];if(typeof d=="string")var e=d,f;else e=d[0],f=d[1];e&&(d=this.make_classifier(e,e,"tag",f),b.push(d))}return b},
make_user_tags:function(){var a=_.keys(this.user_classifiers.tags),b=_.map(this.feed_tags,function(a){return a[0]});return this.make_tags(_.reduce(a,function(a,d){return!_.contains(b,d)?a.concat(d):a},[]))},make_publisher:function(a){return this.make_classifier(a.feed_title,this.feed_id,"feed")},make_classifier:function(a,b,c,d){var e=0;b in this.user_classifiers[c+"s"]&&(e=this.user_classifiers[c+"s"][b]);var f=Inflector.capitalize(c=="feed"?"publisher":c),g=$.make("span",{className:"NB-classifier-container"},
[$.make("span",{className:"NB-classifier NB-classifier-"+c},[$.make("input",{type:"checkbox",className:"NB-classifier-input-like",name:"like_"+c,value:b}),$.make("input",{type:"checkbox",className:"NB-classifier-input-dislike",name:"dislike_"+c,value:b}),$.make("div",{className:"NB-classifier-icon-like"}),$.make("div",{className:"NB-classifier-icon-dislike"},[$.make("div",{className:"NB-classifier-icon-dislike-inner"})]),$.make("label",[c=="feed"&&$.make("img",{className:"feed_favicon",src:$.favicon(this.feed.favicon)}),
$.make("b",f+": "),$.make("span",a)])]),d&&$.make("span",{className:"NB-classifier-count"},["&times;&nbsp;",d])]);e>0?($(".NB-classifier",g).addClass("NB-classifier-like"),$(".NB-classifier-input-like",g).attr("checked",!0)):e<0&&($(".NB-classifier",g).addClass("NB-classifier-dislike"),$(".NB-classifier-input-dislike",g).attr("checked",!0));$(".NB-classifier",g).bind("mouseenter",function(a){$(a.currentTarget).addClass("NB-classifier-hover-like")}).bind("mouseleave",function(a){$(a.currentTarget).removeClass("NB-classifier-hover-like")});
$(".NB-classifier-icon-dislike",g).bind("mouseenter",function(){$(".NB-classifier",g).addClass("NB-classifier-hover-dislike")}).bind("mouseleave",function(){$(".NB-classifier",g).removeClass("NB-classifier-hover-dislike")});return g},change_classifier:function(a,b){var c=$(".NB-classifier-input-like",a),d=$(".NB-classifier-input-dislike",a),e=$(".NB-modal-submit-save",this.$modal),f=$(".NB-modal-submit-close",this.$modal);$(".NB-modal-submit-back",this.$modal);b=="like"?a.is(".NB-classifier-like")?
(a.removeClass("NB-classifier-like"),d.attr("checked",!1),c.attr("checked",!1)):(a.removeClass("NB-classifier-dislike"),a.addClass("NB-classifier-like"),d.attr("checked",!1),c.attr("checked",!0)):b=="dislike"&&(a.is(".NB-classifier-dislike")?(a.removeClass("NB-classifier-dislike"),c.attr("checked",!1),d.attr("checked",!1)):(a.removeClass("NB-classifier-like"),a.addClass("NB-classifier-dislike"),c.attr("checked",!1),d.attr("checked",!0)));this.options.training?f.val("Save & Close"):e.removeClass("NB-disabled").removeAttr("disabled").attr("value",
"Save")},open_modal:function(){var a=this;this.$modal.modal({minWidth:600,maxWidth:600,overlayClose:!0,autoResize:!0,position:[this.options.training?40:0,0],onOpen:function(b){b.overlay.fadeIn(200,function(){b.container.fadeIn(200);b.data.fadeIn(200);setTimeout(function(){a.flags.modal_loaded=!0;$(window).trigger("resize.simplemodal")})})},onShow:function(){$("#simplemodal-container").corner("6px");$(".NB-classifier",a.$modal).corner("14px")},onClose:function(a){a.data.hide().empty().remove();a.container.hide().empty().remove();
a.overlay.fadeOut(200,function(){a.overlay.empty().remove();$.modal.close()});$(".NB-modal-holder").empty().remove()}})},update_homepage_counts:function(){$(".NB-module-account-trainer-count").text(_.size(this.model.get_feeds())-(this.trainer_data.length-this.trainer_iterator)-1)},end:function(){_.defer(function(){$(".NB-module-account-trainer").animate({opacity:0},{duration:1E3,complete:function(){$(".NB-module-account-trainer").slideUp(350)}})},1E3);$.modal.close()},handle_text_highlight:function(){var a=
this,b=$(".NB-classifier-title-highlight",this.$modal),c=$(".NB-classifier-title-placeholder",this.$modal),d=c.parents(".NB-classifier").eq(0),e=$(".NB-classifier-input-like, .NB-classifier-input-dislike",d),f=function(){var b=$.trim($(this).getSelection().text);b.length&&c.text()!=b&&(c.text(b),e.val(b),d.is(".NB-classifier-like,.NB-classifier-dislike")||a.change_classifier(d,"like"))};b.keydown(f).keyup(f).mousedown(f).mouseup(f).mousemove(f);e.val(b.val());c.parents(".NB-classifier").bind("click",
function(){b.val()==e.val()&&c.text(b.val())})},handle_cancel:function(){$(".NB-modal-cancel",this.$modal).click(function(a){a.preventDefault();$.modal.close()})},handle_clicks:function(a,b){var c=this;this.options.training?($.targetIs(b,{tagSelector:".NB-modal-submit-begin"},function(){b.preventDefault();c.load_next_feed_in_trainer()}),$.targetIs(b,{tagSelector:".NB-modal-submit-save.NB-modal-submit-next"},function(){b.preventDefault();c.save(!0);c.load_next_feed_in_trainer();c.update_homepage_counts()}),
$.targetIs(b,{tagSelector:".NB-modal-submit-back"},function(){b.preventDefault();c.load_previous_feed_in_trainer()}),$.targetIs(b,{tagSelector:".NB-modal-submit-reset"},function(){b.preventDefault();c.retrain_all_sites()}),$.targetIs(b,{tagSelector:".NB-modal-submit-close"},function(){b.preventDefault();c.save()}),$.targetIs(b,{tagSelector:".NB-modal-submit-end"},function(){b.preventDefault();NEWSBLUR.reader.force_feed_refresh();c.end()})):$.targetIs(b,{tagSelector:".NB-modal-submit-save:not(.NB-modal-submit-next)"},
function(){b.preventDefault();c.save();return!1});var d=!1;$.targetIs(b,{tagSelector:".NB-classifier-icon-dislike"},function(a){b.preventDefault();d=!0;c.change_classifier(a.closest(".NB-classifier"),"dislike")});d||$.targetIs(b,{tagSelector:".NB-classifier"},function(a){b.preventDefault();c.change_classifier(a,"like")})},serialize_classifier:function(){var a={};$(".NB-classifier",this.$modal).each(function(){var b=$(".NB-classifier-input-like",this).val(),c=$(".NB-classifier-input-like, .NB-classifier-input-dislike",
this).is(":checked")?$("input:checked",this).attr("name"):"remove_"+$(".NB-classifier-input-like",this).attr("name");a[c]||(a[c]=[]);a[c].push(b)});a.feed_id=this.feed_id;if(this.story_id)a.story_id=this.story_id;return a},save:function(a){var b=$(".NB-modal-submit-save",this.$modal),c=this.serialize_classifier(),d=this.feed_id;this.options.training?(this.cache[this.feed_id]=this.$modal.clone(),b.text("Saving...")):b.val("Saving...");b.addClass("NB-disabled").attr("disabled",!0);this.update_opinions();
this.model.save_classifier(c,function(){a||(NEWSBLUR.reader.recalculate_story_scores(d),NEWSBLUR.reader.force_feeds_refresh(null,!0),$.modal.close())})},update_opinions:function(){var a=this,b=this.feed_id;$("input[type=checkbox]",this.$modal).each(function(){var c=$(this),d=c.attr("name").replace(/^(dis)?like_/,""),e=/^dislike/.test(c.attr("name"))?-1:1,f=c.val();c.attr("checked")?d=="tag"?a.model.classifiers[b].tags[f]=e:d=="title"?a.model.classifiers[b].titles[f]=e:d=="author"?a.model.classifiers[b].authors[f]=
e:d=="feed"&&(a.model.classifiers[b].feeds[b]=e):d=="tag"&&a.model.classifiers[b].tags[f]==e?delete a.model.classifiers[b].tags[f]:d=="title"&&a.model.classifiers[b].titles[f]==e?delete a.model.classifiers[b].titles[f]:d=="author"&&a.model.classifiers[b].authors[f]==e?delete a.model.classifiers[b].authors[f]:d=="feed"&&a.model.classifiers[b].feeds[b]==e&&delete a.model.classifiers[b].feeds[b]})}};NEWSBLUR.ReaderClassifierStory.prototype=classifier_prototype;
NEWSBLUR.ReaderClassifierFeed.prototype=classifier_prototype;NEWSBLUR.ReaderClassifierTrainer.prototype=classifier_prototype;NEWSBLUR.ReaderAddFeed=function(a){this.options=$.extend({},{},a);this.model=NEWSBLUR.AssetModel.reader();this.runner()};
NEWSBLUR.ReaderAddFeed.prototype={runner:function(){this.make_modal();this.handle_cancel();this.open_modal();this.handle_keystrokes();this.setup_autocomplete();this.focus_add_feed();this.$modal.bind("click",$.rescope(this.handle_click,this))},make_modal:function(){var a=this;this.$modal=$.make("div",{className:"NB-add NB-modal"},[$.make("h2",{className:"NB-modal-title"},"Add sites and folders"),$.make("div",{className:"NB-add-form"},[$.make("div",{className:"NB-fieldset NB-add-add-url NB-modal-submit"},
[$.make("h5",[$.make("div",{className:"NB-add-folders"},NEWSBLUR.utils.make_folders(this.model)),"Add a new site"]),$.make("div",{className:"NB-fieldset-fields"},[$.make("div",[$.make("div",{className:"NB-loading"}),$.make("label",{"for":"NB-add-url"},"Website or RSS: "),$.make("input",{type:"text",id:"NB-add-url",className:"NB-input NB-add-url",name:"url",value:a.options.url}),$.make("input",{type:"submit",value:"Add site",className:"NB-modal-submit-green NB-add-url-submit"}),$.make("div",{className:"NB-error"})])])]),
$.make("div",{className:"NB-fieldset NB-add-add-folder NB-modal-submit"},[$.make("h5",[$.make("div",{className:"NB-add-folders"},NEWSBLUR.utils.make_folders(this.model)),"Add a new folder"]),$.make("div",{className:"NB-fieldset-fields"},[$.make("div",[$.make("div",{className:"NB-loading"}),$.make("label",{"for":"NB-add-folder"},[$.make("div",{className:"NB-folder-icon"})]),$.make("input",{type:"text",id:"NB-add-folder",className:"NB-input NB-add-folder",name:"url"}),$.make("input",{type:"submit",
value:"Add folder",className:"NB-add-folder-submit NB-modal-submit-green"}),$.make("div",{className:"NB-error"})])])]),$.make("div",{className:"NB-fieldset NB-anonymous-ok NB-modal-submit"},[$.make("h5",["Import feeds"]),$.make("div",{className:"NB-fieldset-fields"},[$.make("a",{href:NEWSBLUR.URLs["google-reader-authorize"],className:"NB-google-reader-oauth NB-modal-submit-green NB-modal-submit-button"},["Import from Google Reader",$.make("img",{className:"NB-add-google-reader-arrow",src:NEWSBLUR.Globals.MEDIA_URL+
"img/icons/silk/arrow_right.png"})]),$.make("div",{className:"NB-add-danger"},NEWSBLUR.Globals.is_authenticated&&_.size(this.model.feeds)&&[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"img/icons/silk/server_go.png"}),"This will erase all existing feeds and folders."])])]),$.make("div",{className:"NB-fieldset NB-add-opml NB-modal-submit"},[$.make("h5",["Upload OPML",$.make("a",{className:"NB-right NB-splash-link",href:NEWSBLUR.URLs["opml-export"]},"Export OPML")]),$.make("div",{className:"NB-fieldset-fields"},
[$.make("form",{method:"post",enctype:"multipart/form-data",className:"NB-add-form"},[$.make("div",{className:"NB-loading"}),$.make("input",{type:"file",name:"file",id:"opml_file_input"}),$.make("input",{type:"submit",className:"NB-add-opml-button NB-modal-submit-green",value:"Upload OPML File"}).click(function(b){b.preventDefault();a.handle_opml_upload();return!1})]),$.make("div",{className:"NB-add-danger"},NEWSBLUR.Globals.is_authenticated&&_.size(this.model.feeds)&&[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+
"img/icons/silk/server_go.png"}),"This will erase all existing feeds and folders."]),$.make("div",{className:"NB-error"})])])])]);NEWSBLUR.Globals.is_anonymous&&this.$modal.addClass("NB-signed-out")},open_modal:function(){var a=this;this.$modal.modal({minWidth:600,maxWidth:600,overlayClose:!0,autoResize:!0,onOpen:function(b){b.overlay.fadeIn(200,function(){b.container.fadeIn(200);b.data.fadeIn(200,function(){a.focus_add_feed()})})},onShow:function(){$("#simplemodal-container").corner("6px")},onClose:function(a){a.data.hide().empty().remove();
a.container.hide().empty().remove();a.overlay.fadeOut(200,function(){a.overlay.empty().remove();$.modal.close()});$(".NB-modal-holder").empty().remove()}})},handle_cancel:function(){$(".NB-modal-cancel",this.$modal).click(function(a){a.preventDefault();$.modal.close()})},focus_add_feed:function(){var a=$(".NB-add-url",this.$modal);NEWSBLUR.Globals.is_anonymous||_.delay(function(){a.focus()},200)},setup_autocomplete:function(){var a=this,b=$(".NB-add-url",this.$modal);b.autocomplete({minLength:1,source:"/rss_feeds/feed_autocomplete",
focus:function(a,d){b.val(d.item.value);return!1},select:function(c,d){b.val(d.item.value);a.save_add_url();return!1}}).data("autocomplete")._renderItem=function(a,b){return $.make("li",[$.make("a",[$.make("div",{className:"NB-add-autocomplete-subscribers"},b.num_subscribers+Inflector.pluralize(" subscriber",b.num_subscribers)),$.make("div",{className:"NB-add-autocomplete-title"},b.label),$.make("div",{className:"NB-add-autocomplete-address"},b.value)])]).data("item.autocomplete",b).appendTo(a)}},
handle_keystrokes:function(){var a=this;$(".NB-add-url",this.$modal).bind("keyup","return",function(b){b.preventDefault();a.save_add_url()});$(".NB-add-folder",this.$modal).bind("keyup","return",function(b){b.preventDefault();a.save_add_folder()})},handle_opml_upload:function(){var a=$(".NB-fieldset.NB-add-opml .NB-loading");a.addClass("NB-active");if(NEWSBLUR.Globals.is_anonymous){var b=$(".NB-error",".NB-fieldset.NB-add-opml");b.text("Please create an account. Not much to do without an account.");
b.slideDown(300);a.removeClass("NB-active");return!1}$.ajaxFileUpload({url:NEWSBLUR.URLs["opml-upload"],secureuri:!1,fileElementId:"opml_file_input",dataType:"text",success:function(){a.removeClass("NB-active");NEWSBLUR.reader.load_feeds();NEWSBLUR.reader.load_recommended_feed();$.modal.close()},error:function(b,d,e){a.removeClass("NB-active");NEWSBLUR.log(["Error",b,d,e])}});return!1},handle_click:function(a,b){var c=this;$.targetIs(b,{tagSelector:".NB-add-url-submit"},function(){b.preventDefault();
c.save_add_url()});$.targetIs(b,{tagSelector:".NB-add-folder-submit"},function(){b.preventDefault();c.save_add_folder()})},save_add_url:function(){var a=$(".NB-add-add-url input[type=submit]",this.$modal),b=$(".NB-error",".NB-fieldset.NB-add-add-url"),c=$(".NB-loading",".NB-fieldset.NB-add-add-url"),d=$(".NB-add-url").val(),e=$(".NB-add-url").parents(".NB-fieldset").find(".NB-folders").val();b.slideUp(300);c.addClass("NB-active");a.addClass("NB-disabled").val("Adding...");this.model.save_add_url(d,
e,$.rescope(this.post_save_add_url,this))},post_save_add_url:function(a,b){NEWSBLUR.log(["Data",b]);var c=$(".NB-add-add-url input[type=submit]",this.$modal);$(".NB-loading",".NB-fieldset.NB-add-add-url").removeClass("NB-active");c.removeClass("NB-disabled");if(b.code>0)NEWSBLUR.reader.load_feeds(),NEWSBLUR.reader.load_recommended_feed(),NEWSBLUR.reader.handle_mouse_indicator_hover(),$.modal.close(),c.val("Added!");else{var d=$(".NB-error",".NB-fieldset.NB-add-add-url");d.text(b.message);d.slideDown(300);
c.val("Add Site")}},save_add_folder:function(){var a=$(".NB-add-add-folder input[type=submit]",this.$modal),b=$(".NB-error",".NB-fieldset.NB-add-add-folder"),c=$(".NB-loading",".NB-fieldset.NB-add-add-folder"),d=$(".NB-add-folder").val(),e=$(".NB-add-folder").parents(".NB-fieldset").find(".NB-folders").val();b.slideUp(300);c.addClass("NB-active");a.addClass("NB-disabled").val("Adding...");this.model.save_add_folder(d,e,$.rescope(this.post_save_add_folder,this))},post_save_add_folder:function(a,b){var c=
$(".NB-add-add-folder input[type=submit]",this.$modal);$(".NB-loading",".NB-fieldset.NB-add-add-folder").removeClass("NB-active");c.removeClass("NB-disabled");if(b.code>0)NEWSBLUR.reader.load_feeds(),_.defer(function(){NEWSBLUR.reader.open_add_feed_modal()}),c.val("Added!");else{var d=$(".NB-error",".NB-fieldset.NB-add-add-folder");d.text(b.message);d.slideDown(300);c.val("Add Folder")}}};
NEWSBLUR.ReaderMarkRead=function(a){this.options=$.extend({},{days:1},a);this.model=NEWSBLUR.AssetModel.reader();this.runner()};
NEWSBLUR.ReaderMarkRead.prototype={runner:function(){this.make_modal();this.load_slider();this.generate_explanation(this.options.days);this.handle_cancel();this.open_modal();this.$modal.bind("click",$.rescope(this.handle_click,this))},make_modal:function(){var a=this;this.$modal=$.make("div",{className:"NB-modal-markread NB-modal"},[$.make("h2",{className:"NB-modal-title"},"Mark old stories as read"),$.make("form",{className:"NB-markread-form"},[$.make("div",{className:"NB-markread-slider"}),$.make("div",
{className:"NB-markread-explanation"}),$.make("div",{className:"NB-modal-submit"},[$.make("input",{type:"submit",className:"NB-modal-submit-save NB-modal-submit-green",value:"Do it"})," or ",$.make("a",{href:"#",className:"NB-modal-cancel"},"cancel")])]).bind("submit",function(b){b.preventDefault();a.save_mark_read();return!1})])},open_modal:function(){this.$modal.modal({minWidth:600,maxWidth:600,overlayClose:!0,onOpen:function(a){a.overlay.fadeIn(200,function(){a.container.fadeIn(200);a.data.fadeIn(200)})},
onShow:function(){$("#simplemodal-container").corner("6px")},onClose:function(a){a.data.hide().empty().remove();a.container.hide().empty().remove();a.overlay.fadeOut(200,function(){a.overlay.empty().remove();$.modal.close()});$(".NB-modal-holder").empty().remove()}})},load_slider:function(){var a=this;$(".NB-markread-slider",this.$modal).slider({range:"min",min:0,max:7,step:1,value:this.options.days,slide:function(b,c){var d=c.value;a.update_dayofweek(d);a.generate_explanation(d)},stop:function(){}})},
update_dayofweek:function(){},generate_explanation:function(a){var b=$(".NB-markread-explanation",this.$modal),c;a==0?c="Mark <b>every story</b> as read.":a>=1&&(c="Mark all stories older than <b>"+a+" day"+(a==1?"":"s")+" old</b> as read.");b.html(c)},save_mark_read:function(){var a=$(".NB-modal input[type=submit]"),b=$(".NB-markread-slider",this.$modal).slider("option","value");a.attr("value","Marking as read...").addClass("NB-disabled").attr("disabled",!0);NEWSBLUR.Globals.is_authenticated?this.model.save_mark_read(b,
function(){NEWSBLUR.reader.start_count_unreads_after_import();$.modal.close();NEWSBLUR.reader.force_feeds_refresh(function(){NEWSBLUR.reader.finish_count_unreads_after_import()},!0)}):$.modal.close()},handle_click:function(a,b){$.targetIs(b,{tagSelector:".NB-add-url-submit"},function(){b.preventDefault()})},handle_cancel:function(){$(".NB-modal-cancel",this.$modal).click(function(a){a.preventDefault();$.modal.close()})}};
NEWSBLUR.ReaderGoodies=function(a){this.options=$.extend({},{},a);this.model=NEWSBLUR.AssetModel.reader();this.runner()};
NEWSBLUR.ReaderGoodies.prototype={runner:function(){this.make_modal();this.open_modal();this.$modal.bind("click",$.rescope(this.handle_click,this))},make_modal:function(){this.$modal=$.make("div",{className:"NB-modal-goodies NB-modal"},[$.make("h2",{className:"NB-modal-title"},"Goodies &amp; Extras"),$.make("div",{className:"NB-goodies-group"},[NEWSBLUR.generate_bookmarklet(),$.make("div",{className:"NB-goodies-title"},"Add Site Bookmarklet")]),$.make("div",{className:"NB-goodies-group NB-modal-submit"},
[$.make("a",{className:"NB-goodies-firefox-link NB-modal-submit-button NB-modal-submit-green",href:"#"},"Add to Firefox"),$.make("div",{className:"NB-goodies-firefox"}),$.make("div",{className:"NB-goodies-title"},"Firefox: Register Newsblur as an RSS reader")]),$.make("div",{className:"NB-goodies-group NB-modal-submit"},[$.make("a",{className:"NB-goodies-chrome-link NB-modal-submit-button NB-modal-submit-green",href:"#"},"Add to Chrome"),$.make("div",{className:"NB-goodies-chrome"}),$.make("div",
{className:"NB-goodies-title"},"Google Chome: NewsBlur Chrome Web App")]),$.make("div",{className:"NB-goodies-group NB-modal-submit"},[$.make("a",{className:"NB-goodies-safari-link NB-modal-submit-button NB-modal-submit-green",href:"#"},"Add to Safari"),$.make("div",{className:"NB-goodies-safari"}),$.make("div",{className:"NB-goodies-title"},"Safari: Register Newsblur as an RSS reader"),$.make("div",{className:"NB-goodies-subtitle"},["To use this extension, extract and move the NewsBlur Safari Helper.app ",
"to your Applications folder. Then in ",$.make("b","Safari > Settings > RSS")," choose the new NewsBlur Safari Helper.app. Then clicking on the RSS button in ","Safari will open the feed in NewsBlur. Simple!"])]),$.make("div",{className:"NB-goodies-group NB-modal-submit"},[$.make("input",{className:"NB-goodies-custom-input",value:"http://www.newsblur.com/?url=BLOG_URL_GOES_HERE"}),$.make("div",{className:"NB-goodies-custom"}),$.make("div",{className:"NB-goodies-title"},"Custom Add Site URL")]),$.make("div",
{className:"NB-goodies-group NB-modal-submit"},[$.make("a",{className:"NB-goodies-mobile-link NB-modal-submit-button NB-modal-submit-green",href:"mailto:samuel@ofbrooklyn.com?subject=iPhone Beta! Yeah!&body=My username is: "+NEWSBLUR.Globals.username+", and my iTunes/iPhone UUID is: [http://www.ispeeddial.com/how-to-find-your-iphone-uuid/]"},"Request Beta"),$.make("div",{className:"NB-goodies-iphone"}),$.make("div",{className:"NB-goodies-title"},"Official NewsBlur iPhone App")]),$.make("div",{className:"NB-goodies-group NB-modal-submit"},
[$.make("a",{className:"NB-goodies-mobile-link NB-modal-submit-button NB-modal-submit-green",href:"https://market.android.com/details?id=bitwrit.Blar"},"View in Android Market"),$.make("div",{className:"NB-goodies-android"}),$.make("div",{className:"NB-goodies-title"},"Blar: User-Created Android App")])])},open_modal:function(){this.$modal.modal({minWidth:600,maxWidth:600,overlayClose:!0,onOpen:function(a){a.overlay.fadeIn(200,function(){a.container.fadeIn(200);a.data.fadeIn(200);setTimeout(function(){$(window).resize()})})},
onShow:function(){$("#simplemodal-container").corner("6px")},onClose:function(a){a.data.hide().empty().remove();a.container.hide().empty().remove();a.overlay.fadeOut(200,function(){a.overlay.empty().remove();$.modal.close()});$(".NB-modal-holder").empty().remove()}})},handle_click:function(a,b){$.targetIs(b,{tagSelector:".NB-goodies-bookmarklet-button"},function(){b.preventDefault();alert("Drag this button to your bookmark toolbar.")});$.targetIs(b,{tagSelector:".NB-goodies-firefox-link"},function(){b.preventDefault();
navigator.registerContentHandler("application/vnd.mozilla.maybe.feed",document.location+"?url=%s","NewsBlur")});$.targetIs(b,{tagSelector:".NB-goodies-safari-link"},function(){b.preventDefault();window.location.href=NEWSBLUR.Globals.MEDIA_URL+"extensions/NewsBlur Safari Helper.app.zip"});$.targetIs(b,{tagSelector:".NB-goodies-chrome-link"},function(){b.preventDefault();window.location.href="https://chrome.google.com/webstore/detail/gchdledhagjbhhodjjhiclbnaioljomj"});$.targetIs(b,{tagSelector:".NB-goodies-custom-input"},
function(a){b.preventDefault();a.select()})}};NEWSBLUR.ReaderPreferences=function(a){this.options=$.extend({},{},a);this.model=NEWSBLUR.AssetModel.reader();this.runner()};NEWSBLUR.ReaderPreferences.prototype=new NEWSBLUR.Modal;NEWSBLUR.ReaderPreferences.prototype.constructor=NEWSBLUR.ReaderPreferences;
_.extend(NEWSBLUR.ReaderPreferences.prototype,{runner:function(){this.options.onOpen=_.bind(function(){this.resize_modal()},this);this.make_modal();this.select_preferences();this.handle_change();this.open_modal();this.original_preferences=this.serialize_preferences();this.$modal.bind("click",$.rescope(this.handle_click,this))},make_modal:function(){var a=this;this.$modal=$.make("div",{className:"NB-modal-preferences NB-modal"},[$.make("a",{href:"#preferences",className:"NB-link-account-preferences NB-splash-link"},
"Switch to Account"),$.make("h2",{className:"NB-modal-title"},"Preferences"),$.make("form",{className:"NB-preferences-form"},[$.make("div",{className:"NB-preferences-scroll"},[$.make("div",{className:"NB-preference"},[$.make("div",{className:"NB-preference-options"},[$.make("div",[$.make("select",{id:"NB-preference-timezone-1",name:"timezone"},[$.make("option",{value:"Pacific/Midway"},"(GMT-11:00) Midway Island, Samoa"),$.make("option",{value:"America/Adak"},"(GMT-10:00) Hawaii-Aleutian"),$.make("option",
{value:"Etc/GMT+10"},"(GMT-10:00) Hawaii"),$.make("option",{value:"Pacific/Marquesas"},"(GMT-09:30) Marquesas Islands"),$.make("option",{value:"Pacific/Gambier"},"(GMT-09:00) Gambier Islands"),$.make("option",{value:"America/Anchorage"},"(GMT-09:00) Alaska"),$.make("option",{value:"America/Ensenada"},"(GMT-08:00) Tijuana, Baja California"),$.make("option",{value:"Etc/GMT+8"},"(GMT-08:00) Pitcairn Islands"),$.make("option",{value:"America/Los_Angeles"},"(GMT-08:00) Pacific Time (US & Canada)"),$.make("option",
{value:"America/Denver"},"(GMT-07:00) Mountain Time (US & Canada)"),$.make("option",{value:"America/Chihuahua"},"(GMT-07:00) Chihuahua, La Paz, Mazatlan"),$.make("option",{value:"America/Dawson_Creek"},"(GMT-07:00) Arizona"),$.make("option",{value:"America/Belize"},"(GMT-06:00) Saskatchewan, Central America"),$.make("option",{value:"America/Cancun"},"(GMT-06:00) Guadalajara, Mexico City"),$.make("option",{value:"Chile/EasterIsland"},"(GMT-06:00) Easter Island"),$.make("option",{value:"America/Chicago"},
"(GMT-06:00) Central Time (US & Canada)"),$.make("option",{value:"America/New_York"},"(GMT-05:00) Eastern Time (US & Canada)"),$.make("option",{value:"America/Havana"},"(GMT-05:00) Cuba"),$.make("option",{value:"America/Bogota"},"(GMT-05:00) Bogota, Lima, Quito, Rio Branco"),$.make("option",{value:"America/Caracas"},"(GMT-04:30) Caracas"),$.make("option",{value:"America/Santiago"},"(GMT-04:00) Santiago"),$.make("option",{value:"America/La_Paz"},"(GMT-04:00) La Paz"),$.make("option",{value:"Atlantic/Stanley"},
"(GMT-04:00) Faukland Islands"),$.make("option",{value:"America/Campo_Grande"},"(GMT-04:00) Brazil"),$.make("option",{value:"America/Goose_Bay"},"(GMT-04:00) Atlantic Time (Goose Bay)"),$.make("option",{value:"America/Glace_Bay"},"(GMT-04:00) Atlantic Time (Canada)"),$.make("option",{value:"America/St_Johns"},"(GMT-03:30) Newfoundland"),$.make("option",{value:"America/Araguaina"},"(GMT-03:00) UTC-3"),$.make("option",{value:"America/Montevideo"},"(GMT-03:00) Montevideo"),$.make("option",{value:"America/Miquelon"},
"(GMT-03:00) Miquelon, St. Pierre"),$.make("option",{value:"America/Godthab"},"(GMT-03:00) Greenland"),$.make("option",{value:"America/Argentina/Buenos_Aires"},"(GMT-03:00) Buenos Aires"),$.make("option",{value:"America/Sao_Paulo"},"(GMT-03:00) Brasilia"),$.make("option",{value:"America/Noronha"},"(GMT-02:00) Mid-Atlantic"),$.make("option",{value:"Atlantic/Cape_Verde"},"(GMT-01:00) Cape Verde Is."),$.make("option",{value:"Atlantic/Azores"},"(GMT-01:00) Azores"),$.make("option",{value:"Europe/Belfast"},
"(GMT) Greenwich Mean Time : Belfast"),$.make("option",{value:"Europe/Dublin"},"(GMT) Greenwich Mean Time : Dublin"),$.make("option",{value:"Europe/Lisbon"},"(GMT) Greenwich Mean Time : Lisbon"),$.make("option",{value:"Europe/London"},"(GMT) Greenwich Mean Time : London"),$.make("option",{value:"Africa/Abidjan"},"(GMT) Monrovia, Reykjavik"),$.make("option",{value:"Europe/Amsterdam"},"(GMT+01:00) Amsterdam, Berlin, Stockholm"),$.make("option",{value:"Europe/Belgrade"},"(GMT+01:00) Belgrade, Budapest, Prague"),
$.make("option",{value:"Europe/Brussels"},"(GMT+01:00) Brussels, Copenhagen, Paris"),$.make("option",{value:"Africa/Algiers"},"(GMT+01:00) West Central Africa"),$.make("option",{value:"Africa/Windhoek"},"(GMT+01:00) Windhoek"),$.make("option",{value:"Asia/Beirut"},"(GMT+02:00) Beirut"),$.make("option",{value:"Africa/Cairo"},"(GMT+02:00) Cairo"),$.make("option",{value:"Asia/Gaza"},"(GMT+02:00) Gaza"),$.make("option",{value:"Africa/Blantyre"},"(GMT+02:00) Harare, Pretoria"),$.make("option",{value:"Asia/Jerusalem"},
"(GMT+02:00) Jerusalem"),$.make("option",{value:"Europe/Minsk"},"(GMT+02:00) Minsk"),$.make("option",{value:"Asia/Damascus"},"(GMT+02:00) Syria"),$.make("option",{value:"Europe/Moscow"},"(GMT+03:00) Moscow, St. Petersburg"),$.make("option",{value:"Africa/Addis_Ababa"},"(GMT+03:00) Nairobi"),$.make("option",{value:"Asia/Tehran"},"(GMT+03:30) Tehran"),$.make("option",{value:"Asia/Dubai"},"(GMT+04:00) Abu Dhabi, Muscat"),$.make("option",{value:"Asia/Yerevan"},"(GMT+04:00) Yerevan"),$.make("option",{value:"Asia/Kabul"},
"(GMT+04:30) Kabul"),$.make("option",{value:"Asia/Yekaterinburg"},"(GMT+05:00) Ekaterinburg"),$.make("option",{value:"Asia/Tashkent"},"(GMT+05:00) Tashkent"),$.make("option",{value:"Asia/Kolkata"},"(GMT+05:30) Chennai, Mumbai, New Delhi"),$.make("option",{value:"Asia/Katmandu"},"(GMT+05:45) Kathmandu"),$.make("option",{value:"Asia/Dhaka"},"(GMT+06:00) Astana, Dhaka"),$.make("option",{value:"Asia/Novosibirsk"},"(GMT+06:00) Novosibirsk"),$.make("option",{value:"Asia/Rangoon"},"(GMT+06:30) Yangon (Rangoon)"),
$.make("option",{value:"Asia/Bangkok"},"(GMT+07:00) Bangkok, Hanoi, Jakarta"),$.make("option",{value:"Asia/Krasnoyarsk"},"(GMT+07:00) Krasnoyarsk"),$.make("option",{value:"Asia/Hong_Kong"},"(GMT+08:00) Beijing, Chongqing, Hong Kong"),$.make("option",{value:"Asia/Irkutsk"},"(GMT+08:00) Irkutsk, Ulaan Bataar"),$.make("option",{value:"Australia/Perth"},"(GMT+08:00) Perth"),$.make("option",{value:"Australia/Eucla"},"(GMT+08:45) Eucla"),$.make("option",{value:"Asia/Tokyo"},"(GMT+09:00) Osaka, Sapporo, Tokyo"),
$.make("option",{value:"Asia/Seoul"},"(GMT+09:00) Seoul"),$.make("option",{value:"Asia/Yakutsk"},"(GMT+09:00) Yakutsk"),$.make("option",{value:"Australia/Adelaide"},"(GMT+09:30) Adelaide"),$.make("option",{value:"Australia/Darwin"},"(GMT+09:30) Darwin"),$.make("option",{value:"Australia/Brisbane"},"(GMT+10:00) Brisbane"),$.make("option",{value:"Australia/Sydney"},"(GMT+10:00) Sydney, Hobart"),$.make("option",{value:"Asia/Vladivostok"},"(GMT+10:00) Vladivostok"),$.make("option",{value:"Australia/Lord_Howe"},
"(GMT+10:30) Lord Howe Island"),$.make("option",{value:"Etc/GMT-11"},"(GMT+11:00) Solomon Is., New Caledonia"),$.make("option",{value:"Asia/Magadan"},"(GMT+11:00) Magadan"),$.make("option",{value:"Pacific/Norfolk"},"(GMT+11:30) Norfolk Island"),$.make("option",{value:"Asia/Anadyr"},"(GMT+12:00) Anadyr, Kamchatka"),$.make("option",{value:"Pacific/Auckland"},"(GMT+12:00) Auckland, Wellington"),$.make("option",{value:"Etc/GMT-12"},"(GMT+12:00) Fiji, Kamchatka, Marshall Is."),$.make("option",{value:"Pacific/Chatham"},
"(GMT+12:45) Chatham Islands"),$.make("option",{value:"Pacific/Tongatapu"},"(GMT+13:00) Nuku'alofa"),$.make("option",{value:"Pacific/Kiritimati"},"(GMT+14:00) Kiritimati")])])]),$.make("div",{className:"NB-preference-label"},["Timezone"])]),$.make("div",{className:"NB-preference NB-preference-view"},[$.make("div",{className:"NB-preference-options"},[$.make("div",[$.make("input",{id:"NB-preference-view-1",type:"radio",name:"default_view",value:"page"}),$.make("label",{"for":"NB-preference-view-1"},
[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/preferences_view_original.png"})])]),$.make("div",[$.make("input",{id:"NB-preference-view-2",type:"radio",name:"default_view",value:"feed"}),$.make("label",{"for":"NB-preference-view-2"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/preferences_view_feed.png"})])]),$.make("div",[$.make("input",{id:"NB-preference-view-3",type:"radio",name:"default_view",value:"story"}),$.make("label",{"for":"NB-preference-view-3"},[$.make("img",
{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/preferences_view_story.png"})])])]),$.make("div",{className:"NB-preference-label"},["Default view",$.make("div",{className:"NB-preference-sublabel"},"You can override this on a per-site basis.")])]),$.make("div",{className:"NB-preference NB-preference-story-pane-position"},[$.make("div",{className:"NB-preference-options"},[$.make("div",[$.make("input",{id:"NB-preference-story-pane-position-1",type:"radio",name:"story_pane_anchor",value:"north"}),$.make("label",
{"for":"NB-preference-story-pane-position-1"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/layout_top.png"}),"Top"])]),$.make("div",[$.make("input",{id:"NB-preference-story-pane-position-2",type:"radio",name:"story_pane_anchor",value:"west"}),$.make("label",{"for":"NB-preference-story-pane-position-2"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/layout_left.png"}),"Left"])]),$.make("div",[$.make("input",{id:"NB-preference-story-pane-position-3",type:"radio",name:"story_pane_anchor",
value:"south"}),$.make("label",{"for":"NB-preference-story-pane-position-3"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/layout_bottom.png"}),"Bottom"])])]),$.make("div",{className:"NB-preference-label"},["Story titles pane"])]),$.make("div",{className:"NB-preference NB-preference-window"},[$.make("div",{className:"NB-preference-options"},[$.make("div",[$.make("input",{id:"NB-preference-window-1",type:"radio",name:"new_window",value:0}),$.make("label",{"for":"NB-preference-window-1"},
[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/application_view_gallery.png"}),"In this window"])]),$.make("div",[$.make("input",{id:"NB-preference-window-2",type:"radio",name:"new_window",value:1}),$.make("label",{"for":"NB-preference-window-2"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/application_side_expand.png"}),"In a new window"])])]),$.make("div",{className:"NB-preference-label"},["Open links"])]),$.make("div",{className:"NB-preference NB-preference-hidereadfeeds"},
[$.make("div",{className:"NB-preference-options"},[$.make("div",[$.make("input",{id:"NB-preference-hidereadfeeds-1",type:"radio",name:"hide_read_feeds",value:0}),$.make("label",{"for":"NB-preference-hidereadfeeds-1"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/text_list_bullets.png"}),"Show everything"])]),$.make("div",[$.make("input",{id:"NB-preference-hidereadfeeds-2",type:"radio",name:"hide_read_feeds",value:1}),$.make("label",{"for":"NB-preference-hidereadfeeds-2"},[$.make("img",
{src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/text_list_bullets_single.png"}),"Hide sites with no unread stories"])])]),$.make("div",{className:"NB-preference-label"},["Site sidebar",$.make("div",{className:"NB-preference-sublabel"},this.make_site_sidebar_count())])]),$.make("div",{className:"NB-preference NB-preference-feedorder"},[$.make("div",{className:"NB-preference-options"},[$.make("div",[$.make("input",{id:"NB-preference-feedorder-1",type:"radio",name:"feed_order",value:"ALPHABETICAL"}),
$.make("label",{"for":"NB-preference-feedorder-1"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/pilcrow.png"}),"Alphabetical"])]),$.make("div",[$.make("input",{id:"NB-preference-feedorder-2",type:"radio",name:"feed_order",value:"MOSTUSED"}),$.make("label",{"for":"NB-preference-feedorder-2"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/report_user.png"}),"Most used at top, then alphabetical"])])]),$.make("div",{className:"NB-preference-label"},["Site sidebar order"])]),
$.make("div",{className:"NB-preference NB-preference-hidestorychanges"},[$.make("div",{className:"NB-preference-options"},[$.make("div",[$.make("input",{id:"NB-preference-hidestorychanges-1",type:"radio",name:"hide_story_changes",value:0}),$.make("label",{"for":"NB-preference-hidestorychanges-1"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/code_icon.png"}),"Show ",$.make("del","changes")," ",$.make("ins","revisions")," in stories"])]),$.make("div",[$.make("input",{id:"NB-preference-hidestorychanges-2",
type:"radio",name:"hide_story_changes",value:1}),$.make("label",{"for":"NB-preference-hidestorychanges-2"},["Hide changes and only show the final story"])])]),$.make("div",{className:"NB-preference-label"},["Story changes"])]),$.make("div",{className:"NB-preference NB-preference-singlestory"},[$.make("div",{className:"NB-preference-options"},[$.make("div",[$.make("input",{id:"NB-preference-singlestory-1",type:"radio",name:"feed_view_single_story",value:0}),$.make("label",{"for":"NB-preference-singlestory-1"},
[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/text_linespacing.png"}),"Show all stories"])]),$.make("div",[$.make("input",{id:"NB-preference-singlestory-2",type:"radio",name:"feed_view_single_story",value:1}),$.make("label",{"for":"NB-preference-singlestory-2"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/text_horizontalrule.png"}),"Show a single story at a time"])])]),$.make("div",{className:"NB-preference-label"},["Feed view"])]),$.make("div",{className:"NB-preference NB-preference-animations"},
[$.make("div",{className:"NB-preference-options"},[$.make("div",[$.make("input",{id:"NB-preference-animations-1",type:"radio",name:"animations",value:"true"}),$.make("label",{"for":"NB-preference-animations-1"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/arrow_in.png"}),"Show all animations"])]),$.make("div",[$.make("input",{id:"NB-preference-animations-2",type:"radio",name:"animations",value:"false"}),$.make("label",{"for":"NB-preference-animations-2"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+
"/img/icons/silk/arrow_right.png"}),"Jump immediately with no animations"])])]),$.make("div",{className:"NB-preference-label"},["Animations"])]),$.make("div",{className:"NB-preference NB-preference-folder-counts"},[$.make("div",{className:"NB-preference-options"},[$.make("div",[$.make("input",{id:"NB-preference-folder-counts-1",type:"radio",name:"folder_counts",value:"false"}),$.make("label",{"for":"NB-preference-folder-counts-1"},["Only show counts on collapsed folders"])]),$.make("div",[$.make("input",
{id:"NB-preference-folder-counts-2",type:"radio",name:"folder_counts",value:"true"}),$.make("label",{"for":"NB-preference-folder-counts-2"},["Always show unread counts on folders"])])]),$.make("div",{className:"NB-preference-label"},["Folder unread counts"])]),$.make("div",{className:"NB-preference NB-preference-story-styling"},[$.make("div",{className:"NB-preference-options"},[$.make("div",[$.make("input",{id:"NB-preference-story-styling-1",type:"radio",name:"story_styling",value:"sans-serif"}),
$.make("label",{"for":"NB-preference-story-styling-1",className:"NB-preference-story-styling-sans-serif"},"Lucida Grande, sans serif")]),$.make("div",[$.make("input",{id:"NB-preference-story-styling-2",type:"radio",name:"story_styling",value:"serif"}),$.make("label",{"for":"NB-preference-story-styling-2",className:"NB-preference-story-styling-serif"},"Georgia, serif")])]),$.make("div",{className:"NB-preference-label"},["Feed view styling"])]),$.make("div",{className:"NB-preference NB-preference-tooltips"},
[$.make("div",{className:"NB-preference-options"},[$.make("div",[$.make("input",{id:"NB-preference-tooltips-1",type:"radio",name:"show_tooltips",value:1}),$.make("label",{"for":"NB-preference-tooltips-1"},["Show tooltips"])]),$.make("div",[$.make("input",{id:"NB-preference-tooltips-2",type:"radio",name:"show_tooltips",value:0}),$.make("label",{"for":"NB-preference-tooltips-2"},["Don't bother showing tooltips"])])]),$.make("div",{className:"NB-preference-label"},["Tooltips",$.make("div",{className:"tipsy tipsy-n"},
[$.make("div",{className:"tipsy-arrow"}),$.make("div",{className:"tipsy-inner"},"Tooltips like this")]).css({display:"block",top:24,left:-5})])]),$.make("div",{className:"NB-preference NB-preference-story-share"},[$.make("div",{className:"NB-preference-options"},[$.make("div",{className:"NB-preference-option",title:"Twitter"},[$.make("input",{type:"checkbox",id:"NB-preference-story-share-twitter",name:"story_share_twitter"}),$.make("label",{"for":"NB-preference-story-share-twitter"})]),$.make("div",
{className:"NB-preference-option",title:"Facebook"},[$.make("input",{type:"checkbox",id:"NB-preference-story-share-facebook",name:"story_share_facebook"}),$.make("label",{"for":"NB-preference-story-share-facebook"})]),$.make("div",{className:"NB-preference-option",title:"Instapaper"},[$.make("input",{type:"checkbox",id:"NB-preference-story-share-instapaper",name:"story_share_instapaper"}),$.make("label",{"for":"NB-preference-story-share-instapaper"})]),$.make("div",{className:"NB-preference-option",
title:"Read It Later"},[$.make("input",{type:"checkbox",id:"NB-preference-story-share-readitlater",name:"story_share_readitlater"}),$.make("label",{"for":"NB-preference-story-share-readitlater"})])]),$.make("div",{className:"NB-preference-label"},["Sharing services"])]),$.make("div",{className:"NB-preference NB-preference-opml"},[$.make("div",{className:"NB-preference-options"},[$.make("a",{className:"NB-splash-link",href:NEWSBLUR.URLs["opml-export"]},"Download OPML")]),$.make("div",{className:"NB-preference-label"},
["Backup your sites",$.make("div",{className:"NB-preference-sublabel"},"Download this XML file as a backup")])])]),$.make("div",{className:"NB-modal-submit"},[$.make("input",{type:"submit",disabled:"true",className:"NB-modal-submit-green NB-disabled",value:"Change what you like above..."})," or ",$.make("a",{href:"#",className:"NB-modal-cancel"},"cancel")])]).bind("submit",function(b){b.preventDefault();a.save_preferences();return!1})])},resize_modal:function(){var a=$(".NB-preferences-scroll",this.$modal),
b=this.$modal,c=b.closest(".simplemodal-container");b.height()>c.height()-24&&(a.height(a.height()-5),this.resize_modal())},select_preferences:function(){NEWSBLUR.Preferences.timezone&&$("select[name=timezone] option",this.$modal).each(function(){if($(this).val()==NEWSBLUR.Preferences.timezone)return $(this).attr("selected",!0),!1});$("input[name=default_view]",this.$modal).each(function(){if($(this).val()==NEWSBLUR.Preferences.default_view)return $(this).attr("checked",!0),!1});$("input[name=story_pane_anchor]",
this.$modal).each(function(){if($(this).val()==NEWSBLUR.Preferences.story_pane_anchor)return $(this).attr("checked",!0),!1});$("input[name=new_window]",this.$modal).each(function(){if($(this).val()==NEWSBLUR.Preferences.new_window)return $(this).attr("checked",!0),!1});$("input[name=hide_read_feeds]",this.$modal).each(function(){if($(this).val()==NEWSBLUR.Preferences.hide_read_feeds)return $(this).attr("checked",!0),!1});$("input[name=feed_order]",this.$modal).each(function(){if($(this).val()==NEWSBLUR.Preferences.feed_order)return $(this).attr("checked",
!0),!1});$("input[name=hide_story_changes]",this.$modal).each(function(){if($(this).val()==NEWSBLUR.Preferences.hide_story_changes)return $(this).attr("checked",!0),!1});$("input[name=feed_view_single_story]",this.$modal).each(function(){if($(this).val()==NEWSBLUR.Preferences.feed_view_single_story)return $(this).attr("checked",!0),!1});$("input[name=animations]",this.$modal).each(function(){if($(this).val()==""+NEWSBLUR.Preferences.animations)return $(this).attr("checked",!0),!1});$("input[name=folder_counts]",
this.$modal).each(function(){if($(this).val()==""+NEWSBLUR.Preferences.folder_counts)return $(this).attr("checked",!0),!1});$("input[name=show_tooltips]",this.$modal).each(function(){if($(this).val()==NEWSBLUR.Preferences.show_tooltips)return $(this).attr("checked",!0),!1});$("input[name=story_styling]",this.$modal).each(function(){if($(this).val()==NEWSBLUR.Preferences.story_styling)return $(this).attr("checked",!0),!1});var a=_.select(_.keys(NEWSBLUR.Preferences),function(a){return a.indexOf("story_share")!=
-1});_.each(a,_.bind(function(a){var c=a.match(/story_share_(.*)/)[1];$("input#NB-preference-story-share-"+c,this.$modal).attr("checked",NEWSBLUR.Preferences[a])},this))},serialize_preferences:function(){var a={};$("input[type=radio]:checked, select",this.$modal).each(function(){var b=$(this).attr("name"),c=a[b]=$(this).val();c=="true"?a[b]=!0:c=="false"&&(a[b]=!1)});$("input[type=checkbox]",this.$modal).each(function(){a[$(this).attr("name")]=$(this).is(":checked")});return a},save_preferences:function(){var a=
this,b=this.serialize_preferences();$(".NB-preference-error",this.$modal).text("");$("input[type=submit]",this.$modal).val("Saving...").attr("disabled",!0).addClass("NB-disabled");this.model.save_preferences(b,function(){NEWSBLUR.reader.switch_feed_view_unread_view();NEWSBLUR.reader.apply_story_styling(!0);NEWSBLUR.reader.apply_tipsy_titles();NEWSBLUR.reader.show_stories_preference_in_feed_view();(a.original_preferences.feed_order!=b.feed_order||a.original_preferences.folder_counts!=b.folder_counts)&&
NEWSBLUR.reader.make_feeds();a.original_preferences.story_pane_anchor!=b.story_pane_anchor&&NEWSBLUR.reader.apply_resizable_layout(!0);a.close()})},make_site_sidebar_count:function(){var a=_.keys(this.model.feeds).length;return["Currently ",_.select(this.model.feeds,function(a){return a.ng||a.nt||a.ps}).length," out of ",a,Inflector.pluralize(" site",a)," would be shown."].join("")},close_and_load_account:function(){this.close(function(){NEWSBLUR.reader.open_account_modal()})},handle_click:function(a,
b){var c=this;$.targetIs(b,{tagSelector:".NB-add-url-submit"},function(){b.preventDefault();c.save_preferences()});$.targetIs(b,{tagSelector:".NB-link-account-preferences"},function(){b.preventDefault();c.close_and_load_account()});$.targetIs(b,{tagSelector:".NB-modal-cancel"},function(){b.preventDefault();c.close()})},handle_change:function(){$("input[type=radio],input[type=checkbox],select",this.$modal).bind("change",_.bind(this.enable_save,this))},enable_save:function(){$("input[type=submit]",
this.$modal).removeAttr("disabled").removeClass("NB-disabled").val("Save Preferences")},disable_save:function(){$("input[type=submit]",this.$modal).attr("disabled",!0).addClass("NB-disabled").val("Change what you like above...")}});NEWSBLUR.ReaderAccount=function(a){var b={animate_email:!1,change_password:!1,onOpen:_.bind(function(){this.animate_fields()},this)};this.options=$.extend({},b,a);this.model=NEWSBLUR.AssetModel.reader();this.runner()};NEWSBLUR.ReaderAccount.prototype=new NEWSBLUR.Modal;
NEWSBLUR.ReaderAccount.prototype.constructor=NEWSBLUR.ReaderAccount;
_.extend(NEWSBLUR.ReaderAccount.prototype,{runner:function(){this.make_modal();this.open_modal();this.$modal.bind("click",$.rescope(this.handle_click,this));this.handle_change();this.select_preferences()},make_modal:function(){var a=this;this.$modal=$.make("div",{className:"NB-modal-preferences NB-modal-account NB-modal"},[$.make("a",{href:"#preferences",className:"NB-link-account-preferences NB-splash-link"},"Switch to Preferences"),$.make("h2",{className:"NB-modal-title"},"My Account"),$.make("form",
{className:"NB-preferences-form"},[$.make("div",{className:"NB-preference NB-preference-username"},[$.make("div",{className:"NB-preference-options"},[$.make("div",{className:"NB-preference-option"},[$.make("input",{id:"NB-preference-username",type:"text",name:"username",value:NEWSBLUR.Globals.username})])]),$.make("div",{className:"NB-preference-label"},[$.make("label",{"for":"NB-preference-username"},"Username"),$.make("div",{className:"NB-preference-error"})])]),$.make("div",{className:"NB-preference NB-preference-email"},
[$.make("div",{className:"NB-preference-options"},[$.make("div",{className:"NB-preference-option"},[$.make("input",{id:"NB-preference-email",type:"text",name:"email",value:NEWSBLUR.Globals.email})])]),$.make("div",{className:"NB-preference-label"},[$.make("label",{"for":"NB-preference-email"},"Email address"),$.make("div",{className:"NB-preference-error"})])]),$.make("div",{className:"NB-preference NB-preference-password"},[$.make("div",{className:"NB-preference-options"},[$.make("div",{className:"NB-preference-option",
style:this.options.change_password?"opacity: .2":""},[$.make("label",{"for":"NB-preference-password-old"},"Old password"),$.make("input",{id:"NB-preference-password-old",type:"password",name:"old_password",value:""})]),$.make("div",{className:"NB-preference-option"},[$.make("label",{"for":"NB-preference-password-new"},"New password"),$.make("input",{id:"NB-preference-password-new",type:"password",name:"new_password",value:""})])]),$.make("div",{className:"NB-preference-label"},["Change password",
$.make("div",{className:"NB-preference-error"})])]),$.make("div",{className:"NB-preference NB-preference-premium"},[$.make("div",{className:"NB-preference-options"},[!NEWSBLUR.Globals.is_premium&&$.make("a",{className:"NB-modal-submit-button NB-modal-submit-green NB-account-premium-modal"},"Go Premium!"),NEWSBLUR.Globals.is_premium&&$.make("div",["Thank you! You have a ",$.make("b","premium account"),"."])]),$.make("div",{className:"NB-preference-label"},["Premium"])]),$.make("div",{className:"NB-preference NB-preference-opml"},
[$.make("div",{className:"NB-preference-options"},[$.make("a",{className:"NB-splash-link",href:NEWSBLUR.URLs["opml-export"]},"Download OPML")]),$.make("div",{className:"NB-preference-label"},["Backup your sites",$.make("div",{className:"NB-preference-sublabel"},"Download this XML file as a backup")])]),$.make("div",{className:"NB-preference NB-preference-emails"},[$.make("div",{className:"NB-preference-options"},[$.make("div",[$.make("input",{id:"NB-preference-emails-1",type:"radio",name:"send_emails",
value:"true"}),$.make("label",{"for":"NB-preference-emails-1"},["Mail me the infrequent email"])]),$.make("div",[$.make("input",{id:"NB-preference-emails-2",type:"radio",name:"send_emails",value:"false"}),$.make("label",{"for":"NB-preference-emails-2"},["Never ever send me an email"])])]),$.make("div",{className:"NB-preference-label"},["Emails"])]),$.make("div",{className:"NB-modal-submit"},[$.make("input",{type:"submit",disabled:"true",className:"NB-modal-submit-green NB-disabled",value:"Change what you like above..."}),
" or ",$.make("a",{href:"#",className:"NB-modal-cancel"},"cancel")])]).bind("submit",function(b){b.preventDefault();a.save_account_settings();return!1})])},animate_fields:function(){this.options.animate_email?_.delay(_.bind(function(){var a=$(".NB-preference-emails",this.$modal),b=a.css("backgroundColor");a.css("backgroundColor",b).animate({backgroundColor:"orange"},{queue:!1,duration:1200,easing:"easeInQuad",complete:function(){a.animate({backgroundColor:b},{queue:!1,duration:650,easing:"easeOutQuad"})}})},
this),200):this.options.change_password&&_.delay(_.bind(function(){var a=$(".NB-preference-password",this.$modal),b=a.css("backgroundColor");a.css("backgroundColor",b).animate({backgroundColor:"orange"},{queue:!1,duration:1200,easing:"easeInQuad",complete:function(){a.animate({backgroundColor:b},{queue:!1,duration:650,easing:"easeOutQuad"})}})},this),200)},close_and_load_preferences:function(){this.close(function(){NEWSBLUR.reader.open_preferences_modal()})},close_and_load_premium:function(){this.close(function(){NEWSBLUR.reader.open_feedchooser_modal()})},
handle_cancel:function(){$(".NB-modal-cancel",this.$modal).click(function(a){a.preventDefault();$.modal.close()})},select_preferences:function(){var a=this.model.preference;$("input[name=send_emails]",this.$modal).each(function(){console.log(["pref",a("send_emails"),$(this).val()]);if($(this).val()==""+a("send_emails"))return $(this).attr("checked",!0),!1})},serialize_preferences:function(){var a={};$("input[type=radio]:checked, select, input[type=text], input[type=password]",this.$modal).each(function(){var b=
$(this).attr("name"),c=a[b]=$(this).val();c=="true"?a[b]=!0:c=="false"&&(a[b]=!1)});$("input[type=checkbox]",this.$modal).each(function(){a[$(this).attr("name")]=$(this).is(":checked")});return a},save_account_settings:function(){var a=this,b=this.serialize_preferences();$(".NB-preference-error",this.$modal).text("");$("input[type=submit]",this.$modal).val("Saving...").attr("disabled",!0).addClass("NB-disabled");console.log(["form['send_emails']",b.send_emails]);this.model.preference("send_emails",
b.send_emails);this.model.save_account_settings(b,function(b){if(b.code==-1)return $(".NB-preference-username .NB-preference-error",this.$modal).text(b.message),a.disable_save();else if(b.code==-2)return $(".NB-preference-email .NB-preference-error",this.$modal).text(b.message),a.disable_save();else if(b.code==-3)return $(".NB-preference-password .NB-preference-error",this.$modal).text(b.message),a.disable_save();NEWSBLUR.Globals.username=b.payload.username;NEWSBLUR.Globals.email=b.payload.email;
$(".NB-module-account-username").text(NEWSBLUR.Globals.username);a.close()})},handle_click:function(a,b){var c=this;$.targetIs(b,{tagSelector:".NB-account-premium-modal"},function(){b.preventDefault();c.close_and_load_premium()});$.targetIs(b,{tagSelector:".NB-link-account-preferences"},function(){b.preventDefault();c.close_and_load_preferences()});$.targetIs(b,{tagSelector:".NB-modal-cancel"},function(){b.preventDefault();c.close()})},handle_change:function(){$("input[type=radio],input[type=checkbox],select,input",
this.$modal).bind("change",_.bind(this.enable_save,this));$("input",this.$modal).bind("keydown",_.bind(this.enable_save,this))},enable_save:function(){$("input[type=submit]",this.$modal).removeAttr("disabled").removeClass("NB-disabled").val("Save My Account")},disable_save:function(){this.resize();$("input[type=submit]",this.$modal).attr("disabled",!0).addClass("NB-disabled").val("Change what you like above...")}});
NEWSBLUR.ReaderFeedchooser=function(a){this.options=$.extend({},{},a);this.model=NEWSBLUR.AssetModel.reader();this.runner()};
NEWSBLUR.ReaderFeedchooser.prototype={runner:function(){this.start=new Date;this.MAX_FEEDS=64;this.approve_list=[];this.make_modal();this.make_paypal_button();_.defer(_.bind(function(){this.open_modal()},this));this.find_feeds_in_feed_list();this.initial_load_feeds();this.choose_dollar_amount(2);this.flags={has_saved:!1};this.$modal.bind("mousedown",$.rescope(this.handle_click,this))},make_modal:function(){this.$modal=$.make("div",{className:"NB-modal-feedchooser NB-modal"},[$.make("h2",{className:"NB-modal-title"},
"Choose Your "+this.MAX_FEEDS),$.make("h2",{className:"NB-modal-subtitle"},[$.make("b",["You have a ",$.make("span",{style:"color: #303060;"},"Standard Account"),", which can follow up to "+this.MAX_FEEDS+" sites."]),"You can always change these."]),$.make("div",{className:"NB-feedchooser-type"},[$.make("div",{className:"NB-feedchooser-info"},[$.make("div",{className:"NB-feedchooser-info-type"},[$.make("span",{className:"NB-feedchooser-subtitle-type-prefix"},"Free")," Standard Account"]),$.make("div",
{className:"NB-feedchooser-info-counts"}),$.make("div",{className:"NB-feedchooser-info-sort"},"Auto-Selected By Popularity")]),this.make_feeds(),$.make("form",{className:"NB-feedchooser-form"},[$.make("div",{className:"NB-modal-submit"},[$.make("input",{type:"submit",disabled:"true",className:"NB-disabled NB-modal-submit-save NB-modal-submit-green",value:"Check what you like above..."}),$.make("input",{type:"submit",className:"NB-modal-submit-add NB-modal-submit-green",value:"First, add sites"})])]).bind("submit",
function(a){a.preventDefault();return!1})]),$.make("div",{className:"NB-feedchooser-type NB-last"},[$.make("div",{className:"NB-feedchooser-info"},[$.make("div",{className:"NB-feedchooser-info-type"},[$.make("span",{className:"NB-feedchooser-subtitle-type-prefix"},"Super-Mega")," Premium Account"])]),$.make("ul",{className:"NB-feedchooser-premium-bullets"},[$.make("li",{className:"NB-1"},[$.make("div",{className:"NB-feedchooser-premium-bullet-image"}),"Sites are updated 10x more often."]),$.make("li",
{className:"NB-2"},[$.make("div",{className:"NB-feedchooser-premium-bullet-image"}),"Unlimited number of sites."]),$.make("li",{className:"NB-3"},[$.make("div",{className:"NB-feedchooser-premium-bullet-image"}),"Access to the premium-only River of News."]),$.make("li",{className:"NB-4"},[$.make("div",{className:"NB-feedchooser-premium-bullet-image"}),"Access to the future premium-only features like searching and visualizations."]),$.make("li",{className:"NB-5"},[$.make("div",{className:"NB-feedchooser-premium-bullet-image"}),
"You feed my poor, hungry dog for 6 days!",$.make("img",{className:"NB-feedchooser-premium-poor-hungry-dog",src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/shiloh.jpg"})]),$.make("li",{className:"NB-6"},[$.make("div",{className:"NB-feedchooser-premium-bullet-image"}),"You are supporting an indie developer."]),$.make("li",{className:"NB-7"},[$.make("div",{className:"NB-feedchooser-premium-bullet-image"}),"Choose how much you would like to pay.",$.make("div",{style:"color: #490567"},"The only difference is happiness.")])]),
$.make("div",{className:"NB-modal-submit NB-modal-submit-paypal"},[$.make("div",{className:"NB-feedchooser-paypal"}),$.make("div",{className:"NB-feedchooser-dollar"},[$.make("div",{className:"NB-feedchooser-dollar-value NB-1"},[$.make("div",{className:"NB-feedchooser-dollar-image"}),$.make("div",{className:"NB-feedchooser-dollar-month"},"$12/year"),$.make("div",{className:"NB-feedchooser-dollar-year"},"($1/month)")]),$.make("div",{className:"NB-feedchooser-dollar-value NB-2"},[$.make("div",{className:"NB-feedchooser-dollar-image"}),
$.make("div",{className:"NB-feedchooser-dollar-month"},"$24/year"),$.make("div",{className:"NB-feedchooser-dollar-year"},"($2/month)")]),$.make("div",{className:"NB-feedchooser-dollar-value NB-3"},[$.make("div",{className:"NB-feedchooser-dollar-image"}),$.make("div",{className:"NB-feedchooser-dollar-month"},"$36/year"),$.make("div",{className:"NB-feedchooser-dollar-year"},"($3/month)")])])])])])},make_paypal_button:function(){var a=this,b=$(".NB-feedchooser-paypal",this.$modal);$.get("/profile/paypal_form",
function(c){b.html(c);a.choose_dollar_amount(2)})},make_google_button:function(){return $('<script type="text/javascript" src="https://images-na.ssl-images-amazon.com/images/G/01/cba/js/widget/widget.js"><\/script><form method=POST action="https://payments.amazon.com/checkout/A215TOHXICT770"><input type="hidden" name="order-input" value="type:cba-signed-order/sha1-hmac/1;order:PD94bWwgdmVyc2lvbj0nMS4wJyBlbmNvZGluZz0nVVRGLTgnPz48T3JkZXIgeG1sbnM9J2h0dHA6Ly9wYXltZW50cy5hbWF6b24uY29tL2NoZWNrb3V0LzIwMDgtMTEtMzAvJz48Q2FydD48SXRlbXM+PEl0ZW0+PE1lcmNoYW50SWQ+QTIxNVRPSFhJQ1Q3NzA8L01lcmNoYW50SWQ+PFRpdGxlPk5ld3NCbHVyIFByZW1pdW0gLSAxIFllYXI8L1RpdGxlPjxEZXNjcmlwdGlvbj5UaGFuayB5b3UsIHRoYW5rIHlvdSwgdGhhbmsgeW91ITwvRGVzY3JpcHRpb24+PFByaWNlPjxBbW91bnQ+MTI8L0Ftb3VudD48Q3VycmVuY3lDb2RlPlVTRDwvQ3VycmVuY3lDb2RlPjwvUHJpY2U+PFF1YW50aXR5PjE8L1F1YW50aXR5PjxGdWxmaWxsbWVudE5ldHdvcms+TUVSQ0hBTlQ8L0Z1bGZpbGxtZW50TmV0d29yaz48L0l0ZW0+PC9JdGVtcz48L0NhcnQ+PC9PcmRlcj4=;signature:Zfg83JluKTIhItevtaGpspjdbfQ="><input alt="Checkout with Amazon Payments" src="https://payments.amazon.com/gp/cba/button?ie=UTF8&color=tan&background=white&cartOwnerId=A215TOHXICT770&size=large" type="image"></form>')},
make_feeds:function(){this.feed_count=_.size(this.model.feeds);var a=$("#feed_list").clone(!0).attr({id:"NB-feedchooser-feeds","class":"NB-feedlist NB-feedchooser unread_view_positive",style:""});a.data("sortable")&&a.data("sortable").disable();$(".folder",a).css({display:"block",opacity:1});$(".NB-feed-unfetched",a).removeClass("NB-feed-unfetched");$(".unread_count_positive",a).text("On");$(".unread_count_negative",a).text("Off");return a},resize_modal:function(a){var b=this.$modal.height()+16,c=
this.$modal.parent().height();b>c&&a!=b&&(a=$("#NB-feedchooser-feeds").height(),c=Math.max(4,b-c),$("#NB-feedchooser-feeds").css({"max-height":a-c}),_.defer(_.bind(function(){this.resize_modal(b)},this),1))},open_modal:function(){var a=this;this.$modal.modal({minWidth:780,maxWidth:780,overlayClose:!0,onOpen:function(b){b.overlay.fadeIn(200,function(){b.container.fadeIn(200);b.data.fadeIn(200,function(){_.defer(_.bind(a.resize_modal,a),10)})})},onShow:function(){$("#simplemodal-container").corner("6px")},
onClose:function(b,c){!a.flags.has_saved&&!NEWSBLUR.reader.flags.has_chosen_feeds&&NEWSBLUR.reader.show_feed_chooser_button();b.data.hide().empty().remove();b.container.hide().empty().remove();b.overlay.fadeOut(200,function(){b.overlay.empty().remove();$.modal.close(c)});$(".NB-modal-holder").empty().remove()}})},add_feed_to_decline:function(a,b){this.approve_list=_.without(this.approve_list,a);var c=this.$feeds[a];c.removeClass("NB-feedchooser-approve");c.addClass("NB-feedchooser-decline");b&&this.update_counts()},
add_feed_to_approve:function(a,b){_.contains(this.approve_list,a)||this.approve_list.push(a);var c=this.$feeds[a];c.removeClass("NB-feedchooser-decline");c.addClass("NB-feedchooser-approve");b&&this.update_counts()},find_feeds_in_feed_list:function(){var a=this,b=$(".NB-feedchooser",this.$modal),c={};$(".feed",b).each(function(){var a=parseInt($(this).attr("data-id"),10);a in c||(c[a]=$([]));c[a].push($(this).get(0))});var d=_.uniq(_.keys(c)).sort();_.each(a.model.feeds,function(b){_.contains(d,b)||
delete a.model.feeds[b]});this.$feeds=c},update_counts:function(){var a=$(".NB-feedchooser-info-counts"),b=this.approve_list.length,c=$(".NB-modal-submit-save",this.$modal),d=b-this.MAX_FEEDS;a.text(b+"/"+Inflector.commas(this.feed_count));a.toggleClass("NB-full",b==this.MAX_FEEDS);a.toggleClass("NB-error",b>this.MAX_FEEDS);$(".NB-feedchooser-info-sort",this.$modal).fadeOut(500);b>this.MAX_FEEDS?c.addClass("NB-disabled").attr("disabled",!0).val("Too many sites! Deselect "+(d==1?"1 site...":d+" sites...")):
c.removeClass("NB-disabled").attr("disabled",!1).val("Turn on these "+b+" sites, please")},initial_load_feeds:function(){var a=this,b=$(".feed",this.$modal),c=this.model.get_feeds();if(_.keys(c).length){var d=_.any(_.pluck(c,"active"));if(d)this.approve_list=d=_.pluck(_.select(c,function(a){if(a.active)return!0}),"id"),c=[],b.each(function(){var b=parseInt($(this).attr("data-id"),10);_.contains(d,b)?a.add_feed_to_approve(b):a.add_feed_to_decline(b)});else{var e=_.last(_.first(_.pluck(_.select(this.model.get_feeds(),
function(a){return!a.has_exception}),"subs").sort(function(a,b){return b-a}),this.MAX_FEEDS)),f=[];_.each(c,function(b,c){a.add_feed_to_decline(parseInt(c,10));b.subs>=e&&f.push(parseInt(c,10))});_.each(f,function(b){a.model.get_feed(b).subs>e&&a.approve_list.length<a.MAX_FEEDS&&!a.model.get_feed(b).has_exception&&a.add_feed_to_approve(b)});_.each(f,function(b){a.model.get_feed(b).subs==e&&a.approve_list.length<a.MAX_FEEDS&&a.add_feed_to_approve(b)})}_.defer(_.bind(function(){this.update_counts()},
this))}else _.defer(_.bind(function(){var a=$(".NB-feedchooser-info",this.$modal);$(".NB-feedchooser-info-counts",a).hide();$(".NB-feedchooser-info-sort",a).hide();$("#NB-feedchooser-feeds").hide();$(".NB-modal-submit-save").hide();$(".NB-modal-submit-add").show()},this))},save:function(){var a=this,b=this.approve_list;$(".NB-modal-submit-save",this.$modal).addClass("NB-disabled").val("Saving...");this.update_homepage_count();this.model.save_feed_chooser(b,function(){a.flags.has_saved=!0;NEWSBLUR.reader.hide_feed_chooser_button();
NEWSBLUR.reader.load_feeds();$.modal.close()})},close_and_add:function(){$.modal.close(function(){NEWSBLUR.add_feed=new NEWSBLUR.ReaderAddFeed})},update_homepage_count:function(){var a=$(".NB-module-account-feedcount"),b=$(".NB-module-account-upgrade");a.text(this.approve_list.length);b.removeClass("NB-modal-submit-green").addClass("NB-modal-submit-close");$(".NB-module-account-trainer").removeClass("NB-hidden").hide().slideDown(500)},choose_dollar_amount:function(a){var b=$(".NB-feedchooser-dollar-value",
this.$modal),c=$("input[name=a3]");b.removeClass("NB-selected");b.filter(".NB-"+a).addClass("NB-selected");a==1?c.val(12):a==2?c.val(24):a==3&&c.val(36)},handle_click:function(a,b){$.targetIs(b,{tagSelector:".feed"},_.bind(function(a){b.preventDefault();a=parseInt(a.attr("data-id"),10);_.contains(this.approve_list,a)?this.add_feed_to_decline(a,!0):this.add_feed_to_approve(a,!0)},this));$.targetIs(b,{tagSelector:".NB-modal-submit-save"},_.bind(function(){b.preventDefault();this.save()},this));$.targetIs(b,
{tagSelector:".NB-modal-submit-add"},_.bind(function(){b.preventDefault();this.close_and_add()},this));$.targetIs(b,{tagSelector:".NB-feedchooser-dollar-value"},_.bind(function(a){b.preventDefault();var d;a.hasClass("NB-1")?d=1:a.hasClass("NB-2")?d=2:a.hasClass("NB-3")&&(d=3);this.choose_dollar_amount(d)},this))},handle_cancel:function(){$(".NB-modal-cancel",this.$modal).click(function(a){a.preventDefault();$.modal.close()})}};
NEWSBLUR.ReaderStatistics=function(a,b){this.options=$.extend({},{},b);this.model=NEWSBLUR.AssetModel.reader();this.feed_id=a;this.feed=this.model.get_feed(a);this.feeds=this.model.get_feeds();this.first_load=!0;this.runner()};
NEWSBLUR.ReaderStatistics.prototype={runner:function(){var a=this;this.make_modal();this.open_modal();setTimeout(function(){a.get_stats()},50);this.$modal.bind("change",$.rescope(this.handle_change,this))},make_modal:function(){this.$modal=$.make("div",{className:"NB-modal-statistics NB-modal"},[$.make("div",{className:"NB-modal-feed-chooser-container"},[this.make_feed_chooser()]),$.make("div",{className:"NB-modal-loading"}),$.make("h2",{className:"NB-modal-title"},"Statistics &amp; History"),$.make("h2",
{className:"NB-modal-subtitle"},[$.make("img",{className:"NB-modal-feed-image feed_favicon",src:$.favicon(this.feed.favicon)}),$.make("div",{className:"NB-modal-feed-heading"},[$.make("span",{className:"NB-modal-feed-title"},this.feed.feed_title),$.make("span",{className:"NB-modal-feed-subscribers"},Inflector.commas(this.feed.num_subscribers)+Inflector.pluralize(" subscriber",this.feed.num_subscribers))])]),$.make("div",{className:"NB-modal-statistics-info"})]);var a=this.make_stats({last_update:"",
next_update:""});$(".NB-modal-statistics-info",this.$modal).replaceWith(a)},initialize_feed:function(a){this.feed_id=a;this.feed=this.model.get_feed(a);$(".NB-modal-subtitle .NB-modal-feed-image",this.$modal).attr("src",$.favicon(this.feed.favicon));$(".NB-modal-subtitle .NB-modal-feed-title",this.$modal).html(this.feed.feed_title);$(".NB-modal-subtitle .NB-modal-feed-subscribers",this.$modal).html(Inflector.commas(this.feed.num_subscribers)+Inflector.pluralize(" subscriber",this.feed.num_subscribers))},
open_modal:function(){this.$modal.modal({minWidth:600,maxWidth:600,minHeight:425,overlayClose:!0,autoResize:!0,onOpen:function(a){a.overlay.fadeIn(200,function(){a.container.fadeIn(200);a.data.fadeIn(200)})},onShow:function(){$("#simplemodal-container").corner("6px")},onClose:function(a){a.data.hide().empty().remove();a.container.hide().empty().remove();a.overlay.fadeOut(200,function(){a.overlay.empty().remove();$.modal.close()});$(".NB-modal-holder").empty().remove()}})},make_feed_chooser:function(){var a=
$.make("select",{name:"feed",className:"NB-modal-feed-chooser"}),b;for(b in this.feeds){var c=this.feeds[b],d=$.make("option",{value:c.id},c.feed_title);d.appendTo(a);c.id==this.feed_id&&d.attr("selected",!0)}$("option",a).tsort();return a},get_stats:function(){$(".NB-modal-loading",this.$modal).addClass("NB-active");this.model.get_feed_statistics(this.feed_id,$.rescope(this.populate_stats,this))},populate_stats:function(a,b){var c=this;NEWSBLUR.log(["Stats",b]);$(".NB-modal-loading",this.$modal).removeClass("NB-active");
var d=b.update_interval_minutes,e=b.update_interval_minutes*1.25,f="";if(d<60)f=d+" to "+e+" minutes";else var f=parseInt(d/60,10),g=parseInt(e/60,10),f=f+(d%60>=30?".5":"")+" to "+g+(e%60>=30||f==g?".5":"")+" hours";d=this.make_stats(b,f);$(".NB-modal-statistics-info",this.$modal).replaceWith(d);setTimeout(function(){c.make_charts(b)},this.first_load?500:50);setTimeout(function(){$.modal.impl.resize(c.$modal)},100)},make_stats:function(a,b){return $.make("div",{className:"NB-modal-statistics-info"},
[$.make("div",{className:"NB-statistics-stat NB-statistics-updates"},[$.make("div",{className:"NB-statistics-update"},[$.make("div",{className:"NB-statistics-label"},"Last Update"),$.make("div",{className:"NB-statistics-count"},"&nbsp;"+(a.last_update&&a.last_update+" ago"))]),$.make("div",{className:"NB-statistics-update"},[$.make("div",{className:"NB-statistics-label"},"Every"),$.make("div",{className:"NB-statistics-count"},b)]),$.make("div",{className:"NB-statistics-update"},[$.make("div",{className:"NB-statistics-label"},
"Next Update"),$.make("div",{className:"NB-statistics-count"},"&nbsp;"+(a.next_update&&"in "+a.next_update))])]),$.make("div",{className:"NB-statistics-stat NB-statistics-history"},[$.make("div",{className:"NB-statistics-history-stat"},[$.make("div",{className:"NB-statistics-label"},"Stories per month")]),$.make("div",{id:"NB-statistics-history-chart",className:"NB-statistics-history-chart"})]),a.classifier_counts&&$.make("div",{className:"NB-statistics-state NB-statistics-classifiers"},[this.make_classifier_count("tag",
a.classifier_counts.tag),this.make_classifier_count("author",a.classifier_counts.author),this.make_classifier_count("title",a.classifier_counts.title),this.make_classifier_count("feed",a.classifier_counts.feed)]),$.make("div",{className:"NB-statistics-stat NB-statistics-fetches"},[$.make("div",{className:"NB-statistics-fetches-half"},[$.make("div",{className:"NB-statistics-label"},"Feed"),$.make("div",this.make_history(a,"feed"))]),$.make("div",{className:"NB-statistics-fetches-half"},[$.make("div",
{className:"NB-statistics-label"},"Page"),$.make("div",this.make_history(a,"page"))])])])},make_classifier_count:function(a,b){var c=this;if(b){var d=$.make("div",{className:"NB-statistics-facets"},[$.make("div",{className:"NB-statistics-facet-title"},Inflector.pluralize(a,b.length))]),e=10;_.each(b,function(a){if(a.pos>e||a.neg>e)e=Math.max(a.pos,a.neg)});var f=100/parseFloat(e,10);_.each(b,function(b){var e=b.pos||0,k=b.neg||0,b=b[a];a=="feed"&&(b=[$.make("div",[$.make("img",{className:"NB-modal-feed-image feed_favicon",
src:$.favicon(c.feed.favicon)}),$.make("span",{className:"NB-modal-feed-title"},c.feed.feed_title)])]);if(b&&(e||k))e=$.make("div",{className:"NB-statistics-facet"},[e&&$.make("div",{className:"NB-statistics-facet-pos"},[$.make("div",{className:"NB-statistics-facet-bar"}).css("width",Math.max(1,f*e)),$.make("div",{className:"NB-statistics-facet-count"},e+Inflector.pluralize(" like",e)).css("margin-left",Math.max(1,f*e)+5)]),k&&$.make("div",{className:"NB-statistics-facet-neg"},[$.make("div",{className:"NB-statistics-facet-bar"}).css("width",
Math.max(1,f*k)),$.make("div",{className:"NB-statistics-facet-count"},k+Inflector.pluralize(" dislike",k)).css("margin-right",Math.max(1,f*k)+5)]),$.make("div",{className:"NB-statistics-facet-separator"}),$.make("div",{className:"NB-statistics-facet-name"},b)]),d.append(e)});return d}},make_history:function(a,b){var c=a[b+"_fetch_history"];if(c)return _.map(c,function(a){var b=_.contains([200,304],a.status_code);return $.make("div",{className:"NB-statistics-history-fetch"+(b?" NB-ok ":" NB-error "),
title:b?"":a.exception},[$.make("div",{className:"NB-statistics-history-fetch-date"},a.fetch_date),$.make("div",{className:"NB-statistics-history-fetch-message"},[a.message,$.make("div",{className:"NB-statistics-history-fetch-code"}," ("+a.status_code+")")])])})},make_charts:function(a){a.story_count_history=_.map(a.story_count_history,function(a){var b=a[0].match(/(\d{4})-(\d{1,2})/);return[(new Date(parseInt(b[1],10),parseInt(b[2],10)-1)).getTime(),a[1]]});var b=$(".NB-statistics-history-chart");
$.plot(b,[{data:a.story_count_history,label:"Stories"}],{series:{lines:{show:!0},points:{show:!0}},average:a.average_stories_per_month,legend:{show:!1},grid:{hoverable:!0,clickable:!0},yaxis:{tickDecimals:0,min:0},xaxis:{mode:"time",minTickSize:[1,"month"],timeformat:"%b %y"}})},handle_change:function(a,b){var c=this;$.targetIs(b,{tagSelector:".NB-modal-feed-chooser"},function(a){a=a.val();c.first_load=!1;c.initialize_feed(a);c.get_stats()})}};
NEWSBLUR.ReaderFeedException=function(a,b){this.options=$.extend({},{},b);this.model=NEWSBLUR.AssetModel.reader();this.feed_id=a;this.feed=this.model.get_feed(a);this.runner()};
NEWSBLUR.ReaderFeedException.prototype={runner:function(){this.make_modal();this.show_recommended_options_meta();this.handle_cancel();this.open_modal();this.$modal.bind("click",$.rescope(this.handle_click,this));NEWSBLUR.log(["Exception Modal",this.feed])},make_modal:function(){this.$modal=$.make("div",{className:"NB-modal-exception NB-modal"},[$.make("div",{className:"NB-modal-loading"}),$.make("h2",{className:"NB-modal-title"},"Fix a misbehaving site"),$.make("h2",{className:"NB-modal-subtitle"},
[$.make("img",{className:"NB-modal-feed-image feed_favicon",src:$.favicon(this.feed.favicon)}),$.make("span",{className:"NB-modal-feed-title"},this.feed.feed_title)]),$.make("div",{className:"NB-fieldset NB-exception-option NB-exception-option-retry NB-modal-submit"},[$.make("h5",[$.make("div",{className:"NB-exception-option-meta"}),$.make("span",{className:"NB-exception-option-option"},"Option 1:"),"Retry"]),$.make("div",{className:"NB-fieldset-fields"},[$.make("div",[$.make("div",{className:"NB-loading"}),
$.make("input",{type:"submit",value:"Retry fetching and parsing",className:"NB-modal-submit-green NB-modal-submit-retry"}),$.make("div",{className:"NB-error"})])])]),$.make("div",{className:"NB-fieldset NB-exception-option NB-exception-option-page NB-modal-submit"},[$.make("h5",[$.make("div",{className:"NB-exception-option-meta"}),$.make("span",{className:"NB-exception-option-option"},"Option 2:"),"Change Website Address"]),$.make("div",{className:"NB-fieldset-fields"},[$.make("div",[$.make("div",
{className:"NB-loading"}),$.make("label",{"for":"NB-exception-input-link"},[$.make("div",{className:"NB-folder-icon"}),"Website URL: "]),$.make("input",{type:"text",id:"NB-exception-input-link",className:"NB-exception-input-link",name:"feed_link",value:this.feed.feed_link}),$.make("input",{type:"submit",value:"Fetch Feed From Website",className:"NB-modal-submit-green NB-modal-submit-link"}),$.make("div",{className:"NB-error"})])])]),$.make("div",{className:"NB-fieldset NB-exception-option NB-exception-option-feed NB-modal-submit"},
[$.make("h5",[$.make("div",{className:"NB-exception-option-meta"}),$.make("span",{className:"NB-exception-option-option"},"Option 3:"),"Change RSS Feed Address"]),$.make("div",{className:"NB-fieldset-fields"},[$.make("div",[$.make("div",{className:"NB-loading"}),$.make("label",{"for":"NB-exception-input-address"},[$.make("div",{className:"NB-folder-icon"}),"RSS/XML URL: "]),$.make("input",{type:"text",id:"NB-exception-input-address",className:"NB-exception-input-address",name:"feed_address",value:this.feed.feed_address}),
$.make("input",{type:"submit",value:"Parse this RSS/XML Feed",className:"NB-modal-submit-green NB-modal-submit-address"}),$.make("div",{className:"NB-error"})])])]),$.make("div",{className:"NB-fieldset NB-exception-option NB-exception-option-delete NB-modal-submit"},[$.make("h5",[$.make("span",{className:"NB-exception-option-option"},"Option 4:"),"Just Delete This Feed"]),$.make("div",{className:"NB-fieldset-fields"},[$.make("div",[$.make("div",{className:"NB-loading"}),$.make("input",{type:"submit",
value:"Delete It. It Just Won't Work!",className:"NB-modal-submit-red NB-modal-submit-delete"}),$.make("div",{className:"NB-error"})])])])])},show_recommended_options_meta:function(){var a=$(".NB-exception-option-retry .NB-exception-option-meta",this.$modal),b=$(".NB-exception-option-page .NB-exception-option-meta",this.$modal),c=$(".NB-exception-option-feed .NB-exception-option-meta",this.$modal),d=400<=this.feed.exception_code&&this.feed.exception_code<500;d?(this.feed.exception_type=="feed"&&(b.addClass("NB-exception-option-meta-recommended"),
b.text("Recommended")),this.feed.exception_type=="page"&&(d?(c.addClass("NB-exception-option-meta-recommended"),c.text("Recommended")):(b.addClass("NB-exception-option-meta-recommended"),b.text("Recommended")))):(a.addClass("NB-exception-option-meta-recommended"),a.text("Recommended"))},open_modal:function(){this.$modal.modal({minWidth:600,maxWidth:600,overlayClose:!0,onOpen:function(a){a.overlay.fadeIn(200,function(){a.container.fadeIn(200);a.data.fadeIn(200)})},onShow:function(){$("#simplemodal-container").corner("6px")},
onClose:function(a){a.data.hide().empty().remove();a.container.hide().empty().remove();a.overlay.fadeOut(200,function(){a.overlay.empty().remove();$.modal.close()});$(".NB-modal-holder").empty().remove()}})},handle_cancel:function(){$(".NB-modal-cancel",this.$modal).click(function(a){a.preventDefault();$.modal.close()})},save_retry_feed:function(){$(".NB-modal-loading",this.$modal).addClass("NB-active");$(".NB-modal-submit-retry",this.$modal).addClass("NB-disabled").attr("value","Fetching...");this.model.save_exception_retry(this.feed_id,
function(){$.modal.close()})},delete_feed:function(){$(".NB-modal-loading",this.$modal).addClass("NB-active");$(".NB-modal-submit-delete",this.$modal).addClass("NB-disabled").attr("value","Deleting...");NEWSBLUR.reader.manage_menu_delete_feed(this.feed_id);_.delay(function(){$.modal.close()},500)},change_feed_address:function(){$(".NB-modal-loading",this.$modal).addClass("NB-active");$(".NB-modal-submit-address",this.$modal).addClass("NB-disabled").attr("value","Parsing...");var a=this.feed_id,b=
$("input[name=feed_address]",this.$modal).val();b.length&&this.model.save_exception_change_feed_address(a,b,function(){$.modal.close()})},change_feed_link:function(){$(".NB-modal-loading",this.$modal).addClass("NB-active");$(".NB-modal-submit-link",this.$modal).addClass("NB-disabled").attr("value","Fetching...");var a=this.feed_id,b=$("input[name=feed_link]",this.$modal).val();b.length&&this.model.save_exception_change_feed_link(a,b,function(){$.modal.close()})},handle_click:function(a,b){var c=this;
$.targetIs(b,{tagSelector:".NB-modal-submit-retry"},function(){b.preventDefault();c.save_retry_feed()});$.targetIs(b,{tagSelector:".NB-modal-submit-delete"},function(){b.preventDefault();c.delete_feed()});$.targetIs(b,{tagSelector:".NB-modal-submit-address"},function(){b.preventDefault();c.change_feed_address()});$.targetIs(b,{tagSelector:".NB-modal-submit-link"},function(){b.preventDefault();c.change_feed_link()})}};NEWSBLUR.ReaderKeyboard=function(a){this.options=$.extend({},{},a);this.runner()};
NEWSBLUR.ReaderKeyboard.prototype={runner:function(){this.make_modal();this.handle_cancel();this.open_modal();this.$modal.bind("click",$.rescope(this.handle_click,this))},make_modal:function(){this.$modal=$.make("div",{className:"NB-modal-keyboard NB-modal"},[$.make("h2",{className:"NB-modal-title"},"Keyboard shortcuts"),$.make("div",{className:"NB-keyboard-group"},[$.make("div",{className:"NB-keyboard-shortcut"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Next story"),$.make("div",
{className:"NB-keyboard-shortcut-key"},["&#x2193;"]),$.make("div",{className:"NB-keyboard-shortcut-key"},["j"]),$.make("div",{className:"NB-keyboard-shortcut-image"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/keyboard_down.png",width:268,height:65})])]),$.make("div",{className:"NB-keyboard-shortcut NB-last"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Previous story"),$.make("div",{className:"NB-keyboard-shortcut-key"},["&#x2191;"]),$.make("div",{className:"NB-keyboard-shortcut-key"},
["k"]),$.make("div",{className:"NB-keyboard-shortcut-image"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/keyboard_up.png",width:268,height:65})])])]),$.make("div",{className:"NB-keyboard-group"},[$.make("div",{className:"NB-keyboard-shortcut"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Next site"),$.make("div",{className:"NB-keyboard-shortcut-key"},["shift",$.make("span","+"),"&#x2193;"]),$.make("div",{className:"NB-keyboard-shortcut-key"},["shift",$.make("span",
"+"),"j"])]),$.make("div",{className:"NB-keyboard-shortcut NB-last"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Prev. site"),$.make("div",{className:"NB-keyboard-shortcut-key"},["shift",$.make("span","+"),"&#x2191;"]),$.make("div",{className:"NB-keyboard-shortcut-key"},["shift",$.make("span","+"),"k"])])]),$.make("div",{className:"NB-keyboard-group"},[$.make("div",{className:"NB-keyboard-shortcut"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Switch views"),$.make("div",
{className:"NB-keyboard-shortcut-key"},["&#x2190;"]),$.make("div",{className:"NB-keyboard-shortcut-key"},["&#x2192;"]),$.make("div",{className:"NB-keyboard-shortcut-image"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/keyboard_leftright.png",width:268,height:29})])]),$.make("div",{className:"NB-keyboard-shortcut NB-last"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Open Site"),$.make("div",{className:"NB-keyboard-shortcut-key"},["enter"]),$.make("div",{className:"NB-keyboard-shortcut-image"},
[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/keyboard_enter.png",width:268,height:29})])])]),$.make("div",{className:"NB-keyboard-group"},[$.make("div",{className:"NB-keyboard-shortcut"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Page down"),$.make("div",{className:"NB-keyboard-shortcut-key"},["space"])]),$.make("div",{className:"NB-keyboard-shortcut NB-last"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Page up"),$.make("div",{className:"NB-keyboard-shortcut-key"},
["shift",$.make("span","+"),"space"])])]),$.make("div",{className:"NB-keyboard-group"},[$.make("div",{className:"NB-keyboard-shortcut"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Next Unread Story"),$.make("div",{className:"NB-keyboard-shortcut-key"},["n"])]),$.make("div",{className:"NB-keyboard-shortcut NB-last"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Hide Sidebar"),$.make("div",{className:"NB-keyboard-shortcut-key"},["u"])])]),$.make("div",{className:"NB-keyboard-group"},
[$.make("div",{className:"NB-keyboard-shortcut"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Save/Unsave Story"),$.make("div",{className:"NB-keyboard-shortcut-key"},["s"])]),$.make("div",{className:"NB-keyboard-shortcut NB-last"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Change Intelligence"),$.make("div",{className:"NB-keyboard-shortcut-key"},["+"]),$.make("div",{className:"NB-keyboard-shortcut-key"},["-"])])]),$.make("div",{className:"NB-keyboard-group"},[$.make("div",
{className:"NB-keyboard-shortcut"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Open site/feed trainer"),$.make("div",{className:"NB-keyboard-shortcut-key"},["f"])]),$.make("div",{className:"NB-keyboard-shortcut NB-last"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Open story trainer"),$.make("div",{className:"NB-keyboard-shortcut-key"},["t"])])]),$.make("div",{className:"NB-keyboard-group"},[$.make("div",{className:"NB-keyboard-shortcut"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},
"Open story in new window"),$.make("div",{className:"NB-keyboard-shortcut-key"},["o"])]),$.make("div",{className:"NB-keyboard-shortcut NB-last"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Mark site/folder as read"),$.make("div",{className:"NB-keyboard-shortcut-key"},["shift",$.make("span","+"),"a"])])])])},open_modal:function(){this.$modal.modal({minWidth:620,maxWidth:620,overlayClose:!0,onOpen:function(a){a.overlay.fadeIn(200,function(){a.container.fadeIn(200);a.data.fadeIn(200);
$(window).resize()})},onShow:function(){$("#simplemodal-container").corner("6px")},onClose:function(a){a.data.hide().empty().remove();a.container.hide().empty().remove();a.overlay.fadeOut(200,function(){a.overlay.empty().remove();$.modal.close()});$(".NB-modal-holder").empty().remove()}})},handle_cancel:function(){$(".NB-modal-cancel",this.$modal).click(function(a){a.preventDefault();$.modal.close()})},handle_click:function(a,b){var c=this;$.targetIs(b,{tagSelector:".NB-add-url-submit"},function(){b.preventDefault();
c.save_add_url()})}};NEWSBLUR.ReaderRecommendFeed=function(a,b){this.options=$.extend({},{},b);this.model=NEWSBLUR.AssetModel.reader();this.feed_id=a;this.feed=this.model.get_feed(a);this.feeds=this.model.get_feeds();this.first_load=!0;this.runner()};
NEWSBLUR.ReaderRecommendFeed.prototype={runner:function(){this.make_modal();this.open_modal();_.delay(_.bind(function(){this.get_tagline()},this),50);this.$modal.bind("click",$.rescope(this.handle_click,this));this.$modal.bind("change",$.rescope(this.handle_change,this))},make_modal:function(){this.$modal=$.make("div",{className:"NB-modal-recommend NB-modal"},[$.make("div",{className:"NB-modal-feed-chooser-container"},[this.make_feed_chooser()]),$.make("div",{className:"NB-modal-loading"}),$.make("h2",
{className:"NB-modal-title"},"Recommend this Site"),$.make("h2",{className:"NB-modal-subtitle"},[$.make("img",{className:"NB-modal-feed-image feed_favicon",src:$.favicon(this.feed.favicon)}),$.make("div",{className:"NB-modal-feed-heading"},[$.make("span",{className:"NB-modal-feed-title"},this.feed.feed_title),$.make("span",{className:"NB-modal-feed-subscribers"},Inflector.commas(this.feed.num_subscribers)+Inflector.pluralize(" subscriber",this.feed.num_subscribers))])]),$.make("div",{className:"NB-modal-recommend-explanation"},
["Spruce up the site's tagline. If chosen, this site will enjoy a week on the NewsBlur dashboard."]),$.make("div",{className:"NB-modal-recommend-tagline-container"},[$.make("textarea",{className:"NB-modal-recommend-tagline"})]),$.make("div",{className:"NB-modal-recommend-credit"},["&raquo; Want credit? Enter your Twitter username: ",$.make("input",{className:"NB-input NB-modal-recommend-twitter"})]),$.make("form",{className:"NB-recommend-form"},[$.make("div",{className:"NB-modal-submit"},[$.make("input",
{type:"submit",className:"NB-modal-submit-save NB-modal-submit-green",value:"Recommend Site"})," or ",$.make("a",{href:"#",className:"NB-modal-cancel"},"cancel")])])])},make_feed_chooser:function(){var a=$.make("select",{name:"feed",className:"NB-modal-feed-chooser"}),b;for(b in this.feeds){var c=this.feeds[b],d=$.make("option",{value:c.id},c.feed_title);d.appendTo(a);c.id==this.feed_id&&d.attr("selected",!0)}$("option",a).tsort();return a},get_tagline:function(){$(".NB-modal-loading",this.$modal).addClass("NB-active");
this.model.get_feed_recommendation_info(this.feed_id,_.bind(this.populate_tagline,this))},populate_tagline:function(a){var b=$(".NB-modal-submit-save",this.$modal);$(".NB-modal-loading",this.$modal).removeClass("NB-active");$(".NB-modal-recommend-tagline",this.$modal).val(a.tagline);a.previous_recommendation?b.addClass("NB-disabled").val("Previously Recommended on: "+a.previous_recommendation):b.removeClass("NB-disabled").val("Recommend Site")},initialize_feed:function(a){this.feed_id=a;this.feed=
this.model.get_feed(a);$(".NB-modal-subtitle .NB-modal-feed-image",this.$modal).attr("src",$.favicon(this.feed.favicon));$(".NB-modal-subtitle .NB-modal-feed-title",this.$modal).html(this.feed.feed_title);$(".NB-modal-subtitle .NB-modal-feed-subscribers",this.$modal).html(Inflector.commas(this.feed.num_subscribers)+Inflector.pluralize(" subscriber",this.feed.num_subscribers))},open_modal:function(){this.$modal.modal({minWidth:600,maxWidth:600,overlayClose:!0,onOpen:function(a){a.overlay.fadeIn(200,
function(){a.container.fadeIn(200);a.data.fadeIn(200);setTimeout(function(){$(window).resize()})})},onShow:function(){$("#simplemodal-container").corner("6px")},onClose:function(a){a.data.hide().empty().remove();a.container.hide().empty().remove();a.overlay.fadeOut(200,function(){a.overlay.empty().remove();$.modal.close()});$(".NB-modal-holder").empty().remove()}})},save:function(){$(".NB-modal-submit-save",this.$modal).addClass("NB-disabled").val("Saving...");this.model.save_recommended_site({feed_id:this.feed_id,
tagline:$(".NB-modal-recommend-tagline").val(),twitter:$(".NB-modal-recommend-twitter").val()},function(){$.modal.close()})},handle_click:function(a,b){var c=this;$.targetIs(b,{tagSelector:".NB-modal-cancel"},function(){b.preventDefault();$.modal.close()});$.targetIs(b,{tagSelector:".NB-modal-submit-save"},function(a){b.preventDefault();a.hasClass("NB-disabled")||c.save()})},handle_change:function(a,b){var c=this;$.targetIs(b,{tagSelector:".NB-modal-feed-chooser"},function(a){a=a.val();c.first_load=
!1;c.initialize_feed(a);c.get_tagline()})}};NEWSBLUR.ReaderSendEmail=function(a,b){_.bindAll(this,"close","save_callback","error");this.options=$.extend({},{},b);this.model=NEWSBLUR.AssetModel.reader();this.story_id=a;this.story=this.model.get_story(a);this.feed_id=this.story.story_feed_id;this.feed=this.model.get_feed(this.feed_id);this.runner()};
NEWSBLUR.ReaderSendEmail.prototype=_.extend({},NEWSBLUR.Modal.prototype,{runner:function(){this.make_modal();this.open_modal();NEWSBLUR.Globals.is_authenticated||this.save_callback({code:-1,message:"You must be logged in to send a story over email."});this.$modal.bind("click",$.rescope(this.handle_click,this))},make_modal:function(){this.$modal=$.make("div",{className:"NB-modal-email NB-modal"},[$.make("span",{className:"NB-modal-loading NB-spinner"}),$.make("div",{className:"NB-modal-error"}),$.make("h2",
{className:"NB-modal-title"},"Send Story by Email"),$.make("h2",{className:"NB-modal-subtitle"},[$.make("div",{className:"NB-modal-email-feed"},[$.make("img",{className:"NB-modal-feed-image feed_favicon",src:$.favicon(this.feed.favicon)}),$.make("div",{className:"NB-modal-feed-title"},this.feed.feed_title)]),$.make("div",{className:"NB-modal-email-story-title"},this.story.story_title),$.make("div",{className:"NB-modal-email-story-permalink"},this.story.story_permalink)]),$.make("div",{className:"NB-modal-email-to-container"},
[$.make("label",{"for":"NB-send-email-to"},[$.make("span",{className:"NB-raquo"},"&raquo;")," Recipient's email: "]),$.make("input",{className:"NB-input NB-modal-to",name:"to",id:"NB-send-email-to",value:""})]),$.make("div",{className:"NB-modal-email-explanation"},["Add an optional comment to send with the story. The story will be sent below your comment."]),$.make("div",{className:"NB-modal-email-comments-container"},[$.make("textarea",{className:"NB-modal-email-comments"})]),$.make("div",{className:"NB-modal-email-from-container"},
[$.make("div",[$.make("label",{"for":"NB-send-email-from-name"},[$.make("span",{className:"NB-raquo"},"&raquo;")," Your name: "]),$.make("input",{className:"NB-input NB-modal-email-from",name:"from_name",id:"NB-send-email-from-name",value:this.model.preference("full_name")||NEWSBLUR.Globals.username||""})]),$.make("div",{style:"margin-top: 8px"},[$.make("label",{"for":"NB-send-email-from-email"},[$.make("span",{className:"NB-raquo"},"&raquo;")," Your email: "]),$.make("input",{className:"NB-input NB-modal-email-from",
name:"from_email",id:"NB-send-email-from-email",value:NEWSBLUR.Globals.email||this.model.preference("email")||""})])]),$.make("form",{className:"NB-recommend-form"},[$.make("div",{className:"NB-error"}),$.make("div",{className:"NB-modal-submit"},[$.make("input",{type:"submit",className:"NB-modal-submit-save NB-modal-submit-green",value:"Send this story"})," or ",$.make("a",{href:"#",className:"NB-modal-cancel"},"cancel")])])])},save:function(){var a=$("input[name=from_name]",this.$modal).val(),b=
$("input[name=from_email]",this.$modal).val(),c=$("input[name=to]",this.$modal).val(),d=$("textarea",this.$modal).val(),e=$("input[type=submit]",this.$modal);$(".NB-modal-error",this.$modal).hide();e.addClass("NB-disabled").val("Sending...");$(".NB-modal-loading",this.$modal).addClass("NB-active");this.model.preference("full_name",a);this.model.preference("email",b);$(".NB-error",this.$modal).fadeOut(500);this.model.send_story_email({story_id:this.story_id,feed_id:this.feed_id,from_name:a,from_email:b,
to:c,comments:d},this.save_callback,this.error)},save_callback:function(a){var b=$("input[type=submit]",this.$modal);!a||a.code<0?($(".NB-error",this.$modal).html(a.message).fadeIn(500),$(".NB-modal-loading",this.$modal).removeClass("NB-active"),b.removeClass("NB-disabled").val("Send this story")):(b.val("Sent!"),this.close())},error:function(){var a=$(".NB-modal-error",this.$modal);a.show();a.text("There was a issue on the backend with sending your email. Sorry about this! It has been noted and will be fixed soon. You should probably send this manually now.");
$(".NB-modal-loading",this.$modal).removeClass("NB-active")},handle_click:function(a,b){var c=this;$.targetIs(b,{tagSelector:".NB-modal-submit-save"},function(){b.preventDefault();c.save();return!1})}});NEWSBLUR.ReaderTutorial=function(a){_.bindAll(this,"close");this.options=$.extend({page_number:1},{},a);this.model=NEWSBLUR.AssetModel.reader();this.page_number=this.options.page_number;this.intervals={};this.runner()};NEWSBLUR.ReaderTutorial.prototype=new NEWSBLUR.Modal;
NEWSBLUR.ReaderTutorial.prototype.constructor=NEWSBLUR.ReaderTutorial;
_.extend(NEWSBLUR.ReaderTutorial.prototype,{TITLES:["Learn to use NewsBlur","Three Site Views","Training the Intelligence","Tips and Tricks","Feedback and Open Source"],runner:function(){this.make_modal();this.open_modal();this.page(1);this.load_newsblur_blog_info();this.load_intelligence_slider();this.load_tips();this.make_story_titles();this.rotate_slider();this.$modal.bind("click",$.rescope(this.handle_click,this))},load_newsblur_blog_info:function(){this.model.load_tutorial({},_.bind(function(a){this.newsblur_feed=
a.newsblur_feed;$(".NB-javascript",this.$modal).removeClass("NB-javascript")},this))},make_modal:function(){this.$modal=$.make("div",{className:"NB-modal-tutorial NB-modal"},[$.make("span",{className:"NB-modal-loading NB-spinner"}),$.make("div",{className:"NB-modal-page"}),$.make("h2",{className:"NB-modal-title"}),$.make("div",{className:"NB-page NB-page-1"},[$.make("h4","NewsBlur is a visual feed reader with intelligence."),$.make("div","You'll figure out much of NewsBlur by playing around and trying things out. This tutorial is here to quickly offer a foundation."),
$.make("h4","This tutorial covers:"),$.make("ul",[$.make("li",[$.make("div",{className:"NB-right"},"Page 2"),"Using the three views (Original, Feed, and Story)"]),$.make("li",[$.make("div",{className:"NB-right"},"Page 3"),"Training and filtering stories"]),$.make("li",[$.make("div",{className:"NB-right"},"Page 4"),"Tips and tricks that may not be obvious"]),$.make("li",[$.make("div",{className:"NB-right"},"Page 5"),"Feedback, open source, the blog, and twitter"])]),$.make("h4","Why you should use NewsBlur:"),
$.make("ul",[$.make("li",["This is a free service that is always getting better."]),$.make("li",["See the original site and read stories as the author intended."]),$.make("li",["Spend less time as NewsBlur filters the stories for you."])])]),$.make("div",{className:"NB-page NB-page-2"},[$.make("h4","Read your sites with three different views:"),$.make("div",{className:"NB-tutorial-view"},[$.make("div",{className:"NB-tutorial-view-title"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/application_view_tile.png"}),
"Original"]),$.make("img",{className:"NB-tutorial-view-image",src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/tutorial_view_original.png"}),$.make("span","The site itself.")]),$.make("div",{className:"NB-tutorial-view"},[$.make("div",{className:"NB-tutorial-view-title"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/application_view_list.png"}),"Feed"]),$.make("img",{className:"NB-tutorial-view-image",src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/tutorial_view_feed.png"}),$.make("span",
"All feed stories.")]),$.make("div",{className:"NB-tutorial-view"},[$.make("div",{className:"NB-tutorial-view-title"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/application_view_gallery.png"}),"Story"]),$.make("img",{className:"NB-tutorial-view-image",src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/tutorial_view_story.png"}),$.make("span","Story click-through.")]),$.make("ul",[$.make("li",["The view you choose is saved per-site, so you can mix-and-match."]),$.make("li",["Double-click story titles to temporarily open a story in the Story view."]),
$.make("li",["In the Original view, if a story is not found, it will temporarily open in the Feed view."]),$.make("li",["Much about these views can be customized under Preferences."])])]),$.make("div",{className:"NB-page NB-page-3"},[$.make("h4","NewsBlur works best when you use intelligence classifiers."),$.make("ul",[$.make("li",{className:"NB-tutorial-train-1"},[$.make("b","First: Train stories and sites."),$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/tutorial_train_feed.png"}),$.make("img",
{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/tutorial_train_story.png"})]),$.make("li",[$.make("b","Second: The intelligence slider filters stories based on training."),$.make("div",{className:"NB-tutorial-stories",id:"story_titles"}),$.make("img",{className:"NB-trainer-bullet",src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/bullet_green.png"})," are stories you like",$.make("br"),$.make("img",{className:"NB-trainer-bullet",src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/bullet_yellow.png"})," are stories you have not yet rated",
$.make("br"),$.make("img",{className:"NB-trainer-bullet",src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/bullet_red.png"})," are stories you don't like",$.make("div",{className:"NB-taskbar-intelligence"},[$.make("div",{className:"NB-tutorial-slider"}),$.make("div",{className:"NB-taskbar-intelligence-indicator NB-taskbar-intelligence-negative"}),$.make("div",{className:"NB-taskbar-intelligence-indicator NB-taskbar-intelligence-neutral"}),$.make("div",{className:"NB-taskbar-intelligence-indicator NB-taskbar-intelligence-positive"}),
$.make("div",{className:"NB-intelligence-slider"})])])])]),$.make("div",{className:"NB-page NB-page-4"},[$.make("h4","Here are a few tricks that may enhance your experience:"),$.make("ul",[$.make("li",{className:"NB-tutorial-tips-sites"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/tutorial_tips_sites.png"}),$.make("div",["Click on the sites count at the top of the sidebar to hide sites with no unread stories."])]),$.make("li",[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/tutorial_tips_instafetch.png"}),
"Instantly refresh a site by right-clicking on it and selecting ",$.make("b","Insta-fetch stories.")]),$.make("li",[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/tutorial_tips_stories.png"}),"Click the arrow next to sites and stories to open up a menu."]),$.make("li",{className:"NB-tutorial-tips-train"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/tutorial_tips_train.png"}),$.make("div","Train sites in the Feed view by clicking directly on the tags and authors. The tags will rotate color between like and dislike.")]),
$.make("li",[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/tutorial_tips_folders.png"}),"Folders can be nested inside folders."]),$.make("li",["There are more than a dozen keyboard shortcuts you can use:",$.make("div",{className:"NB-modal-keyboard"},[$.make("div",{className:"NB-keyboard-group"},[$.make("div",{className:"NB-keyboard-shortcut"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Next story"),$.make("div",{className:"NB-keyboard-shortcut-key"},["&#x2193;"]),$.make("div",
{className:"NB-keyboard-shortcut-key"},["j"])]),$.make("div",{className:"NB-keyboard-shortcut NB-last"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Previous story"),$.make("div",{className:"NB-keyboard-shortcut-key"},["&#x2191;"]),$.make("div",{className:"NB-keyboard-shortcut-key"},["k"])])]),$.make("div",{className:"NB-keyboard-group"},[$.make("div",{className:"NB-keyboard-shortcut"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Next site"),$.make("div",{className:"NB-keyboard-shortcut-key"},
["shift",$.make("span","+"),"&#x2193;"])]),$.make("div",{className:"NB-keyboard-shortcut NB-last"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Prev. site"),$.make("div",{className:"NB-keyboard-shortcut-key"},["shift",$.make("span","+"),"&#x2191;"])])]),$.make("div",{className:"NB-keyboard-group"},[$.make("div",{className:"NB-keyboard-shortcut"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Switch views"),$.make("div",{className:"NB-keyboard-shortcut-key"},["&#x2190;"]),
$.make("div",{className:"NB-keyboard-shortcut-key"},["&#x2192;"])]),$.make("div",{className:"NB-keyboard-shortcut NB-last"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Open Site"),$.make("div",{className:"NB-keyboard-shortcut-key"},["enter"])])]),$.make("div",{className:"NB-keyboard-group"},[$.make("div",{className:"NB-keyboard-shortcut"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Page down"),$.make("div",{className:"NB-keyboard-shortcut-key"},["space"])]),$.make("div",
{className:"NB-keyboard-shortcut NB-last"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Page up"),$.make("div",{className:"NB-keyboard-shortcut-key"},["shift",$.make("span","+"),"space"])])]),$.make("div",{className:"NB-keyboard-group"},[$.make("div",{className:"NB-keyboard-shortcut"},[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Next Unread Story"),$.make("div",{className:"NB-keyboard-shortcut-key"},["n"])]),$.make("div",{className:"NB-keyboard-shortcut NB-last"},
[$.make("div",{className:"NB-keyboard-shortcut-explanation"},"Hide Sidebar"),$.make("div",{className:"NB-keyboard-shortcut-key"},["u"])])])])])])]),$.make("div",{className:"NB-page NB-page-5"},[$.make("h4","Stay connected to NewsBlur on Twitter"),$.make("div",{className:"NB-tutorial-twitter"},[$.make("a",{className:"NB-splash-link",href:"http://twitter.com/samuelclay",target:"_blank"},[$.make("img",{src:"http://img.tweetimag.es/i/samuelclay_n.png",style:"border-color: #505050;"}),$.make("span","@samuelclay")]),
$.make("a",{className:"NB-splash-link",href:"http://twitter.com/newsblur",target:"_blank"},[$.make("img",{src:"http://img.tweetimag.es/i/newsblur_n.png"}),$.make("span","@newsblur")])]),$.make("h4",{className:"NB-tutorial-feedback-header"},"Community Feedback"),$.make("ul",[$.make("li",[$.make("a",{href:"http://getsatisfaction.com/newsblur",className:"NB-splash-link"},["NewsBlur on ",$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/getsatisfaction.png",style:"vertical-align: middle;margin: -2px 0 0"}),
" Get Satisfaction"])])]),$.make("h4",{className:"NB-tutorial-feedback-header"},["Open Source Code"]),$.make("ul",[$.make("li",[$.make("a",{href:"http://github.com/samuelclay",className:"NB-splash-link"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/howitworks_github.png",style:"float: right;margin: -68px 12px 0 0"}),"NewsBlur on ",$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/github_icon.png",style:"vertical-align: middle;margin: -2px 0 0"})," GitHub"])])]),$.make("h4",{className:"NB-tutorial-feedback-header"},
"The NewsBlur Blog"),$.make("ul",[$.make("li",[$.make("div",{className:"NB-modal-submit-button NB-modal-submit-green NB-javascript NB-tutorial-finish-newsblur-blog",style:"float: right;margin-top: -2px"},["Finish Tutorial and Load",$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/favicon.png",style:"margin: -3px 0px 0px 4px; vertical-align: middle;"})," the NewsBlur Blog ",$.make("span",{className:"NB-raquo"},"&raquo;")]),"Monthly updates."])])]),$.make("div",{className:"NB-modal-submit"},[$.make("div",
{className:"NB-page-next NB-modal-submit-button NB-modal-submit-green NB-modal-submit-save"},[$.make("span",{className:"NB-tutorial-next-page-text"},"Next Page "),$.make("span",{className:"NB-raquo"},"&raquo;")]),$.make("div",{className:"NB-page-previous NB-modal-submit-button NB-modal-submit-close NB-modal-submit-save"},[$.make("span",{className:"NB-raquo"},"&laquo;")," Previous Page"])])])},set_title:function(){$(".NB-modal-title",this.$modal).text(this.TITLES[this.page_number-1])},load_tips:function(){},
make_story_titles:function(){var a=$(".NB-tutorial-stories",this.$modal);_.each([["Story about space travel","","space","neutral"],["NewsBlur becomes #1 feed reader","","","positive"],["Everyday news","Sam Clay","news","neutral"],["Another top 10 list","RSC","top 10","negative"],["Boring story about sports","Godzilla","","negative"],["New Strokes album!","P. Smith","music","positive"]],function(b){b=$.make("div",{className:"story NB-story-"+b[3]},[$.make("div",{className:"NB-storytitles-sentiment"}),
$.make("a",{href:"#",className:"story_title"},[$.make("span",{className:"NB-storytitles-title"},b[0]),b[1]&&$.make("span",{className:"NB-storytitles-author"},b[1]),b[2]&&$.make("span",{className:"NB-storytitles-tags"},[$.make("span",{className:"NB-storytitles-tag"},b[2]).corner("4px")])]),$.make("div",{className:"NB-story-manage-icon"})]);a.append(b)})},load_intelligence_slider:function(){var a=this,b=$(".NB-intelligence-slider",this.$modal),c=this.model.preference("unread_view");b.slider({range:"max",
min:-1,max:1,step:1,value:c,slide:function(){},stop:function(b,c){clearInterval(a.intervals.slider);a.show_story_titles_above_intelligence_level(c.value)}})},rotate_slider:function(){clearInterval(this.intervals.slider);this.slider_value=0;this.intervals.slider=setInterval(_.bind(function(){this.slider_value=(this.slider_value+1)%3;this.set_slider_value(this.slider_value-1);this.show_story_titles_above_intelligence_level(this.slider_value-1)},this),2E3)},set_slider_value:function(a){$(".NB-intelligence-slider",
this.$modal).slider("value",a)},show_story_titles_above_intelligence_level:function(a){var a=a||0,b,c;a>0?(b=$(".NB-story-positive",this.$modal),c=$(".NB-story-neutral,.NB-story-negative",this.$modal)):a==0?(b=$(".NB-story-positive,.NB-story-neutral",this.$modal),c=$(".NB-story-negative",this.$modal)):a<0&&(b=$(".NB-story-positive,.NB-story-neutral,.NB-story-negative",this.$modal),c=$(".NB-story-nothing",this.$modal));b.slideDown(500);c.slideUp(500)},next_page:function(){return this.page(this.page_number+
1)},previous_page:function(){return this.page(this.page_number-1)},page:function(a){if(a==null)return this.page_number;var b=$(".NB-page",this.$modal).length;this.page_number=a;if(a==b)$(".NB-tutorial-next-page-text",this.$modal).text("Finish Tutorial ");else if(a>b)return this.close();else $(".NB-tutorial-next-page-text",this.$modal).text("Next Page ");$(".NB-page-previous",this.$modal).toggle(a!=1);$(".NB-page",this.$modal).css({display:"none"});$(".NB-page-"+this.page_number,this.$modal).css({display:"block"});
$(".NB-modal-page",this.$modal).html($.make("div",["Page ",$.make("b",this.page_number)," of ",$.make("b",b)]));this.set_title()},close:function(){this.model.load_tutorial({finished:!0});_.delay(function(){NEWSBLUR.reader.hide_tutorial()},500);NEWSBLUR.Modal.prototype.close.call(this)},close_and_load_newsblur_blog:function(){this.close();NEWSBLUR.reader.load_feed_in_tryfeed_view(this.newsblur_feed.id,this.newsblur_feed)},handle_click:function(a,b){var c=this;$.targetIs(b,{tagSelector:".NB-page-next"},
function(){b.preventDefault();c.next_page()});$.targetIs(b,{tagSelector:".NB-page-previous"},function(){b.preventDefault();c.previous_page()});$.targetIs(b,{tagSelector:".NB-tutorial-finish-newsblur-blog"},function(){b.preventDefault();c.close_and_load_newsblur_blog()});$.targetIs(b,{tagSelector:".NB-story-manage-icon"},function(){b.preventDefault();b.stopPropagation()})}});NEWSBLUR.About=function(a){this.options=$.extend({},{},a);this.runner()};
NEWSBLUR.About.prototype={runner:function(){this.make_modal();this.open_modal();this.$modal.bind("click",$.rescope(this.handle_click,this))},make_modal:function(){this.$modal=$.make("div",{className:"NB-modal-about NB-modal-exception NB-modal"},[$.make("a",{href:"#faq",className:"NB-link-about-faq"},"FAQ"),$.make("h2",{className:"NB-modal-title"},"About NewsBlur"),$.make("div",{className:"NB-fieldset NB-modal-submit"},[$.make("h5",[$.make("div",{className:"NB-exception-option-meta"}),$.make("span",
{className:"NB-exception-option-option"},"What:"),"A Feed Reader with Intelligence"]),$.make("div",{className:"NB-fieldset-fields"},[$.make("ul",{className:"NB-about-what"},[$.make("li","Read the original site or the RSS feed."),$.make("li","Automatically highlight stories you want to read."),$.make("li",{className:"last"},"Filter out stories you don't want to read.")])])]),$.make("div",{className:"NB-fieldset NB-modal-submit"},[$.make("h5",[$.make("div",{className:"NB-exception-option-meta"}),$.make("span",
{className:"NB-exception-option-option"},"Who:"),"A Labor of Love"]),$.make("div",{className:"NB-fieldset-fields"},[$.make("ul",{className:"NB-about-who"},[$.make("li",["Hand-crafted by: ",$.make("a",{href:"http://www.samuelclay.com"},"Samuel Clay")]),$.make("li",["Find him on Twitter: ",$.make("a",{href:"http://twitter.com/samuelclay"},"@samuelclay")]),$.make("li",["E-mail: ",$.make("a",{href:"mailto:samuel@ofbrooklyn.com"},"samuel@ofbrooklyn.com")]),$.make("li",{className:"last"},["Made in: ",$.make("a",
{href:"http://www.newyorkfieldguide.com"},"New York City")])])])]),$.make("div",{className:"NB-fieldset NB-modal-submit"},[$.make("h5",[$.make("div",{className:"NB-exception-option-meta"}),$.make("span",{className:"NB-exception-option-option"},"How:"),"Server-side technologies"]),$.make("div",{className:"NB-fieldset-fields"},[$.make("ul",{className:"NB-about-server"},[$.make("li",[$.make("a",{href:"http://www.djangoproject.com"},"Django"),": Web framework written in Python, used to serve all pages."]),
$.make("li",[$.make("a",{href:"http://ask.github.com/celery"},"Celery")," &amp; ",$.make("a",{href:"http://www.rabbitmq.com"},"RabbitMQ"),": Asynchronous queueing server, used to fetch and parse RSS feeds."]),$.make("li",[$.make("a",{href:"http://www.mongodb.com"},"MongoDB"),", ",$.make("a",{href:"http://www.mongodb.com/pymongo"},"Pymongo"),", &amp; ",$.make("a",{href:"http://www.github.com/hmarr/mongoengine"},"Mongoengine"),": Non-relational database, used to store stories, read stories, feed/page fetch histories, and proxied sites."]),
$.make("li",{className:"last"},[$.make("a",{href:"http://www.postgresql.com"},"PostgreSQL"),": Relational database, used to store feeds, subscriptions, and user accounts."])])])]),$.make("div",{className:"NB-fieldset NB-modal-submit"},[$.make("h5",[$.make("div",{className:"NB-exception-option-meta"}),$.make("span",{className:"NB-exception-option-option"},"How:"),"Client-side and design"]),$.make("div",{className:"NB-fieldset-fields"},[$.make("ul",{className:"NB-about-client"},[$.make("li",[$.make("a",
{href:"http://www.jquery.com"},"jQuery"),": Cross-browser compliant JavaScript code. IE works without effort."]),$.make("li",[$.make("a",{href:"http://documentcloud.github.com/underscore/"},"Underscore.js"),": Functional programming for JavaScript. Indispensible."]),$.make("li",[$.make("b","Miscellaneous jQuery Plugins:")," Everything from resizable layouts, to progress bars, sortables, date handling, colors, corners, JSON, animations. See the complete list on ",$.make("a",{href:"http://github.com/samuelclay/NewsBlur/"},
"NewsBlur's GitHub repository")])])])]),$.make("div",{className:"NB-fieldset NB-modal-submit"},[$.make("h5",[$.make("div",{className:"NB-exception-option-meta"}),$.make("span",{className:"NB-exception-option-option"},"Why:"),"What's the point of another RSS feed reader?"]),$.make("div",{className:"NB-fieldset-fields"},[$.make("ul",{className:"NB-about-why"},[$.make("li",["To learn how to build and scale the entire web stack: front-end JavaScript, HTML5 layout, back-end view processing, large dataset schema migrations, relational and non-relational database clusters across multiple servers, and getting multiple machines to talk to each other."]),
$.make("li",["All of this just to prove that I could do it."]),$.make("li",["But most importantly, to meet future co-founders."])])])])])},open_modal:function(){this.$modal.modal({minWidth:600,maxWidth:600,overlayClose:!0,onOpen:function(a){a.overlay.fadeIn(200,function(){a.container.fadeIn(200);a.data.fadeIn(200)})},onShow:function(){$("#simplemodal-container").corner("6px")},onClose:function(a,b){a.data.hide().empty().remove();a.container.hide().empty().remove();a.overlay.fadeOut(200,function(){a.overlay.empty().remove();
$.modal.close(b)});$(".NB-modal-holder").empty().remove()}})},handle_cancel:function(){$(".NB-modal-cancel",this.$modal).click(function(a){a.preventDefault();$.modal.close()})},handle_click:function(a,b){$.targetIs(b,{tagSelector:".NB-link-about-faq"},function(){b.preventDefault();$.modal.close(function(){NEWSBLUR.faq=new NEWSBLUR.Faq})})}};NEWSBLUR.Faq=function(a){this.options=$.extend({},{},a);this.runner()};
NEWSBLUR.Faq.prototype={runner:function(){$.modal.close();this.make_modal();this.open_modal();this.$modal.bind("click",$.rescope(this.handle_click,this))},make_modal:function(){this.$modal=$.make("div",{className:"NB-modal-about NB-modal-exception NB-modal"},[$.make("a",{href:"#faq",className:"NB-link-about-faq"},"About NewsBlur"),$.make("h2",{className:"NB-modal-title"},"Frequently Asked Questions"),$.make("div",{className:"NB-fieldset NB-modal-submit"},[$.make("h5",["The Reader"]),$.make("div",
{className:"NB-fieldset-fields"},[$.make("ul",{className:"NB-about-what"},[$.make("li",[$.make("div",{className:"NB-faq-question"},"What is the difference between the three views: Original, Feed, and Story?"),$.make("div",{className:"NB-faq-answer"},"Original view is the original site. Feed view is the RSS feed from the site. And Story view is the original site for one story at a time. Original view is the blog site, whereas Story view is an individual blog post. It's all personal preference, really."),
$.make("div",{className:"NB-faq-answer"},"You can double-click a story to temporarily open it up in the Story view. The next story you open will transport you back to whichever view you were on before. Double-clicking a Feed will open up the feed in a new tab.")]),$.make("li",[$.make("div",{className:"NB-faq-question"},"Am I actually at the original site? Can NewsBlur see what I see?"),$.make("div",{className:"NB-faq-answer"},"In order to show you the original site, NewsBlur takes a snapshot of the page. You may have noticed that if you are logged into the original site, you are not logged into NewsBlur's snapshot of the page. This is because NewsBlur fetched the site for you.")]),
$.make("li",{className:"last"},[$.make("div",{className:"NB-faq-question"},"Why doesn't NewsBlur follow me when I click on links on the page?"),$.make("div",{className:"NB-faq-answer"},"When you click on a link, you are technically leaving NewsBlur, although only for a portion of the page in an iframe. In order to track what you're reading, you need to read NewsBlur's snapshot of the page, or switch to the Feed view."),$.make("div",{className:"NB-faq-answer last"},"This may change one day. There is a way to fix this behavior so it works like you would expect. It is not easy to do, however. One day.")])])])]),
$.make("div",{className:"NB-fieldset NB-modal-submit"},[$.make("h5",["The Intelligence"]),$.make("div",{className:"NB-fieldset-fields"},[$.make("ul",{className:"NB-about-server"},[$.make("li",[$.make("div",{className:"NB-faq-question"},["What does the three-color slider do?"]),$.make("div",{className:"NB-faq-answer"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/intelligence_slider_positive.png",className:"NB-faq-image",width:114,height:29}),"This is called the intelligence slider. Slide it to the right to only show stories you like."]),
$.make("div",{className:"NB-faq-answer last"},[$.make("img",{src:NEWSBLUR.Globals.MEDIA_URL+"/img/reader/intelligence_slider_negative.png",className:"NB-faq-image",width:114,height:29}),"Slide it to the left to show stories you dislike. Stories all start off neutral, in the center of the slider."]),$.make("div",{className:"NB-faq-answer"},[$.make("br"),$.make("img",{className:"NB-trainer-bullet",src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/bullet_red.png"})," are stories you don't like",$.make("br"),
$.make("img",{className:"NB-trainer-bullet",src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/bullet_yellow.png"})," are stories you have not yet rated",$.make("br"),$.make("img",{className:"NB-trainer-bullet",src:NEWSBLUR.Globals.MEDIA_URL+"/img/icons/silk/bullet_green.png"})," are stories you like"])]),$.make("li",{className:"last"},[$.make("div",{className:"NB-faq-question"},"How does NewsBlur know whether I like or dislike a story?"),$.make("div",{className:"NB-faq-answer"},"When you like or dislike a story, you mark a facet of that story by checking a tag, author, part of the title, or entire publisher. When these facets are found in future stories, the stories are then weighted with your preferences. It is a very simple, explicit process where you tell NewsBlur what you like and don't like."),
$.make("div",{className:"NB-faq-answer"},"The idea is that by explicitly telling NewsBlur what your story preferences are, there is increased likelihood that you will like what the intelligence slider does for you."),$.make("div",{className:"NB-faq-answer last"},"Currently, there is not an automated way of detecting stories you like or dislike without having to train NewsBlur. This implicit, automatic intelligence will come in the near-term future, but it will require an evolution to the interface that has not been easy to figure out how to make in a simple, clear, and effective manner. Soon.")])])])]),
$.make("div",{className:"NB-fieldset NB-modal-submit"},[$.make("h5",["What's Coming"]),$.make("div",{className:"NB-fieldset-fields"},[$.make("ul",{className:"NB-about-who"},[$.make("li",[$.make("div",{className:"NB-faq-answer"},"An iPhone app.")]),$.make("li",{className:"last"},[$.make("div",{className:"NB-faq-answer last"},"Sort sites alphabetically, by popularity, use, unread counts.")])])])]),$.make("div",{className:"NB-fieldset NB-modal-submit"},[$.make("h5",["Something's Wrong"]),$.make("div",
{className:"NB-fieldset-fields"},[$.make("ul",{className:"NB-about-client"},[$.make("li",[$.make("div",{className:"NB-faq-question"},"Help! All of the stories are several days old and new stories are not showing up."),$.make("div",{className:"NB-faq-answer"},"Sites that only have a single subscriber tend to get updated much less often than popular sites. Additionally, the frequency that a site publishes stories (once per month or several per day) has an impact on how often the site is refreshed.")]),
$.make("li",[$.make("div",{className:"NB-faq-question"},"Help! A bunch of my sites are misbehaving and they work in Google Reader."),$.make("div",{className:"NB-faq-answer"},"This is a known issue that is being addressed in a number of ways. About half of these misbehaving errors are errors that you really do need to address (like 404 Not Found errors). The other half are various edge cases, parser errors, uncaught exceptions, and bad code on NewsBlur's part."),$.make("div",{className:"NB-faq-answer"},
"But because this problem is so severe, various measures are taken every few weeks that fix a huge swath of misbheaving sites at once. You might find that this happens and it's quite nice when it does.")]),$.make("li",{className:"last"},[$.make("div",{className:"NB-faq-question"},"Help! I have an issue and it's not mentioned here."),$.make("div",{className:"NB-faq-answer last"},["Please, please, please e-mail ",$.make("a",{href:"mailto:samuel@ofbrooklyn.com"},"samuel@ofbrooklyn.com"),". If you have an issue it is entirely possible that other people do, too."])])])])])])},
open_modal:function(){this.$modal.modal({minWidth:600,maxWidth:600,overlayClose:!0,onOpen:function(a){a.overlay.fadeIn(200,function(){a.container.fadeIn(200);a.data.fadeIn(200)})},onShow:function(){$("#simplemodal-container").corner("6px")},onClose:function(a,b){a.data.hide().empty().remove();a.container.hide().empty().remove();a.overlay.fadeOut(200,function(){a.overlay.empty().remove();$.modal.close(b)});$(".NB-modal-holder").empty().remove()}})},handle_cancel:function(){$(".NB-modal-cancel",this.$modal).click(function(a){a.preventDefault();
$.modal.close()})},handle_click:function(a,b){$.targetIs(b,{tagSelector:".NB-link-about-faq"},function(){b.preventDefault();$.modal.close(function(){NEWSBLUR.about=new NEWSBLUR.About})})}};
