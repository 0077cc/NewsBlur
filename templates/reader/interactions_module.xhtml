{% load utils_tags typogrify_tags statistics_tags %}

{% if interactions %}
<div class="NB-module NB-module-features">

    <h5 class="NB-module-header">
        <div class="NB-module-header-right">
            <div class="NB-spinner NB-left"></div>
            <a href="#" class="NB-module-direction NB-module-next-page NB-javascript {% if interactions|length <= 5 %}NB-disabled{% endif %}"></a>
            <a href="#" class="NB-module-direction NB-module-previous-page NB-disabled"></a>
        </div>
        Interactions
    </h5>

    <ul class="NB-interactions">
        {% for interaction in interactions|slice:":5" %}
        <li class="NB-interaction NB-interaction-{{ interaction.category }}"
            {% if interaction.content_id %}data-content-id="{{ interaction.content_id }}"{% endif %}>
            {% if interaction.category == 'follow' %}
                <img class="NB-interaction-photo NB-interaction-profile-photo" src="{{ interaction.photo_url }}"  data-user-id="{{ interaction.with_user_id }}">
                <div class="NB-interaction-date">
                    {{ interaction.date }} ago
                </div>
                <div class="NB-interaction-title">
                    <span class="NB-interaction-username NB-splash-link" data-user-id="{{ interaction.with_user_id }}">
                        {{ interaction.with_user.username }}
                    </span> started following you.
                </div>
            {% endif %}

            {% if interaction.category == 'comment_reply' or interaction.category == 'reply_reply' %}
                <img class="NB-interaction-photo NB-interaction-profile-photo" src="{{ interaction.photo_url }}"  data-user-id="{{ interaction.with_user_id }}">
                <div class="NB-interaction-date">
                    {{ interaction.date }} ago
                </div>
                <div class="NB-interaction-title">
                    <span class="NB-interaction-username NB-splash-link" data-user-id="{{ interaction.with_user_id }}">
                        {{ interaction.with_user.username }}
                    </span> replied to your {% if interaction.category == 'comment_reply' %}comment{% else %}reply{% endif %}:
                </div>
                <div class="NB-interaction-content">
                    "<span class="NB-interaction-starred-story-title NB-splash-link" data-social-user-id="{{ interaction.feed_id }}">{{ interaction.content|truncatewords:16 }}</span>"
                </div>
            {% endif %}
        </li>
        {% endfor %}
    </ul>

</div>
{% endif %}